
package fire.pb.battle.livedie;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import fire.pb.PropRole;
import fire.pb.StateCommon;
import fire.pb.battle.pvp.PvPHelperManager;
import fire.pb.buff.BuffAgent;
import fire.pb.buff.BuffConstant;
import fire.pb.buff.BuffRoleImpl;
import fire.pb.main.ConfigManager;
import fire.pb.map.MapConfig;
import fire.pb.map.Role;
import fire.pb.map.RoleManager;
import fire.pb.talk.MessageMgr;
import fire.pb.team.PAbsentReturnTeam;
import fire.pb.team.Team;
import fire.pb.team.TeamManager;
import fire.pb.title.COffTitle;
import fire.pb.util.MessageUtil;

import org.apache.log4j.Logger;



// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CAcceptLiveDieBattle__ extends mkio.Protocol { }

// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

public class CAcceptLiveDieBattle extends __CAcceptLiveDieBattle__ {
	@Override
	protected void process() {
		// npc濠电姷鏁告慨鐑藉极閸涘﹥鍙忓ù鍏兼綑閸ㄥ倿鏌ｉ幘宕囧哺闁哄鐗楃换娑㈠箣閻愰潧鏆￠梺鐟板槻閸㈡煡锝炲┑瀣亗閹肩补妲呭楣冩⒒娴ｇ鎮戞俊鐐跺Г缁傚秶鎹勬笟顖氭婵犵數濮甸懝鎯ф暜闂備線娼ч敍蹇曚沪閼恒儱锟芥稒绻濋悽闈浶ユい锝堟鍗遍柛娑欐綑閸ㄥ倿姊婚崼鐔衡枔闁哄绉归弻銊モ攽閸℃ɑ鎮欏銈冨劜閼归箖鍩為幋锔藉亹鐎规洖娴傞弳锟犳⒑缂佹ɑ灏伴柣鐔叉櫊瀵濡搁埡鍌氫簽闂佺鏈粙鎴︻敂閿燂拷?
		final long guestid = gnet.link.Onlines.getInstance().findRoleid(this);
		if (guestid <= 0)
			return;
		
		//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣规偠閸庢椽宕滃▎鎴濐棜鐟滅増甯楅悡娑氾拷骞垮劚妤犳悂鐛弽顓熺參闁告劦浜滈弸娑㈡煛鐏炲墽娲村┑锛勫厴閺佹劙宕ㄩ褏锟界兘姊绘担鍝ワ紞缂侇噮鍨拌灋闁告劦鍠栫粻鏍ㄤ繆閵堝懏鍣洪柡鍛叀楠炴牜鍒掗惂鍛婂闁肩⒈鍓涘▔鍧楁⒒閸屾瑦绁版い鏇嗗懏宕查柟瀵稿Х閻瑩鏌熸潏鍓х暠闁绘挴锟芥剚鐔嗛柤鎼佹涧婵洨绱掗銏⑿ч柡宀�鍠栭幃娆擃敆閿熻姤鏅堕娑氱鐎瑰壊鍠栭獮鏍煃鐟欏嫬鐏撮柟顔界懇閹崇娀顢楅敓浠嬄烽敓浠嬫⒒娴ｈ鍋犻柛鏂挎湰閺呰埖鎯旈敐鍛亰闁诲函缍嗘禍鍫曞触鐎ｎ亶鐔嗛悹杞拌閸庡繘鏌ㄩ悢鐑樻珪缂侇噮鍨辩粚杈ㄧ節閸ヨ埖鏅┑鐐村灦椤ㄥ棝宕板鑸碘拺闁圭瀛╃粈锟介梺绋匡工缂嶅﹪骞冮敓鐘插嵆闁绘梻顭堝鍨攽閳藉棗鐏犻柟纰卞亰閸╂盯寮崼鐔哄幗闂佹寧绻傞ˇ顕�骞夋ィ鍐╃厸鐎癸拷鐎ｎ剛蓱濡ょ姷鍋涢敃顏堝蓟濞戙垹绫嶉柨鐔剁矙瀹曞綊鎮介崨濠備患闂佺粯鍨兼慨銈夊疾閹间焦鐓ラ柣鏇炲�圭�氾拷?
		Long hostid=xtable.Livedie2key.select(guestid);
		//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣规偠閸庢椽宕滃▎鎴濐棜鐟滅増甯楅悡娑氾拷骞垮劚妤犳悂鐛弽顓熺參闁告劦浜滈弸娑㈡煛鐏炲墽娲村┑锛勫厴椤㈡瑩鎮℃惔顔戒氦闂傚倷绀侀幉锟犳偡閵夆晜鏅濋柕澶嗘櫅妗呴梺鍛婃处閸ㄤ即宕橀敓浠嬫⒑闂堟丹娑氫沪閻愵剦鍟囬梻鍌氬�烽懗鍫曗�﹂崼鐕佹闁归棿鐒﹂弲婵囥亜韫囨挾澧曢柦鍐枛閺屻劑鎮㈤崫鍕戙垽姊洪崡鐐村缂佺粯绻堝畷褰掝敃閵忕媭娼旈梺鍝ュ枎閹芥粎妲愰幘璇茬＜婵炲棙鍨垫俊钘夘渻閵堝啫濡奸柟铏耿閻涱喗绻濋崒銈嗗缓闂佽法鍠嶇划娆撳箖娴兼惌鏁婇柟鎯ф噺鐎氬綊鏌ㄥ┑鍡楀毐闁归鍏橀、姗�鎮╅崣澶屼邯闂備浇顕栭崰姘跺礂濡警鍤曢悹楦裤��閺嬪酣鏌ｉ幇闈涘缂佷緡鍣ｅ濠氬磼濮橆剨鎷烽悜鑺ュ�块柨鏇炲�归崕鎴犳喐閻楀牆绗掔紒锟芥径宀嬫嫹閻у憡瀚归梺璺ㄥ枍缁瑩寮幘缁樺殟闁靛鍎卞В鍫熺箾鐎涙鐭嬬紒顔肩Ч瀵煡濡烽埡鍌楁嫼闁荤姵浜介崝灞解枍閹扮増鐓欓柛鎴欏�栫�氾拷
		if(hostid==null){
			//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝夋交閼板潡寮堕崼姘珔闁搞劍绻冮妵鍕冀椤愵澀绮剁紓渚婃嫹濠㈣泛顑勭换鍡涙煏閸繃鍣洪柛锝囨嚀椤╁ジ宕ㄩ娑欐杸濡炪倖姊归弸缁樼瑹濞戙垺鐓曢煫鍥ㄦ閼拌法锟芥鍠栭…鐑藉极閸愵喖纾兼繛鎴炶壘鐢姊绘担鍝ユ瀮婵℃ぜ鍔庣划鍫熺瑹閿熻棄顕ｉ幎鑺ュ�烽柣銏㈡暩閿涙粓姊虹紒妯忣亪宕捄銊х當鐟滃繒妲愰幒鎾寸秶闁靛绠戦棄宥夋⒑閻熸澘妲婚柟铏悾鐑芥倻缁涘鏅ｉ梺缁樻閺�閬嶆偟閿涘嫮纾介柛灞捐壘閿熻姤鎮傚畷鎰板传閵壯呯厠婵炶揪绲介崯顖炲箠瀹�锟界槐鎾诲磼濞嗘埈妲銈嗗灥閹虫妫熼梻渚囧墮缁夌敻寮查幖浣圭厸闁稿本锚閿熻姤顨堢划鏃堟偨閸涘﹦鍘遍柣搴秵娴滄粓顢旈銏＄厵妞ゆ梻鐓鍫濈叀濠㈣泛谩閻斿吋鐓ラ悗锝呯仛缂嶅矂姊婚崒娆戭槮闁圭⒈鍋婂畷顖烆敍閻愯尙顔囬梺褰掓？闂勫秹鏁撻挊澶嬪殗妞ゃ垺顨嗛幏鍛存惞鐠団�虫櫗闂傚倷绀佹竟濠囧磻閸℃稑绐楅幖娣妽閸婂爼鏌ㄩ弬鍨挃缁炬儳銈搁弻娑樼暆鐎ｎ喗顎嶉柣搴㈢啲閹凤拷?162079
			fire.pb.talk.MessageMgr.sendMsgNotify(guestid, 162079, null);
			return ;
		}
		//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹鐎规洏鍎抽敓鏂ょ秵閸犳牜澹曢崸妤佺厵闁诡垳澧楅ˉ澶愬箹閺夋埊韬柡灞诲�楅崰濠囧础閻愬樊娼芥俊鐐�栭崝鎺斿垝濞嗗浚鍤曢柛顐ｆ礀闁卞洦绻涢幋鐏活亪鈥栫�ｎ喗鈷戠�规洖娲ㄧ敮娑欎繆椤愩垹鏆ｆ鐐插暙铻栭柛娑卞枟濞呮粓鏌熼懖鈺勊夐柨鐔凤拷鐔风毢闁烩晛閰ｅ缁樻媴缁涘娈紓浣虹帛閸ㄥ湱鍒掑▎鎾崇闁挎洩鎷烽柣鎾拷鎰佺唵闁兼悂娼ф慨鍥╃磼椤愩垻效闁哄瞼鍠栭獮鍡氼槻妞わ絽纾槐鎺楀箛椤撗勭暦缂備胶绮惄顖炲极閹版澘宸濇い鏃囧Г閸婄兘姊绘担鐟邦嚋婵炶闄勭粋宥夘敂閸喎浠掑銈嗘⒒閺咁偊鎮疯ぐ鎺撶叆闁绘柨澧庨惌娆撴煏閸℃洜顦﹂柍钘夘樀婵拷闁绘ɑ鐖犻崶銊у幈闂侀潧顦崹鍝勨枍閹剧繝绻嗛柤纰卞墮閸樺瓨鎱ㄦ繝鍕笡闁瑰嘲鎳樺畷銊︾節閸屾稒鐣奸梻浣圭湽閸╁嫰宕归弶妫垫椽顢橀悙鍨闂佸湱澧楀姗�宕橀敓钘夘渻閵堝棙灏甸柛瀣█楠炴寮撮姀鈾�鎷洪梺纭呭亹閸嬫盯宕濋幘顔界厱闁规儳顕幊鍥╋拷瑙勬穿缁插墽鎹㈠┑瀣闁挎棁娉曢惄搴ㄦ⒒娴ｅ憡鎯堢紒澶嬬叀瀹曟繃鎯旈妸锝忔嫹閸岀偛钃熼柕澶涘閸橀亶鏌熼懖鈺勊夋俊鎻掑閻擃剟顢楅崒锔藉婵炲牆鐏濋弸娑㈡煟閺嵮佸仮鐎规洘妞介崺鍕礃閳轰緡锟芥捇姊洪懡銈呮灈闁稿锕ゅ嵄閺夊牄鍔庣弧锟介梺姹囧灲濞佳囶敁閹剧粯鐓欏瀣閸樻挳鏌＄仦璇插闁诡喓鍊濆畷鎺戔槈濮楀棔绱�
		xbean.LiveDieRoleInfo hostliveDieRoleInfo=xtable.Livedieroleinfotab.select(hostid);
		if(hostliveDieRoleInfo==null){
			return ;
		}
		if(System.currentTimeMillis()-hostliveDieRoleInfo.getInvitationtime()>LiveDieMange.getLiveDieTime()){
			logger.info("闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ礀缁犵娀鏌熼崜褏甯涢柛瀣ㄥ�濋弻鏇熺箾瑜嶇�氼噣鎮鹃幎鑺モ拻闁稿本鐟чˇ锕傛煙濞村鎷烽幇浣圭稁婵犵數濮甸懝鍓х玻濡ゅ懎绠归柟纰卞幘閸樻盯鏌℃担闈╄含闁绘搩鍋婂畷鍫曞Ω瑜夊銊╂⒑閹肩偛锟芥牠宕归崼鏇炍﹂柛鏇ㄥ灠缁犳娊鏌熺�涙绠伴柟鐑筋棑閹风姴顔忛鐣岀▉濠德板�х徊浠嬪疮椤栫偞鍋傛繛鎴烇供閻斿棝鎮归搹鐟板妺妞ゃ儳鍋炵换娑㈠川椤撶喎娅ょ紓浣虹帛缁嬫捇骞忛悩渚Ь闂佷紮缍佹禍鍫曞蓟閵娾晛鍗虫俊顖濇娴煎牓姊虹化鏇熸珔閻庢碍婢橀悾宄邦潨閿熶粙銆侀弬娆惧悑闁糕剝绋掗弳锟�?");
			return ;
		}
		
		//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣规偠閸庢椽宕滃▎鎴濐棜鐟滅増甯楅悡娑氾拷骞垮劚妤犳悂鐛弽顓熺參闁告劦浜滈弸娑㈡煛鐏炲墽娲村┑锛勫厴椤㈡瑩鎮℃惔顔芥祰闂傚倷鑳堕…鍫ヮ敄閸℃瑦宕查柛顐犲劚閽冪喓锟藉箍鍎卞Λ娆愭叏濠婂牊鐓欐繛鍫濈仢閺嬶妇绱掗幇顓ф疁婵﹥妞藉畷顐﹀Ψ閵夛妇褰氶梻浣哥秺椤ユ捇宕楀Ο渚綎缂備焦蓱婵挳鏌涘☉姗堟敾闁稿孩鎹囬弻锝嗘償閵忥紕娈ら梺绋跨箲閿氶柣锝夘棑閹叉挳宕熼顐㈡闂備礁鎼ˇ浼村垂瑜版帗鍋╅柣鎰靛墰缁犻箖鏌熼幆褜鍤熼柛鐔哥叀閺岀喖鎮滅粵瀣棖闂佽法鍠庨敓鐣屽櫏濞兼劖绻涢崣澶岀煉鐎规洘顨呰灒閻犱礁纾粻姘攽椤旂晫绠撻柣顓炵墕鍗遍悹鍥ㄧゴ閺�浠嬫煟閹邦垰鐨哄褎濞婇弻鐔煎礄閵堝棗顏�
		Role hostRole = RoleManager.getInstance().getRoleByID(hostid);
		if (hostRole == null){
			fire.pb.talk.MessageMgr.sendMsgNotify(guestid, 145001, null);
			return ;
		}
		//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣规偠閸庢椽宕滃▎鎴濐棜鐟滅増甯楅悡娑氾拷骞垮劚妤犳悂鐛弽顓熺參闁告劦浜滈弸娑㈡煛鐏炲墽娲村┑锛勫厴椤㈡瑩鎮℃惔顔芥祰闂傚倷鐒﹂幃鍫曞磹閺囥垺鏅濋柕澶嗘櫅妗呴梺鍛婃处閸犳岸鎮块敓浠嬫⒑閸︻厼浜鹃柛鎾寸鐎靛ジ鏁撻悾宀�纾介柛灞剧懆閸忓苯鈹戦鐐毄闁轰緡鍣ｉ弫鎾绘偐閼艰埖鎲伴梻浣芥硶閸犳挻鎱ㄧ�靛摜鐭嗛悗锝庡枟閳锋帡鏌涢銈呮灁闁靛棙甯掗湁闁绘﹩鍋呭▍濠冩叏婵犲懏顏犻柟椋庡█閸ㄦ儳鐣烽崶锔藉煕缂傚倸鍊峰ù鍥春閺嶎厽鍤屽Δ锝呭暞閸嬧晠鏌ｉ幋锝呅撻柛濠傤煼閺岋箑螣閻氬绀嗛梺鍐叉惈閹冲繘鎮¤箛鎿冪唵閻犻缚娅ｆ晶鏇㈡煕閺傝法鎽犲ǎ鍥э躬椤㈡洟濮�閳ヨ櫕鐏庢繝娈垮枛閿曘儱顪冮挊澶屾殾妞ゆ劧绠戠粈瀣亜閹捐泛浜归柟鍑ょ節濮婄粯鎷呴崨濠傛殘闂佸湱顭堥悥鐓庣暦濠靛洦鍎熼柍顓滃劵缂嶄線鐛崶顒夋晞闁兼亽鍎查弶鎼佹⒑鐠囨彃鍤辩紓宥呮缁傚秴鈹戦崱娆愭閻庡箍鍎遍ˇ浼村煕閹达附鈷掗柛顐ゅ枍缁堕亶鏌ｉ幒妤冪暫闁哄本绋掗幆鏃堝Ω閵堝棗鏋ら梺鑺ヮ焽閸犳捇鏁撻悾灞绢仧闁归鍏橀弻娑㈠即閵娿儱顫梺鍛娚戦幃鍌氼潖濞差亜绀堥柟缁樺笂閼割亪姊虹粙娆惧剰閻庢凹鍙冨鏌ュ醇閺囥劍鏅┑鐐村灦椤ㄥ牏绮诲顒夋富闁靛牆妫楁慨澶娾攽椤旇姤灏﹂柡浣规崌閹崇偤濡烽敂缁㈡Ч闂備胶纭堕弬鍌炲垂閽樺鍤曟い鏇嫹鐎规洜鍘ч埞鎴﹀幢濡ゅ啨鍋栭梻鍌氬�烽懗鍓佸垝椤栫偛绀夋俊顖炴？閻掑﹥绻涢崱妤冪闁哄棗妫欑换娑㈠箣濞嗗繒浠鹃梺鎶芥敱鐢帡濡撮幒鎴僵妞ゆ帊鐒﹂幃娆愮箾鐎涙鐭嬫い銊ユ閹广垹鈽夐姀鐘甸獓闂佺懓顕崑娑㈠几閻樺樊娓婚柕鍫濆暙閻忣亞锟界櫢鎷烽柟闂撮檷閿熸垝绀佽灃闁告侗鍠楀▍銏ゆ⒑閸忛棿鑸柛搴㈠絻閳诲秹鏁撻敓锟�?
		MapConfig cfg = ConfigManager.getInstance().getConf(MapConfig.class).get(hostRole.getMapId());
		if(cfg.dynamic ==1){
			fire.pb.talk.MessageMgr.sendMsgNotify(guestid,162002, null);
			return ;
		}
		xbean.Properties guestprop=xtable.Properties.select(guestid);
		//缂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴顏呭濡炪値鍋勭换鎴犳崲濠靛棭娼╂い鎺戝亰缁遍亶姊绘担铏瑰笡闁告梹顨堥幑銏犫攽閸喎搴婇梺绯曞墲閻燂箓宕伴幇鐗堢厸闁稿本绻冪涵鍫曟煛閸☆厾鐣甸柡宀嬬秮楠炲鏁愰崱鈺傤棄濠电偟顥愰崑鎰箾閿熶粙鏌＄仦鍓ф创鐎殿喗鎸虫俊鎼佸Ψ閵夘喗浜ら梻浣筋嚙閸戠晫绱為崶顒�绠柣鎴ｅГ閳锋帡鏌涚仦鍓ф噮闁告柨绉归弻鐔碱敊閼测晛鐓熼悗瑙勬礃濞茬喖鐛惔銊﹀癄濠㈣泛鐭夌槐閬嶆⒒娴ｅ憡璐￠柛瀣尵濞嗐垽鎮欏ù瀣潔闂侀潧绻掓慨鍫ｎ樄闁哄本绋戦埥澶愬矗濡厧鍤梻浣筋嚙妤犲繘骞忛敓锟�?
		if (PvPHelperManager.isPvPMap(hostRole.getMapId())){
			fire.pb.talk.MessageMgr.sendMsgNotify(guestid,162121, null);
			fire.pb.talk.MessageMgr.sendMsgNotify(hostid,162130, Arrays.asList(guestprop.getRolename()));
			return ;
		}
		//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣规偠閸庢椽宕滃▎鎴濐棜鐟滅増甯楅悡娑氾拷骞垮劚妤犳悂鐛弽顓熺參闁告劦浜滈弸娑㈡煛鐏炲墽娲村┑锛勫厴閺佹劙宕ㄩ褏锟界兘姊绘担鍝ワ紞缂侇噮鍨拌灋闁告劦鍠栫粻鏍ㄤ繆閵堝懏鍣洪柡鍛叀楠炴牜鍒掗惂鍛婂闁肩⒈鍓涘▔鍧楁⒒閸屾瑦绁版い鏇嗗懏宕查柟瀵稿Х閻瑩鏌熸潏鍓х暠闁绘挴锟芥剚鐔嗛柤鎼佹涧婵洨绱掗銏⑿ч柡宀�鍠栭幃娆擃敆閿熻姤鏅堕娑氱鐎瑰壊鍠栭獮鏍煃鐟欏嫬鐏撮柟顔界懇閹崇娀顢楅敓浠嬄烽敓浠嬫⒒娴ｈ鍋犻柛鏂胯嫰椤洭鏁撻悩闈涚ウ闂佸憡鍔﹂崰鏍不椤曪拷閺岋箑螣娓氼垱楔闂佸憡锚閹诧紕鎹㈠☉銏犵缁炬儳顑呴ˉ婵嗏攽閻愯尙婀撮柛濠冪箓椤曪綁骞撻幒鍡樼�婚梺鐟板⒔鐞涖儵骞忓ú顏呪拺闁告稑锕︾粻鎾绘倵濮樼厧澧存い銏℃楠炴﹢顢欓悾灞藉箞闂備線娼ч…鍫ュ磹閺囩偟鏆ら柛鈩冿供濞堜粙鏌ｉ幇顒�绾фい銉у仧缁辨帒螖閸愩劍鐏堥梺杞扮劍閹瑰洭骞愭繝鍐ㄧ窞閻忕偟鍋撻鏇㈡⒒娴ｈ櫣甯涢柛銊у帶铻為柛鏇ㄥ墮閸旀棃姊婚崒娆戝妽閻庣瑳鍏犳椽鍩￠崨顓狀唵闂佺粯鍨兼慨銈夋偂閻旇偐鍙撻柛銉ｅ妽閳锋帗绻涢崣澶嬪唉闁哄备锟藉磭鏆嗛悗锝庡墰閻﹀牓鎮楃憴鍕閻㈩垱甯￠崺銉﹀緞鐎ｎ偆绉堕梺闈浤涢崟顒夊晭闂傚倸鍊搁崐鐑芥倿閿曞倸绠栭柛顐ｆ礀缁�澶娾攽閻樺弶鎼愮紒锟芥径鎰厵閺夊牆澧介悾杈╃磼閻橀潧鈻堥柡宀�鍠栭獮鎴﹀箛闂堟稒顔勯柣搴ｆ嚀閹诧紕鎹㈤崼婵愭綎婵炲樊浜堕弫鍥煏婵炵偓娅嗘い搴＄Ф缁辨捇宕掑姣欍垺淇婇锝囩畵妞ゎ偄绻愮叅妞ゅ繐鎳庨崜顒勬⒑閸涘﹦鈽夐柨鏇樺�濋、鏃堟晸閿燂拷?
		BuffAgent hostAgent = new BuffRoleImpl(hostid, true);
		if (hostAgent.existBuff(BuffConstant.StateType.STATE_REPLAY)||hostAgent.existBuff(BuffConstant.StateType.STATE_BATTLE_FIGHTER)||hostAgent.existBuff(BuffConstant.StateType.STATE_BATTLE_WATCHER)) {
			MessageMgr.sendMsgNotify(guestid, 162132, null);
			fire.pb.talk.MessageMgr.sendMsgNotify(hostid,162130, Arrays.asList(guestprop.getRolename()));
			return ;
		}
		if (hostAgent.existBuff(500343)) {
			fire.pb.talk.MessageMgr.sendMsgNotify(guestid, 144999, 0, null);
			return ;
		}
		//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣规偠閸庢椽宕滃▎鎴濐棜鐟滅増甯楅悡娑氾拷骞垮劚妤犳悂鐛弽顓熺參闁告劦浜滈弸娑㈡煛鐏炲墽娲村┑锛勫厴婵拷闁斥晛鍟拌ぐ锝夋⒒娴ｅ憡璐￠柛蹇旓耿瀵劑鏌嗗鍛唵闂佸憡绋掑娆戠矆閸愵喗鐓熼柟浼存涧婢ф壆绱掓径灞藉幋婵﹦绮幏鍛村川婵犲啫鍓甸梻浣规た閸撴瑩濡剁粙璺ㄦ殾濞村吋娼欓崘锟介悷婊勭矒瀹曠敻寮撮悘璇茬秺瀹曟宕楅悡搴″闂備浇妗ㄧ粈浣虹矓閻㈢绠為柕濞垮労濞笺劑鏌涢埄鍐炬當缂佺姴缍婂娲川婵犲啫钄奸梺鍛婃⒐閸ㄧ敻锝炶箛鎾佹椽顢旈崪浣诡棃闂備礁鍟块幖顐わ拷姘煎櫍钘濆ù鐓庣摠閳锋垿鏌涘☉姗堟敾闁绘挶鍎靛铏规暜椤旀儳鍩岄梺浼欑悼閸忔﹢骞冩禒瀣窛濠电姴鍟鐔兼⒒娴ｈ姤纭堕柛锝忕畵楠炲繘鏁撻敓锟�
		if (!StateCommon.isOnlineBuffer(hostid)) {
			fire.pb.talk.MessageMgr.sendMsgNotify(guestid, 145001, null);
			return ;
		}
		int isteamfight=0;
		
		//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣规偠閸庢椽宕滃▎鎴濐棜鐟滅増甯楅悡娑氾拷骞垮劚妤犳悂鐛弽顓熺參闁告劦浜滈弸娑㈡煛鐏炲墽娲村┑锛勫厴椤㈡瑩鎮℃惔顔戒氦缂傚倸鍊烽懗鑸靛垔鐎电绶ら柣鎰靛墰閳瑰秴鈹戦悩鍙夌ォ闁轰礁绉电换婵囩節閸屾稑娅ｇ紓浣诡殣缁绘繂顫忛搹瑙勫珰闁肩⒈鍓涢鍥╃磽娴ｅ壊妲稿褍楠稿嵄闁圭増婢樼粻铏繆閵堝拑鏀婚柡鍛箞濮婃椽妫冨☉杈ㄢ枔闂佸摜濮甸悧鏇㈠煝閹炬椿鏁囬柕蹇婃閹锋椽鏌ｉ悩鍙夋悙鐎殿喖鐖奸獮鎴︽晲婢跺鍘遍棅顐㈡处濡垿鎳撶捄顭掓嫹濞堝灝娅橀柛瀣椤㈡ɑ绺界粙璺ㄥ�為梺鎸庢濡嫭鍒婃导瀛樷拻濞达綀娅ｇ敮娑㈡煕閺冩挾鐣电�规洘娲熼幃婊堟嚍閵夛附鐝曢梻浣告啞閹稿棝宕崘顏堟７濠电姷鏁搁崑鐘诲箵椤忓棗绶ら柛褎銇涢敓鏂ょ畵瀹曞ジ濡烽鑺ユ珕婵＄偑鍊栭幐楣冨窗瀹ュ洦宕查柛鈩冪♁閸嬶綁鏌涢妷銉︽悙婵炶绠撻、鎾愁吋閸涱亝鏂�闂佺粯鍔樺▔娑⑺夊鍡愪簻闁哄洤妫楀Λ娑欑閻ｅ瞼纾介柛灞捐壘閿熺晫鍏橀幃鐐烘晝閸屾鎷烽敃鍌氱妞ゆ牗绋掑▍鍥⒑缁嬫寧婀扮紒瀣崌瀹曘垽宕￠悙鈺傛杸闁圭儤濞婂畷鎰板箻缂佹ê锟藉潡鏌ㄩ弮锟介崕鎶剿夊杈╃＝濞达綀鍋傞幋锕�鐭楅煫鍥ㄧ♁閻撶喓鎲稿澶婄疅闁挎稑瀚搁幏宄邦潩閻愵剙顏�
		if(hostliveDieRoleInfo.getSelecttype()==1){//缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴闇夐柨婵嗘搐閻ㄦ垿鏌熷畡鏉挎Щ妞ゎ偅绻堥、姗�鎮㈤崫鍕闂備礁鎲￠〃濠冪閸洖钃熼柕濞炬櫆閸嬪棝鏌涚仦鍓р槈妞ゅ骏鎷�
			isteamfight=1;
			//濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閿熻棄鍊圭粋鎺旓拷锝庡亝濞呫垽姊洪懞銉冾亪藝椤栫偛姹查梺顒�绉甸悡銉╂煟閺冨倻甯涙い銉ヮ槺缁辨挸顓奸崪鍐惈濡ょ姷鍋涢崯顐ョ亽闁荤姴娲╃亸娆戠玻閻愮儤鈷戠憸鐗堝笒娴滀即鏌涢幘瀵告噧妞ゆ洩绲介悾锟犳焽閿旇棄鐦滈梻渚�娼ч悧鍡椢涘☉娆愭珷妞ゆ帒鍊荤壕鍏笺亜閺傝￥鍋㈤柛娆忓閺岀喖顢涘杈╀紘闂佽法鍠愰弸鑽ょ礊閸℃稑绐楁俊銈呮噹閻撴洟鏌熼悜姗嗘畷闁绘挻娲熼弻鐔煎级閸喗鍊庣紓浣靛妿缁垳鎹㈠☉銏犲窛妞ゆ梻鍘ч～搴ｇ磽娴ｄ粙鍝洪悽顖涱殔椤洩绠涘☉妯溾晝鎲歌箛娑欏仾闁告洦鍋�閺�浠嬫煃閽樺顥滃ù婊堢畺閺岀喖宕欓妶鍡楊伓?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾缁愭鏌熼柇锕�鍔掓繛宸簻缁狅綁鏌ｅΟ鍏兼毄闁绘帒鍚嬬换娑㈠箻鐎电鏆￠梺鍦厴椤ユ捇鏁撻崐鐕佹綈婵炲弶绻堥敐鐐村緞瀹�锟介惌澶愭煙閻戞ɑ顥栭柟椋庡厴閺佹劖鎯斿┑鍫濆毈婵＄偑鍊戦崕鑼崲閸岀偐锟芥棃宕橀鍢壯囨煕閳╁厾顏堝汲濡ゅ懏鈷戠紒瀣儥閸庢垿鏌涢悩铏暗闁告帗甯″顕�鏁撻悾宀�绱﹀ù鐘差儏瀹告繂鈹戦悩鎻掝仼妤犵偛鐗撳缁樻媴缁涘缍堥梺绋块绾绢厽绔熼弴銏╂晣闁绘柨鎲￠悵鈩冪節閻㈤潧孝闁汇儱顦垫俊鑸垫償閳╁啰鏉洪梻鍌氬�搁崐鍝ワ拷姘煎墰閿熻姤鍑归崳锝夊极閹剧粯鍋╅悘鐐靛亾濮ｅ嫰姊洪崨濠庣劶闁搞儴鍩栭弲锝嗙節闂堟稑锟藉鈥﹂崼銉у祦闁靛繆锟借尙绠氬銈嗙墬缁矂宕滃畷鍥╃＜闁绘娅曞畷宀�锟芥鍠涢褔鍩ユ径濠庢建闁糕剝锚閸忓﹪姊绘担鍛婂暈闁圭妫濆畷銊╊敊缁涘鏅梻鍌氬�搁崐鐑芥嚄閸洍锟斤箓宕奸姀鈥冲簥闂佺鎻梽鍕疾濠靛鐓忛煫鍥ㄦ礀椤庡矂鏌涢妶鍡樼闂囧鏌涜箛鎾虫倯闁稿孩顨婇弻鈩冩媴閸濄儛褔鏌″畝瀣М妤犵偛娲、娑樷槈濡崵鏆為梻鍌欑閹碱偄煤閵忋倕鍨傛繛宸簻閻撴洟鏌熼悜姗嗘畷闁绘挶鍎甸弻锝夊即閻愯鎷烽崷顓ㄦ嫹濮樼偓瀚�?
			//缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴闇夐柨婵嗘搐閻ㄦ垿鏌熷畡鏉挎Щ妞ゎ偅绻堥、姗�鎮㈤崫鍕闂備礁鎲￠〃濠冪閸洖钃熼柕濞炬櫅閸楁娊鏌ｉ幇顖ｅ殝闁归鍏樺畷顐﹀Ψ瑜忛悞濂告⒑閸涘﹤濮﹂柛鐘愁殜閹繝鏁愭径灞藉絼闂佹悶鍎甸ˉ鎾诲礆閺夋５鐟邦煥閸曨厾鐤勯梺鍝勭焿缂嶏拷缂佺姵鐩俊鐑芥晝閿熶粙顢旈敓锟�,闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢婚梻浣瑰濞叉牠宕愰幖浣稿瀭闁稿本鍩冮弨浠嬫煕鐏炲墽鐭ら柣鎺戝⒔缁辨帡鎮╁畷鍥у绩闂佸搫琚崝宀勫煘閹达箑骞㈡慨妤�妫欓敓銉︿繆閻愵亜锟芥劙寮插鍫熷亗闁炽儲鍓氶崵鏇㈡煕椤愶絾绀冮柛濠勫厴閺屸剝寰勭�ｎ亞鍔稿┑鈽嗗亜濡繂顫忓ú顏呭殥闁靛牆鎳忛悗鍓х磽娴ｇ瓔鍤欓柣妤佹尭椤曪絾绻濆顓熸闂佺粯顭堢亸娆撍囨导瀛樷拻闁稿本姘ㄦ晶娑氱磼鐎ｎ偅灏扮紒鍌涘笧缁瑦鎯旈幘瀛樻澑闂傚倸瀚ú顓€�佸顒夌叆闁告侗鍨粭澶愭⒑閸︻厼浜鹃柛鎾磋壘椤洭寮介锝呮瀾闂佺粯顨呴悧鍡欑箔閹烘梻纾奸柣妯哄船瀹撳棙顨ラ悙瀵稿ⅹ閼挎劖銇勯幒鐐村闂佺粯甯為崕銈嗙┍婵犲嫭瀚氱憸搴ｏ拷姘炬嫹,闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑﹦绋忔繝銏ｆ硾椤戝洭銆呴幓鎹楀綊鎮╁顔煎壈缂佺偓鍎冲鈥愁嚕閸洖閱囨い鎰垫線缁ㄥ瓨绻涚�涙鐭婄紓宥咃躬瀵鈽夐姀鈺傛櫇闂侀潧鐗嗛幊蹇涙倶娴ｅ壊娓婚柕鍫濆�瑰▍鍡涙煟閹垮嫮绡�鐎殿喗妲掗ˇ鍓佺磼閻樺磭娲寸�殿喗鎸抽幃銏ゆ煥鐎ｎ剚娈┑鐘垫暩閸嬫盯顢氶鐔峰灁妞ゆ挶鍨归崹鍌炴煕椤愶絾绀�闁藉啰鍠愮换娑㈠箣濞嗗繒浠肩紓浣哄缂嶄線寮婚妸銉㈡斀闁糕剝渚楅敓鑺ヮ殕缁绘盯宕奸銏犵缂備浇椴搁幐濠氬箯閸涱喚顩烽悗锝庝簼閹虫瑩姊绘担瑙勫仩闁告柨鑻…鍥晸閻樺啿浠掑銈嗘穿閹风兘鏌℃担瑙勫磳闁轰焦鎹囬弫鎾绘晸閿燂拷?,闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑﹦绋忔繝銏ｆ硾椤戝洭銆呴幓鎹楀綊鎮╁顔煎壈缂佺偓鍎冲鈥愁嚕閸洖閱囨い鎰垫線缁ㄥ瓨绻涚�涙鐭婄紓宥咃躬瀵鈽夐姀鈺傛櫇闂侀潧鐗嗛幊蹇涙倶娴ｅ壊娓婚柕鍫濆�瑰▍鍡涙煟閹绢垽鎷烽幇浣告闂佸壊鍋呭ú姗�宕愰悜鑺ョ厸濠㈣泛顑呴悞鐐繆椤愩垺顥犵紒杈ㄦ尰閹峰懘鎮烽弶娆炬綌婵＄偑鍊戦崝宀勬晝椤忓嫷鍤曞┑鐘崇閸嬪嫰鏌ц箛鎾磋础闁挎稒绮岄埞鎴﹀煡閸℃浠╅梺鍦拡閸嬪﹪鏁愰悙瀛樺劅闁靛鑵归幏娲⒒閸屾氨澧涚紒瀣笚瀵板嫰宕熼銊﹀闁谎冩啞鐎氬湱绱撴担鍓插創婵炲娲熷鎶芥晝閸屾稓鍙嗗┑鐘绘涧濡厼危閸濄儳纾奸柣娆忔噽缁夘噣鏌＄仦璇插闁宠鍨垮畷鍗烆潨閸℃﹩妫ч梻鍌氬�搁崐鎼佸磻閸℃稑鍨傞弶鍫氭櫆瀹曞弶绻涢幋鐐靛暡闁瑰嘲鍢查埥澶娾枎濡厧濮洪梻浣规た閸樿偐锟芥稈鏅滅粚杈ㄧ節閸屻倖瀵岄梺缁樻尭妤犳悂鈥栫�ｎ剛纾藉〒姘搐濞呮﹢鏌涘Ο鎸庮棄妞ゆ洏鍎靛畷鐔碱敍濮樿京鏉告俊鐐�栫敮顏堝箯妞嬪函鎷峰▓鍨灈闁搞垺鐓￠垾鏃堝礃椤斿槈褔鏌涢埄鍐噧闁冲嘲鐗撳铏圭矙濞嗘儳鍓抽梺绋款儑婵烇拷鐠侯垶鏌涘畝锟介崑鐐哄煕閹烘鐓曢悘鐐村礃婢规ê霉濠婏拷閸楁娊寮婚悢鐓庣闁靛牆妫楅锟�?,闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢婚梻浣瑰濞叉牠宕愰幖浣稿瀭闁稿本鍩冮弨浠嬫煕鐏炲墽鐭ら柣鎺戝⒔缁辨帡鎮╁畷鍥у绩闂佸搫琚崝宀勫煘閹达箑骞㈡慨妤�妫欓敓銉︿繆閻愵亜锟芥劙寮插鍫熷亗闁炽儲鍓氶崵鏇㈡煕椤愶絾绀冮柛濠勫厴閺屸剝寰勭�ｎ亞鍔稿┑鈽嗗亜濡稓妲愰幘瀛樺闁荤喐婢橀～宥咁渻閵堝啫濡奸柨鏇ㄤ簻椤曪絾绻濆顓炰簻闂佹儳绻愬﹢閬嶆晬濠婂啠鏀介柍钘夋閻忕娀鏌熺喊鍗炰喊闁挎繄鍋為幆鏃堝Ω閿旇瀚奸梻鍌氬�搁悧濠勭矙閹烘挸绶為柛鏇ㄥ弿閹风兘鎯傞崨濠傤伓闂備礁缍婂Λ鍧楁嚄鐠鸿櫣鏆ゅ〒姘炬嫹闁哄瞼鍠栭幃婊冾潨閸℃鏆ラ梺鍝ュ剱閸ㄨ泛顫忓ú顏咁棃婵炴垼椴歌倴闂備胶顭堟鍝ュ椤撶姴鍨濋柡鍐ㄧ墱閺佸棗霉閿濆牊顏犳い鏃�娲熼弻锝嗘償閵忊懇妾ㄥ銈庡幖濞差參骞嗙仦鍓х瘈闁搞儯鍔庨崢鐢电磼閻愵剚绶茬�规洦鍓氱粋宥夊箥椤曞棙瀚归悷娆忓缁�鍐煟閻斿弶娅婄�殿噮鍋勯鍏煎緞婵犲嫷妲规俊鐐�栭幐鐐垔鐎靛憡顫曢柡灞诲劜閳锋帒鈹戦悩鏌ヮ�楀ù婊勭矋缁绘稓鎷犺閻ｇ數锟芥鍠栭…閿嬩繆閹间焦鏅濋柨鐔烘櫕濞嗐垽鎮欑喊澶嬪妤犵偛鐏濋崝姘亜閿斿灝宓嗛柟顕嗙節瀵挳鎮㈤搹璇″晭闂備胶纭堕崜婵嬫晪婵犳鍣梽鍕崲濞戙垹閱囬柣鏂垮濡啴姊洪崫鍕拱闁烩晩鍨堕獮鍐煛閸涱厾鐓戞繝銏ｆ硾閿曘儵鎮炬繝姘厽閹兼番鍩勯崯蹇涙煕閿濆骸鐏︽鐐茬箻閺佹捇鏁撻敓锟�?,闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜堕弫鍥煏韫囨洖啸闁告繃顨婂缁樼瑹閸パ冾潻缂備礁顦伴幐鍐茬暦瑜版帒纾兼繛鎴炵懃瀵灝鈹戦绛嬫當婵☆偅顨婇悰顔碱潨閿熶粙寮诲鍥╃＜婵☆垳鍎甸幏鍦磽娴ｈ櫣甯涚紒瀣灴椤㈡瑨绠涘☉杈ㄦ櫓闂佺厧顫曢崐鏇㈠吹椤掑嫭鐓熼柣鎰嚟椤ｈ尙绱掔拠鑼妞ゎ偄绻戠换婵嗩潩椤掑偊绱查梻浣瑰濡礁螞閸曨垼鏁傞柨鐕傛嫹?
			Team hostteam = TeamManager.selectTeamByRoleId(hostid);
			if(hostteam==null){
				//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝夋交閼板潡寮堕崼姘珔闁搞劍绻冮妵鍕冀椤愵澀绮剁紓渚婃嫹濠㈣泛顑勭换鍡涙煏閸繃鍣洪柛锝囨嚀椤╁ジ宕ㄩ娑欐杸濡炪倖姊婚悺鏃堟倿閻愵剛绠惧璺侯儑濞叉挳鏌熼姘冲閾绘牠鏌涘☉鍗炴灓闁告鏁婚弻鈩冨緞婵犲嫬顣烘繝鈷�鍛珪缂侇喗鐟╅幊锟犲Χ韫囨柨顏堕柣鐔哥懃鐎氼厾绮堥敓浠嬫⒑閸濄儱鏋庢繛灏栵拷绛硅�垮ù锝囩《閺�浠嬫煟濡鍤嬬�规悶鍎甸弻鐔煎礃閺屻儱寮伴梺璇″灠閸熸挳鐛�ｎ喗鍋愰柣銏㈩暜缁辨煡姊洪崫鍕垫Ц闁绘瀚板畷婵囨償閿濆洣绗夐梺缁樺姈閹苯鈻撴禒瀣厽闁归偊鍓氶埢鏇㈡煕鎼淬垺鈷愭い銊ｅ劦閹瑩宕ｆ径濠冪亷婵＄偑鍊戦崹鍝勎涢崘銊ф殾闁割偅娲栭悡娑樷攽閻樻彃鏁憸鏂款潖婵犳艾纾兼慨姗嗗墾閹风兘骞栨担鍝ワ紮闂佸綊妫跨粈渚�鎮块娴庡綊宕楅崗鑲╃▏缂備焦鍔栭〃濠囧蓟閳ユ剚鍚嬮幖绮癸拷宕囶啇婵犳鍠涢～澶愭偂閿熺姴钃熼柕濞炬櫆閸嬪棝鏌涚仦鍓р槈妞ゅ骏鎷�
				fire.pb.talk.MessageMgr.sendMsgNotify(hostid, 162125, Arrays.asList(guestprop.getRolename()));
				fire.pb.talk.MessageMgr.sendMsgNotify(guestid, 162121, null);
				return ;
			}
			if(hostteam.getTeamLeaderId()!=hostid){
				//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝夋交閼板潡寮堕崼姘珔闁搞劍绻冮妵鍕冀椤愵澀绮剁紓渚婃嫹濠㈣泛顑勭换鍡涙煏閸繃鍣洪柛锝囨嚀椤╁ジ宕ㄩ娑欐杸濡炪倖姊婚悺鏃堟倿閻愵剛绠惧璺侯儑濞叉挳鏌熼姘冲閾绘牠鏌涘☉鍗炴灓闁告鏁婚弻鈩冨緞婵犲嫬顣烘繝鈷�鍛珪缂侇喗鐟╅幊锟犲Χ韫囨柨顏堕柣鐔哥懃鐎氼厾绮堥敓浠嬫⒑閸濄儱鏋庢繛灏栵拷绛硅�垮ù锝囩《閺�浠嬫煟濡鍤嬬�规悶鍎甸弻鐔煎礃閺屻儱寮伴梺璇″灠閸熸挳鐛�ｎ喗鍋愰柣銏㈩暜缁辨煡姊洪崫鍕垫Ц闁绘瀚板畷婵囨償閿濆洣绗夐梺缁樺姈閹苯鈻撴禒瀣厽闁归偊鍓氶埢鏇㈡煕鎼淬垺鈷愭い銊ｅ劦閹瑩宕ｆ径濠冪亷婵＄偑鍊戦崹鍝勎涢崘銊ф殾闁割偅娲栭悡娑樷攽閻樻彃鏁憸鏂款潖婵犳艾纾兼慨姗嗗墾閹风兘骞栨担鍝ワ紮闂佸綊妫跨粈渚�鎮块娴庡綊宕楅崗鑲╃▏缂備焦鍔栭〃濠囧蓟閳ユ剚鍚嬮幖绮癸拷宕囶啇婵犳鍠涢～澶愭偂閿熺姴钃熼柕濞炬櫆閸嬪棝鏌涚仦鍓р槈妞ゅ骏鎷�
				fire.pb.talk.MessageMgr.sendMsgNotify(hostid, 162125, Arrays.asList(guestprop.getRolename()));
				fire.pb.talk.MessageMgr.sendMsgNotify(guestid, 162121, null);
				return ;
			}
			//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣规偠閸庢椽宕滃▎鎴濐棜鐟滅増甯楅悡娑氾拷骞垮劚妤犳悂鐛弽顓熺參闁告劦浜滈弸娑㈡煛鐏炲墽娲村┑锛勫厴椤㈡瑩鎮℃惔顔芥祰闂傚倷鐒︽繛濠囧绩闁秴绠查柛銉墮閽冪喖鏌ㄥ┑鍡╂Ц婵☆偅锕㈤弻娑⑩�﹂幋婵囩彯闂佸搫妫庨崹鑽ゆ閹惧鐟瑰┑鐘插暙椤忚泛鈹戦悩鍨毄濠殿喗鎸冲畷鎰版濞寸缍佸畷濂稿Ψ閿旀儳骞嶉梻浣稿閻撳牓宕伴弽顓炴辈婵炲棙鍔﹀▓浠嬫煟閹邦喗鎳栭柟瀵稿У瀹曞弶绻涢幋娆忕仼闂佸崬娲弻锝夊籍閸偅顥栨繛瀵稿帶閼活垵鐏冮梺缁橈耿濞佳勭濠婂嫨浜滈柟瀛樼箥濡拷闂佺粯渚楅崳锝呯暦閸洦鏁嗗璺侯儐濞呭苯鈹戦悙鑸靛涧缂佽弓绮欓獮澶愭晸閻樺啿锟藉灚銇勯幇鍫曟闁抽攱甯掗湁闁挎繂鎳忛崯鐐烘煙椤栨氨澧﹂柟顔筋殔椤繈宕￠悙鎻掔闁诲氦顫夊ú婵嬶綖婢跺矉鎷烽棃娑栧仮鐎殿喖鐖奸獮瀣偐閸偅鐦炲┑鐘垫暩閸嬬娀骞撻鍡欑闁跨喕濮ょ换娑㈠椽閸愵亝鍋х紓渚囧枛椤嘲顕ｉ锟藉畷濂告偄閸濆嫬姹查梻鍌欑閹碱偄霉閸屾稓顩叉繝闈涚墳閹峰嘲顫濋鍌溞ㄥ┑顔硷龚濞咃綁骞忛悩璇茬伋闁惧浚鍋嗘禍顏呯節閻㈤潧浠滄い鏇ㄥ弮瀹曟顫滈敓浠嬫偘椤旇棄绶為柟閭﹀幖娴滈亶姊洪崜鎻掍簽闁哥姴閰ｉ、鎾诲箻缂佹ǚ鎷洪梻鍌氱墐閺呮盯鎯佸鍫熺厱婵☆垰婀遍惌娆戯拷瑙勬礈閸犳牠寮幘缁樻櫢闁跨噦鎷�
			if(isTeamCanFight(hostteam,hostid)==false){
				fire.pb.talk.MessageMgr.sendMsgNotify(guestid, 162121, null);
				return ;
			}
			
			Team guestteam = TeamManager.selectTeamByRoleId(guestid);
			if(guestteam==null){
				//濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姳鍗抽弻娑樷攽閸曨偄濮㈤梺娲诲幗閹瑰洤顫忔繝姘唶闁绘柨鍢查獮蹇涙⒑閹稿海绠撴い锔诲灣缁鎮烽幊濠傜秺閺佹劙宕ㄩ鐐剁窡闂備礁缍婂濠氬箯閻戣姤鈷掗柛灞剧懆閸忓瞼绱掗鍛仸鐎殿喖顭锋俊鎼佸煛娴ｅ彨鏇㈡煟鎼搭垳绉甸柨鐔虹摂閸ㄨ京鏁敓鐘靛祦闁搞儺鍓氶崑瀣煕椤愮姴鐏╃�殿喛娅曠换婵嬫偨闂堟稐娌梺鎼炲妽閸庡ジ骞楅鈶╂斀闁绘瑥鎳忕�氬綊姊虹紒姗嗘當闁绘鎳愰幑銏ゅ幢濡晲绨婚梺褰掑亰閸犳牕鐡梻浣芥硶閸犳洘鎱ㄩ妶鍚ゆ椽鎮㈤悡搴㈡К闂侀潧绻堥崐鏇犵尵瀹ュ鐓曟い鎰剁悼缁犳挾锟借鎸稿Λ婵嗩潖閾忓湱纾兼俊顖氭惈椤帒鈹戦悙鏉垮皟闁搞儯鍔屾禒濂告⒑闂堟单鍫ュ疾濠婂牆鐓曢柟杈鹃檮閻撶喓鎲稿澶婄疅闁挎稑瀚搁幏宄邦潩閻愵剙顏�?
				fire.pb.talk.MessageMgr.sendMsgNotify(guestid, 162081, null);
				return ;
			}
			//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣规偠閸庢椽宕滃▎鎴濐棜鐟滅増甯楅悡娑氾拷骞垮劚妤犳悂鐛弽顓熺參闁告劦浜滈弸娑㈡煛鐏炲墽娲村┑锛勫厴椤㈡瑩鎮℃惔顔戒氦闂傚倷绀侀幉锟犳偡閵夆晜鏅濋柕澶嗘櫅妗呴梺鍛婃处閸ㄤ即宕橀敓浠嬫⒑闂堟丹娑氫沪閻愵剦鍟囬梻鍌氬�烽懗鍫曗�﹂崼鐕佹闁归棿鐒﹂弲婵囥亜韫囨挾澧曢柦鍐枛閺屻劑鎮㈤崫鍕戙垻绱掗敓鐣岋拷锝庡枟閳锋帡鏌涢銈呮灁闁靛棙甯掗湁闁绘ɑ顔栭悞楣冩煃鐟欏嫬鐏存俊鎹愰哺閵囧嫰寮撮悢铏圭厒缂備緡鍠栭…鐑界嵁濮楋拷楠炲洦鎷呴崷顓犫枆闂傚倷娴囧▔鏇㈠闯閿曞倸绠柨鐕傛嫹?
			if(guestteam.getTeamLeaderId()!=guestid){
				//濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姳鍗抽弻娑樷攽閸曨偄濮㈤梺娲诲幗閹瑰洤顫忔繝姘唶闁绘柨鍢查獮蹇涙⒑閹稿海绠撴い锔诲灣缁鎮烽幊濠傜秺閺佹劙宕ㄩ鐐剁窡闂備礁缍婂濠氬箯閻戣姤鈷掗柛灞剧懆閸忓瞼绱掗鍛仸鐎殿喖顭锋俊鎼佸煛娴ｅ彨鏇㈡煟鎼搭垳绉甸柨鐔虹摂閸ㄨ京鏁敓鐘靛祦闁搞儺鍓氶崑瀣煕椤愮姴鐏╃�殿喛娅曠换婵嬫偨闂堟稐娌梺鎼炲妽閸庡ジ骞楅鈶╂斀闁绘瑥鎳忕�氬綊姊虹紒姗嗘當闁绘鎳愰幑銏ゅ幢濡晲绨婚梺褰掑亰閸犳牕鐡梻浣芥硶閸犳洘鎱ㄩ妶鍚ゆ椽鎮㈤悡搴㈡К闂侀潧绻堥崐鏇犵尵瀹ュ鐓曟い鎰剁悼缁犳挾锟借鎸稿Λ婵嗩潖閾忓湱纾兼俊顖氭惈椤帒鈹戦悙鏉垮皟闁搞儯鍔屾禒濂告⒑闂堟单鍫ュ疾濠婂牆鐓曢柟杈鹃檮閻撶喓鎲稿澶婄疅闁挎稑瀚搁幏宄邦潩閻愵剙顏�?
				fire.pb.talk.MessageMgr.sendMsgNotify(guestid, 162081, null);
				return ;
			}
			//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣规偠閸庢椽宕滃▎鎴濐棜鐟滅増甯楅悡娑氾拷骞垮劚妤犳悂鐛弽顓熺參闁告劦浜滈弸娑㈡煛鐏炲墽娲村┑锛勫厴椤㈡瑩鎮℃惔顔芥祰闂傚倷鐒︽繛濠囧绩闁秴绠查柛銉墮閽冪喖鏌ㄥ┑鍡╂Ц婵☆偅锕㈤弻娑⑩�﹂幋婵囩彯闂佸搫妫庨崹鑽ゆ閹惧鐟瑰┑鐘插暙椤忚泛鈹戦悩鍨毄濠殿喗鎸冲畷鎰版濞寸缍佸畷濂稿Ψ閿旀儳骞嶉梻浣稿閻撳牓宕伴弽顓炴辈婵炲棙鍔﹀▓浠嬫煟閹邦喗鎳栭柟瀵稿У瀹曞弶绻涢幋娆忕仼闂佸崬娲弻锝夊籍閸偅顥栨繛瀵稿帶閼活垵鐏冮梺缁橈耿濞佳勭濠婂嫨浜滈柟瀛樼箥濡拷闂佺粯渚楅崳锝呯暦閸洦鏁嗗璺侯儐濞呭苯鈹戦悙鑸靛涧缂佽弓绮欓獮澶愭晸閻樺啿锟藉灚銇勯幇鍫曟闁抽攱甯掗湁闁挎繂鎳忛崯鐐烘煙椤栨氨澧﹂柟顔筋殔椤繈宕￠悙鎻掔闁诲氦顫夊ú婵嬶綖婢跺矉鎷烽棃娑栧仮鐎殿喖鐖奸獮瀣偐閸偅鐦炲┑鐘垫暩閸嬬娀骞撻鍡欑闁跨喕濮ょ换娑㈠椽閸愵亝鍋х紓渚囧枛椤嘲顕ｉ锟藉畷濂告偄閸濆嫬姹查梻鍌欑閹碱偄霉閸屾稓顩叉繝闈涚墳閹峰嘲顫濋鍌溞ㄥ┑顔硷龚濞咃綁骞忛悩璇茬伋闁惧浚鍋嗘禍顏呯節閻㈤潧浠滄い鏇ㄥ弮瀹曟顫滈敓浠嬫偘椤旇棄绶為柟閭﹀幖娴滈亶姊洪崜鎻掍簽闁哥姴閰ｉ、鎾诲箻缂佹ǚ鎷洪梻鍌氱墐閺呮盯鎯佸鍫熺厱婵☆垰婀遍惌娆戯拷瑙勬礈閸犳牠寮幘缁樻櫢闁跨噦鎷�
			if(isTeamCanFight(guestteam,guestid)==false){
				return ;
			}
			//濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閿熻棄鍊圭粋鎺旓拷锝庡亝濞呫垽姊洪懞銉冾亪藝椤栫偛姹查梺顒�绉甸悡銉╂煟閺冨倻甯涙い銉ヮ槺缁辨挸顓奸崪鍐惈濡ょ姷鍋涢崯顐ョ亽闁荤姴娲╃亸娆戠玻閻愮儤鈷戠憸鐗堝笒娴滀即鏌涢幘瀵告噰闁诡噣娼ц灒闁煎鍊楅惁鍫ユ⒑闂堟盯鐛滅紒韫矙閹繝骞囬悧鍫㈠幈闂佸搫鍠涢幏鐑芥煟濡ゅ啫浠辩捄顖炴煕鐏炴儳鐒归柡锟芥禒瀣厽闁归偊鍓氶埢鏇㈡煕閵堝洤鏋涢柡灞剧☉铻ｉ柣妯哄级閸ｄ粙鏌ｉ鐔烘噰闁哄本鐩鎾Ω閵夈儳顔戞俊鐐�ら崑鍛哄Ο鍏煎床婵犻潧顑嗛ˉ鍫熺箾閹存繂鑸归柛鎾存緲閳规垿顢欏▎鐐秷闂佺粯鎼换婵嗩嚕鐠囨祴妲堟慨姗嗗亝閸曞啴姊洪崨濠冨瘷闁告侗鍨伴獮姗�姊婚崒娆愮グ妞ゆ泦鍜冩嫹濞戞帗娅婇柟顕嗙節閺佹捇鎮╅懠鑸垫啺闂備焦瀵х换鍌炲箟濮楋拷閹垽鎮℃惔锛勶拷顓烆渻閵堝棙鈷愰柛搴＄－閺侇噣鏁撻敓锟�?婵犵數濮烽弫鎼佸磻閻樿绠垫い蹇撴缁�濠傘�掑鐐闁芥鍠栭弻鐔煎礈瑜忕敮娑㈡煕鎼粹槄鍔熼柨鐔绘缁犲秹宕曢柆宥呯疇濠㈣泛谩閿濆閱囬柕澶涘閸樼敻姊虹拠鈥崇�婚柛婊冨暟缁�濠囨⒑閸濄儱鏋戦柟顔煎�搁～蹇涙惞閸︻厾鐓撻柣鐘充航閸斿酣顢欐径鎰拺闁圭娴烽。鏌ユ煏閸パ冾伃鐎殿喗鎸抽、鏃堝川椤撗傜处?闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯悹楦裤��閺嬪秹鏌曡箛瀣拷鏇犵不椤栫偞鐓ラ柣鏇炲�圭�氾拷?
			if(hostteam.getAbsentMemberIds().contains(hostid)){
				//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝夋交閼板潡寮堕崼姘珔闁搞劍绻冮妵鍕冀椤愵澀绮剁紓渚婃嫹濠㈣泛顑勭换鍡涙煏閸繃鍣洪柛锝囨嚀椤╁ジ宕ㄩ娑欐杸濡炪倖姊婚悺鏃堟倿閻愵剛绠惧璺侯儑濞叉挳鏌熼姘冲閾绘牠鏌涘☉鍗炴灓闁告鏁婚弻鈩冨緞婵犲嫬顣烘繝鈷�鍛珪缂侇喗鐟╅幊锟犲Χ韫囨柨顏堕柣鐔哥懃鐎氼厾绮堥敓浠嬫⒑閸濄儱鏋庢繛灏栵拷绛硅�垮ù锝囩《閺�浠嬫煟濡鍤嬬�规悶鍎甸弻鐔煎礃閺屻儱寮伴梺璇″灠閸熸挳鐛�ｎ喗鍋愰柣銏㈩暜缁辨煡姊洪崫鍕垫Ц闁绘瀚板畷婵囨償閿濆洣绗夐梺缁樺姈閹苯鈻撴禒瀣厽闁归偊鍓氶埢鏇㈡煕鎼淬垺鈷愭い銊ｅ劦閹瑩宕ｆ径濠冪亷婵＄偑鍊戦崹鍝勎涢崘銊ф殾闁割偅娲栭悡娑樷攽閻樻彃鏁憸鏂款潖婵犳艾纾兼慨姗嗗墾閹风兘骞栨担鍝ワ紮闂佸綊妫跨粈渚�鎮块娴庡綊宕楅崗鑲╃▏缂備焦鍔栭〃濠囧蓟閳ユ剚鍚嬮幖绮癸拷宕囶啇婵犳鍠涢～澶愭偂閿熺姴钃熼柕濞炬櫆閸嬪棝鏌涚仦鍓р槈妞ゅ骏鎷�
				fire.pb.talk.MessageMgr.sendMsgNotify(guestid, 162080, null);
				return ;
			}
			if(guestteam.getAbsentMemberIds().contains(guestid)){
				fire.pb.talk.MessageMgr.sendMsgNotify(guestid, 162081, null);
				return ;
			}
			
		}else{
			Team guestteam = TeamManager.selectTeamByRoleId(guestid);
			if(guestteam!=null){
				fire.pb.talk.MessageMgr.sendMsgNotify(guestid, 162112, null);
				return ;
			}
			//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐椤曞棙瀚归柛鎰靛枛楠炪垺淇婇悙瀛樼婵＄偘绮欓悰顔撅拷锝庝憾閻斿棙銇勯幋顓炲閻庢凹鍓涘▎銏ゆ倷閻戞鍘甸梻渚囧弿缁犳垶鏅堕悧鍫涗簻闁规崘娅曢幆鍫ユ煃鐟欏嫬鐏撮柛鈹垮劦瀹曞崬螖閸愌冨闂傚倷鑳堕、濠傗枍閺囥垹绠板┑鐘宠壘缁犵偤鏌曟繛鍨姉婵℃彃鐗撻弻鏇＄疀鐎ｎ亞浠奸悷婊勬緲鐎氭澘顫忓ú顏勭闁绘劖褰冩俊褔姊洪崨濠冨闁稿鎳橀幃鐐節濮橆厸鎷绘繛鎾寸啲閹烽攱绻涙担鍐插悩濞戞鏃堝礃閳轰礁绨ユ繝娈垮枟椤ㄦ劙骞忔搴嫹濞堝灝鏋涙い顓炲槻閻ｉ攱绺界粙璇俱劑鏌ㄩ弴顏呭濠电偛鐗忛崰鏍ь潖濞差亝顥堟繛鎴濈－缁�鍥⒑鐠恒劌鏋嶇紒顔界懇瀵偊宕橀鑲╋紲濠电偞鍨堕懝楣冪嵁閸喓绡�鐎典即鏀卞姗�鏁撻懞銉﹀磳闁诡喚鍋ら弫鍌炲箚瑜滃Λ婊呯磽閸屾瑧鍔嶉拑閬嶆煕濞嗗繒绠婚柡宀嬬秮閹垽鎮℃惔婵嗘瀳婵犵妲呴崹浠嬪箯闁垮绻嗛柕鍫濇搐鍟搁梺绋款儐缁嬫挾鍒掗弮鍫濈妞ゆ洖鎳忛弲锝嗙節闂堟稑锟藉鈥﹂崼銉︾厑闁搞儯鍔庣弧锟介梻鍌氱墛缁嬫帡藟濠婂懐纾奸柣娆忔噽缁夘喗鎱ㄦ繝鍕笡闁瑰嘲鎳樺畷銊︾節閸屾稒鐣奸梻鍌欐祰瀹曠敻宕伴崱娑樼？闂傚牊绋撻弳锕傛煙閻楀牊绶茬�瑰憡绻傞埞鎴︽偐閹绘帗娈悗娈垮枛濞尖�愁潖閾忚宕夐柕濞垮劜閻濄垽姊洪悷鏉挎闁瑰嚖鎷�
			Team hostteam = TeamManager.selectTeamByRoleId(hostid);
			if(hostteam!=null&&hostteam.getFighterMemberIds().contains(hostid)){
				//闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ礀绾惧潡鏌ｉ姀銏╃劸闁汇倗鍋撶换娑㈠箣濞嗗繒浠鹃梺绋款儍閸婃繈寮婚弴鐔虹鐟滃秶锟芥凹鍘奸埢鎾村鐎涙ǚ鎷洪梺闈╁瘜閸欙拷婵＄偓鎮傞弻娑㈡偐瀹曞洤鈷堢紓渚囧枛椤兘銆佸▎鎴滅剨闁哄秲鍔嶉弶鎼佹⒒娴ｈ櫣甯涢拑杈╂喐閺夊灝鏆ｆい銏℃椤㈡棃宕卞▎鎴床闂備礁缍婇崑濠囧矗鎼粹檧鏋旀繝濠傜墛閻撴盯鎮橀悙鐑樹氦闁归鍏橀獮鍥ㄦ媴閸涘﹤锟筋垶姊绘担鍛婂暈濞撴碍顨婂畷浼村冀椤愩倗骞撳┑鐐村灟閸ㄦ椽鎮￠悢鍏肩厪闊洤锕ュ▍鍛存煟韫囧鍔滅紒缁樼洴瀹曨亪宕橀鍠版粓姊烘潪鎵妽闁圭懓娲獮鍐箚瑜忛弳鍡椻攽閻樻彃鏆為柡鍡欏仱濮婄粯鎷呴搹骞匡拷濠囨煛閸涱喚鐭掗柟顔ㄥ洤鍗抽柕蹇曞Х閸樻椽姊虹憴鍕姢婵狅拷闁秵鍋柨鐔剁矙濮婃椽宕崟顒�绐涙繝娈垮枤閸忔﹢骞冮悙鍝勯敜婵°倓鑳堕崢浠嬫⒑缂佹﹩鐒惧ù婊庡墴钘濋柨鏂垮⒔濡垳绱撴担闈涚仼鐎殿噮鍠氶敓鍊燁潐濞诧箓宕归崼鏇炴瀬闁瑰墽绮弲鎼佹煥閻曞倹瀚�
				//濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閿熻棄鍊圭粋鎺旓拷锝庡亝濞呫垽姊洪懞銉冾亪藝椤栫偛姹查梺顒�绉甸悡銉╂煟閺冨倻甯涙い銉ヮ槺缁辨挸顓奸崪鍐惈濡ょ姷鍋涢崯顐ョ亽闁荤姴娲╃亸娆戠玻閻愮儤鈷戠憸鐗堝笒娴滀即鏌涢幘瀵告噰闁诡噣娼ц灒闁煎鍊楅惁鍫ユ⒑闂堟盯鐛滅紒韫矙閹繝骞囬悧鍫㈠幈闂佸搫鍠涢幏鐑芥煟濡ゅ啫浠辩捄顖炴煕鐏炴儳鐒归柡锟芥禒瀣厽闁归偊鍓氶埢鏇㈡煕閵堝洤鏋涢柡灞剧☉铻ｉ柣妯哄级閸ｄ粙鏌ｉ鐔稿磳闁哄备鍓濆鍕拷锝庝簽閸旂鈹戦悙鑼癁闁哄懐濞�瀵寮撮悢铏诡啎闂佺粯鍔﹂崜姘舵偟閺傚簱鏀芥い鏃�顑欏鎰版煟閹垮嫮绡�鐎殿喛顕ч埥澶婎潩椤愶絽濯伴梻浣告啞閹稿棝宕ㄩ姘闂傚倸鍊峰ù鍥敋瑜忛敓鑺ョ▓閺呯娀骞冮敓鐘茬伋闁归鐒︾紞搴㈢節閻㈤潧校闁肩懓澧界划鍫ュ礃閳瑰じ绨婚棅顐㈡处閹告悂顢旈鍫熺厽閹兼番鍊栭鐘电磼鏉堛劍灏伴柟宄版嚇閹兘鎮ч崼鐔哥槥闂傚倷鑳堕幊鎾诲吹閺嶎厼绠柨鐕傛嫹
				new PAbsentReturnTeam(hostid, 1).submit();
			}
		}

		new PLiveDieBattle(hostid,guestid,isteamfight).submit();
		
	}
	
	/**
	 * 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣规偠閸庢椽宕滃▎鎴濐棜鐟滅増甯楅悡娑氾拷骞垮劚妤犳悂鐛弽顓熺參闁告劦浜滈弸娑㈡煛鐏炲墽娲村┑锛勫厴椤㈡瑩鎮℃惔顔芥祰闂傚倷鐒︽繛濠囧绩闁秴绠查柛銉墮閽冪喖鏌ㄥ┑鍡╂Ц婵☆偅锕㈤弻娑⑩�﹂幋婵囩彯闂佸搫妫庨崹鑽ゆ閹惧鐟瑰┑鐘插暙椤忚泛鈹戦悩鍨毄濠殿喗鎸冲畷鎰版濞寸缍佸畷濂稿Ψ閿旀儳骞嶉梻浣稿閻撳牓宕伴弽顓炴辈婵炲棙鍔﹀▓浠嬫煟閹邦喗鎳栭柟瀵稿У瀹曞弶绻涢幋娆忕仼闂佸崬娲弻锝夊籍閸偅顥栨繛瀵稿帶閼活垵鐏冮梺缁橈耿濞佳勭濠婂嫨浜滈柟瀛樼箥濡拷闂佺粯渚楅崳锝呯暦閸洦鏁嗗璺侯儐濞呭苯鈹戦悙鑸靛涧缂佽弓绮欓獮澶愭晸閻樺啿锟藉灚銇勯幇鍫曟闁抽攱甯掗湁闁挎繂鎳忛崯鐐烘煙椤栨氨澧﹂柟顔筋殔椤繈宕￠悙鎻掔闁诲氦顫夊ú婵嬶綖婢跺矉鎷烽棃娑栧仮鐎殿喖鐖奸獮瀣偐閸偅鐦炲┑鐘垫暩閸嬬娀骞撻鍡欑闁跨喕濮ょ换娑㈠椽閸愵亝鍋х紓渚囧枛椤嘲顕ｉ锟藉畷濂告偄閸濆嫬姹查梻鍌欑閹碱偄霉閸屾稓顩叉繝闈涚墳閹峰嘲顫濋鍌溞ㄥ┑顔硷龚濞咃綁骞忛悩璇茬伋闁惧浚鍋嗘禍顏呯節閻㈤潧浠滄い鏇ㄥ弮瀹曟顫滈敓浠嬫偘椤旇棄绶為柟閭﹀幖娴滈亶姊洪崜鎻掍簽闁哥姴閰ｉ、鎾诲箻缂佹ǚ鎷洪梻鍌氱墐閺呮盯鎯佸鍫熺厱婵☆垰婀遍惌娆戯拷瑙勬礈閸犳牠寮幘缁樻櫢闁跨噦鎷�
	 * @param guestteam
	 * @param guestid  闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾捐鈹戦悩鍙夋悙缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾缁愭鏌熼柇锕�鍔掓繛宸簻缁狅綁鏌ㄩ弮鍥棄闁跨喕妫勫锟犲蓟閵娾晛鍗虫慨妯垮煐椤庢牗绻涚�涙鐭岄柟铏崌濠�渚�姊洪幐搴ｇ畵闁绘锕、鏃堟偐缂佹鍘藉銈嗘尵閸嬬偤藟閵忋倖鐓涚�癸拷鐎ｎ剛袦濡ょ姷鍋涢澶愬箖濠婂牆骞㈡繛鍡楃箰妤旈梻鍌欑閹芥粓宕伴幇鏉跨畺闁稿本鍑瑰鏍煣韫囨凹娼愰悗姘哺閺屽秹濡烽妷銉︽瘣闁诲孩鍐荤紞浣割潖濞差亜绠归柣鎰絻椤牓姊洪崫銉ユ瀻婵炵》绻濆畷娲閵堝懐顔掗柣鐘叉穿鐏忔瑩顢樺ú顏呪拺闁圭瀛╅ˉ鍡樹繆椤愩垹顏�规洘绮撻、娆戝枈鏉堛劌鐦滈梻渚�娼ч悧鍡椢涘▎鎾崇厱闁圭儤顨嗛悡娑㈡煕濠婏拷缁�浣圭閹殿噯鎷风憴鍕婵狅拷闁秴绀岄柡宥庡亞妞规娊鏌ㄩ悤鍌涘
	 * @return
	 */
	public boolean isTeamCanFight(Team guestteam,long guestid){
		//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣规偠閸庢椽宕滃▎鎴濐棜鐟滅増甯楅悡娑氾拷骞垮劚妤犳悂鐛弽顓熺參闁告劦浜滈弸娑㈡煛鐏炲墽娲村┑锛勫厴椤㈡瑩鎳￠妶鍡橆唫婵犵數鍋涢悺銊у垝瀹�锟界槐鐐寸節閸パ嗘憰闂佺粯姊婚崢褏绮诲杈ㄥ枑鐎广儱顦Ч鏌ュ级閸稑濡稿ù婊勭矒閺屾洟宕煎┑鍥ф闂佹悶鍊曞ú锕傚箞閵婏妇绡�闁稿被鍊楅崥瀣倵鐟欏嫭绀冮柨鏇樺灲閵嗕線寮崼婵堫槹濡炪倖甯掗崑濠囧箯閻戣姤鎯為柛锔诲幘閿涙繃绻涙潏鍓хɑ闁搞劍绻堝畷銉╊敃閿旂晫鍘遍柣搴秵閸撴瑦绂掕缁辨帡顢欓悾灞惧櫗閻庡灚婢樼�氫即鐛崶顒�鍨傛い鎰剁稻閻濇繈姊婚崒娆掑厡缂侇噮鍨堕弫瀣磼閸撗嗘闁告瑥鍟锝夊箮閼恒儱浜圭紓鍌欑劍鑿ら柟鐤缁辨捇宕掑▎鎴濆闂佹寧纰嶉妵鍕Ψ閿曪拷閸濇椽鏌″畝瀣瘈鐎规洏鍔戦、娆撴倷椤掞拷閸ㄨ鲸淇婇悙顏勶拷鎴﹀垂濞差亝鍋￠柕澶嗘櫓閺佸洤鈹戦崒婊庣劸闁绘劕锕弻宥夊传閸曨剙娅濋梺鐚存嫹闁告繂瀚ч弨浠嬫煟濮楀棗鏋涢柣蹇氶哺缁绘稒寰勭�ｎ剚鍒涢梺璇″灠閻倸鐣烽幒妤佸�烽柡澶嬪灣缁囨⒒娴ｇ儤鍤�濠⒀呮櫕閸掓帡顢涢悙鏉戜簵濠电偞鍨崹娲偂閺囥垺鐓涢柛銉ｅ劚閻忣亝绻涢幊宄版处閻撶喖鐓崶銊︾闁宠鐗撻弻鈥崇暆閿熶粙宕伴弽顓滐拷浣糕槈濡攱鐎婚梺鍦劋閸ㄧ數鏁婊呯＝闁稿本鐟х拹浼存煕閿濆骸娅嶇�规洩缍佸畷姗�顢欓崗鑲╋拷顒勬⒑閸涘﹤濮﹂柛鐘愁殜瀵尙绮欏Λ闈涚秺閹晛顔忛鐓庡缂傚倷鑳舵慨鐢告偋閻樿崵宓侀柡宥冨妽缂嶅洭鏌涢幘妤�鎯欓幋锔解拺闁告縿鍎遍弸搴ㄦ煙绾板崬浜版繝锟芥笟锟藉娲箰鎼达絿鐣甸梺鐟板暱缁绘帡骞忚ぐ鎺戠労闁告劦浜為惁鍫ユ⒑鐠恒劌鏋嶇紒顔界懇閻涱喖顫滈敓浠嬨�佸▎鎾村仼閻忕偠妫勫Ч鎻掆攽閻樺灚鏆╅柛瀣仱瀹曞綊骞嗛悧鍫熷櫡濠电姷鏁告刊鎾箯閻戣姤鐓熸俊銈忔嫹闁绘鎳愰幑銏ゅ幢濞戞瑧鍘卞┑鐐叉濞存艾危瑜版帗鐓曞┑鐘插暙婵鏌ㄩ悢鍑ゆ嫹閻曚焦缍堝┑鐐村絻缁绘ê鐣烽弴銏″仺缂佸瀵ч悗顒勬⒑缁嬭法鐏遍柛瀣仱瀹曢潧顓兼径瀣帾婵犮垼顕栭崹浼村箠韫囨挴鏋旈柣鎴烆焽缁★拷闂佹眹鍨藉褎绂掗敃鍌涚厱闁靛鍎抽崺锝嗩殽閻愭潙濮嶆鐐寸墬缁楃喖宕堕妸锔界彈闂傚倷绀佹竟濠囧磻娓氾拷瀹曞綊宕崟顓熸闂佸搫琚崕鏌ユ偂閺囥垺鐓欏ù鐓庣摠濞懷囨煛鐎ｎ偆銆掔紒杈ㄥ浮閹亪宕ㄩ婧曟垶绻涢敐鍛悙闁挎洦浜妴浣糕槈濮楀棛鍙嗛梺鍛婃处閸嬪懘鎮鹃锟介埞鎴︽偐閹颁礁鏅遍梺鍝ュУ椤ㄥ﹪骞嗛崟顖ｆ晬闁绘劘灏幗鏇㈡⒑缂佹ɑ鈷掗悘蹇嬪姂楠炲繐鐣￠幍铏潔濠电偛妫欓…鍥礉闁垮绡�闁冲嚖鎷风�广儱妫楅锟�?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鏁撻悩鍐插壆濡炪倖鐗滈崑娑氬鐠囨祴鏀介柣妯诲絻娴滅偤鏌ｉ幒宥囩煓闁诡喛顫夊顏堝箯瀹�濠傚Τ闂備胶绮弻銊ノ涘┑瀣摕闁绘梻鈷堥弫宥嗙箾閹寸儑渚涙俊顐㈡缁辨挻鎷呴棃娑橆瀳濠电偟銆嬬换婵嬬嵁閸愩劎鏆嬮柟浣冩珪閻庤鈹戦悙鍙夘棡闁告梹娲熼、鏃堟晸閿燂拷
		List<Long> guestlevelLess50 = new ArrayList<Long>();
		List<Long> guestfightLess50 = new ArrayList<Long>();
		
		List<Long> guestmembers = guestteam.getNormalMemberIds();
		for (long mem : guestmembers) {
			PropRole guestrole = new PropRole(mem, true);
			if (guestrole.getLevel() < LiveDieMange.getLiveDieLevel()) {
				//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝夋交閼板潡寮堕崼姘珔闁搞劍绻冮妵鍕冀椤愵澀绮剁紓渚婃嫹濠㈣泛顑勭换鍡涙煏閸繃鍣洪柛锝囨嚀椤╁ジ宕ㄩ娑欐杸濡炪倖姊婚悺鏃堟倿妤ｅ啯鐓曢柍鍝勫�绘晶鐢告煕閳哄倻娲存鐐搭焽缁辨帒螣閻撳骸绠洪梻鍌欑閹碱偊宕愰幖浣瑰�舵繝闈涱儍閿熻棄鍊搁悾鐑藉炊閳哄喛绱查梻浣芥硶閸犳洘鎱ㄩ妶鍥ㄥ床婵犻潧顑呯壕鍏间繆閵堝嫮璐版繛鍏兼濮婄粯鎷呴悜妯烘畬闂佽绻戠换鍫濈暦椤栫儐鏁冮柨鏃�鍎崇粊锕�鈹戞幊閸婃捇鎳楅崜浣稿К闁跨喍绮欏铏规崉閵娿儲鐏嗘繝娈垮枔閸婃繈鐛箛娑樺窛閻庢稒蓱閸庮亪鎮峰鍛暭鐎圭顭峰銊╁传閸曘劍鏂�闂佺粯锕╅崰鏍倶鏉堛劎绠惧璺侯儑濞叉挳鏌熼姘辩劯鐎规洘甯￠幃娆撳级閹存粎閽甸梻鍌欑濠�閬嶅磻閹捐鍑犻柣鎾冲閿濆閱囬柕澶涘閸樼敻姊虹拠鈥崇�婚柛婊冨暟缁�濠囨⒑閻撳骸绾ч柣妤佹礋閳ユ棃宕橀鍢壯囨煕閳╁喚娈樺ù鐙�鍨崇槐鎾存媴閽樺鍘梺鐓庣秺缁犳牠骞冩ィ鍐╁�婚柦妯猴級閵娾晜鐓冮弶鐐村缁愭棃鏌涢悙鑼煟婵﹥妞介獮鎰償閿濆洨鏆ら梺璇插缁嬪牓寮查悩璇茬畾閻忕偠濞囬弮鍫熸櫢濞寸姴顑呴悡姗�鏌熸潏鎯х槣闁轰礁锕弻锝夊箛闂堟稑顫╁┑鐐茬墕閻倸顫忛搹鍦煓闁告牭绻濈欢鏉戭渻閵堝棙鑲犻柛銉戝懎骞掗梻浣烘嚀婢х晫鍒掗鐐茬柧闁归棿鐒﹂悡銉╂煟閺囩偛锟藉湱锟芥熬鎷�
				guestlevelLess50.add(mem);
			}
			//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂磋閿熸枻绠撻、妤呭礋椤愩値妲堕梻浣瑰濞叉牠宕愰崫銉ヮ棜濠电姵纰嶉悡鏇㈡倶閻愭彃鈷旈柣顓炵灱缁辨帡鎮╅搹顐闂佸搫鏈粙鎴︽偩濠靛鏅稿ù鐘差儏绾剧粯绻涢幋鐐靛暡闁瑰嘲鍢查～婵嬵敆婢跺瑩锕�顪冮妶搴″绩婵炲娲熼獮鎴﹀礋椤栨稑锟界粯淇婇婊呭笡閻庢碍濞婂缁樻媴閸涘﹥鍎撻梺鐟板暱闁帮綁鐛径鎰櫢闁绘灏欓悿鍕⒑闂堟侗鐒鹃柛搴櫍瀵劍绂掔�ｎ偆鍘卞銈嗗姉婵挳鎮橀埡鍐＜婵°倕顑囩弧锟藉┑顔硷攻濡炶棄鐣峰鍫熷殤妞ゆ帪鎷烽悽顖樺劦濮婃椽宕ㄦ繝鍐ㄩ瀺缂備礁顑嗛幑鍥х暦濮樿泛绠虫俊銈忔嫹缂侇偄绉归弻娑㈩敃閿濆洨鐣兼俊銈囧Т濞差厼顫忓ú顏勭闁肩⒈鍓欑敮銉╂⒑閸濄儱校闁绘濞�瀹曟椽濮�閵堝棙娅㈤梺璺ㄥ櫐閹凤拷
			if(COffTitle.isLiveDieTitle(guestrole)){
				//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝夋交閼板潡寮堕崼姘珔闁搞劍绻冮妵鍕冀椤愵澀绮剁紓渚婃嫹濠㈣泛顑勭换鍡涙煏閸繃鍣洪柛锝囨嚀椤╁ジ宕ㄩ娑欐杸濡炪倖姊婚悺鏃堟倿妤ｅ啯鐓曢柍鍝勫�绘晶鐢告煕閳哄倻娲存鐐搭焽缁辨帒螣閻撳骸绠洪梻鍌欑閹碱偊宕愰幖浣瑰�舵繝闈涱儍閿熻棄鍊搁悾鐑藉炊閳哄喛绱查梻浣芥硶閸犳洘鎱ㄩ妶鍥ㄥ床婵犻潧顑呯壕鍏间繆閵堝嫮璐版繛鍏兼濮婄粯鎷呴悜妯烘畬闂佽绻戠换鍫濈暦椤栫儐鏁冮柨鏃�鍎崇粊锕�鈹戞幊閸婃捇鎳楅崜浣稿К闁跨喍绮欏铏规崉閵娿儲鐏嗘繝娈垮枔閸婃鍒掗銏″亜闁稿繐鍚嬪▍銏＄箾鐎电孝妞ゆ垵妫濆畷鎴﹀磼濞戞牔绨婚梺鍦劋閸ㄧ敻顢旈幘顔界厸濞达絿顭堥弳锝夋煛鐏炶濡奸柍钘夘槸铻ｅ〒姘煎灟缁辨垿姊绘担鐑樺殌婵☆垰锕ョ粋宥夘敂閸曞灚缍庡┑鐐叉▕娴滄粍瀵奸悩缁樼厱闁哄洢鍔岄獮鏍ㄣ亜閿濆懏鎯堟い顏勫暣婵℃儼绠涢弴鐘虫濠电偛鐡ㄧ划蹇撯枖濞戙埄鏁嬮柨婵嗩樈閺佸啴鏌ㄩ弴顏呭缂備胶濮撮…鐑藉蓟閻旈潻绱ｅù锝呮惈婵¤棄鈹戦埄鍐︿粻闁告柨娴峰Σ鎰板箻鐠囪尙锛滃┑鐐叉閸ㄥ灚淇婃禒瀣拺闁圭楠搁崫娲煛瀹�瀣К缂佺姵鐩顕�宕掑鍫熷闁圭儤姊荤壕濂稿级閸稑濡肩紒妤佹皑閿熻棄鐏氬妯硷拷姘煎櫍閺佹捇寮妶鍥┬ｉ梺绋款儏濡繂鐣峰▎鎾存櫢闁绘ê鍟挎禒顓炩攽閻樿宸ラ柛鐕佸亞閼鸿鲸绻濆顓犲幍闂佸憡鍨崐鏍拷姘炬嫹
				guestfightLess50.add(mem);
			}
		}
		if (!guestlevelLess50.isEmpty()) {
			String roleNames = MessageUtil.getRoleNames(guestlevelLess50);
			List<String> paras = MessageUtil.getMsgParaList(roleNames);
			//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝夋交閼板潡寮堕崼姘珔闁搞劍绻冮妵鍕冀椤愵澀绮剁紓渚婃嫹濠㈣泛顑勭换鍡涙煏閸繃鍣洪柛锝囨嚀椤╁ジ宕ㄩ娑欐杸濡炪倖姊婚悺鏃堟倿妤ｅ啯鐓曢柍鍝勫�绘晶鐢告煕閳哄倻娲存鐐搭焽缁辨帒螣閻撳骸绠洪梻鍌欑閹碱偊宕愰幖浣瑰�舵繝闈涱儍閿熻棄鍊搁悾鐑藉炊閳哄喛绱查梻浣芥硶閸犳洘鎱ㄩ妶鍥ㄥ床婵犻潧顑呯壕鍏间繆閵堝嫮璐版繛鍏兼濮婄粯鎷呴悜妯烘畬闂佽绻戠换鍫濈暦椤栫儐鏁冮柨鏃�鍎崇粊锕�鈹戞幊閸婃捇鎳楅崜浣稿К闁跨喍绮欏铏规崉閵娿儲鐏嗘繝娈垮枔閸婃繈鐛箛娑樺窛閻庢稒蓱閸庮亪鎮峰鍛暭鐎圭顭峰銊╁传閸曘劍鏂�闂佺粯锕╅崰鏍倶鏉堛劎绠惧璺侯儑濞叉挳鏌熼姘辩劯鐎规洘甯￠幃娆撳级閹存粎閽甸梻鍌欑濠�閬嶅磻閹捐鍑犻柣鎾冲閿濆閱囬柕澶涘閸樼敻姊虹拠鈥崇�婚柛婊冨暟缁�濠囨⒑閻撳骸绾ч柣妤佹礋閳ユ棃宕橀鍢壯囨煕閳╁喚娈樺ù鐙�鍨崇槐鎾存媴閽樺鍘梺鐓庣秺缁犳牠骞冩ィ鍐╁�婚柦妯猴級閵娾晜鐓冮弶鐐村缁愭棃鏌涢悙鑼煟婵﹥妞介獮鎰償閿濆洨鏆ら梺璇插缁嬪牓寮查悩璇茬畾閻忕偠濞囬弮鍫熸櫢濞寸姴顑呴悡姗�鏌熸潏鎯х槣闁轰礁锕弻锝夊箛闂堟稑顫╁┑鐐茬墕閻倸顫忛搹鍦煓闁告牭绻濈欢鏉戭渻閵堝棙鑲犻柛銉戝懎骞掗梻浣烘嚀婢х晫鍒掗鐐茬柧闁归棿鐒﹂悡銉╂煟閺囩偛锟藉湱锟芥熬鎷�
			fire.pb.talk.MessageMgr.sendMsgNotify(guestid, 162119,paras);
			return false;
		}
		if (!guestfightLess50.isEmpty()) {
			String roleNames = MessageUtil.getRoleNames(guestfightLess50);
			List<String> paras = MessageUtil.getMsgParaList(roleNames);
			//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝夋交閼板潡寮堕崼姘珔闁搞劍绻冮妵鍕冀椤愵澀绮剁紓渚婃嫹濠㈣泛顑勭换鍡涙煏閸繃鍣洪柛锝囨嚀椤╁ジ宕ㄩ娑欐杸濡炪倖姊婚悺鏃堟倿妤ｅ啯鐓曢柍鍝勫�绘晶鐢告煕閳哄倻娲存鐐搭焽缁辨帒螣閻撳骸绠洪梻鍌欑閹碱偊宕愰幖浣瑰�舵繝闈涱儍閿熻棄鍊搁悾鐑藉炊閳哄喛绱查梻浣芥硶閸犳洘鎱ㄩ妶鍥ㄥ床婵犻潧顑呯壕鍏间繆閵堝嫮璐版繛鍏兼濮婄粯鎷呴悜妯烘畬闂佽绻戠换鍫濈暦椤栫儐鏁冮柨鏃�鍎崇粊锕�鈹戞幊閸婃捇鎳楅崜浣稿К闁跨喍绮欏铏规崉閵娿儲鐏嗘繝娈垮枔閸婃鍒掗銏″亜闁稿繐鍚嬪▍銏＄箾鐎电孝妞ゆ垵妫濆畷鎴﹀磼濞戞牔绨婚梺鍦劋閸ㄧ敻顢旈幘顔界厸濞达絿顭堥弳锝夋煛鐏炶濡奸柍钘夘槸铻ｅ〒姘煎灟缁辨垿姊绘担鐑樺殌婵☆垰锕ョ粋宥夘敂閸曞灚缍庡┑鐐叉▕娴滄粍瀵奸悩缁樼厱闁哄洢鍔岄獮鏍ㄣ亜閿濆懏鎯堟い顏勫暣婵℃儼绠涢弴鐘虫濠电偛鐡ㄧ划蹇撯枖濞戙埄鏁嬮柨婵嗩樈閺佸啴鏌ㄩ弴顏呭缂備胶濮撮…鐑藉蓟閻旈潻绱ｅù锝呮惈婵¤棄鈹戦埄鍐︿粻闁告柨娴峰Σ鎰板箻鐠囪尙锛滃┑鐐叉閸ㄥ灚淇婃禒瀣拺闁圭楠搁崫娲煛瀹�瀣К缂佺姵鐩顕�宕掑鍫熷闁圭儤姊荤壕濂稿级閸稑濡肩紒妤佹皑閿熻棄鐏氬妯硷拷姘煎櫍閺佹捇寮妶鍥┬ｉ梺绋款儏濡繂鐣峰▎鎾存櫢闁绘ê鍟挎禒顓炩攽閻樿宸ラ柛鐕佸亞閼鸿鲸绻濆顓犲幍闂佸憡鍨崐鏍拷姘炬嫹
			fire.pb.talk.MessageMgr.sendMsgNotify(guestid, 162118,paras);
			return false;
		}
		return true;
	}
	
	
	public static final Logger logger = Logger.getLogger("BATTLE");
	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 793839;

	public int getType() {
		return 793839;
	}


	public CAcceptLiveDieBattle() {
	}

	public final boolean _validator_() {
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CAcceptLiveDieBattle) {
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append(")");
		return _sb_.toString();
	}

	public int compareTo(CAcceptLiveDieBattle _o_) {
		if (_o_ == this) return 0;
		int _c_ = 0;
		return _c_;
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

