
package fire.pb.team;
import fire.pb.StateCommon;
import fire.pb.buff.BuffAgent;
import fire.pb.buff.BuffConstant;
import fire.pb.buff.BuffRoleImpl;
import fire.pb.talk.MessageMgr;


// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CAnswerforSetLeader__ extends mkio.Protocol { }

// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

public class CAnswerforSetLeader extends __CAnswerforSetLeader__ {
	
	private long now = 0L;//procedure闂傚倸鍊峰ù鍥敋瑜嶉湁闁绘垵顫曢敓钘夊�块、姘舵晸娴犲宓侀煫鍥ㄧ♁閺呮悂鏌ㄩ悤鍌涘?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹缂佹劖顨婇弻鈥愁吋鎼粹�冲闂佽桨绀佺�氫即寮诲☉銏犵労闁告劗鍋撻鐟扳攽閻愬瓨灏い顓犲厴瀵鈽夊顐ｅ媰闂佸憡鎸嗘笟濠冨闁圭儤顨嗛悡鍐煟閻旂顥嬮弽锛勭磽娴ｈ櫣甯涚紒璇茬墕铻為柛鎰╁妷濡插牊绻涢崱妯曟垿鏁撻妷鈺傗拻濞达絽鎲＄拹锟犳煛閸滀礁浜濋柟渚垮姂楠炴﹢顢欓懖鈺佸绩濠电姰鍨奸崺鏍礉閺嶎厼鐤鹃柟闂寸劍閻撱儵鏌ｉ弴鐐诧拷鍦拷姘炬嫹?濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨偓鎷锋繝姘ワ拷鍛村矗婢跺瞼鐦堟繝鐢靛Т閸婂綊宕抽悾宀�纾奸柨鐔诲Г缁绘繈宕堕妸銉嫹閻㈠憡鐓ユ繝闈涙椤庢鏌＄�ｎ偆銆掔紒杈ㄥ浮閺佹挻绂掔�ｎ亪鍞跺銈庡亽閸犳锟芥俺顫夐〃銉╂倷閼碱兛铏庨梺鍛婃⒐绾板秵绌辨繝鍥舵晝闁挎繂娲﹂崳浼存煢濡崵绠橀柟鍙夋倐瀵剙鈻庨悙顒傜▉濠电姷鏁告慨鐢告嚌閸撗冾棜闁稿繗鍋愮弧锟介梻鍌氱墛缁嬫帡骞栭幇顓犵闁瑰啿鍢查幊鎰閽樺褰掓晲閸曨厾鐓撻梺鍛婄箚濞咃絿妲愰幒鏃�瀚氶柟缁樺笚濞堝墎绱撴笟鍥ф灍鐎癸拷缁嬭法鏆﹂柨鐔哄У閸婄兘鏌嶉崫鍕拷褰掑级缁嬪簱鏀介柣妯虹仛閺嗏晛鈹戦纰卞殶闁跨喕濮ら崙褰掑矗閸愵喗鏅查柣鎰▕閸氬鏌涘☉鍙樼凹闁哄偊鎷峰┑锛勫亼閸婃牕顫忔繝姘柧妞ゆ劑鍊楁稉宥夋煏婢舵稓绱扮紒璇叉閺屾稑鈻庤箛锝嗏枔闂佸憡姊瑰Ο鍧坋dure濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺绋胯閸旀垿寮婚敃锟借灒濞撴凹鍨遍埢鎾斥攽閻愬瓨灏い顓犲厴瀵鈽夊Ο鍏兼畷闂佽法鍠嶇划娆忕暦閹达附鍊烽柛婵嗗閸橀亶姊洪崷顓炲妺妞ゃ劌妫濆畷鎰版偨閸涘ň鎷婚梺鍓插亞閸犳捇鍩︽笟锟介弻娑㈡偄閸濆嫪妲愰梺鍝勭焿缂嶄線寮幇鏉块唶婵犲﹤鍟崕鎾剁磽閸屾瑦绁板瀛樻倐楠炴劖绻濆顒傤唵闂佸憡绋掑娆愬閻樼粯鐓曢柡鍥ュ妼婢т即鏌ㄩ悢鍑ゆ嫹閻斿壊浠╃紓浣介哺閹稿骞忛崨顖涘枂闁告洏鍔嶇�氬姊绘担鐑樺殌闁规祴鍓濈换娑欑節閸ャ劌浠掑銈嗘穿閹风兘鏌℃担瑙勫磳闁轰焦鎹囬弫鎾绘晸閿燂拷?
	Team team;
	
	@Override
	protected void process() {
		// protocol handle
		TeamManager.logger.debug("Enter: " + this.getClass());
		final long newLeaderRoleId = gnet.link.Onlines.getInstance().findRoleid(this);
		if (newLeaderRoleId < 0)
			return;
		mkdb.Procedure setTeamLeaderP = new mkdb.Procedure()
		{

			@Override
			protected boolean process()
			{
				//lock start
				Long teamId = xtable.Roleid2teamid.select(newLeaderRoleId);
				now = System.currentTimeMillis();
				
				//闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ磵閿熸枻绠撳畷濂稿閳ュ啿绨ラ梻浣筋潐婢瑰棙鏅跺Δ鍛；閻庯綆鍠楅悡娆撴煕閹炬鎳庣粭锟犳⒑缁嬫鍎愰拑杈╃磼缂佹娲寸�规洖宕灒闁惧繘锟芥稒顢橀梻浣筋嚙鐎涒晝鍠婂澶嬪殞濡わ絽鍟繚闂佸湱鍎ら崺鍫濐焽閳哄懏鐓熼柟浼存涧婢ь喗銇勮箛姘厫缂佺粯绻傞銉╁几椤愵澁鎷烽妶澶婂惞閻庯綆鍠楅埛鎺楁煕閺囥劌浜滄い蹇ｅ亰閺屻劑鎮㈤悜妯荤彧闂佽桨鐒﹂幃鍌氱暦閵忥綆妯勫銈冨灪钃辩紒铏规櫕缁瑩宕归鍖℃嫹閸喒鏀介柍钘夋閻忥綁鏌涙惔銏犵仼缂侇喖顭烽獮妯兼嫚閼艰埖鎲版繝鐢靛仦閸ㄥ爼鏁冮埡渚囩劷闁冲搫鎳忛悡鏇㈡煙閻愵剦娈旈柟铏姍閹即濡烽埡鍌楁嫼闂佺厧顫曢崐鏇熺墡闂備礁鎲″褰掋�冩繝鍌滄殾濞村吋娼欑粻濠氭偣閸濆嫭鎯堥柣蹇擄躬濮婅櫣鎹勯妸銉︾彚闂佺懓鍤栭幏锟�?
				if(teamId != null)
					team = new Team(teamId,false);
				else
					return true;

				long oldLeaderRoleId = team.getTeamInfo().getTeamleaderid();
				if(!team.isInTeam(newLeaderRoleId))
				{
					TeamManager.logger.debug("闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�哥粻鏍煕椤愶絾绀�缁炬儳娼￠弻鐔煎箚閻楀牜妫勭紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劙顣︾�涒晜绻濆▓鍨灍濠电偛锕濠氭晬閸曨亝鍕冮柣鐘叉处瑜板啯鎱ㄩ弴銏♀拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬礃缁矂鍩ユ径鎰潊闁炽儱鍘栭悽缁樼節閻㈤潧鈻堟繛浣冲浂鏁勯柛鈩冪♁閸嬪倹绻涢幋娆忕仾闁绘挻娲熼弻锟犲炊閵夈儳浠惧┑鐐村毆閸ャ劎鍘介棅顐㈡处濞叉牠寮搁弮鍌滅＜閺夊牄鍔屽ù顔撅拷娈垮櫘閸撴盯骞戦崟顖毼╅柨鏃囨閺嬫稓绱撻崒姘拷椋庣矆娓氾拷椤㈡牠宕ㄥ銈呮喘閹粙骞栭悜鍥ㄥ濞撴熬鎷风�殿噮鍣ｅ畷鐓庘攽鐎ｎ亝鏆梻鍌欒兌缁垰顫忛崷顓炲灊鐎广儱鎮垮ú顏勫唨妞ゆ挾鍠撻悾鎶芥⒒閸屾瑨鍏岀紒顕呭灦楠炴劗绮欏Λ闈涚秺閹潡顢涘鐐閻庢稒顭囩弧锟介梺姹囧灲濞佳勭濠婂牊鐓熸俊銈忔嫹闁挎洦浜滈悾鐤亹閹烘垵鐎銈嗘礀閹冲繒绱炴惔銏㈢瘈闂傚牊绋戦敓鑺ユ倐楠炲鏁撻悩鑼紱闂佸憡娲﹂崹閬嶅煕閹达附鐓曟い顓熷灥濞呮﹢鏌涙惔锛勭闁哄矉绱曢敓鏂ょ秬閸╂牜锟芥熬鎷�, newLeaderRoleId: " + newLeaderRoleId);
					fire.pb.talk.MessageMgr.psendMsgNotifyWhileCommit(newLeaderRoleId, 141056, null);
					psend(oldLeaderRoleId, new STeamError(TeamError.AbsentCantBeLeader));
					return true;
				}
				if(team.isTeamLeader(newLeaderRoleId))
				{
					TeamManager.logger.debug("闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�哥粻鏍煕椤愶絾绀�缁炬儳娼￠弻鐔煎箚閻楀牜妫勭紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劙顣︾�涒晜绻濆▓鍨灍濠电偛锕濠氭晬閸曨亝鍕冮柣鐘叉处瑜板啯鎱ㄩ弴銏♀拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬磸閸ㄨ櫣缂撻悾宀�鐭欓柛顭戝枟閸庮亪姊绘担鍛婅础闁稿簺鍊曢～蹇涙嚒閵堝拋妫滈梺鑺ッˉ銏ｃ亹閹烘挻娅滈梺鍛婁緱閸犳宕伴幇顔剧＝濞达絽鎼瓭閻庢鍠涢崺鏍矚鏉堛劎绡�闁搞儜鍛幀濠电姰鍨煎▔娑㈩敄閸涘瓨鏅搁柤鎭掑劚婵牓鏌熸笟鍨缂佺粯绻堝畷鎺懳熸潪鏉垮灊闂傚倷娴囬鏍窗閹捐鍨傞柦妯侯槺閺嗭附淇婇妶鍛櫣缂侊拷閸岀偞鐓犳繛鏉戭儐濞呭棛鎮敓锟�, newLeaderRoleId: " + newLeaderRoleId);
					return true;
				}
				
				Long[] roleids = new Long[2];
				if(oldLeaderRoleId < newLeaderRoleId)
				{
					roleids[0] = oldLeaderRoleId;
					roleids[1] = newLeaderRoleId;
				}
				else
				{
					roleids[0] = newLeaderRoleId;
					roleids[1] = oldLeaderRoleId;
				}
				this.lock(mkdb.Lockeys.get(xtable.Locks.ROLELOCK,(Object[])roleids));
				//lock end

				if(agree == 0)
				{//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁�濠傗攽閻樺弶鎼愮紓浣叉櫊瀵爼宕煎顓熺彆闂佸搫妫欑划鎾诲蓟閿濆绠涢柣妤�鐗婇柨顓㈡⒑閹肩偛濡界紒璇茬墦瀵鏁愭径濠勵吅闂佹寧绻傚Λ顓炍涢崟顓犵＝濞达絽鎼鎾剁磽瀹ュ嫮绐旂�殿喖顭烽幃銏ゅ礂閼测晛濮洪梻浣瑰濮婂湱锟界瑳鍥х闁挎繂娲ㄧ壕钘夈�掑顒婃敾閻庢艾缍婇弻锝嗘償椤栨粎校闂佸摜濮甸〃濠囧春濞戙垹绠虫俊銈勮兌閸橀亶姊虹憴鍕凡闁告熬鎷风紓浣靛妼椤兘寮婚敍鍕舵嫹閿濆骸浜炴繛鍙夋尦閺屸�崇暆鐎ｎ剛鐦堥悗瑙勬礋娴滃爼銆佸锟介幃銏＄附婢跺澶�
					if(!checkAnwserIsNewLeader(team, newLeaderRoleId))
					{
						//闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�哥粻鏍煕椤愶絾绀�缁炬儳娼￠弻鐔煎箚閻楀牜妫勭紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劙顣︾�涒晜绻濆▓鍨灍濠电偛锕濠氭晬閸曨亝鍕冮柣鐘叉处瑜板啯鎱ㄩ弴銏♀拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬礃缁矂鍩ユ径鎰潊闁炽儱鍘栭悽缁樼節閻㈤潧鈻堟繛浣冲浂鏁勯柛鈩冪♁閸嬪倹绻涢幋娆忕仾闁绘挻娲熼弻锟犲炊閵夈儳浠惧┑鐐村毆閸ャ劎鍘介棅顐㈡搐椤戝懘宕濆鍫熺厪闁搞儜鍐句純闂佺硶鏅槐鏇㈡晸閺傘倗绉甸柛鐘愁殜椤㈡挸顓奸崶鈺冿紳婵炶揪绲块…鍫ユ晸閽樺璐￠柡渚囧櫍閹瑩宕崟顓у數闂備胶绮…鍫ヮ敋瑜旈幆灞轿旈敓浠嬧�︾捄銊﹀磯闁绘艾鐡ㄩ弫鎯ь渻閵堝棙灏柕鍫㈩焾椤繒绱掑Ο璇差�撻梺闈╁瘜閸樹粙鎳ｉ崶顒佲拺闁告稑锕ラ悡銉╂煟椤掞拷閵堟悂寮幘缁樺殟闁靛鍎卞В鍫ユ⒑閸涘﹦鎳冮柛鐕佸亰椤㈡岸鏁愰崶鈺冿紲濠碘槅鍨甸崑鎰版儊閸儲鈷戦柟鑲╁仜閸旀﹢鏌涢弬娆炬█妤犵偞鍔欓弫鎾寸鐎ｎ偀鎷绘繛杈剧秬濞咃絿鏁☉銏＄厸閻忕偠顕ф慨鍌滐拷瑙勬磸閸庢娊鏁撻弬銈囩У闁跨喓鐡旈崹杈╂暜閿熺姴鏋侀柟鍓х帛閺呮悂鏌ㄩ悤鍌涘(illegal)
						TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�哥粻鏍煕椤愶絾绀�缁炬儳娼￠弻鐔煎箚閻楀牜妫勭紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劙顣︾�涒晜绻濆▓鍨灍濠电偛锕濠氭晬閸曨亝鍕冮柣鐘叉处瑜板啯鎱ㄩ弴銏♀拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬礃缁矂鍩ユ径鎰潊闁炽儱鍘栭悽缁樼節閻㈤潧鈻堟繛浣冲浂鏁勯柛鈩冪♁閸嬪倹绻涢幋娆忕仾闁绘挻娲熼弻锟犲炊閵夈儳浠惧┑鐐村毆閸ャ劎鍘介棅顐㈡搐椤戝懘宕濆鍫熺厪闁搞儜鍐句純闂佺硶鏅槐鏇㈡晸閺傘倗绉甸柛鐘愁殜椤㈡挸顓奸崶鈺冿紳婵炶揪绲块…鍫ユ晸閽樺璐￠柡渚囧櫍閹瑩宕崟顓у數闂備胶绮…鍫ヮ敋瑜旈幆灞轿旈敓浠嬧�︾捄銊﹀磯闁绘艾鐡ㄩ弫鎯ь渻閵堝棙灏柕鍫㈩焾椤繒绱掑Ο璇差�撻梺闈╁瘜閸樹粙鎳ｉ崶顒佲拺闁告稑锕ラ悡銉╂煟椤掞拷閵堟悂寮幘缁樺殟闁靛鍎卞В鍫ユ⒑閸涘﹦鎳冮柛鐕佸亰椤㈡岸鏁愰崶鈺冿紲濠碘槅鍨甸崑鎰版儊閸儲鈷戦柟鑲╁仜閸旀﹢鏌涢弬娆炬█妤犵偞鍔欓弫鎾寸鐎ｎ偀鎷绘繛杈剧秬濞咃絿鏁☉銏＄厸閻忕偠顕ф慨鍌滐拷瑙勬磸閸庢娊鏁撻弬銈囩У闁跨喓鐡旈崹杈╂暜閿熺姴鏋侀柟鍓х帛閺呮悂鏌ㄩ悤鍌涘, teamId: " + teamId);
						psend(oldLeaderRoleId, new STeamError(TeamError.AbsentCantBeLeader));
						return true;
					}
					team.getTeamInfo().setSwitchleaderid(-1);
					team.getTeamInfo().setSwitchleadertime(-1);
					psend(oldLeaderRoleId, new STeamError(TeamError.RefuseChangeLeader));
					TeamManager.logger.debug("SUCC:闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟缁�濠傗攽閻樺弶鎼愮紓浣叉櫊瀵爼宕煎顓熺彆闂佸搫妫欑划鎾诲蓟閿濆绠涢柣妤�鐗婇柨顓㈡⒑閹肩偛濡界紒璇茬墦瀵鏁愭径濠勵吅闂佹寧绻傚Λ顓炍涢崟顓犵＝濞达絽鎼鎾剁磽瀹ュ嫮绐旂�殿喖顭烽幃銏ゅ礂閼测晛濮洪梻浣瑰濮婂湱锟界瑳鍥х闁挎繂娲ㄧ壕钘夈�掑顒婃敾閻庢艾缍婇弻锝嗘償椤栨粎校闂佸摜濮甸〃濠囧春濞戙垹绠虫俊銈勮兌閸橀亶姊虹憴鍕凡闁告熬鎷风紓浣靛妼椤兘寮婚敍鍕舵嫹閿濆骸浜炴繛鍙夋尦閺屸�崇暆鐎ｎ剛鐦堥悗瑙勬礋娴滃爼銆佸锟介幃銏＄附婢跺澶�, roleid: " + newLeaderRoleId);
					return true;
				}

				if (checkPvP(oldLeaderRoleId, newLeaderRoleId) != 0) {
					return true;
				}

				if(!checkLeaderOnline(newLeaderRoleId))
				{
					//闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�哥粻鏍煕椤愶絾绀�缁炬儳娼￠弻鐔煎箚閻楀牜妫勭紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劙顣︾�涒晜绻濆▓鍨灍濠电偛锕濠氭晬閸曨亝鍕冮柣鐘叉处瑜板啯鎱ㄩ弴銏♀拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬礃缁矂鍩ユ径鎰潊闁炽儱鍘栭悽缁樼節閻㈤潧鈻堟繛浣冲浂鏁勯柛鈩冪♁閸嬪倿鏌￠崶銉ョ仾闁绘挶鍎甸弻锟犲磼濞戞﹩鍤嬮梺璇″灠閻楀棝鍩為幋锕�鐏抽柧蹇ｅ亜娴犳挳姊洪崫鍕拱闁烩晩鍨辨穱濠囧箚閹殿喚鏉搁梺鍝勫�归娆愬閿燂拷(illegal)
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�哥粻鏍煕椤愶絾绀�缁炬儳娼￠弻鐔煎箚閻楀牜妫勭紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劙顣︾�涒晜绻濆▓鍨灍濠电偛锕濠氭晬閸曨亝鍕冮柣鐘叉处瑜板啯鎱ㄩ弴銏♀拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬礃缁矂鍩ユ径鎰潊闁炽儱鍘栭悽缁樼節閻㈤潧鈻堟繛浣冲浂鏁勯柛鈩冪♁閸嬪倿鏌￠崶銉ョ仾闁绘挶鍎甸弻锟犲磼濞戞﹩鍤嬮梺璇″灠閻楀棝鍩為幋锕�鐏抽柧蹇ｅ亜娴犳挳姊洪崫鍕拱闁烩晩鍨辨穱濠囧箚閹殿喚鏉搁梺鍝勫�归娆愬閿燂拷, roleid: " + newLeaderRoleId);
				}
				else if(!checkNewLeaderNormal(team, newLeaderRoleId))
				{
					//闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�哥粻鏍煕椤愶絾绀�缁炬儳娼￠弻鐔煎箚閻楀牜妫勭紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劙顣︾�涒晜绻濆▓鍨灍濠电偛锕濠氭晬閸曨亝鍕冮柣鐘叉处瑜板啯鎱ㄩ弴銏♀拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬穿缁查箖骞嗛弮鍫濈劸闁靛鍨崇粔顔撅拷瑙勬穿缁绘繈骞冨锟介幊锟犲Χ閸℃鐣俊鐐�ら崢褰掑礉閹存繄鏆︽慨妤嬫嫹妞ゃ垺鐟╅幃鈩冩償閳ヨ櫕灏嬪┑鐘垫暩婵兘寮幖浣哥；闁绘梻鍘ч悡鏇㈡煕椤愩倕鏋旀い鈺佸级缁绘繃绻濋崒婊冣拪缂傚倸绉甸悧鐘诲蓟閺囷紕鐤�閻庯綆浜烽幏鐑藉冀椤撶偟鏌ч梺鍝勮閸庢煡鎮￠弴鐔虹闁瑰瓨绻傞懜褰掓煟韫囨洖鈻堥柡宀嬬秮楠炴﹢寮堕幋鐘辩礉婵犳鍠栭敃銊モ枍閿濆洦顫曢柟鐑樺焾濞笺劑鏌涢埄鍐噧濠殿喖銈稿缁樻媴閾忓箍锟藉﹪鏌￠崪浣烽偗妤犵偛绻橀弫鎾绘晸閿燂拷?婵犵數濮烽弫鎼佸磻閻愬搫绠板┑鐘崇閸ゅ苯螖閿濆懎鏆為柡鍛箞閺屻劑寮崹顔规寖闂佹椿鍘煎Λ婵嬪蓟濞戙垹鍗抽柕濞垮劤娴狀參姊虹紒妯诲鞍闁烩晩鍨跺璇测槈閵忕姷鍔撮梺鍛婂姉閸嬫捇鎮鹃崼鏇熲拺閻犳亽鍔岄弸娆愪繆椤愩垹顏柍銉畵閹粓鎸婃径灞肩礈闂備礁鎼粙渚�宕㈡總鍛婂�峰┑鐘插暔娴滄粓鏌熼搹鐟颁沪閻庢艾缍婂鍫曞煛閸屾粎鐣虹紓浣虹帛缁嬫帒顭囪箛娑樼鐟滃繗鈪靛┑锛勫亼閸婃垿宕曢弻銉ョ闁搞儺鍓欑粻鏍煟閹达絾顥夌紒鐘差煼閺屾盯骞橀懠璺哄帯闂佹寧绋掔划鎾愁潖閾忚鍏滈柛婊�鐒︾紞鍫ユ⒑閸涘﹥鈷愰柣妤佺矊閳藉鎮界粙鍧楀敹闂佸搫娲ㄩ崰鎾诲储娴犲鈷戦柡鍌樺劜濞呭懘鏌涢悤浣镐喊闁诡喗锕㈤獮姗�顢欓悾灞藉箰濠电偞鎸婚懝楣冩晝閵壯嶆嫹濮樼偓瀚�?(illegal)
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�哥粻鏍煕椤愶絾绀�缁炬儳娼￠弻鐔煎箚閻楀牜妫勭紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劙顣︾�涒晜绻濆▓鍨灍濠电偛锕濠氭晬閸曨亝鍕冮柣鐘叉处瑜板啯鎱ㄩ弴銏♀拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬穿缁查箖骞嗛弮鍫濈劸闁靛鍨崇粔顔撅拷瑙勬穿缁绘繈骞冨锟介幊锟犲Χ閸℃鐣俊鐐�ら崢褰掑礉閹存繄鏆︽慨妤嬫嫹妞ゃ垺鐟╅幃鈩冩償閳ヨ櫕灏嬪┑鐘垫暩婵兘寮幖浣哥；闁绘梻鍘ч悡鏇㈡煕椤愩倕鏋旀い鈺佸级缁绘繃绻濋崒婊冣拪缂傚倸绉甸悧鐘诲蓟閺囷紕鐤�閻庯綆浜烽幏鐑藉冀椤撶偟鏌ч梺鍝勮閸庢煡鎮￠弴鐔虹闁瑰瓨绻傞懜褰掓煟韫囨洖鈻堥柡宀嬬秮楠炴﹢寮堕幋鐘辩礉婵犳鍠栭敃銊モ枍閿濆洦顫曢柟鐑樺焾濞笺劑鏌涢埄鍐噧濠殿喖銈稿缁樻媴閾忓箍锟藉﹪鏌￠崪浣烽偗妤犵偛绻橀弫鎾绘晸閿燂拷?婵犵數濮烽弫鎼佸磻閻愬搫绠板┑鐘崇閸ゅ苯螖閿濆懎鏆為柡鍛箞閺屻劑寮崹顔规寖闂佹椿鍘煎Λ婵嬪蓟濞戙垹鍗抽柕濞垮劤娴狀參姊虹紒妯诲鞍闁烩晩鍨跺璇测槈閵忕姷鍔撮梺鍛婂姉閸嬫捇鎮鹃崼鏇熲拺閻犳亽鍔岄弸娆愪繆椤愩垹顏柍銉畵閹粓鎸婃径灞肩礈闂備礁鎼粙渚�宕㈡總鍛婂�峰┑鐘插暔娴滄粓鏌熼搹鐟颁沪閻庢艾缍婂鍫曞煛閸屾粎鐣虹紓浣虹帛缁嬫帒顭囪箛娑樼鐟滃繗鈪靛┑锛勫亼閸婃垿宕曢弻銉ョ闁搞儺鍓欑粻鏍煟閹达絾顥夌紒鐘差煼閺屾盯骞橀懠璺哄帯闂佹寧绋掔划鎾愁潖閾忚鍏滈柛婊�鐒︾紞鍫ユ⒑閸涘﹥鈷愰柣妤佺矊閳藉鎮界粙鍧楀敹闂佸搫娲ㄩ崰鎾诲储娴犲鈷戦柡鍌樺劜濞呭懘鏌涢悤浣镐喊闁诡喗锕㈤獮姗�顢欓悾灞藉箰濠电偞鎸婚懝楣冩晝閵壯嶆嫹濮樼偓瀚�?, roleid: " + newLeaderRoleId);
					MessageMgr.psendMsgNotifyWhileCommit(team.getTeamLeaderId(), 141671, null);
					MessageMgr.psendMsgNotifyWhileCommit(newLeaderRoleId, 141671, null);
				}
				else if(!checkTeamStatusValid(team))
				{
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閻斿吋鐓欓梺顓ㄧ畱楠炴绱撳鍡楃仼缂佽鲸甯″畷婊勬媴闂�鎰潟闂備礁鎼張顒勬儎椤栨凹鍤曢柟缁㈠枛鎯熼梺闈涚墕濞诧箓寮叉總鍛娾拻濞达綀妫勯ˉ宥嗐亜椤愩埄妯�鐎规洘娲熼獮搴ㄦ寠婢跺苯寮ㄥ┑鐘灱閸╂牠宕濋弴鐘典笉闁煎鍊ч幏椋庢喆閸曨剛顦ュ┑鐐差檧缁犳挻鎱ㄩ敓浠嬫煏韫囧鎷烽搹顐わ拷楣冩⒒娴ｈ櫣甯涙い銊ユ嚇閹嗙疀濞戞鐓戦梺璺ㄥ枙濡嫯鐏冮梺缁橈耿濞佳勭閿曞倹鐓曢柕濠忕畱椤曟粓鏌熸笟鍨闁轰焦鎸荤粋鎺旓拷锝庡亞閸橆亪姊洪崜鎻掍簼缂佽鍟撮幃锟犳晸娴犲鈷戦柛婵嗗閸屻劑鏌涢妸锔姐仢闁糕晜鐩獮鎺懳旀担鍝勫汲闂備胶绮濠氬磿閵堝應鏋嶉柡鍥ュ灪閻撴瑩鏌ｉ悢鍛婄凡妞ゅ浚鍘奸埞鎴﹀焺閸愨晛锟芥劕鈹戦敍鍕幋妤犵偛娲畷婊勬媴閻戞ɑ顔撻梻鍌欑閹碱偊鎯夋總绋跨獥闁哄稁鍘归敓鎴掔窔瀵粙顢曢敐鍛紡闂備線娼ц噹闁告侗鍠楅崯鐘电磽閸屾艾锟芥悂宕愬畡鎳婂綊宕堕妸锝勭矒闂佸綊妫块悞锕傚磻閿熺姵鐓ラ柡鍥╁仒缁鳖亪鏌涢妷锝呭妞ゆ洟浜堕幃妤�鈽夊▍顓т邯閺佹捇鎸婃径濠冃╅柧鑽ゅ仱閺岋絽螖閿熶粙鎮ц箛鏇犱笉闁哄稁鍘介悡娑㈡煕瀹�瀣閻庢艾缍婂濠氬磼濮橆剨鎷烽悜鑺ュ殑闁割偅娲栫粻鐘绘煙閸撗呭笡闁稿鍊濋弻鏇熺箾閻愵剚鐝曢梺绋款儏椤戝棙绌辨繝鍥ч柛娑卞枛濞咃綁姊洪幖鐐插闁稿﹤缍婃俊鐢稿礋椤栨氨顔婇梺鐟扮摠缁诲秵绂掗悡搴樻斀闁宠棄妫楁禍婵嬫嫅閸楃們搴ㄥ炊瑜濋煬顒勬煙椤旂晫鎳囨鐐存崌楠炴帡宕卞Ο铏规Ш闂傚倸鍊峰ù鍥х暦閻㈢绐楅柟閭﹀枟瀹曟煡鏌涢鐘插姎闁藉啰鍠栭弻鏇㈠醇濠垫劖效闂佽鍨抽崑鐐哄Φ閸曨垰绠涢柛鎾茬劍閸嬔勭箾鐎电甯堕悗姘煎枤濡叉劙骞樼�涙ê顎撻梺鑽ゅ枔婢ф寮虫导瀛樷拺闁荤喐婢樺▓鈺呮煙閸戙倖瀚�(illegal)
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閻斿吋鐓欓梺顓ㄧ畱楠炴绱撳鍡楃仼缂佽鲸甯″畷婊勬媴闂�鎰潟闂備礁鎼張顒勬儎椤栨凹鍤曢柟缁㈠枛鎯熼梺闈涚墕濞诧箓寮叉總鍛娾拻濞达綀妫勯ˉ宥嗐亜椤愩埄妯�鐎规洘娲熼獮搴ㄦ寠婢跺苯寮ㄥ┑鐘灱閸╂牠宕濋弴鐘典笉闁煎鍊ч幏椋庢喆閸曨剛顦ュ┑鐐差檧缁犳挻鎱ㄩ敓浠嬫煏韫囧鎷烽搹顐わ拷楣冩⒒娴ｈ櫣甯涙い銊ユ嚇閹嗙疀濞戞鐓戦梺璺ㄥ枙濡嫯鐏冮梺缁橈耿濞佳勭閿曞倹鐓曢柕濠忕畱椤曟粓鏌熸笟鍨闁轰焦鎸荤粋鎺旓拷锝庡亞閸橆亪姊洪崜鎻掍簼缂佽鍟撮幃锟犳晸娴犲鈷戦柛婵嗗閸屻劑鏌涢妸锔姐仢闁糕晜鐩獮鎺懳旀担鍝勫汲闂備胶绮濠氬磿閵堝應鏋嶉柡鍥ュ灪閻撴瑩鏌ｉ悢鍛婄凡妞ゅ浚鍘奸埞鎴﹀焺閸愨晛锟芥劕鈹戦敍鍕幋妤犵偛娲畷婊勬媴閻戞ɑ顔撻梻鍌欑閹碱偊鎯夋總绋跨獥闁哄稁鍘归敓鎴掔窔瀵粙顢曢敐鍛紡闂備線娼ц噹闁告侗鍠楅崯鐘电磽閸屾艾锟芥悂宕愬畡鎳婂綊宕堕妸锝勭矒闂佸綊妫块悞锕傚磻閿熺姵鐓ラ柡鍥╁仒缁鳖亪鏌涢妷锝呭妞ゆ洟浜堕幃妤�鈽夊▍顓т邯閺佹捇鎸婃径濠冃╅柧鑽ゅ仱閺岋絽螖閿熶粙鎮ц箛鏇犱笉闁哄稁鍘介悡娑㈡煕瀹�瀣閻庢艾缍婂濠氬磼濮橆剨鎷烽悜鑺ュ殑闁割偅娲栫粻鐘绘煙閸撗呭笡闁稿鍊濋弻鏇熺箾閻愵剚鐝曢梺绋款儏椤戝棙绌辨繝鍥ч柛娑卞枛濞咃綁姊洪幖鐐插闁稿﹤缍婃俊鐢稿礋椤栨氨顔婇梺鐟扮摠缁诲秵绂掗悡搴樻斀闁宠棄妫楁禍婵嬫嫅閸楃們搴ㄥ炊瑜濋煬顒勬煙椤旂晫鎳囨鐐存崌楠炴帡宕卞Ο铏规Ш闂傚倸鍊峰ù鍥х暦閻㈢绐楅柟閭﹀枟瀹曟煡鏌涢鐘插姎闁藉啰鍠栭弻鏇㈠醇濠垫劖效闂佽鍨抽崑鐐哄Φ閸曨垰绠涢柛鎾茬劍閸嬔勭箾鐎电甯堕悗姘煎枤濡叉劙骞樼�涙ê顎撻梺鑽ゅ枔婢ф寮虫导瀛樷拺闁荤喐婢樺▓鈺呮煙閸戙倖瀚�, teamId: " + teamId);
				}
				else if(!checkTeamInSwitchStatus(team))
				{
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閻斿吋鐓欓梺顓ㄧ畱婢у鏌涢妶鍥ф灈闁哄苯绉剁槐鎺懳熼悜鈺傚闂備浇娉曢崰鏇炍涢崟顓犱笉鐎广儱顦壕鍧楁⒑椤掞拷缁夊绮婚鐐村�甸柨婵嗗嚱閹风兘顢橀妸褏袦閻庤娲╃换婵嬪箖濮楋拷閹筹繝濡堕崱妤佺暚婵＄偑鍊ら崢褰掑礉閹存繄鏆︽慨妤嬫嫹闁炽儻绠撻獮瀣攽閸狀喓鍔岄埞鎴︽偐閸偅姣勯梺绋款儑閸嬬娀濡甸幇鏉跨妞ゎ厽鍨归崝鐑芥⒑鐠恒劌鏋斿┑顔煎槻閻ｅ灚绗熼敓浠嬪蓟閻斿憡缍囬柛鎾楀懏娈告俊鐐�ら崑鍕箠濮楋拷瀵寮撮姀鐘诲敹濠电娀娼уú銊╁储閹扮増鈷戦柛婵嗗閸屻劑鏌涢妸锔姐仢闁糕晜鐩獮鎺懳旀担鍝勫汲闂備胶绮濠氬磿閵堝應鏋嶉柡鍥ュ灪閻撴瑩鏌ｉ悢鍛婄凡妞ゅ浚鍘奸埞鎴﹀焺閸愨晛锟芥劙鏌℃担绋匡拷鍧楀箠閻愬搫唯妞ゆ柨鍚嬪▍鏇㈡⒒閸屾艾锟藉嘲霉閸パ呮殾闁割煈鍋呴崣蹇涙煛婢跺娈繛宸憾閺佸洭鏌嶇捄鐑樻儓妞わ妇鏁婚悰顔嘉熺涵閿嬪婵炴垶顏鍕靛殨闁秆勵殕閳锋垹鎲搁悧鍫濈瑲闁挎稓鍠撶槐鎺楁晸閼恒儲濯撮柧蹇涳拷娑氱憹闂備胶鎳撻悺銊ф閻ゎ垬浜归柟鐑樻尰濞呮粓姊洪幖鐐插姌闁告柨鑻埢鎾崇暆閸曨兘鎷洪柣鐘叉穿鐏忔瑧绮婚崣澶堜簻闁靛鍎婚煬顒傦拷娈垮枛椤攱淇婇懜闈涚窞濠电姴瀚伴悰鎾绘⒒娴ｅ憡璐℃い顓炵墛椤ㄣ儳绮欐惔鎾寸亖閻庣櫢鎷烽柨鐔烘櫕濡叉劙骞樼�涙ê顎撻梺鍛婃尭瀵埖鏅ラ梻鍌欑濠�閬嶁�﹂崼銉ョ柈闁秆勵殢閺佸鏌ㄥ┑鍡╂Ч闁哄懏鎮傞弻銊╂偆閸屾稑顏�?(illegal)
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閻斿吋鐓欓梺顓ㄧ畱婢у鏌涢妶鍥ф灈闁哄苯绉剁槐鎺懳熼悜鈺傚闂備浇娉曢崰鏇炍涢崟顓犱笉鐎广儱顦壕鍧楁⒑椤掞拷缁夊绮婚鐐村�甸柨婵嗗嚱閹风兘顢橀妸褏袦閻庤娲╃换婵嬪箖濮楋拷閹筹繝濡堕崱妤佺暚婵＄偑鍊ら崢褰掑礉閹存繄鏆︽慨妤嬫嫹闁炽儻绠撻獮瀣攽閸狀喓鍔岄埞鎴︽偐閸偅姣勯梺绋款儑閸嬬娀濡甸幇鏉跨妞ゎ厽鍨归崝鐑芥⒑鐠恒劌鏋斿┑顔煎槻閻ｅ灚绗熼敓浠嬪蓟閻斿憡缍囬柛鎾楀懏娈告俊鐐�ら崑鍕箠濮楋拷瀵寮撮姀鐘诲敹濠电娀娼уú銊╁储閹扮増鈷戦柛婵嗗閸屻劑鏌涢妸锔姐仢闁糕晜鐩獮鎺懳旀担鍝勫汲闂備胶绮濠氬磿閵堝應鏋嶉柡鍥ュ灪閻撴瑩鏌ｉ悢鍛婄凡妞ゅ浚鍘奸埞鎴﹀焺閸愨晛锟芥劙鏌℃担绋匡拷鍧楀箠閻愬搫唯妞ゆ柨鍚嬪▍鏇㈡⒒閸屾艾锟藉嘲霉閸パ呮殾闁割煈鍋呴崣蹇涙煛婢跺娈繛宸憾閺佸洭鏌嶇捄鐑樻儓妞わ妇鏁婚悰顔嘉熺涵閿嬪婵炴垶顏鍕靛殨闁秆勵殕閳锋垹鎲搁悧鍫濈瑲闁挎稓鍠撶槐鎺楁晸閼恒儲濯撮柧蹇涳拷娑氱憹闂備胶鎳撻悺銊ф閻ゎ垬浜归柟鐑樻尰濞呮粓姊洪幖鐐插姌闁告柨鑻埢鎾崇暆閸曨兘鎷洪柣鐘叉穿鐏忔瑧绮婚崣澶堜簻闁靛鍎婚煬顒傦拷娈垮枛椤攱淇婇懜闈涚窞濠电姴瀚伴悰鎾绘⒒娴ｅ憡璐℃い顓炵墛椤ㄣ儳绮欐惔鎾寸亖閻庣櫢鎷烽柨鐔烘櫕濡叉劙骞樼�涙ê顎撻梺鍛婃尭瀵埖鏅ラ梻鍌欑濠�閬嶁�﹂崼銉ョ柈闁秆勵殢閺佸鏌ㄥ┑鍡╂Ч闁哄懏鎮傞弻銊╂偆閸屾稑顏�?, teamId: " + teamId);
				}
				else if(!checkAnwserIsNewLeader(team, newLeaderRoleId))
				{
					//闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�哥粻鏍煕椤愶絾绀�缁炬儳娼￠弻鐔煎箚閻楀牜妫勭紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劙顣︾�涒晜绻濆▓鍨灍濠电偛锕濠氭晬閸曨亝鍕冮柣鐘叉处瑜板啯鎱ㄩ弴銏♀拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬礃缁矂鍩ユ径鎰潊闁炽儱鍘栭悽缁樼節閻㈤潧鈻堟繛浣冲浂鏁勯柛鈩冪♁閸嬪倹绻涢幋娆忕仾闁绘挻娲熼弻锟犲炊閵夈儳浠惧┑鐐村毆閸ャ劎鍘介棅顐㈡搐椤戝懘宕濆鍫熺厪闁搞儜鍐句純闂佺硶鏅槐鏇㈡晸閺傘倗绉甸柛鐘愁殜椤㈡挸顓奸崶鈺冿紳婵炶揪绲块…鍫ユ晸閽樺璐￠柡渚囧櫍閹瑩宕崟顓у數闂備胶绮…鍫ヮ敋瑜旈幆灞轿旈敓浠嬧�︾捄銊﹀磯闁绘艾鐡ㄩ弫鎯ь渻閵堝棙灏柕鍫㈩焾椤繒绱掑Ο璇差�撻梺闈╁瘜閸樹粙鎳ｉ崶顒佲拺闁告稑锕ラ悡銉╂煟椤掞拷閵堟悂寮幘缁樺殟闁靛鍎卞В鍫ユ⒑閸涘﹦鎳冮柛鐕佸亰椤㈡岸鏁愰崶鈺冿紲濠碘槅鍨甸崑鎰版儊閸儲鈷戦柟鑲╁仜閸旀﹢鏌涢弬娆炬█妤犵偞鍔欓弫鎾寸鐎ｎ偀鎷绘繛杈剧秬濞咃絿鏁☉銏＄厸閻忕偠顕ф慨鍌滐拷瑙勬磸閸庢娊鏁撻弬銈囩У闁跨喓鐡旈崹杈╂暜閿熺姴鏋侀柟鍓х帛閺呮悂鏌ㄩ悤鍌涘(illegal)
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�哥粻鏍煕椤愶絾绀�缁炬儳娼￠弻鐔煎箚閻楀牜妫勭紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劙顣︾�涒晜绻濆▓鍨灍濠电偛锕濠氭晬閸曨亝鍕冮柣鐘叉处瑜板啯鎱ㄩ弴銏♀拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬礃缁矂鍩ユ径鎰潊闁炽儱鍘栭悽缁樼節閻㈤潧鈻堟繛浣冲浂鏁勯柛鈩冪♁閸嬪倹绻涢幋娆忕仾闁绘挻娲熼弻锟犲炊閵夈儳浠惧┑鐐村毆閸ャ劎鍘介棅顐㈡搐椤戝懘宕濆鍫熺厪闁搞儜鍐句純闂佺硶鏅槐鏇㈡晸閺傘倗绉甸柛鐘愁殜椤㈡挸顓奸崶鈺冿紳婵炶揪绲块…鍫ユ晸閽樺璐￠柡渚囧櫍閹瑩宕崟顓у數闂備胶绮…鍫ヮ敋瑜旈幆灞轿旈敓浠嬧�︾捄銊﹀磯闁绘艾鐡ㄩ弫鎯ь渻閵堝棙灏柕鍫㈩焾椤繒绱掑Ο璇差�撻梺闈╁瘜閸樹粙鎳ｉ崶顒佲拺闁告稑锕ラ悡銉╂煟椤掞拷閵堟悂寮幘缁樺殟闁靛鍎卞В鍫ユ⒑閸涘﹦鎳冮柛鐕佸亰椤㈡岸鏁愰崶鈺冿紲濠碘槅鍨甸崑鎰版儊閸儲鈷戦柟鑲╁仜閸旀﹢鏌涢弬娆炬█妤犵偞鍔欓弫鎾寸鐎ｎ偀鎷绘繛杈剧秬濞咃絿鏁☉銏＄厸閻忕偠顕ф慨鍌滐拷瑙勬磸閸庢娊鏁撻弬銈囩У闁跨喓鐡旈崹杈╂暜閿熺姴鏋侀柟鍓х帛閺呮悂鏌ㄩ悤鍌涘, teamId: " + teamId);
				}
				/*else if(!checkTeamNoSuccSwitchIn2min(team))
				{
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閵夆晜鐓熼柡鍥╁仜閿熻棄婀遍敓鑺ョ啲閹凤拷2闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣告贡閸庛倝宕甸敃锟介埥澶娢熼柨瀣澑闂佽鍑界紞鍡樼閻愪警鏁婇柛銉墯閳锋垿鎮峰▎蹇擃仼缂侊拷閸愨斂浜滈柡鍥ф濞诧箓宕曞Δ浣风箚闁靛牆瀚板宄懊瑰鍕煉闁绘搩鍋婂畷鍫曞Ω閿曪拷闂夊秹姊洪悷鏉挎倯闁告梹鐟╁璇测槈濡粎鍠撶槐鎺懳熼崫鍕暘闂傚倷绀侀幖顐︽儗婢跺本宕叉繝闈涙閺嗭箓鏌熼鐐蹭喊婵℃煡绠栧娲捶椤撶喐鐝繝娈垮枤閸忔﹢寮幘璇茬９闁绘洑鐒︾紞鍫濃攽閻愭彃绾ч柨鏇樺灲楠炲啴鏁撻悩鑼紜闂佸綊顣﹂悞锔剧礊鎼淬垻绡�闂傚牊绋戦敓鑺ユ倐楠炲鏁撻悩鑼紱闂佸憡娲﹂崹閬嶆偂閺囥垻鍙撻柛銉ｅ妽鐏忣參鏌熼钘夌伌闁哄矉缍侀弫鍌炴嚃閳哄叐鎴犵磽娴ｈ櫣甯涢柣鈺婂灦閻涱喚锟斤綆鍣弫宥嗙箾閹寸儑渚涘ù纭锋嫹?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熸潏鍓х暠缂佺媭鍨堕弻銊╂偆閸屾稑顏�?
					psend(newLeaderRoleId, new STeamError(TeamError.ChangeLeaderInCD));
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閵夆晜鐓熼柡鍥╁仜閿熻棄婀遍敓鑺ョ啲閹凤拷2闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣告贡閸庛倝宕甸敃锟介埥澶娢熼柨瀣澑闂佽鍑界紞鍡樼閻愪警鏁婇柛銉墯閳锋垿鎮峰▎蹇擃仼缂侊拷閸愨斂浜滈柡鍥ф濞诧箓宕曞Δ浣风箚闁靛牆瀚板宄懊瑰鍕煉闁绘搩鍋婂畷鍫曞Ω閿曪拷闂夊秹姊洪悷鏉挎倯闁告梹鐟╁璇测槈濡粎鍠撶槐鎺懳熼崫鍕暘闂傚倷绀侀幖顐︽儗婢跺本宕叉繝闈涙閺嗭箓鏌熼鐐蹭喊婵℃煡绠栧娲捶椤撶喐鐝繝娈垮枤閸忔﹢寮幘璇茬９闁绘洑鐒︾紞鍫濃攽閻愭彃绾ч柨鏇樺灲楠炲啴鏁撻悩鑼紜闂佸綊顣﹂悞锔剧礊鎼淬垻绡�闂傚牊绋戦敓鑺ユ倐楠炲鏁撻悩鑼紱闂佸憡娲﹂崹閬嶆偂閺囥垻鍙撻柛銉ｅ妽鐏忣參鏌熼钘夌伌闁哄矉缍侀弫鍌炴嚃閳哄叐鎴犵磽娴ｈ櫣甯涢柣鈺婂灦閻涱喚锟斤綆鍣弫宥嗙箾閹寸儑渚涘ù纭锋嫹?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧潡鏌熸潏鍓х暠缂佺媭鍨堕弻銊╂偆閸屾稑顏�?, teamId: " + teamId);
				}*/
				else
				{
					
					//xbean.TeamInfo team = xtable.Team.get(team);
					if(team.switchTeamLeaderWithSP(newLeaderRoleId))
					{
						team.getTeamInfo().setSuccessswitchtime(now);
						TeamManager.logger.debugWhileCommit("SUCC:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閻斿吋鐓欓梺顓ㄧ畱婢ь垶鏌熼姘卞ⅵ闁哄本绋戣灃濞达絿纭堕弸娆撴⒑鐠団�虫灍妞ゃ劌鎳橀崺銉﹀緞婵炵偓鐎哄銈嗘寙閸屾粌鍤梻浣筋嚃閸ㄥ崬顫忛崷顓熷床婵犻潧顑呴悙濠囨煏婵炲灝鐏悗姘矙濮婄粯鎷呴崨濠傛殘闂佸憡妫戦梽鍕矉瀹ュ拋鐓ラ柛顐ｇ箓閸ゆ垵鈹戦悙鏉戠仧闁搞劍妞介幃鈥斥槈閵忥紕鍘遍梺瀹犳濡鐛Δ鍛�垫慨妯煎亾鐎氾拷, teamId: " + teamId);
					}
					else
						TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閻斿吋鐓欓梺顓ㄧ畱婢ь垶鏌熼姘卞ⅵ闁哄本绋戣灃濞达絿纭堕弸娆撴⒑鐠団�虫灍妞ゃ劌鎳橀崺銉﹀緞婵炵偓鐎哄銈嗘寙閸屾粌鍤梻浣筋嚃閸ㄥ崬顫忛崷顓熷床婵犻潧顑呴悙濠囨煏婵炲灝鐏悗姘矙濮婄粯鎷呴崨濠傛殘闂佸憡妫戦梽鍕矉瀹ュ拋鐓ラ柛顐ｇ箓閸ゆ垵鈹戦悙鏉戠仧闁搞劍妞介幃鈥斥槈閵忥紕鍘遍梺鏂ユ櫅閸燁偊宕ú顏呯厱婵犻潧锕ラ鐘绘煥閻旂粯顥夐柣蹇旇壘椤灝螣绾攱瀚规慨妯煎帶楠炴牗銇勯鐐寸┛缂佺姵绋戦埥澶嬫綇閵婏附鐝栭梻鍌欑窔濞佳囁囨导鏉戠鐟滄棃鐛箛娑欐櫢闁跨噦鎷�, teamId: " + teamId);
				}
					 
				return true;
			}
		};
		setTeamLeaderP.submit();
	}

	// 婵犵數濮烽弫鍛婃叏閻戝锟藉倿鎸婃竟鈺嬬秮瀹曠喖顢涘槌栧數闂備浇娉曢崳锕傚箯閿燂拷?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉梺缁樻尰閿曘垽寮婚悢鐑樺磯妞ゎ厽鍨堕锟�
	private static int checkPvP(long oldLeaderRoleId, long newLeaderRoleId) {
		// 闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�哥粻鏍煕椤愶絾绀�缁炬儳娼￠弻鐔煎箚閻楀牜妫勭紒鐐劤椤兘寮婚敐澶婃闁割煈鍠楅崐顖炴⒑缁嬫鍎嶉柛濠冪箞瀵鏁愭径濠勭潉闂佺鏈懝鐐濮楋拷濮婃椽宕ㄦ繝鍕櫑闂佹寧娲忛崕鍨繆閻㈢绀嬫い鏍ㄨ壘閸炪劑姊洪棃娴ゆ稓浠﹂悙顒夊晣闂傚倸鍊烽懗鍫曗�﹂崼鐕佹闁归棿鐒﹂弲婵囥亜韫囨挾澧曢柦鍐枛閺岋綁寮崒姘粯缂備胶濮电敮锟犲蓟閻斿吋鍊绘俊顖濇娴犲瓨绻濆▓鍨灈闂佸府缍侀獮鍐ㄧ暋闁妇鍙嗛梺鍛婃处閸撴盯宕欓敓鐘斥拺缂備焦锕╁▓鏇㈡煙閸涘﹥鍊愰柨婵堝仩缁犳盯寮崒鐐搭�嶉梻浣告啞缁嬫垿鏁冮妶鍡欘洸婵犲﹤鐗婇埛鎴犵磼鐎ｎ厽纭剁紒鐘卞嵆閺屾稑顫濋澶婂壎闂佽鍨欢姘跺极閹版澘骞㈡繛鍡樺焾閸熷酣姊虹拠鍙夋崳闁轰焦鎮傞垾锕傚醇閵壯嶆嫹闁垮绻嗛柣鎰典簻閿熻姤鐗曢埢鏃堟晝閸屾氨鍊為悷婊冪箻閹潡宕堕浣叉嫼闁荤姵浜介崝灞解枍閹扮増鐓欓柛鎴欏�栫�氾拷
		return fire.pb.battle.pvp.PvPTeamHandle.onAnswerforSetLeader(oldLeaderRoleId, newLeaderRoleId);
	}

	// 闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�哥粻鏍煕椤愶絾绀�缁炬儳娼￠弻鐔煎箚閻楀牜妫勭紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劙顣︾�涒晜绻濆▓鍨灍濠电偛锕濠氭晬閸曨亝鍕冮柣鐘叉处瑜板啯鎱ㄩ弴銏♀拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬磸閸ㄨ櫣绮嬮幒鏃撴嫹閿濆骸澧憸鏉挎椤啴濡堕崱妤冪懆闂佺锕ㄥ畷鍨珶閺囩喓闄勯柛娑橈功閸欏棝姊虹紒妯荤闁稿﹤婀遍敓鑺ョ啲閹凤拷??闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢绘俊鐐�栭悧妤冪矙閹炬眹锟藉懘寮婚妷锔惧弳濠电娀娼уΛ顓炍ｉ崫銉х＜闁跨喍绮欏畷鎺戔槈濞嗗繐浼庢繝寰锋澘锟芥洟顢栭崱娆欐嫹濮橆剛绉洪柟顔筋殘閹叉挳宕熼鍌ゆФ闂備胶顭堢换鎴︽晝閵忕姷鏆﹂柣鎴灻欢鐐烘煙闁箑澧版い鏂挎嚇濮婄儤瀵煎▎鎴濐嚤缂備焦妫忛弻鍗島re濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柛宀�鍋為埛鎺楁煕鐏炲墽鎳呴柛鏂跨Ч閹绮☉妯诲櫧闁活厽鐟╅弻鐔告綇妤ｅ啯顎嶉梺绋垮椤ㄥ﹪寮诲☉妯兼殕闁跨喍绮欏畷鎴濃槈濮樿京锛滈梺鍐叉惈閸婅埖绂嶅鍫熺厪闁割偅绻冨婵喢瑰鍕磼derRoleId闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�归崕鎴犳喐閻楀牆绗掔紒锟芥径鎰�堕柣鎰版涧娴滅偓绻涢崨顖氣枅闁哄矉绻濋弫鎾寸鐎ｎ亞鐣抽梺鍝勵槸閸╂仜ck
	private boolean checkLeaderOnline(long leaderRoleId)
	{
		if(StateCommon.isOnline(leaderRoleId))
			return true;
		else
			return false;
	}
	
	//闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�哥粻鏍煕椤愶絾绀�缁炬儳娼￠弻鐔煎箚閻楀牜妫勭紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劙顣︾�涒晜绻濆▓鍨灍濠电偛锕濠氭晬閸曨亝鍕冮柣鐘叉处瑜板啯鎱ㄩ弴銏♀拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬穿缁查箖骞嗛弮鍫濈劸闁靛鍨崇粔顔撅拷瑙勬穿缁绘繈骞冨锟介幊锟犲Χ閸℃鐣俊鐐�ら崢褰掑礉閹存繄鏆︽慨妤嬫嫹闁炽儻绠撻獮瀣攽閸狀喓鍔岄埞鎴︽晬閸曨偂鏉梺绋匡攻閻楁粓寮鍢夋棃宕橀妸銉т喊闂佺懓鍚嬮悾顏堝礉瀹�鍕嚑濞达絽绠嶆禍婊堟煛閸ユ湹绨奸悗姘秺閹鎲撮崟顒�顦╅梺绋款儏閿曘儲绌辨繝鍥ㄥ�婚柦妯猴級閵娾晜鐓欓柡澶婄仢椤ｆ娊鏌ｉ敐鍥ㄦ毈闁哄备锟藉磭鏆嗛柨鐔剁矙瀹曚即寮介婊愭嫹娓氾拷瀵粙顢曢敐鍛紡闂備線娼ц噹闁告侗鍠楅崯鐘电磽閸屾艾锟芥悂宕愬畡鎳婂綊宕堕妸褜娲稿銈嗗笒鐎氼剟寮告笟锟介幃褰掑炊椤忓嫮姣㈤梺鍝勬４缁犳捇寮婚妸銉㈡斀闁糕檧鏅滈埢鎾绘⒑鏉炴壆顦﹂柛濠傛健瀵鈽夐姀鐘栥劑鏌熺�涙绠撻柡鍡樼懅缁辨帡鎮崨顖溞滃┑顔硷功缁垳绮悢鍏兼櫢闁芥ê顦介悞钘夆攽閻樺磭顣查柛銈呯墦閹嘲鈻庤箛鎿冧痪濠电偛鎳愭慨鐢稿Φ閸曨噮妲鹃梺缁樼箘閻楁瓱dure濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
	private boolean checkNewLeaderNormal(Team team, long memberRoleId)
	{
		//xbean.TeamInfo team = xtable.Team.get(teamId);
		for(xbean.TeamMember member: team.getTeamInfo().getMembers())
		{
			if(member.getRoleid() == memberRoleId && member.getState() == fire.pb.team.TeamMemberState.eTeamNormal)
				return true;
		}
		return false;
	}
	
	
	//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閻斿吋鐓欓梺顓ㄧ畱楠炴绱撳鍡楃仼缂佽鲸甯″畷婊勬媴闂�鎰潟闂備礁鎼張顒勬儎椤栨凹鍤曢柟缁㈠枛鎯熼梺闈涚墕濞诧箓寮叉總鍛娾拻濞达絽鎼敮鍓佺磽瀹ュ拑鍔熺紒顔碱煼瀵粙顢橀悙鑸垫啺婵犵數鍋為崹鎯板綔闂佸搫顑呯�涒晜绌辨繝鍥舵晬婵犻潧娴傛禒鈺傜箾鐎电顫掗柛鏇ㄥ幘椤旀洟鏌ｆ惔銏⑩檨妞ゎ厼娲幆宀�锟斤綆鍠楅崑銊︺亜閺嶃儱锟芥寮ч敓浠嬫⒑缂佹ü绶遍柛锝忕秮閻涱喚锟斤綆鍠楅弲婵嬫煥閻斿墎鐭欓柨婵堝仱瀹曘劎锟芥稒顭囬崢顏堟⒑閸撴彃浜濈紒璇插暣閹繝鏁撴禒瀣拺闁告繂瀚崒銊╂煕閵婏附銇濋柛鈺傜洴楠炴帒螖娴ｅ搫寮抽梻浣虹帛濮婂宕曢妶鍛瀺闁哄洢鍨洪悡娆撴煟閻斿憡绶叉い蹇ｅ幖閳规垿鍩勯崘鈺侊拷鎰版煛娴ｇ锟藉潡骞冨▎鎿冩晢濞撴艾娲ら弲鐘绘⒒閸屾艾锟芥悂宕愰悜鑺ュ殑闁告挷绀侀崹婵囥亜閺嶎偄浜归柨鐔告灮缁犳挸鐣锋總绋课ㄩ柕澶涢檮琚ｉ梻鍌欐祰濞夋洟宕抽敃鍌氱闁跨噦鎷�?婵犵數濮烽弫鎼佸磻閻愬搫绠板┑鐘崇閸ゅ苯螖閿濆懎鏆為柡鍛箞閺屻劑寮撮悙璇ф嫹閸濄儲鍠嗛柨鏃傚亾閸犳劙鏌ｅΔ锟介悧鍡欑箔濮樿埖鐓熼柟鎯у船閸旀粎绱掔紒妯兼创妤犵偛顑夐幃婊堝幢濞嗗繐楔婵犵數濮幏鍐吋婢跺锟藉秹姊洪棃娑欐悙閻庢氨澧楁穱濠囨倻缁涘鏅┑鐘诧工鐎氼剚绂掕ぐ鎺撯拻濞达絿鐡旈崵鍐煕閻樻剚娈旀い顓炵仢椤粓鏁撴禒瀣畺闁诡垎锟介弨浠嬫煕椤愵偄澧悗姘秺閺屻劌鈹戦崱娑憋拷妤�顭胯婢ф濡甸崟顖涙櫆閻犲洤寮堕悵婵嗏攽椤旂》鏀绘俊鐐扮矙楠炲啴鎮滈挊澶岊吋濡炪倖妫佹慨銈夊窗閺嶎厽鈷戦柦妯侯槸閺嗭絽霉濠婂啰鍩ｇ�殿喖顭烽弫宥夊礋閼搁潧顏堕梺鎸庣箓妤犲憡鏅堕锟介弻锛勶拷锝庡亜閻忊晝绱掓潏銊ョ闁跨喐鏋荤紞鍡樼鐠轰綍鐔兼晸閽樺娓婚柕鍫濆暙閻忣亪鏌ㄥ鑸电厓閻熸瑥瀚悘瀵革拷瑙勬礀閵堝憡鎱ㄩ敓浠嬫煃閵夈劍鐝柣蹇ユ嫹闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ礀閸屻劎鎲搁弮鍫濈畺闁秆勵殔閻愬﹪鏌曟繝蹇曠暠鐎殿喖娼″娲濞戞艾顣洪梺纭呮珪閸旀瑥顕ｉ幎鑺ユ櫇闁稿本绋撻崢鎼佹煟韫囨洖浠╂い鏇嗗洤绀夋繝濠傜墛閻撳啴姊洪崹顕呭剱鐎规洖鐭傞弻鈥崇暆鐎ｎ剛袦閻庢鍣崜鐔风暦瑜版帩鏁婇柦妯侯檧閹风兘顢涘锝嗘杸濡炪倖娲栧Λ娑氱矙婵犳碍鐓曢柡鍐挎嫹闁荤啿鏅涢锝嗙節濮橆儵鈺呮煏婢跺牆鐏い顐㈢Т閳规垿鍩ラ崱妤冧淮闂佺顑嗛崝娆忕暦濠靛鏁婇柛鎾楀拑绱冲┑鐐舵彧缂嶏拷婵炲拑绲块弫顔尖槈濞嗘垹顔曢梺鑲┾拡閸撴瑩寮告惔鈧簻闁哄浂浜炵粔顔撅拷瑙勬礀缂嶅﹪銆侀弴銏狀潊闁靛繈鍨诲畵浣圭節閻㈤潧啸闁轰礁鎲￠幈銊╁箻椤旇偐锛欓梺鍛婄缚閸庢煡顢曢懞銉ｄ簻闁规崘娉涢弸鏃傜磼閻樿崵鐣洪柟顔筋殜閹棄鈻撶捄銊ュЪ闂佸搫绋勭换婵嗩潖閾忓湱纾兼慨妤�妫欓悾椋庣磽娓氬洤鏋涚紒澶婄秺閻涱噣宕奸妷銉庘晠鏌嶆潪鎷屽厡妞ゆ梹鍔栫换娑欐綇閸撗冨煂闂佺濮ょ划鎾诲箖閻愵剚缍囬柕濞у拋鍟庨梺鍝勵槸閻楀棙鏅舵禒瀣濞寸厧鐡ㄩ悡娆撴偣閸ュ洤鎳愰惁鍫ユ倵鐟欏嫭绀冮柛銊ョ秺閺佹捇寮妶鍥┬ｉ梺鍝ュУ椤ㄥ﹪骞冮敓鐘参ㄩ柨鏂垮⒔椤旀洟姊洪悷閭﹀殶闁稿濮电粩鐔肺熼懡銈囶啎闂佸憡渚楅崰鏍ㄦ叏婢跺瞼纾奸弶鍫涘妼濞搭喗顨ラ悙宸Ш闁跨喐鏋荤紞鍡涘磻閸曨垼鏁傞柨鐕傛嫹
	private boolean checkTeamStatusValid(Team team)
	{
		BuffAgent agent = new BuffRoleImpl(team.getTeamLeaderId(),true);
		int conflictId = agent.checkCanAddBuff(BuffConstant.StateType.STATE_TEAM_LEADER);
		return conflictId == 0;
	}
	
	//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閻斿吋鐓欓梺顓ㄧ畱楠炴绱撳鍡楃仼缂佽鲸甯″畷婊勬媴闂�鎰潟闂備礁鎼張顒勬儎椤栨凹鍤曢柟缁㈠枛鎯熼梺闈涚墕濞诧箓寮叉總鍛娾拻濞达絽鎼敮鍓佺磽瀹ュ拑鍔熺紒顔碱煼瀵粙顢橀悙鑸垫啺闂備浇娉曢崰鎾存叏閹绢喗鍊峰┑鐘插閸犳劙鐓崶銊р槈缂佺姵妞介弻锝呂熺喊杈ㄦ闂佸湱鍏橀ˉ鎾诲箟閹绢喖绀嬫い鎺戝亞濡蹭即姊绘担铏瑰笡闁瑰憡鎸抽弫鎾绘嚍閵夈儱顫┑鐐插悑閻楁洟鍩為幋锕�纾兼慨姗嗗幖閺嗗牓姊虹粙娆惧剰閻庢矮鍗冲璇测槈濠婂懐鏉搁梺瑙勫礃濞呮洟宕愰鐐粹拺濞村吋鐟ㄩ铏圭磽瀹ュ嫮顦︽い顐㈢箻瀹曨偊宕熼幊宄版搐閻愬﹦鎲歌箛鏃傤浄濠靛倸鎲￠埛鎴炴叏閻熺増鎼愰柨鐔诲Г濞叉牜鍙呭銈嗘尨閸嬫捇鏁撻幋鎺旑槮妞ゎ偅绻冮敍鎰攽閸ャ劍鐝滈梻鍌欑閹测�趁洪敃鍌氱婵炲棙鍔楅々鑼喐閻楀牆绗氶柍閿嬪灥閳规垿宕掑顓炴殘婵炲瓨鍤庨崐婵嬪蓟閻旂厧绀勯柕鍫濇椤忥拷?婵犵數濮烽弫鎼佸磻閻樿绠垫い蹇撴缁躲倕螖閿濆懎鏆為柛瀣ㄥ�濋弻锟犲炊閳轰緡锟芥捇鏌熷畡鏉挎Щ妞ゎ偅绻堥、姗�鎮╅崘鍙夌彛闂傚倷绀侀悿鍥涢崟顖�鍥偨閸濄儱绁﹀┑鈽嗗灣閵嗗骞忓畡鎵虫婵炲懓椴稿畝鎼佺嵁韫囨稒鍋￠柟浣冩珪閺傦拷闂備胶绮悷銉╁箠韫囨洩鎷峰杈ㄥ殌妞ゎ亜鍟存俊鍫曞幢濡儤娈┑鐘愁問閸犳岸寮繝姘卞祦闁糕剝绋戝敮闂佸啿鎼崐濠氬储閸楃偐鏀介柣鎰綑閻忋儳锟借娲﹂崜鐔奉嚕閹间焦鍋勯柟鑲╁仒缁ㄥ鏌ㄥ鍐剧吋鐎规洖鐖兼俊姝岊槻鐎殿喗濞婂缁樻媴閼恒儳銆婇梺闈╃秶缁犳捇鐛箛娑欐櫢闁跨噦鎷�?
	private boolean checkTeamInSwitchStatus(Team team)
	{
		//xbean.TeamInfo team = xtable.Team.get(teamId);
		if(team.getTeamInfo().getSwitchleaderid() == -1)
			return false;
		else if((now - team.getTeamInfo().getSwitchleadertime()) > TeamManager.MAX_INVITE_TIMEOUT )
		{
			team.getTeamInfo().setSwitchleaderid(-1);
			return false;
		}
		else
			return true;
	}
	
	//闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�哥粻鏍煕椤愶絾绀�缁炬儳娼￠弻鐔煎箚閻楀牜妫勭紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劙顣︾�涒晜绻濆▓鍨灍濠电偛锕濠氭晬閸曨亝鍕冮柣鐘叉处瑜板啯鎱ㄩ弴銏♀拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬磸閸ㄨ櫣绮嬮幒鏃撴嫹閿濆骸浜滈柛鎿冨弮濮婅櫣娑甸崨顔兼锭闂傚倸瀚�氫即骞冮垾鏂ユ闁靛骏绱曢崢閬嶆⒑閸濆嫭鍌ㄩ柛銊ユ惈閳藉顦归柡宀嬬秬缁犳盯濡疯閻﹀牓姊洪崫鍕効缂佽鲸娲樼粋鎺楁晝閸屾碍顥濋梺闈涚墕閻楀棝骞嗛崼鐔虹瘈婵炲牆鐏濋弸娑㈡煥閺囨ê锟芥繃淇婇崼鏇炵濞达絽鎽滈悾娲⒑闂堟稓绠為柛濠冩礈缁牓宕掗悙瀵稿幈闂婎偄娲﹂懝鐐鐟欏嫪绻嗙�瑰壊鍠曢柇顖涙叏婵犲嫮甯涢柟宄版噽缁瑧鎹勯妸锔诲晣闂傚倷鑳堕幊鎾诲吹閺嶎厼绠柨鐕傛嫹?
	private boolean checkAnwserIsNewLeader(Team team , long newLeaderId)
	{
		if(team.getTeamInfo().getSwitchleaderid() == newLeaderId)
			return true;
		else
			return false;
	}
	
	//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閵夆晜鐓熼柡鍥╁仜閿熻棄婀遍敓鑺ョ啲閹凤拷2闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣告贡閸庛倝宕甸敃锟介埥澶娢熼柨瀣澑闂佽鍑界紞鍡樼閻愪警鏁婇柛銉墯閳锋垿鎮峰▎蹇擃仼缂侊拷閸愨斂浜滈柡鍥ф閹虫劙鎯岄崱娑欑厱闁逛即娼ч弸鐔兼煟閹惧瓨绀冪紒缁樼洴楠炲鈹戦崱姘厴闂備礁鎼鍥窗閹剧粯鏅搁柤鎭掑労閸熷繘鏌涢悩鎰佹疁妤犵偞鍨垮畷鍫曨敆閿熶粙鎷戦悢鍏肩厽闁哄啫鍊搁惃鎴︽煙瀹勬澘妲婚柍钘夘槸閳诲秹顢樿缁ㄥジ鏌熸笟鍨鐎规洘鍎奸ˇ顕�鏌￠敓浠嬫嚍閵夛絼绨婚梺鍝勫暙閸婄懓鈻嶉弴鐔虹闁圭粯甯╅崵鐔兼煥閻旇袚妞ゆ梹鐗犲畷浼村冀椤撗勬櫔濡炪倖鎸堕崹娲疾閹间焦鐓犻柟顓熷笒閸斻倝鏌嶉崣銉х獢闁哄被鍔岄～婵堟崉閾忚鍟囬梻浣告惈椤︿即宕烘繝鍥╁彆妞ゆ帒鍋婇幏宄扳枔閸喗鐏堥梺缁樼墪閵堢鐣峰ú顏勭労闁告劏鏅涢鎾绘⒑閼姐倕鏋斿褎顨婇幃妯绘償閵忋垻鐦堥悗鐢靛閻忔岸宕愰妶澶婂惞閻庯綆鍓涚壕濂告煟濡寧鐝悘蹇ｅ幗閵囧嫰顢曢姀銏㈩啈闂侀潧娲﹂崝娆撶嵁閹烘绠ｉ柣娆欐嫹婵″弶妞藉缁樻媴閻熼偊鍤嬬紓浣割儐閸ㄥ綊鏁撻懞銉ュ毈闁告挾鍠栭悰顕�宕卞☉娆愭闂佽法鍣﹂幏锟�
	private boolean checkTeamNoSuccSwitchIn2min(Team team)
	{
		if((now - team.getTeamInfo().getSuccessswitchtime()) > TeamManager.MIN_SUCCESS_SWITCH_LEADER_PERIOD )
			return true;
		else
			return false;
	}
	
	
	
	
	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 794455;

	public int getType() {
		return 794455;
	}

	public byte agree; // 0 拒绝 1同意

	public CAnswerforSetLeader() {
	}

	public CAnswerforSetLeader(byte _agree_) {
		this.agree = _agree_;
	}

	public final boolean _validator_() {
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		_os_.marshal(agree);
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		agree = _os_.unmarshal_byte();
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CAnswerforSetLeader) {
			CAnswerforSetLeader _o_ = (CAnswerforSetLeader)_o1_;
			if (agree != _o_.agree) return false;
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		_h_ += (int)agree;
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append(agree).append(",");
		_sb_.append(")");
		return _sb_.toString();
	}

	public int compareTo(CAnswerforSetLeader _o_) {
		if (_o_ == this) return 0;
		int _c_ = 0;
		_c_ = agree - _o_.agree;
		if (0 != _c_) return _c_;
		return _c_;
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

