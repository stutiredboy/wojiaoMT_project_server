
package fire.pb.team.teammelon;

// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CTeamRollMelon__ extends mkio.Protocol { }

// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

public class CTeamRollMelon extends __CTeamRollMelon__ {
	@Override
	protected void process() {
		// protocol handle
		
		final long roleid = gnet.link.Onlines.getInstance().findRoleid(this);
		if (roleid < 0)
			return;
		mkdb.Procedure teamrollmelon = new mkdb.Procedure() 
		{
			@Override
			/*闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣洴钘濋柣銏㈩焾閸ㄥ倸螖閿濆懎鏆欑紒鐘崇☉闇夐柨婵嗘噺鐠愶紕绱掔�ｂ晞鍏岀紒杈ㄦ崌瀹曟帒顫濋濠冨闁绘垼濮ら崐鍧楁煥閺囩偛锟界敻鏁撻弬銈囩暤鐎规洖鐖奸崺锟犲礃瑜忛悷婵嗏攽鎺抽崐褏寰婃禒瀣柈妞ゆ牜鍋為崑鍌炴煏婢跺棙娅嗛柣鎾跺枛閺岋繝宕掑鍙樿檸濡炪倧绲炬繛濠囧蓟閿濆鏁囬柣鏃傚劋閸ｄ即姊洪崫鍕槵闁跨喕妫勭壕顓㈠汲閸℃稒鍊甸柨婵嗛婢т即鏌ｉ敃锟介悧鎾愁潖閻戞ɑ濮滈柟娈垮枛婵′粙姊虹憴鍕憙鐎规洜鏁搁崚鎺旓拷锝庡枛缁犳娊鏌￠崘鈺傚鞍閻庢艾缍婇弻銊モ攽閸℃侗锟芥霉濠婂嫮绠栫紒缁樼洴瀹曘劑顢欓崜褏鍘滄繝娈垮枛閿曘劌鈻嶉敐澶婄闁哄稁鍘奸崡鎶芥煟閹邦厾銈撮柟鏋�濆缁樻媴閸涘﹤鏆堝┑顔硷工濠�閬嶅极椤曪拷閹瑩鎮滃Ο鐑樼枀闂佸搫顦悧鍕礉鎼达絽濮柨鐔绘閳规垿顢欓弬銈勭返闂佸憡蓱閹倿鐛箛鎾佹椽顢旈崨顏呭闂備礁鎲＄粙鎴︽晝閿曞倸鐓″鑸靛姈閻撱儵鏌￠崶鏈电盎妞も晩鍓涚槐鎺楊敊绾拌京鍚嬪Δ鐘靛仦椤洨妲愰幒鎳崇喖鎮�涙ê顏堕梺鍓茬厛閸嬪懘宕ｈ箛鏂剧箚妞ゆ牗绮岀敮鍫曟偨椤栨氨鍩ｉ柡宀嬬磿閿熸枻绲婚崝宀勬晸閼恒儳绠炵�殿喛顕ч埥澶愬閳ュ厖姹楅梺鑽ゅТ濞壯囧礃瑜忛惌妤呮⒒閸屾瑦顦风紒槌栧枤缁辩偤宕堕埡鍌ゆ綗闂佸搫娲ㄦ慨鎾垂濠靛鐓曟い鎰Т閻忣噣鏌ｉ鐑嗘Ш缂佽鲸甯掗悾婵堬拷锝庡亜椤忥拷 by changhao*/
			protected boolean process()
			{	
				xbean.Properties roleprop = xtable.Properties.select(roleid);
				
				Long battlemelonid = xtable.Roleid2battlemelonid.select(roleid);
				if (battlemelonid == null)
				{
					psend(roleid, new fire.pb.team.STeamError(fire.pb.team.TeamError.SelfNotInTeam));
					fire.pb.team.TeamManager.logger.debug("CTeamRollMelon: "+roleid);
					return true;					
				}
				
				xbean.ETeamMelon eteammelon = xtable.Battlemelonid2melon.get(battlemelonid);
				if (eteammelon == null)
				{
					psend(roleid, new fire.pb.team.STeamError(fire.pb.team.TeamError.SelfNotInTeam));
					fire.pb.team.TeamManager.logger.debug("CTeamRollMelon:濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閹冣挃缂侇噮鍨抽幑銏犫槈閵忕姷顓洪梺缁樺姇閻忔岸宕宠缁辨挻鎷呯粙娆炬殺闂佺顑冮崐婵嗩嚕鐠囨祴妲堥柕蹇曞閵婏负浜滈柡鍐ㄥ�哥敮鑸点亜椤愮喐娅囩紒杈ㄦ尰缁楃喐绻濋崘顭戜紦闂傚倷绀佹竟濠囧磻閸℃稑绐楅柟鎹愭硾婵剟鏌ㄩ悢鍓佺煓婵﹤顭峰畷鎺戭潩閸楃儐鏉哥紓鍌欑椤戝棛鏁敓鐘叉瀬鐎广儱顦猾宥夋煕椤愩倕鏋旈柛姗�绠栧娲传閸曞灚歇濠电偛顦板ú妯肩矉閹烘顫呴柕鍫濇－濮婃寧绻濋姀锝呯厫闁告梹鐗犻幃锟犲Ψ閿斿墽鐦堥梻鍌氱墛缁嬫帡藟閻愮儤鐓曢柨婵嗘閵囨繈鏌熼鑲╃Ш妤犵偛娲畷婊勬媴閾忚顫屽┑鐘愁問閸犳牠鏁冮妶澶嗭拷锕�鐣￠幍顔芥闂佺粯姊婚埛鍫ュ极閸愵喗鐓忛煫鍥э攻濞呭啰绱掓潏銊︻棃婵﹦绮幏鍛村川婵犲啫鍓靛┑鐘灱濞夋稑煤椤撱垹鏋侀柟鍓х帛鐎电姴顭跨捄铏圭効缂佽京鍋ゅ娲传閸曨剦妫戦梺绋匡攻閻楃姵淇婇悽绋跨妞ゆ牗姘ㄩ惈鍕⒑缁嬫寧婀伴柤鍦亾缁傛帒顫滈敓钘夘潖閻戞ɑ濮滈柟娈垮枦缁愭绻涚�涙鐭ゅù婊庝簻椤曪絾绻濆顑┾晠鏌嶉崫鍕拷鍛婄濠婂牊鈷戦柛娑橈功缁犳捇鎮楀顒佸殗闁轰焦鍔栧鍕拷锝庡墮楠炴姊绘担绛嬫綈闁稿孩濞婇幃娲Ω瑜忛惌鍡涙煕閹板吀绨界痪鎹愬亹缁辨挻鎷呯拠锛勫姺濠电偞褰冮顓㈡晸閸婄噥娼愭繛鍙夌墪閻ｇ兘顢楅崘顏冭埅闂傚倸顭崑鍕归崟顓炵筏濠靛倸鎲￠悞鑺ャ亜閺嶎偄浠﹂柣鎾寸懄閵囧嫰寮敓浠嬪几婵犳碍鍤�闁秆勵殕閻撴瑦銇勯弮鍥舵綈婵炲懎娲ㄧ槐鎺撴綇閵娿儳鐟ㄩ柧浼欑秮閺岋綁骞橀幎绛嬶拷妤冪磼閻橀潧浠辨慨濠傤煼瀹曟帒鈻庨幋鐘靛床婵犵數鍋橀崠鐘诲炊閿濆繑瀚归柨鏇炲�搁柋鍥煏婢跺牆鍔ら柨娑氬枛濮婂搫效閸パ呬紕濡炪値鍘奸悧鎾诲箚鐏炶娇鏃堝川椤旀儳骞堥梻浣告惈濞层垽宕濆畝鍕�堕柨鐔哄У閻撶喖鏌熼幆褜鍤熼柕鍡樺浮閺屻劑鎮㈤悜妯荤彧濠电偛鎳岄崹浠嬬嵁韫囨稒鍊婚柤鎭掑劚閿熺晫鏁婚弻銊モ攽閸℃侗锟芥霉濠婂嫮鐭嬮柕鍥у缁犳盯濡烽敃锟介锟�?"+roleid);
					return true;					
				}
				
				xbean.TeamMelon teammelon = eteammelon.getMelonid2melons().get(melonid);
				if (teammelon == null)
				{
					psend(roleid, new fire.pb.team.STeamError(fire.pb.team.TeamError.SelfNotInTeam));
					fire.pb.team.TeamManager.logger.debug("CTeamRollMelon:濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閹冣挃缂侇噮鍨抽幑銏犫槈閵忕姷顓洪梺缁樺姇閻忔岸宕宠缁辨挻鎷呯粙娆炬殺闂佺顑冮崐婵嗩嚕鐠囨祴妲堥柕蹇曞閵婏负浜滈柡鍐ㄥ�哥敮鑸点亜椤愮喐娅囩紒杈ㄦ尰缁楃喐绻濋崘顭戜紦闂傚倷绀佹竟濠囧磻閸℃稑绐楅柟鎹愭硾婵剟鏌ㄩ悢鍓佺煓婵﹤顭峰畷鎺戭潩閸楃儐鏉哥紓鍌欑椤戝棛鏁敓鐘叉瀬鐎广儱顦猾宥夋煕椤愩倕鏋旈柛姗�绠栧娲传閸曞灚歇濠电偛顦板ú妯肩矉閹烘顫呴柕鍫濇－濮婃寧绻濋姀锝呯厫闁告梹鐗犻幃锟犲Ψ閿斿墽鐦堥梻鍌氱墛缁嬫帡藟閻愮儤鐓曢柨婵嗘閵囨繈鏌熼鑲╃Ш妤犵偛娲畷婊勬媴閾忚顫屽┑鐘愁問閸犳牠鏁冮妶澶嗭拷锕�鐣￠幍顔芥闂佺粯姊婚埛鍫ュ极閸愵喗鐓忛煫鍥э攻濞呭啰绱掓潏銊︻棃婵﹦绮幏鍛村川婵犲啫鍓靛┑鐘灱濞夋稑煤椤撱垹鏋侀柟鍓х帛鐎电姴顭跨捄铏圭効缂佽京鍋ゅ娲传閸曨剦妫戦梺绋匡攻閻楃姵淇婇悽绋跨妞ゆ牗姘ㄩ惈鍕⒑缁嬫寧婀伴柤鍦亾缁傛帒顫滈敓钘夘潖閻戞ɑ濮滈柟娈垮枦缁愭绻涚�涙鐭ゅù婊庝簻椤曪絾绻濆顑┾晠鏌嶉崫鍕拷鍛婄濠婂牊鈷戦柛娑橈功缁犳捇鎮楀顒佸殗闁轰焦鍔栧鍕拷锝庡墮楠炴姊绘担绛嬫綈闁稿孩濞婇幃娲Ω瑜忛惌鍡涙煕閹板吀绨界痪鎹愬亹缁辨挻鎷呯拠锛勫姺濠电偞褰冮顓㈡晸閸婄噥娼愭繛鍙夌墪閻ｇ兘顢楅崘顏冭埅闂傚倸顭崑鍕归崟顓炵筏濠靛倸鎲￠悞鑺ャ亜閺嶎偄浠﹂柣鎾寸懄閵囧嫰寮敓浠嬪几婵犳碍鍤�闁秆勵殕閻撴瑦銇勯弮鍥舵綈婵炲懎娲ㄧ槐鎺撴綇閵娿儳鐟ㄩ柧浼欑秮閺岋綁骞橀幎绛嬶拷妤冪磼閻橀潧浠辨慨濠傤煼瀹曟帒鈻庨幋鐘靛床婵犵數鍋橀崠鐘诲炊閿濆繑瀚归柨鏇炲�搁柋鍥煏婢跺牆鍔ら柨娑氬枛濮婂搫效閸パ呬紕濡炪値鍘奸悧鎾诲箚鐏炶娇鏃堝川椤旀儳骞堥梻浣告惈濞层垽宕濆畝鍕�堕柨鐔哄У閻撶喖鏌熼幆褜鍤熼柕鍡樺浮閺屻劑鎮㈤悜妯荤彧濠电偛鎳岄崹浠嬬嵁韫囨稒鍊婚柤鎭掑劚閿熺晫鏁婚弻銊モ攽閸℃侗锟芥霉濠婂嫮鐭嬮柕鍥у缁犳盯濡烽敃锟介锟�?"+roleid);
					return true;					
				}
				
				//濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊閻樺樊妫岄梺杞扮閿曨亪寮婚垾鎰佸悑閹肩补锟藉磭顔愮紓鍌欑劍閸旀牠銆冮崱妯尖攳濠电姴娲ゅ洿闂佸憡渚楅崢钘夆枔閸撲胶纾藉ù锝囨嚀閺佸墽绱掗悩铏磳鐎殿喛顕ч埥澶婎煥鎼粹懣顏呬繆閻愵亜锟芥垿宕濆畝鍕疇闁归偊鍘鹃悵鍫曟煛閸ゅ爼顣﹀Ч妤呮⒑閸︻厼鍔嬮柟鎼佺畺瀹曘垽鎮介崨濞炬嫼缂傚倷鐒﹂敋濠殿噯绠撻弻娑㈠箻鐎靛憡鍣伴柦妯煎枛閺岋綁骞囬鍌欑驳闂佸摜濮甸崝娆撶嵁閺嶎偄鍨濋悷娆忓濞兼垿姊洪幖鐐诧拷鏍�冩繝鍥ц摕婵炴垯鍨归崡鎶芥煏婵炲灝鍔氭い顐亞缁辨挻鎷呴崫鍕ㄦ瀰缂備胶濮甸悧鐘差嚕婵犳碍鏅插璺猴功閻わ拷闂傚倸鍊搁悧濠勭矙閹达讣缍栨い鎰堕檮閳锋垿鏌涘☉姗堝姛闁瑰啿鍟撮弻娑㈡偄閸涘﹦绋囧銈庡亜缁绘帞妲愰幒鎳崇喓鎷犲顕嗘嫹閹剧粯鐓熼柣鏂挎憸閹冲啴鎮楀鐓庢灍閻庨潧銈稿畷鍫曨敆娴ｅ弶瀚奸梻浣告啞缁诲倻锟芥凹鍙冨畷鍐裁洪鍛幗闂佸啿鎼敃銈夋倶閻樼粯鐓熼柨婵嗘搐閸樺瓨銇勯姀锛勬创闁诡喗绮撳畷鍗炍熺紒妯煎建婵犵數濮烽弫鍛婃叏閹绢喗鏅濋柕鍫濐槸缁犵姷锟藉箍鍎卞ú銊х不閺傛鐔嗛柤鎼佹涧婵牓鏌嶉柨瀣伌闁哄本鐩弫鍌滄嫚閹绘帞顔愰梻浣告啞閺屻劑顢栭崱娑樜﹂柛鏇ㄥ灠鎯熼梺闈涱檧鐎靛苯螞閿曞倹鍊甸悷娆忓缁�鍐煕閵娿儲鍋ョ�殿噮鍋婇獮鍥级鐠恒劌锟界偤姊洪棃娑辩劸闁稿孩鐓￠幃妤併偅閸愨晝鍘介柟鑹版彧缁辨洟鎮鹃銏＄厱閹肩补锟藉疇鍩為梻鍥ь樀閺屾盯寮撮妸銉т哗缂備胶濯崹鎶芥晸閻ｅ本鍤�閻庢矮鍗冲畷鎴炵節閸屻倗鍔烽梺鍐叉惈閹冲繘鎮￠悢鍏肩厵闁绘劦鍓欓埢鏇熴亜鎼淬埄娈樼紒杈ㄥ浮椤㈡洟濮�閳跺灕鍕弿濠电姴鎳忛鐘绘煙妞嬪骸鈻堥柛銊╃畺閹煎綊顢曢敐搴℃暢闂傚倸鍊风粈渚�骞夐埄鍐懝婵°倕鎳庨崹鍌炴煙閸撲焦娅曠�规挷绶氶弻鐔煎箚瑜嶉。宕囩棯閹规劖顥夐柕鍡樺笒椤繈顢楁担瑙勫�峰┑鐐茬摠缁秶鎹㈤崟顖氱疅闁归棿绀佺痪褔鏌熺粙鍨劉闁稿骸閰ｅ濠氬磼濮橆剨鎷烽幖浣哥９闁归棿绀佺壕褰掓煙闂傚顦︾痪鎯ф贡閿熺晫鎳撶�氫即宕戞繝鍌橈拷鎺撶節濮橆厾鍘甸梺缁樺灦钃遍柍閿嬪姈閵囧嫰顢曢敐鍡欘槰闂侀潧娲ょ�氭澘顕ｉ幘顕呮晜闁告侗鍙庢导鎾斥攽鎺抽崐妤佹叏閻戣棄纾绘繛鎴炵瀹曞弶鎱ㄥΔ瀣閻庢鍣崑濠囩嵁濡偐纾兼俊顖滅帛椤忕喖姊绘担鑺ョ《闁革綇绠撻獮蹇涙晸閿燂拷? by changhao
				Integer rollpoint = teammelon.getMelonroleids().get(roleid);
				if (rollpoint == null)
				{
					psend(roleid, new fire.pb.team.STeamError(fire.pb.team.TeamError.SelfNotInTeam));
					fire.pb.team.TeamManager.logger.debug("CTeamRollMelon:濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閹冣挃缂侇噮鍨抽幑銏犫槈閵忕姷顓洪梺缁樺姇閻忔岸宕宠缁辨挻鎷呯粙娆炬殺闂佺顑冮崐婵嗩嚕鐠囨祴妲堥柕蹇曞閵婏负浜滈柡鍐ㄥ�哥敮鑸点亜椤愮喐娅囩紒杈ㄦ尰缁楃喐绻濋崘顭戜紦闂傚倷绀佹竟濠囧磻閸℃稑绐楅柟鎹愭硾婵剟鏌ㄩ悢鍓佺煓婵﹤顭峰畷鎺戭潩閸楃儐鏉哥紓鍌欑椤戝棛鏁敓鐘叉瀬鐎广儱顦猾宥夋煕椤愩倕鏋旈柛姗�绠栧娲传閸曞灚歇濠电偛顦板ú妯肩矉閹烘顫呴柕鍫濇－濮婃寧绻濋姀锝呯厫闁告梹鐗犻幃锟犲Ψ閿斿墽鐦堥梻鍌氱墛缁嬫帡藟閻愮儤鐓曢柨婵嗘閵囨繈鏌熼鑲╃Ш妤犵偛娲畷婊勬媴閾忚顫屽┑鐘愁問閸犳牠鏁冮妶澶嗭拷锕�鐣￠幍顔芥闂佺粯姊婚埛鍫ュ极閸愵喗鐓忛煫鍥э攻濞呭啰绱掓潏銊︻棃婵﹦绮幏鍛村川婵犲啫鍓靛┑鐘灱濞夋稑煤椤撱垹鏋侀柟鍓х帛鐎电姴顭跨捄铏圭効缂佽京鍋ゅ娲传閸曨剦妫戦梺绋匡攻閻楃姵淇婇悽绋跨妞ゆ牗姘ㄩ惈鍕⒑缁嬫寧婀伴柤鍦亾缁傛帒顫滈敓钘夘潖閻戞ɑ濮滈柟娈垮枦缁愭绻涚�涙鐭ゅù婊庝簻椤曪絾绻濆顑┾晠鏌嶉崫鍕拷鍛婄濠婂牊鈷戦柛娑橈功缁犳捇鎮楀顒佸殗闁轰焦鍔栧鍕拷锝庡墮楠炴姊绘担绛嬫綈闁稿孩濞婇幃娲Ω瑜忛惌鍡涙煕閹板吀绨界痪鎹愬亹缁辨挻鎷呯拠锛勫姺濠电偞褰冮顓㈡晸閸婄噥娼愭繛鍙夌墪閻ｇ兘顢楅崘顏冭埅闂傚倸顭崑鍕归崟顓炵筏濠靛倸鎲￠悞鑺ャ亜閺嶎偄浠﹂柣鎾寸懄閵囧嫰寮敓浠嬪几婵犳碍鍤�闁秆勵殕閻撴瑦銇勯弮鍥舵綈婵炲懎娲ㄧ槐鎺撴綇閵娿儳鐟ㄩ柧浼欑秮閺岋綁骞橀幎绛嬶拷妤冪磼閻橀潧浠辨慨濠傤煼瀹曟帒鈻庨幋鐘靛床婵犵數鍋橀崠鐘诲炊閿濆繑瀚归柨鏇炲�搁柋鍥煏婢跺牆鍔ら柨娑氬枛濮婂搫效閸パ呬紕濡炪値鍘奸悧鎾诲箚鐏炶娇鏃堝川椤旀儳骞堥梻浣告惈濞层垽宕濆畝鍕�堕柨鐔哄У閻撶喖鏌熼幆褜鍤熼柕鍡樺浮閺屻劑鎮㈤悜妯荤彧濠电偛鎳岄崹浠嬬嵁韫囨稒鍊婚柤鎭掑劚閿熺晫鏁婚弻銊モ攽閸℃侗锟芥霉濠婂嫮鐭嬮柕鍥у缁犳盯濡烽敃锟介锟�?"+roleid);
					return true;	
				}
				
				Integer alreadroll = teammelon.getOpmelonroleids().get(roleid);
				if (alreadroll != null)
				{
					fire.pb.team.TeamManager.logger.debug("CTeamRollMelon:闂傚倸鍊搁崐鎼佸磹閹间礁纾圭�瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟偡濠婂啰效闁挎繄鍋涢埞鎴狅拷锝庡亝濞呭洭姊虹粙璺ㄧ効濠碘�虫川缁瑨绠涢弮鍌滅槇闂侀潧楠忕徊浠嬫偂閹扮増鐓曢柡鍐挎嫹闁绘濮撮悾鐑藉箣閿曪拷鍥存繝銏ｆ硾椤戝洭宕㈤幖浣光拺闁硅偐鍋涢崝妤呮煛閸涱喚鈽夐柣顭戝墴濮婄粯鎷呴搹鐟扮闁汇埄鍨辩敮锟犲极閸愵喖唯鐟滃骸鐣烽崣澶岀闁瑰瓨鐟ラ悘鈺傤殽閻愵亜鐏ǎ鍥э躬椤㈡稑鈹戦崶鏈靛摋濠电偛顕慨鐢稿箰閸愬樊娼栨繛宸簻缁犲綊鏌ｉ幇顓炵祷妞ゎ剙顦辩槐鎾存媴缁涘娈梺鍝ュ枎閻°劍绌辨繝鍥ㄥ仺缂佸娉曢ˇ鏉款渻閵堝棛澧慨妯稿姂瀹曟繈骞橀瑙ｆ嫼闂佸憡绋戦敃銈嗘叏瑜忕槐鎺楁偐閸愯尙浠哥紓浣稿�圭敮锟犲灳閺冨牆绠ラ柨鐔哄У閳锋帡鏌涚仦鎹愬闁跨喕濮ら幃鍌氱暦閹邦収妲归幖杈剧悼閻掑吋绻涢幘瀵稿暡闁圭兘鏀遍〃銉╂倷鐎电鈷屽銈冨灪濞叉垹绱為崨瀛樼厱闁靛鍠栨晶濠氭煛娴ｇ鏆ｉ柡灞诲姂瀵挳顢旈崨顓т紦闂傚倷鐒﹂惇褰掑磹濡ゅ懎纾婚柟鎹愬煐瀹曞弶绻涢幋娆忕仼缂佺媴缍侀弻锝夊箛閵婏附鐝曢梺鎸庣☉閻楀棝鍩為幋锔藉�烽柛娆忣槴閺嬫瑦绻涚�涙鐭嬬紒璇茬墕椤曪綁寮婚妷銉ㄦ憰闂侀潧顧�婵″洭宕㈤柆宥嗏拺闂傚牊渚楀Ο鍫ユ煕閻樿櫕绀堥柤娲憾閹筹繝濡堕崟顓炲⒕闂傚鍋勫ú锔剧矙閹烘鐓曢柟鐑樺殮瑜版帗鏅查柛顐ｇ渤閹惧墎妫い鎾跺仧閸╋綁鏌＄仦鍓ф创闁轰焦鍔樼粻娑㈠即閻樿櫕顔撳┑掳鍊楁慨鐑藉磻濞戞碍宕叉慨妤嬫嫹鐎殿噮鍋婇獮妯肩磼濡粯顏熼梻浣芥硶閸ｏ箓骞忛敓锟�"+roleid);
					return true;
				}
				
				if (status == 0) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閳╁啯鐝栭梻浣芥硶閸犳捇寮查锔芥櫢闁兼亽鍎存竟妯汇亜閿斿灝宓嗗┑锛勬暬瀹曠喖顢涘槌栧敽闂備胶鎳撻悺銊ф崲瀹ュ棛顩烽柤娴嬫櫇绾捐棄銆掑顒婃敾閻庢俺顫夌换婵嬪閿濆懐鍘梺鍛婃⒐閻楃娀骞冮垾鏂ユ瀻闁规儳顕崢浠嬫⒑閻熼偊鍤熷ù鍏肩箞椤㈡棃宕熼幋鐐叉诞鐎规洜鍠栭、姗�鎮㈤柨瀣拷楣冩⒑绾懎浜归悶娑栧劚鍗遍柛娑欐綑閸氳淇婇妶鍛櫤闁绘挻娲熼弻锟犲炊閵夈儱顬堥悗娈垮枛濞硷繝寮婚悢鍓叉Ч閹肩补锟藉啿绠ｉ梻浣芥〃閻掞箓宕濆▎蹇曟殾闁圭儤鍨熷Σ鍫熺箾閸℃ê鐏ョ紒鑼舵硶缁辨捇宕掑顒婃嫹閻戣姤鍤勯柤绋跨仛閸欏繘姊婚崼鐔恒�掗柡鍡楁缁辨帞锟斤綆鍋掗崕銉︾箾閸忚偐澧甸柡灞熷棛鐤�闁瑰墽顥愮涵锟介梻浣规た閸樹粙鎮烽埡鍛摕闁绘棁娅ｉ惌娆撴煕椤垵娅橀柛鏂款樀濮婃椽宕烽鐔哄姽婵炲瓨绮犻崜娑樜ｉ幇鏉跨閻庢稒锚椤庢捇姊洪崨濠冨鞍鐟滄澘鍟村畷婊堟焼瀹ュ棌鎷洪柣鐔哥懃鐎氼噣骞楅崘顏庢嫹鐟欏嫭绀堥柡浣规倐瀹曟岸骞掗弮鎾村闁挎繂绨奸幉楣冩煕濮橆剦鍎忔い顓炴健閹虫粓鎯夐鍛伌鐎殿喗鐓￠、妤呭礋椤戣姤瀚肩紓鍌氬�烽悞锕傛晪婵犳鍠栧ú锕傚Φ閸曨垰鍗抽柕濞垮劚缁秹鎮楃憴鍕８闁搞劋绮欓悰顕�寮介妸锕�顎撻梺绋跨箰椤︽壆锟芥艾銈稿娲嚒閵堝憛锝吤瑰锟界划娆忕暦濠靛棛鏆嗛柛鏇ㄥ亜閸ゆ垿鎮楅獮鍨姎婵炲眰鍔庢竟鏇㈠礂缁楄桨绨婚梺鍝勫暙閸婄懓鈻嶉弴銏＄厵闁告劕寮堕崰姗�鏌″畝瀣埌闁宠棄顦靛畷锟犳倷鐎电缍嗛梺璇叉唉椤煤閺嵮呮殾妞ゆ帒瀚哥紞鏍ㄧ節闂堟侗鍎忕紒锟介崒姘肩唵闁诡垶鍋婇崵鍐煕閹惧銆掓俊鍙夊姍楠炴锟芥稒锚椤庢挾绱撴担鍓插剰缂併劑浜堕獮鎰板礃椤旇В鎷虹紓浣割儐椤戞瑩宕曢幇鐗堢厵闁荤喓澧楅幖鎰版煟閿濆洤鍘寸�殿喗鎸虫慨锟介柣妯活問閸炴挳姊绘担绋挎倯濞存粈绮欏畷鏇㈠箮閼恒儱浠奸梺瑙勫劶婵倝鍩涢幒妤佺厱閻忕偛澧介幊鍕磼娴ｅ搫顣肩紒缁樼♁瀵板嫮锟斤綆鍋嗛ˇ浼存倵鐟欏嫭绀冨┑鐐诧躬瀵偊宕橀鑲╋紲濠殿喗锕㈢涵鎼佸船閻㈠憡鈷掑ù锝堝Г绾爼鏌涢敐蹇曠暤妤犵偛绻橀弫鎾绘晸閿燂拷? by changhao
				{					
					teammelon.getMelonroleids().put(roleid, 0);
				}
				
				int num = teammelon.getOpnum();
				num ++;
				teammelon.setOpnum(num);
				
				teammelon.getOpmelonroleids().put(roleid, teammelon.getMelonroleids().get(roleid));
				
				fire.pb.team.teammelon.SOneTeamRollMelonInfo msg = new fire.pb.team.teammelon.SOneTeamRollMelonInfo();
				msg.itemid = teammelon.getItemid();
				msg.melonid = melonid;
				msg.rollinfo.roleid = roleid;
				msg.rollinfo.rolename = roleprop.getRolename();
				msg.rollinfo.roll = teammelon.getMelonroleids().get(roleid);
				
				for (Long e : eteammelon.getMelonerlist()) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣洴钘濋柣銏㈩焾閺嬩線鏌熼崜褏甯涢柛瀣姍閺屾盯骞囬姘卞闂佹眹鍨归…宄邦潖缂佹ɑ濯撮柣鐔煎亰閸ゅ鈹戦悙鎻掔骇闁绘濮撮悾鐑藉箛閺夎法顔愭繛杈剧悼椤牓鎮楅銏♀拺缂佸娉曢悘閬嶆煕鐎ｎ剙浠遍柟顕嗙節瀵挳濮�閿涘嫬寮抽梻浣告惈閸燁偄霉閸岀偛鍚规繛鍡樺姦濞堜粙鏌ｉ幇顒夊殶濠⒀呮暬閺岋紕浠﹂崜褎鍒涙繝纰樺墲閹倿寮崒鐐茬鐟滃繘寮抽妶澶嬧拻闁稿本纰嶉幖鎰亜閿旂偓鏆�殿喛顕ч埥澶婎煥閸涱垱婢戦梻浣筋潐瀹曟ê鈻嶉弴銏犵９妞ゆ牗绮庣壕浠嬫煕鐏炵偓鐨戦弽锟犳⒑閹肩偛濡兼繝锟介崡鐐嶏綁骞囬弶璺唺濠德板�撶粈浣圭婵傚憡鈷戦柛娑橈梗缁堕亶鏌涢悩宕囧⒌妞ゃ垺妫冮弫鎾绘晸閿燂拷?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閳╁啯鐝曢梻浣藉Г閿氭い锔诲枤缁辨棃寮撮姀鈾�鎷绘繛杈剧秬濞咃綁濡存繝鍥ㄧ厱闁规儳顕粻鐐烘煙閽樺锟藉鏁撻弬銈囩У闁哥姵鐗犻幃娆愮節閸愶缚绨婚梺鐟版惈缁夊墎鎷归悧鍫滅箚妞ゆ劑鍨归弳娆撴煃鐟欏嫬鐏撮柟顔界懃椤斿繘顢欓崗纰卞晙濠碉紕鍋戦崐鏍暜閻旇桨鐒婃繛鍡樺灦椤洟鏌ｉ幇顒夊殶闁荤喎缍婇弻銊╂偄缂佹﹩妫勫銈嗘穿缂嶄線銆侀弴銏℃櫇闁跨喓鏅划鍫ュ礃閳瑰じ绨婚梺鍝勫暙濞层倖绂嶈ぐ鎺撶叆婵炴垶鐟ч惌濠囨煃鐟欏嫬鐏存い銏＄懇瀵剟濡堕崟顓＄箲闂傚倷绀侀幉锟犲箰婵犳碍鍎庢い鏍仜缁犳牕霉閸忓吋缍戦柣鎾寸洴閺屾稓浠﹂崜褏鐓傞梺浼欑畱閻楀繒妲愰幒妤�绀堢憸宥夈�傛總鍛婂珔閺夊牄鍔婃禍婊勩亜閹板灚绶涢棅顒夊墴閺岋紕浠﹂崜褎鍒涙繝纰樺墲閹倹淇婇悿顖ｆ缂備浇浜崑銈咁潖濞差亜宸濆┑鐘插�婚悷鏌ユ煟閵忊晛鐏茬紒缁樼箞婵″瓨鎷呯化鏇燁潔濠碘槅鍨堕弨閬嶏綖瀹ュ應鏀芥い鏃傜叓椤忓牆瑙﹂悗锝庡墰閻牊銇勯幇鍓佹偧缂佲槄鎷风紓浣稿⒔婢ф鎽銈庡亜閿曨亪寮诲☉銏犖╃憸搴ㄥ汲椤掑偊鎷风憴鍕闁搞劌娼￠悰顕�宕堕澶嬫櫓缂佺偓濯芥ご鎼佀夐敓鐘斥拻濞达綀妫勮闂佹寧纰嶉妵鍕Ψ閿濆懐浼囬梺闈涙处閸旀瑩鐛幒妤�绠婚悗娑欘焽瑜版悂姊婚崒娆戭槮闁规祴鍓濈粭鐔肺旈崨顓犵崶濠德板�曢幊搴ｇ玻濡ゅ懏鐓欓梺顓ㄧ畱楠炴绱掗埥鍛闂傚倷绀侀崯鍧楀吹閺嶎厼绠�瑰嫭鍣磋ぐ鎺撴櫜闁告侗鍠楅崰鎰箾鐎电孝濠⒀呮櫕濡叉劙骞樼�涙ê顎撻梺鎯х箳閹虫挾绮敓鐘斥拺闁绘垟鏅滃▍鎾绘煕閵娿倕宓嗛柟顕�绠栭弻銊э拷锝庡墴濡绢噣姊洪崨濠勨槈闁挎洏鍊栫粋宥咁煥閸曨亞绠氶梺缁樺姇濡﹪宕曡箛鏇犵＜闁靛ě鍐ㄤ粯濡炪倐鏅涢妶鎼佺嵁濡》鎷烽棃娑欐喐闁伙箑鐗撳鍝勑ч崶褏浼堝┑鐐板尃閸曨収娴勯梺瀹犳〃缁讹繝鎮㈤崱娑欑厽闁绘梻顭堥ˉ瀣熆瑜濋梽鍕Φ閸曨垰顫呴柍銉ㄥ紦鐎涒晛顪冮妶蹇曠暠缂傚秴锕璇测槈閵忕姷鍘撮梺鍓茬厛閸犳碍绂掓ィ鍐┾拺閻犲洠锟藉磭浠┑鈽嗗亜閸燁垶骞堥妸鈺傛櫢濞寸姴顑嗛悡鍐煏婢跺牆鍔氶柡鍡楀船閳规垿鍩勯崘銊㈡灆濠殿喖锕︾划顖滅箔閻斿吋鏅搁柦妯侯樈閻掔晫鎲搁弮鍫濈伋闁挎洖鍊搁柋鍥煏婢跺牆鍔ら柨娑氬枛濮婃椽宕崟顕呮蕉闂佺瀛╅悡鈥崇暦閹达富鏁傞柛顐ゅ枔閸橀亶鏌ｈ箛鏇炰沪闁稿孩濞婇幃鐐躲亹閹烘挾鍘搁梺璺ㄥ枙婵倗绮嬮幒鏃撴嫹閿濆骸浜為柛妯圭矙濮婇缚銇愰幒鎴滃枈闂佹悶鍔嬮崡鎶藉箚閸愵煁娲敂閸涱垰骞嶉梻浣风串缁蹭粙鎳熼姘瘎缂傚倸鍊峰ù鍥ㄣ仈閸濄儲鏆滈柨鐔哄О閿熸垝绀侀埢搴ㄥ箛椤曪拷濡绢喚绱撴担鍓插剰闁诲繑绻堝畷锝嗙節閸ャ劉鎷绘繛杈剧悼閻℃棃宕甸崘顔界厱闁靛鍊曞畵鍡欙拷瑙勬礃閸旀瑥鐣烽悜绛嬫晣闁绘鏁搁弳銉╂⒒娴ｈ櫣甯涢柡灞诲姂楠炴牠顢曢妶鍡╁仺闂侀潧鐗嗛ˇ浼存偂閺囩媴鎷烽獮鍨姎闁瑰嘲顑呰灒闁跨喕妫勯埞鎴︻敊绾嘲浼愬銈庡幖閸㈡煡鎮鹃悜钘夌闁瑰瓨姊归悗濠氭⒑閸︻厼鍔嬮柛銊ф暩閺侇噣顢涘鍛紳闂佺鏈悷褏鎷规导瀛樼厱闁挎繂楠稿▍宥囷拷瑙勬礀濠�閬嶅箲閸曨垱鎯為悷娆忓椤旀洘绻濋悽闈涒枅婵炰匠鍏炬盯顢橀悜鍡欏姺闂侀潧艌閺呮粓鎮￠妷鈺傜厽闁哄倸鐏濋。鎶芥煟椤撶喓鎳囬柡灞稿墲閹峰懘鎮烽弶娆炬綒闂備浇顕栭崰妤呮偡閳轰緡鍤曢柛顐ｆ礀缁狅綁鏌ｅΟ鍏兼毄鐎规挷绶氬濠氬磼濞嗘埈妲紓鍌氱Т閿曨亜鐣烽幋鐐电瘈闁搞儜鍜佹Ф婵犵數鍋為崹顖炲垂濞差亜鐤炬い鎺戝閻撶喖鏌￠崒姘变虎闁诡喗鍨堕妵鍕Ψ閵夘垱鏁鹃梺闈涙搐鐎氫即鐛崶顒�鐓涘ù锝堟〃閻ヮ亜鈹戦悩顔肩伇婵炲绋撻敓鑺ュ嚬閸犳艾危閹版澘绠抽柡鍐╂尰鐎氬綊鏌ㄥ┑鍡涱�楀ù婊勭矒閺岋綀绠涙繝鍐╃彇缂備浇椴哥敮锟犮�佸▎鎾村殐闁宠桨璁查崣娲⒒娴ｈ姤銆冮柣鎺炵畵楠炴垿宕堕锟介弸渚�鏌熼崜褏甯涢柡鍛倐閺屻劑鎮ら崒娑橆伓? by changhao
				{
					//TeamManager.logger.info("roll闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氫即宕戞繝鍌橈拷鎺撶節濮橆厾鍘甸梺缁樺灦钃遍柍閿嬪姈閵囧嫰顢曢敐鍡欘槰闂侀潧娲ょ�氭澘顕ｉ幘顕呮晜闁告侗鍙庢导鎾斥攽鎺抽崐妤佹叏閻戣棄纾绘繛鎴炵瀹曞弶鎱ㄥΔ瀣閻庢鍣崑濠囩嵁濡偐纾兼俊顖滅帛椤忕喖姊绘担鑺ョ《闁革綇绠撻獮蹇涙晸閿燂拷?:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣洴钘濋柣銏㈩焾閺嬩線鏌熼崜褏甯涢柛瀣姍閺屾盯骞囬姘卞闂佹眹鍨归…宄邦潖缂佹ɑ濯撮柣鐔煎亰閸ゅ鈹戦悙鎻掔骇闁绘濮撮悾鐑藉箛閺夎法顔愭繛杈剧悼椤牓鎮楅銏♀拺缂佸娉曢悘閬嶆煕鐎ｎ剙浠遍柟顕嗙節婵＄兘鍩￠崒婊冨箺闂備礁鎼ú銊╁磻濞戙垺鏅搁柦妯侯槹鐠愶繝鏌ㄩ悢璇残撻柣鏃戝墴楠炲繘鏁撻敓锟�?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝呂熷▎鎯ф缂備胶濮撮悘姘跺Φ閸曨喚鐤�闁圭偓鎯屽Λ銈囩磽娓氬﹥瀚规繝鐢靛Т濞诧箓鎮￠妷鈺傜厽闁哄啫娴傞崵娆戞偖濮樿京纾藉ù锝堟鐢盯鏌ｉ埡濠傜仩闁伙絿鍏橀、鏃堝醇濠靛牜妲版俊鐐�曠换鎰板蓟婵犲偆鐓ラ柛顐ゅ暱閹疯櫣绱掔紒銏犲箹闁瑰啿绻橀幃鐢割敂閸℃瑧锛滃銈嗘煥閸氬骞戦敐澶嬬厱闁圭儤鎸稿ù顔撅拷娈垮櫘閸撴瑩鍩㈡惔銊﹀�锋い鎺戝�婚埢澶愭⒒閸屾瑨鍏岀紒顕呭灦閹囧即閻戝棛鍔烽梺纭呭煐缁旓拷:" + e + "闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴楠炴﹢鎳犻澶嬓滈梻浣规偠閸斿秶鎹㈤崘顔嘉﹂柛鏇ㄥ灠閸愶拷濡炪倖鍔﹀锟界紒顔煎缁辨挻绗熸繝鍐伓濠电姰鍨煎▔娑㈩敄閸℃稑鐭楅煫鍥ㄦ煣缁诲棝鏌曢崼婵囧闁稿孩鍔欓幃妤�顫濋鍌溞ㄥ┑顔硷攻濡炰粙鐛幇顓熷劅闁挎繂娲ㄩ弳顓㈡⒒娴ｄ警鐒炬い鎴濇喘瀹曟垵鈽夐姀鈺傛櫔闂侀潧顦弲娑氱矆鐎ｎ偁浜滈柡宥冨妽閻ㄦ垿鏌ｉ妶蹇斿婵犵绱曢崑鎴﹀磹閺嶎偅鏆滃┑鐘蹭紖瑜版帒鐐婇柍鍝勫亞閸嬨劑姊洪棃娑氱疄闁稿﹥鐗犻崺娑㈠箳閹炽劌缍婇弫鎰板醇濠㈩剚鎸鹃惀顏堫敇閻愰潧鐓熼梺鍝勬湰閻╊垶寮幇顖滅杸闁哄洨濮靛▓鍏间繆閵堝洤啸闁稿绋撻幑銏狀潨閿熻棄顕ｉ锕�绠荤紓浣股戝▍銏ゆ⒑鐠恒劌娅愰柟鍑ゆ嫹:" + msg.rollinfo.roll);
					mkdb.Procedure.psendWhileCommit(e, msg);			
				}
				
				for (Long e : eteammelon.getWatchmelonerlist()) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣洴钘濋柣銏㈩焾閺嬩線鏌熼崜褏甯涢柛瀣姍閺屾盯骞囬姘卞闂佹眹鍨归…宄邦潖缂佹ɑ濯撮柣鐔煎亰閸ゅ鈹戦悙鎻掔骇闁绘濮撮悾鐑藉箛閺夎法顔愭繛杈剧悼椤牓鎮楅銏♀拺缂佸娉曢悘閬嶆煕鐎ｎ剙浠遍柟顕嗙節瀵挳濮�閿涘嫬寮抽梻浣告惈閸燁偄霉閸岀偛鍚规繛鍡樺姦濞堜粙鏌ｉ幇顒夊殶濠⒀呮暬閺岋紕浠﹂崜褎鍒涙繝纰樺墲閹倿寮崒鐐茬鐟滃繘寮舵禒瀣拻濞达絽鎲￠幆鍫ユ煟椤掞拷閵堢鐣烽悧鍫熷劅闁靛鍎抽崢娲⒑鐟欏嫬绀冩い鏇嗗洤鍨傞柛灞剧◤娴滄粓鏌￠崘銊ワ拷鐟扳枍閺囩伝鐟邦煥閸愵亜鐓熷┑顔硷功缁垶骞忛崨鏉戝窛濠电姴鍟弸鎴濃攽閻樻剚鍟忛柛鐘愁殔椤洤鈻庨幒鏂剧綍濠电姷鏁告繛锟芥繛浣冲浂鏁勯柛娑樼摠鐎氬懘鏌ｉ弬鎸庢喐缂佺娀绠栭弻鐔猴拷鐢殿焾娴犙囨煟閹垮啫鐏＄紒缁樼☉閻ｆ繃绻濇笟锟介崑妤呮⒑閸濆嫭婀伴柣鈺婂灦閻涱喖螣娴ｆ洘妫冮弫鎾寸鐎ｎ亞鐤囬梺鍦濠㈡﹢宕掗妸鈺傜厵閻庣數顭堝暩缂佹儳褰炵划娆撳蓟濞戞矮娌柛鎾楀嫬娅欓梻浣侯焾缁绘劙鎳熼鐐茬厴闁硅揪瀵岄弫宥嗙箾閹寸偟鎳冮柛鐐差槸铻栭柣姗�娼ф禒婊呯磼缂佹﹫鑰跨�殿噮鍋婇獮妯肩磼濡粯顏熼梻浣芥硶閸ｏ箓骞忛敓锟� ROLL闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴楠炴﹢鎳犻澶嬓滈梻浣规偠閸斿秶鎹㈤崘顔嘉﹂柛鏇ㄥ灠閸愶拷濡炪倖鍔﹀锟界紒顔煎缁辨挻绗熸繝鍐伓濠电姰鍨奸崺鏍礉閺嶎厽鍋傛繛鎴欏灪閻撴洟鏌曟径鍫濈仾婵炲懎鎳橀弻娑㈠箻閺夋垟鏋欓梺鍝勮閸婃繂顕ｉ崼鏇炵閹肩补锟藉弶妯婇梻鍌欑閹碱偊寮甸鍌滅煓闁硅揪绲挎禍娆撴⒒娴ｅ憡鍟為柛鏃�鍨垮畷婵堬拷锝庯拷顖嗗吘鏃堝川椤旇瀚奸梻浣告啞缁诲倻锟芥氨鍏樺畷鏇㈠箛椤撴繄绠氬銈嗗姂閸ㄥ綊寮抽敐鍥锋嫹濞堝灝鏋涙い顓犲厴楠炲啴濮�閵堝棗浠忛柣搴㈢♁閿氭い蹇撶埣濮婂搫效閸パ呬痪濡炪倖姊归悧鐘诲箖閻愬搫绠氭い顑斤拷宕囩Ш闁诡喒鏅涢埢搴ょ疀閹垮啩娣┑鐐茬摠缁秶鍒掗幘璇茶摕鐎广儱顦导鐘绘煕閺囥垺娑ч柛鎾讳憾閺岋絾鎯旈姀銏犳殹闂佺懓鍤栭幏锟�? by changhao
				{
					if (e != null)
						mkdb.Procedure.psendWhileCommit(e, msg);			
				}
				
				if (num >= teammelon.getMelonroleids().size())
				{
					new PTeamRollMelonInfo(battlemelonid, 0).call();
				}
				
				return true;
			}
			
		};
		teamrollmelon.submit();
	}
	
	/*
	 * 
	 * 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴楠炴﹢宕ｆ径妯烩枈闂備胶绮敮鎺楁晝椤忓牆钃熼柡鍥╁枔缁犻箖鏌ｉ幇闈涘闁绘繃姊荤槐鎾存媴閸濆嫷锟藉矂鏌涢妸銉у煟鐎殿喖顭锋俊鎼佸煛閸屾矮绨介梻浣侯焾閺堫剛绮欓幋锔绘晜闁跨噦鎷�?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閹冣挃闁硅櫕鎹囬垾鏃堝礃椤忓孩瀚归柨婵嗙凹缁ㄥジ鏌熼惂鍝ョМ闁哄矉缍侀、姗�鎮欓幖顓燁棧闂備線娼уΛ娆戞暜閹烘缍栨繝闈涱儐閸婇攱銇勯幒鐐村濡炪倕绻愰悥鐓庮潖缂佹ɑ濯寸紒娑橆儏濞堟劙姊洪崫銉ユ珡闁稿锕ら悾鐑藉箚闁附些闂備礁鍚嬪姗�鎮樺┑瀣厴闁硅揪闄勯崐鐑芥煛婢跺鐏╁ù鐘殿焾椤啴濡舵惔鈥崇濠电偛妯婇崣鍐嵁閸愨晛顕遍柡澶嬪殾閵娾晜鐓冮柛婵嗗閿熺晫鏁婚獮蹇撁洪鍛嫼闂佸憡绋戦敃锕傚煡婢舵劖鐓ラ柡鍥朵簽閹吋绻涢崱鎰伈闁哄苯妫楅濂稿幢濞嗗繐绠為梻鍌欑窔濞佳団�﹂崼銉ョ９婵°倕鎳忛崕妤佺箾閸℃ê濮︽繛鍫滅矙閺岋綁骞囬姘辨缂備胶濮村鍫曞Φ閸曨垱鏅滈柟顖嗗本姣夐梻浣筋嚃閸ㄥ崬螞閸愨晜鍙忛柨鐔剁矙閺岋絽螣閾忕櫢绱為梺璺ㄥ枔閻℃棃宕ｉ崘顭戞綎缂備焦蓱婵挳鏌涘☉姗堝伐闁哄棗鐗嗛埞鎴︽倷妫版繂娈濋梻鍌氬鐎氼喚鍒掔�ｎ亶鍚嬮柛娑变簼閻庡姊虹憴鍕剹闁搞劏浜敓鑺ヤ亢椤鎹㈠☉銏犵闁绘劘灏欓悷鎻掆攽閻愬弶鍣归柨鏇樺劦楠炲牓濡搁敂鍓х槇闂佺鏈粙鎺楀磿閹剧粯鐓涘ù锝呮憸婢э箓鏌＄仦鍓ф创濠碉紕鍏橀獮瀣攽閸℃浜鹃梻浣筋嚙妤犳悂顢氶鐘愁潟闁规崘顕х壕鍏肩箾閸℃ê濮夐柕鍫熸緲椤啴濡堕崱妯垮亖闂佹悶鍎崝灞剧闁秵鈷戦悷娆忓缁�鍐拷瑙勬礋濞佳囨偩閸偆鐟归柨鐔剁矙瀵鈽夐姀鐘靛姶闂佸憡鍔︽禍鏍ｉ崼銏㈢＝濞撴艾锕ョ�氬綊姊洪崨濠傚闁哄倸鍊圭粋宥咁煥閸喓鍘搁梺鍛婂姂閸斿秹骞栭幇顑炵懓顭ㄩ崱鈺傜秷闂侀潧娲ょ�氫即寮崒鐐村殟闁靛／鍐ㄦ濠碉紕鍋戦崐銈嗙濠婂牆鐤悗娑櫭肩换鍡涙煕椤愶絾绀�妤犵偑鍨烘穱濠囶敍濠婂啫濡哄┑鐐茬墱閸嬪﹤顫忕紒妯诲濞撴凹鍨抽崝绋款渻閵堝棗鐏ユ俊顐ｇ箞瀵偊宕橀纰辨綂闂佺粯锚閻忔艾鈻撴ィ鍐┾拺缂備焦锕╅悞鐐亜閺囧棗娲ょ粈鍐煥閻旂粯顥夋い顏勫暣婵″爼宕卞Ο鐑樻闂備礁鎽滈崰搴☆焽閿熺姷宓侀煫鍥ㄦ媼濞差亶鏁傞柛娑变簼鐎氳偐绱撻崒姘拷鐑芥倿閿曞倵锟斤箓宕奸悢铏瑰骄濠殿喗顨愰幏鐑芥煛瀹�瀣ɑ妤犵偛锕弻娑㈠棘閸ф寮伴梺杞扮劍閹瑰洭骞婇悙鍝勎ㄧ憸宥夊汲閿熺姵鈷戦柣鐔告緲濞堚晠鏌熼崙銈嗗?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牆浼愰梺鎼炲妽濮婂綊濡甸崟顖氱閻犲搫鎼竟澶愭⒑缂佹ɑ鐓ユ俊顐ｎ殜婵℃挳骞掗幋顓熷兊闂佺粯鍔﹂崜娆擃敂閼稿吀绻嗛柕鍫濇搐鍟搁梺绋款儐缁嬫捇骞戦姀鐙�娼ㄩ柨鐔绘椤曪綁顢曢敃锟界粻鑽ょ磽娴ｈ偂鎴濃枍閵忋倖鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗? by changhao
	 */
	public long calcMaxRollPoint(java.util.ArrayList<Long> roleids, xbean.TeamMelon teammelon)
	{
		int max = 0;
		long maxroleid = 0;
		for (Long roleid : roleids)
		{
			Integer rollpoint = teammelon.getMelonroleids().get(roleid);
			if (rollpoint >= max)
			{
				max = rollpoint;
				maxroleid = roleid;
			}
		}
		
		return maxroleid;
	}

	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 794523;

	public int getType() {
		return 794523;
	}

	public long melonid; // 分赃id by changhao
	public int status; // 1是ROLL 0是放弃 by changhao

	public CTeamRollMelon() {
	}

	public CTeamRollMelon(long _melonid_, int _status_) {
		this.melonid = _melonid_;
		this.status = _status_;
	}

	public final boolean _validator_() {
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		_os_.marshal(melonid);
		_os_.marshal(status);
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		melonid = _os_.unmarshal_long();
		status = _os_.unmarshal_int();
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CTeamRollMelon) {
			CTeamRollMelon _o_ = (CTeamRollMelon)_o1_;
			if (melonid != _o_.melonid) return false;
			if (status != _o_.status) return false;
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		_h_ += (int)melonid;
		_h_ += status;
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append(melonid).append(",");
		_sb_.append(status).append(",");
		_sb_.append(")");
		return _sb_.toString();
	}

	public int compareTo(CTeamRollMelon _o_) {
		if (_o_ == this) return 0;
		int _c_ = 0;
		_c_ = Long.signum(melonid - _o_.melonid);
		if (0 != _c_) return _c_;
		_c_ = status - _o_.status;
		if (0 != _c_) return _c_;
		return _c_;
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

