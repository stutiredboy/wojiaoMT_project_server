
package fire.pb.team;

import fire.pb.StateCommon;
import fire.pb.battle.PlayPKManage;
import fire.pb.buff.BuffAgent;
import fire.pb.buff.BuffConstant;
import fire.pb.buff.BuffRoleImpl;
import fire.pb.buff.OperateType;
import fire.pb.main.ConfigManager;
import fire.pb.map.MapConfig;
import fire.pb.talk.MessageMgr;


// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CFInviteJoinTeam__ extends mkio.Protocol { }

// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

public class CFInviteJoinTeam extends __CFInviteJoinTeam__ {
private long now = 0L;//procedure闂傚倸鍊峰ù鍥敋瑜嶉湁闁绘垵顫曢敓钘夊�块、姘舵晸娴犲宓侀煫鍥ㄧ♁閺呮悂鏌ㄩ悤鍌涘?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹缂佹劖顨婇弻鈥愁吋鎼粹�冲闂佽桨绀佺�氫即寮诲☉銏犵労闁告劗鍋撻鐟扳攽閻愬瓨灏い顓犲厴瀵鈽夊顐ｅ媰闂佸憡鎸嗘笟濠冨闁圭儤顨嗛悡鍐煟閻旂顥嬮弽锛勭磽娴ｈ櫣甯涚紒璇茬墕铻為柛鎰╁妷濡插牊绻涢崱妯曟垿鏁撻妷鈺傗拻濞达絽鎲＄拹锟犳煛閸滀礁浜濋柟渚垮姂楠炴﹢顢欓懖鈺佸绩濠电姰鍨奸崺鏍礉閺嶎厼鐤鹃柟闂寸劍閻撱儵鏌ｉ弴鐐诧拷鍦拷姘炬嫹?濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨偓鎷锋繝姘ワ拷鍛村矗婢跺瞼鐦堟繝鐢靛Т閸婂綊宕抽悾宀�纾奸柨鐔诲Г缁绘繈宕堕妸銉嫹閻㈠憡鐓ユ繝闈涙椤庢鏌＄�ｎ偆銆掔紒杈ㄥ浮閺佹挻绂掔�ｎ亪鍞跺銈庡亽閸犳锟芥俺顫夐〃銉╂倷閼碱兛铏庨梺鍛婃⒐绾板秵绌辨繝鍥舵晝闁挎繂娲﹂崳浼存煢濡崵绠橀柟鍙夋倐瀵剙鈻庨悙顒傜▉濠电姷鏁告慨鐢告嚌閸撗冾棜闁稿繗鍋愮弧锟介梻鍌氱墛缁嬫帡骞栭幇顓犵闁瑰啿鍢查幊鎰閽樺褰掓晲閸曨厾鐓撻梺鍛婄箚濞咃絿妲愰幒鏃�瀚氶柟缁樺笚濞堝墎绱撴笟鍥ф灍鐎癸拷缁嬭法鏆﹂柨鐔哄У閸婄兘鏌嶉崫鍕拷褰掑级缁嬪簱鏀介柣妯虹仛閺嗏晛鈹戦纰卞殶闁跨喕濮ら崙褰掑矗閸愵喗鏅查柣鎰▕閸氬鏌涘☉鍙樼凹闁哄偊鎷峰┑锛勫亼閸婃牕顫忔繝姘柧妞ゆ劑鍊楁稉宥夋煏婢舵稓绱扮紒璇叉閺屾稑鈻庤箛锝嗏枔闂佸憡姊瑰Ο鍧坋dure濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺绋胯閸旀垿寮婚敃锟借灒濞撴凹鍨遍埢鎾斥攽閻愬瓨灏い顓犲厴瀵鈽夊Ο鍏兼畷闂佽法鍠嶇划娆忕暦閹达附鍊烽柛婵嗗閸橀亶姊洪崷顓炲妺妞ゃ劌妫濆畷鎰版偨閸涘ň鎷婚梺鍓插亞閸犳捇鍩︽笟锟介弻娑㈡偄閸濆嫪妲愰梺鍝勭焿缂嶄線寮幇鏉块唶婵犲﹤鍟崕鎾剁磽閸屾瑦绁板瀛樻倐楠炴劖绻濆顒傤唵闂佸憡绋掑娆愬閻樼粯鐓曢柡鍥ュ妼婢т即鏌ㄩ悢鍑ゆ嫹閻斿壊浠╃紓浣介哺閹稿骞忛崨顖涘枂闁告洏鍔嶇�氬姊绘担鐑樺殌闁规祴鍓濈换娑欑節閸ャ劌浠掑銈嗘穿閹风兘鏌℃担瑙勫磳闁轰焦鎹囬弫鎾绘晸閿燂拷?
	
	@Override
	protected void process()
	{
		// protocol handle
		TeamManager.logger.debug("Enter: " + this.getClass());
		final long inviterRoleId = gnet.link.Onlines.getInstance().findRoleid(this);
		if (inviterRoleId < 0)
			return;
		final long invitedRoleId = roleid;
		if(inviterRoleId == invitedRoleId)
			return;
		//add by cn 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閿熻棄鍊圭粋鎺旓拷锝庡亝濞呫垽姊洪懞銉冾亪藝椤栫偛姹查梺顒�绉甸悡銉╂煟閺冨倻甯涙い銉ヮ槺缁辨挸顓奸崪鍐惈濡ょ姷鍋涢崯顐ョ亽闁荤姴娲╃亸娆戠玻閻愮儤鈷戠憸鐗堝笒娴滀即鏌涢幘纾嬪闁伙綁娼ч鍏煎緞鐎Ｑ勫闂傚倸鍊搁悧濠冪瑹濡ゅ懏鍊垮Δ锝呭暞閻撴洟骞栧ǎ顒�锟芥捇宕ラ銈囩＜妞ゆ棁鍋愭晶銏ゆ煥閻斿憡鐏紓宥呮瀹曟澘螖閸涱喖浜楀┑鐐叉閹稿鎮￠弴鐔虹闁瑰鍎戦崗顒傦拷瑙勬偠閸庣敻寮婚敐鍫㈢杸閻庯綆浜滄慨锕傛⒑閸濆嫭婀伴柣鈺婂灦楠炲啴鍩￠崨顓犵厬婵犮垼娉涢敃銉╂偩婵犳碍鐓熼幖娣焺閸熷繘鏌涢敐搴℃珝鐎规洘绮岄埢搴ㄥ箳閺傚墽鑳洪梻鍌氬�风粈渚�骞夐敓鐘茬闁硅揪绠戠粈鍫ユ⒑椤掞拷缁夌敻寮插┑瀣厱閻忕偛澧介妴鎺楁煕濡吋鏆慨濠呮閹瑰嫰濡搁妷锔惧綒闂備胶鎳撻崵鏍箯閿燂拷?,濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姳鍗抽弻娑樷攽閸曨偄濮㈤梺娲诲幗閹瑰洭寮婚悢铏圭＜闁靛繒濮甸悘鍫ユ⒑缁嬭儻顫﹂柛鏃�鍨垮濠氭偄閻氬瓨瀚归柣銏☆問閻掗箖寮介埄鍐瘈婵炲牆鐏濋悘銉╂煕鐎ｎ偄濮夋俊鍙夊姍楠炴帡寮幘鏉戭伓闂佹寧绻傜花鑲╄姳閽樺褰掓偐椤旇偐浠鹃梺闈涙搐鐎氫即銆侀弴銏╂晢闁稿本绨藉鍫熲拺闁告繂瀚﹢鎵磼鐎ｎ偆澧辩紒顔款嚙閳藉顫濋悙顒�顏堕梺鎸庣箓缁ㄨ偐鑺辩拠娴嬫斀妞ゆ棁鍋愭晥濠殿喖锕ュ浠嬪箖閻戣棄绠ユい鏃傚亾濞堫垶姊绘担瑙勫仩闁告柨绉撮—鍐╃鐎ｎ剙绁﹂棅顐㈡处缁嬫垵顔忓┑瀣厸濠㈣泛顑呴悘銉э拷瑙勬尭濡繂顫忓ú顏咁棃婵炴垶姘ㄩ悾楣冩煟鎼淬埄鍟忛柛鎾跺枎椤曪綁骞橀钘夛拷鍫曟偣閸ヮ亜鐨虹紒澶嬫そ閺屸剝鎷呯憴鍕３闂佽桨鐒﹂幑鍥极閹剧粯鏅搁柨鐕傛嫹?
		BuffAgent agent = new BuffRoleImpl(inviterRoleId, true);
		if (agent.existBuff(PlayPKManage.BuffDuelID)) {
			if (fire.pb.team.TeamManager.isInTeam(inviterRoleId))
				MessageMgr.sendMsgNotify(inviterRoleId, 141866,  null);
			else 
 			    MessageMgr.sendMsgNotify(inviterRoleId, 141133,  null);
			return;
		}
		
		agent = new BuffRoleImpl(invitedRoleId,true);
		if (agent.existBuff(PlayPKManage.BuffDuelID)) {
			MessageMgr.sendMsgNotify(inviterRoleId, 141865,  null);
			return;
		}
		mkdb.Procedure createTeamP = new mkdb.Procedure()
		{

			@Override
			protected boolean process()
			{
				Team team = null;
				//lock start 
				Long teamId = xtable.Roleid2teamid.select(inviterRoleId);
				//闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ磵閿熸枻绠撳畷濂稿閳ュ啿绨ラ梻浣筋潐婢瑰棙鏅跺Δ鍛；閻庯綆鍠楅悡娆撴煕閹炬鎳庣粭锟犳⒑缁嬫鍎愰拑杈╃磼缂佹娲寸�规洖宕灒闁惧繘锟芥稒顢橀梻浣筋嚙鐎涒晝鍠婂澶嬪殞濡わ絽鍟繚闂佸湱鍎ら崺鍫濐焽閳哄懏鐓熼柟浼存涧婢ь喗銇勮箛姘厫缂佺粯绻傞銉╁几椤愵澁鎷烽妶澶婂惞閻庯綆鍠楅埛鎺楁煕閺囥劌浜滄い蹇ｅ亰閺屻劑鎮㈤悜妯荤彧闂佽桨鐒﹂幃鍌氱暦閵忥綆妯勫銈冨灪钃辩紒铏规櫕缁瑩宕归鍖℃嫹閸喒鏀介柍钘夋閻忥綁鏌涙惔銏犵仼缂侇喖顭烽獮妯兼嫚閼艰埖鎲版繝鐢靛仦閸ㄥ爼鏁冮埡渚囩劷闁冲搫鎳忛悡鏇㈡煙閻愵剦娈旈柟铏姍閹即濡烽埡鍌楁嫼闂佺厧顫曢崐鏇熺墡闂備礁鎲″褰掋�冩繝鍌滄殾濞村吋娼欑粻濠氭偣閸濆嫭鎯堥柣蹇擄躬濮婅櫣鎹勯妸銉︾彚闂佺懓鍤栭幏锟�?,闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍥煏韫囨洖啸闁挎稓鍠栧缁樼瑹閸パ冾潻缂備礁顦顓犲垝閿濆憘鏃堝川椤旀儳骞堟繝鐢靛仦閸ㄩ潧鐣烽鍕�堕柡灞诲劜閻撴瑩鏌ｉ幋鐘垫憘婵☆偅鍨块弻鐔煎矗婢跺鍞夐悗瑙勬礈閸犳牠銆佸Ο娆炬Ъ濠电偛鐗愰～澶屾崲濠靛牆鏋堟慨妤�鐗婄�氬綊鏌涢幇顖氱毢濡ょ姴娲铏规嫚閳ヨ櫕鐏堥梺绋匡攻閹倿骞冩ィ鍐╁�婚柦妯猴級閵娾晜鐓冮柛婵嗗閿熺晫鎳撻埢宥夊炊椤掍讲鎷虹紓浣割儐鐎笛冿耿閹殿喚纾奸悗锝庡亜濞搭喚锟芥鍠涘▍鏇犵矙婵犲嫬瀵茬痪鎵皹lock
				if(teamId != null)
				{//闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑鐐婵犵绻濆褑鐏掔紓鍌欑劍椤洨绮旂捄琛℃斀闁绘劕鐡ㄧ亸顓㈡煙閻ｅ瞼澹條ock
					team = new Team(teamId,false);
					if(!team.isTeamLeader(inviterRoleId))
						return true;//濠电姷鏁告慨鎾儉婢舵劕绾ч柛鏍ゅ墲鐎氳淇婇妶鍕妽闁告瑥绻橀弻鐔虹磼閵忕姵鐏嶉梺绋垮椤ㄥ懘濡撮幒鎴僵闁绘劦鍓欓鍫曟⒒娴ｇ瓔鍤冮柛顭戝灦閹偤鏁冮敓浠嬵敋閵夆晛绀嬫い鎾寸箖閸曞啴姊虹拠鈥崇�婚柛娑卞弮閸欙繝姊婚崒姘拷椋庢濮橆剦鐒界憸鏃囨婵炲濮撮鍡涘磻閸岀偞鐓曟い鎰剁悼缁犮儵鏌ｉ幒宥囩煓闁哄被鍔戦幃銏ゅ传閸曟埊缍侀弻锝夊箻鐠鸿　鏋呴梺鍝勭焿缂嶄線骞冮姀銈呭窛濠电姴瀚崵鎺旂磽閸屾瑨鍏岄悗姘箻瀹曠喖顢旈崱娆戞毎闂傚倷绀侀幉锟犳偡閵夆敡鍥ㄥ閺夋垹锛欓梺褰掑亰閸ｎ垶骞忔搴㈠枂闁告洦鍓涢敍姗�姊虹粙鎸庢崳闁轰浇顕ч锝夘敃閿曪拷缁�鍐煃閸濆嫬锟芥悂顢撻幘缁樷拺闁诡垎鍛啈濡炪倖娲橀悧鐘茬暦椤栫偛纾奸柣鎰ˉ閹风粯绻涙潏鍓у埌闁硅绻濋獮鍡涘醇閵夛箑锟藉灚鎱ㄥΟ鍝勮埞闁告ê顕敓鍊燁潐濞叉牕锕㈤柆宥呯闁告洦鍓氭刊鎾煛閸ユ湹绨界紒澶樺櫍閺屸剝鎷呯粙鍖℃嫹閸ф绠板┑鐘插暙缁剁偞淇婇婊冨妺妞ゆ梹鎹囧铏规嫚閺屻儺锟芥绱掗悩鑼х�规洘娲熷畷锟犳倶缂佹ɑ銇濋柡浣稿暣瀹曟帒鈽夊Ο瑙勫亝闂傚倸鍊风欢锟犲礈濞嗘垹鐭撻柣銏㈩焾閻撴洟鏌熼悜姗嗘畷闁绘挻娲熼弻鐔煎级閸喗鍊庣紓浣靛妼椤兘寮婚敍鍕舵嫹閿濆骸浜炴繛鍙夋尦閺屸�崇暆鐎ｎ剛鐦堥悗瑙勬礋娴滃爼銆佸锟介幃銏＄附婢跺澶�
				}
				
				// 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝夋交閼板潡姊洪锟界粔顕�鏁撻弬銈囩暤鐎规洖銈告俊椋庯拷锝庝簼閸犳﹢鏌熼鐐珪缂侇喗鐟ч幏鐘崇┍閸楃偛濮﹀Δ鐘靛仦閻楁洝褰佸銈嗗釜閹风兘鏌ｈ箛锝勯偗闁哄本绋掗幆鏃堟晲閸涱喚浜梻浣虹帛閹尖晠宕戞繝鍌滄殾闁割偅娲栨儫閻熸粌顦‖濠囧Ω閳哄倵鎷洪柡澶屽仦婢瑰棝宕濆鍡愪簻闁圭儤姊归崕鐧糴lock闂傚倸鍊搁崐鎼佸磹妞嬪孩顐芥慨姗嗗墻閻掕棄鈹戦悩瀹犲缂佺媭鍨堕弻銊╂偆閸屾稑顏�? teamlock
				Long inviterTeamId = null;
				Long invitedTeamId = null;
				if (inviterRoleId < invitedRoleId)
				{
					inviterTeamId = xtable.Roleid2teamid.get(inviterRoleId);
					invitedTeamId = xtable.Roleid2teamid.get(invitedRoleId);
				} else
				{
					invitedTeamId = xtable.Roleid2teamid.get(invitedRoleId);
					inviterTeamId = xtable.Roleid2teamid.get(inviterRoleId);
				}
				//lock end
				
				now = System.currentTimeMillis();
				
				if(!checkOnline(invitedRoleId, inviterRoleId))
				{
					//闂傚倸鍊搁崐椋庣矆娓氾拷楠炴牠顢曚綅閸ヮ剦鏁冮柨鏇嫹闁汇倗鍋撶换婵囩節閸屾粌顣洪梺钘夊暟閸犳牠寮婚弴鐔虹闁割煈鍠栨竟鍕攽閻愬弶鈻曞ù婊勭矒瀹曟﹢鏁撴禒瀣仭婵犲﹤鍠氬Σ鎼佸础闁秵鐓曟い鎰Т閸旀粓鏌ｉ幘瀛樼闁靛洤瀚伴獮鍥煛娓氬﹥瀚归柡鍥ュ灩閸戠姷锟藉箍鍎卞ú銊у婵傜绾ч柛顐ｇ☉婵″灝顭胯閺佸寮婚悢纰辨晩闁圭娴烽妴鎰渻閵堝骸浜濈紒璇茬墦楠炲啴鍩勯崘鈺佸妳濠电娀娼уΛ娆撴倵閹惰姤鈷掗柛灞剧懆閸忓本銇勯鐐靛ⅵ闁轰礁鍟存俊鑸靛緞濡粯娅堥梻浣规偠閸庢椽宕滃▎鎴犱笉妞ゆ牜鍋為悡鐔镐繆椤栨繍鍤欏褜鍨辨穱濠囧箵閹烘梻楔濡ょ姷鍋為悧鏇″絹濡炪倖甯幏鐑芥煟韫囷絽娅嶉柡宀嬬節瀹曞崬鈻庤箛濠冪�版繝娈垮枛閿曘劌鈻嶉敐鍥潟闁圭儤鍤﹂悢鍝ョ懝妞ゆ牗渚楀Λ銉╂⒒閸屾瑧顦﹂柟纰卞亰楠炲﹨绠涘☉娆忓壆濡炪倖鐗滈崑鎴︽晸閹存帞顦﹂柍璇叉唉缁犳盯鏁愰崨顔硷拷顖炴⒒娴ｈ櫣銆婇柛鎾寸箞閹兘濮�閵堝懎鍤戦梺鍝勭▉閸樹粙宕愰崹顐闁绘劘灏欐禒銏ゆ煕閺冿拷瀹�鎼佸蓟閻旂厧绀冮柤纰卞墰椤旀帡姊虹紒妯绘儎闁告挾鍠栭妴浣肝旈崨顓狅紲濠电姴锕ら幏鎴犳閺屻儲鈷掑ù锝堝Г绾爼鏌涢敐蹇曠暤妤犵偛绻橀弫鎾绘晸閿燂拷?(illegal)
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂澶嬪殞濡わ絽鍟犻敓鑺ユ瀹曟﹢顢旀惔銏狀伓闂佹寧绻傜花鑲╄姳缂佹ǜ浜滈柟鍝勵儏閻忔煡鏌″畝瀣М闁轰焦鍔栧鍕緞鐎ｎ亝鐏撻梻鍌欑閹碱偊鎯屾径灞界筏濞寸姴顑呴悡姗�鏌涢幇闈涙灍闁稿﹪鏀遍妵鍕箳瀹ュ牆鍘￠悷婊勬緲閹冲繑绌辨繝鍥ㄥ�锋い蹇撳閹风兘寮介鐐舵憰闂侀潧臎閸涱垳鍘犻梻浣圭湽閸ㄥ寮幖浣瑰剹婵炲棗娴氶悢鍡涙偣鏉炴媽顒熼柣鎿冨墴閺屾稑顫濋澶婂壎闂佸搫鏈粙鎴﹀煡婢舵劕纭�闁绘劕顕禒宀勬⒒娴ｅ憡鍟為柛鎴濈秺瀹曟垿宕卞▎鎰垫綗闂佽鍎抽顓㈡偡閻熸壋鏀介柣妯诲絻閺嗘瑦銇勮箛銉﹀?,RoleId: "+invitedRoleId);
				}
				else if(!checkInviterStatus(inviterRoleId))
				{
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄦ儗濡ゅ懎绠圭紒顔炬嚀閻忔娊鏌ㄥ┑鍡╂Ц缁绢叏鎷烽梻浣筋嚙缁绘鐣烽悽绋跨疇闁瑰墽鍎甸敓鏂ょ畵婵℃悂鍩℃担渚О婵＄偑鍊曠换鎰拷姘煎墮琚欓柛顐犲灮绾句粙鏌涚仦鍓ф噮闁告柨绉甸妵鍕Ω閵夛箑娈楅柦妯荤箞閺岋綁濮�閵忊晝鍔哥紓浣哄Х婵灚绌辨繝鍥ч柛娑卞枛濞呫倝姊虹粙娆惧剬闁哄懏绻堥弫鎾绘偩鐏炵虎浠ч梺褰掝棑閸忔﹢寮婚妸鈺傚亜闁告挷鑳堕悡鎾绘⒑鐠団�崇仩闁活剙銈搁弫鎾诲棘閵堝洨校闂佸摜濮甸〃濠囧春濞戙垹绠虫俊銈勮兌閸橀亶姊虹憴鍕凡闁告熬鎷风紓浣靛妼椤兘寮婚敍鍕舵嫹閿濆骸浜濋柍閿嬪姉缁辨帞绱掑Ο鍏煎垱閻庤娲栭妶鎼佸箖閵忊槅妲归幖瀛樼箘缁�澶愭⒒閸屾瑦绁版い鏇熺墵瀹曚即骞掑Δ锟介悿楣冩煟濡鍤欑紒鐘靛У缁绘繃绻濋崒婊冾杸闂佸搫鎳忛幃鍌炲蓟閵娾晜鍋嗛柛灞剧☉椤忥拷?? 
					MessageMgr.psendMsgNotify(inviterRoleId, 141618, null);
//					psend(inviterRoleId, new STeamError(TeamError.SelfInUnteamState));
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄦ儗濡ゅ懎绠圭紒顔炬嚀閻忔娊鏌ㄥ┑鍡╂Ц缁绢叏鎷烽梻浣筋嚙缁绘鐣烽悽绋跨疇闁瑰墽鍎甸敓鏂ょ畵婵℃悂鍩℃担渚О婵＄偑鍊曠换鎰拷姘煎墮琚欓柛顐犲灮绾句粙鏌涚仦鍓ф噮闁告柨绉甸妵鍕Ω閵夛箑娈楅柦妯荤箞閺岋綁濮�閵忊晝鍔哥紓浣哄Х婵灚绌辨繝鍥ч柛娑卞枛濞呫倝姊虹粙娆惧剬闁哄懏绻堥弫鎾绘偩鐏炵虎浠ч梺褰掝棑閸忔﹢寮婚妸鈺傚亜闁告挷鑳堕悡鎾绘⒑鐠団�崇仩闁活剙銈搁弫鎾诲棘閵堝洨校闂佸摜濮甸〃濠囧春濞戙垹绠虫俊銈勮兌閸橀亶姊虹憴鍕凡闁告熬鎷风紓浣靛妼椤兘寮婚敍鍕舵嫹閿濆骸浜濋柍閿嬪姉缁辨帞绱掑Ο鍏煎垱閻庤娲栭妶鎼佸箖閵忊槅妲归幖瀛樼箘缁�澶愭⒒閸屾瑦绁版い鏇熺墵瀹曚即骞掑Δ锟介悿楣冩煟濡鍤欑紒鐘靛У缁绘繃绻濋崒婊冾杸闂佸搫鎳忛幃鍌炲蓟閵娾晜鍋嗛柛灞剧☉椤忥拷??,RoleId: "+inviterRoleId);
				}
				else if(!checkInvitedStatus(invitedRoleId))
				{
					//闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂鍛殕闁归棿绀侀拑鐔兼煥濠靛棭妲搁崶鎾椤愩垺澶勯柡灞诲姂椤㈡棃鏁撻敓锟�?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄦ儗濡ゅ懎绠圭紒顔炬嚀閻忔娊鏌ㄥ┑鍡╂Ц缁绢叏鎷烽梻浣筋嚙缁绘鐣烽悽绋跨疇闁瑰墽鍎甸敓鏂ょ畵婵℃悂鍩℃担渚О婵＄偑鍊曠换鎰拷姘煎墮琚欓柛顐犲灮绾句粙鏌涚仦鍓ф噮闁告柨绉甸妵鍕Ω閵夛箑娈楅柦妯荤箞閺岋綁濮�閵忊晝鍔哥紓浣哄Х婵灚绌辨繝鍥ч柛娑卞枛濞呫倝姊虹粙娆惧剬闁哄懏绻堥弫鎾绘偩鐏炵虎浠ч梺褰掝棑閸忔﹢寮婚妸鈺傚亜闁告挷鑳堕悡鎾绘⒑鐠団�崇仩闁活剙銈搁弫鎾诲棘閵堝洨校闂佸摜濮甸〃濠囧春濞戙垹绠虫俊銈勮兌閸橀亶姊虹憴鍕凡闁告熬鎷风紓浣靛妼椤兘寮婚敍鍕舵嫹閿濆骸浜濋柍閿嬪姉缁辨帞绱掑Ο鍏煎垱閻庤娲栭妶鎼佸箖閵忊槅妲归幖瀛樼箘缁�澶愭⒒閸屾瑦绁版い鏇熺墵瀹曚即骞掑Δ锟介悿楣冩煟濡鍤欑紒鐘靛У缁绘繃绻濋崒婊冾杸闂佸搫鎳忛幃鍌炲蓟閵娾晜鍋嗛柛灞剧☉椤忥拷?? 
					MessageMgr.psendMsgNotify(inviterRoleId, TeamManager.ERROR_MSG_OBJECT_CANT_IN_TEAM, null);
//					psend(invitedRoleId, new STeamError(TeamError.SelfInUnteamState));
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂鍛殕闁归棿绀侀拑鐔兼煥濠靛棭妲搁崶鎾椤愩垺澶勯柡灞诲姂椤㈡棃鏁撻敓锟�?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄦ儗濡ゅ懎绠圭紒顔炬嚀閻忔娊鏌ㄥ┑鍡╂Ц缁绢叏鎷烽梻浣筋嚙缁绘鐣烽悽绋跨疇闁瑰墽鍎甸敓鏂ょ畵婵℃悂鍩℃担渚О婵＄偑鍊曠换鎰拷姘煎墮琚欓柛顐犲灮绾句粙鏌涚仦鍓ф噮闁告柨绉甸妵鍕Ω閵夛箑娈楅柦妯荤箞閺岋綁濮�閵忊晝鍔哥紓浣哄Х婵灚绌辨繝鍥ч柛娑卞枛濞呫倝姊虹粙娆惧剬闁哄懏绻堥弫鎾绘偩鐏炵虎浠ч梺褰掝棑閸忔﹢寮婚妸鈺傚亜闁告挷鑳堕悡鎾绘⒑鐠団�崇仩闁活剙銈搁弫鎾诲棘閵堝洨校闂佸摜濮甸〃濠囧春濞戙垹绠虫俊銈勮兌閸橀亶姊虹憴鍕凡闁告熬鎷风紓浣靛妼椤兘寮婚敍鍕舵嫹閿濆骸浜濋柍閿嬪姉缁辨帞绱掑Ο鍏煎垱閻庤娲栭妶鎼佸箖閵忊槅妲归幖瀛樼箘缁�澶愭⒒閸屾瑦绁版い鏇熺墵瀹曚即骞掑Δ锟介悿楣冩煟濡鍤欑紒鐘靛У缁绘繃绻濋崒婊冾杸闂佸搫鎳忛幃鍌炲蓟閵娾晜鍋嗛柛灞剧☉椤忥拷??,RoleId: "+invitedRoleId);
				}
				else if(!checkInvitedTeamFuctionEnable(invitedRoleId))
				{
					//闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂鍛殕闁归棿绀侀拑鐔兼煥濠靛棭妲搁崶鎾椤愩垺澶勯柡灞诲姂椤㈡棃鏁撻敓锟�?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄥ垂閸岀偞鈷戞い鎺炴嫹缂佸鏁诲畷鎴﹀煛閸涱厾楠囬梺鍓插亝绾板秴鈻嶉崶鈺冩／闁硅鍔栭ˉ澶愭婢舵劖鐓ユ繝闈涙缁佲晠鏌ｉ幒鏂夸壕闁靛洤瀚粻娑㈡晲閸涱厾顔戝┑鐑囩到濞层倝鏁冮敃鍌氱闁绘ü璀﹀Σ楣冩⒑娴兼瑧鎮奸柡浣规倐閺佹捇宕愰悤浣圭秷濠电偛寮堕…鍥箲閵忋倕閱囬柕澶堝劤閻ｆ椽姊洪棃娑氱疄闁搞劏娅ｉ敓鑺ョ瀹�鎼佸蓟閻旇櫣纾兼俊顖濇閻熴劎绱撴担鍝勵�撶紒鎻掑⒔閹广垹鈹戠�ｎ偄浠洪梻鍌氱墛缁嬫劗鍒掗懜鐢电瘈闁靛骏绲剧涵鐐箾瀹割喖骞栭柣锝呭槻椤劑宕橀敐鍡樻澑闂備胶纭跺Σ鍛村矗閿熶粙鏌ㄩ悢缁橆棄闁诲繑绻堟俊鎾箳閹搭厽鍍甸梺缁樺姦閸撴瑩顢旈懜鍏哥箚闁靛牆娲ゅ暩闂佺顑嗙粙鎾跺垝閺冨洢浜归柟鐑樻煥缁侊箑鈹戦埥鍡楃仴婵炲拑缍佸鎶芥晝閸屾稓鍘遍梺闈涱槶閸ㄥ搫鈻嶉弮鍌滅＜闁规彃顑嗙�氾拷
//					psend(inviterRoleId, new STeamError(TeamError.ObjectTeamFunctionClose));
					MessageMgr.psendMsgNotify(inviterRoleId, 141201, null);
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂鍛殕闁归棿绀侀拑鐔兼煥濠靛棭妲搁崶鎾椤愩垺澶勯柡灞诲姂椤㈡棃鏁撻敓锟�?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄥ垂閸岀偞鈷戞い鎺炴嫹缂佸鏁诲畷鎴﹀煛閸涱厾楠囬梺鍓插亝绾板秴鈻嶉崶鈺冩／闁硅鍔栭ˉ澶愭婢舵劖鐓ユ繝闈涙缁佲晠鏌ｉ幒鏂夸壕闁靛洤瀚粻娑㈡晲閸涱厾顔戝┑鐑囩到濞层倝鏁冮敃鍌氱闁绘ü璀﹀Σ楣冩⒑娴兼瑧鎮奸柡浣规倐閺佹捇宕愰悤浣圭秷濠电偛寮堕…鍥箲閵忋倕閱囬柕澶堝劤閻ｆ椽姊洪棃娑氱疄闁搞劏娅ｉ敓鑺ョ瀹�鎼佸蓟閻旇櫣纾兼俊顖濇閻熴劎绱撴担鍝勵�撶紒鎻掑⒔閹广垹鈹戠�ｎ偄浠洪梻鍌氱墛缁嬫劗鍒掗懜鐢电瘈闁靛骏绲剧涵鐐箾瀹割喖骞栭柣锝呭槻椤劑宕橀敐鍡樻澑闂備胶纭跺Σ鍛村矗閿熶粙鏌ㄩ悢缁橆棄闁诲繑绻堟俊鎾箳閹搭厽鍍甸梺缁樺姦閸撴瑩顢旈懜鍏哥箚闁靛牆娲ゅ暩闂佺顑嗙粙鎾跺垝閺冨洢浜归柟鐑樻煥缁侊箑鈹戦埥鍡楃仴婵炲拑缍佸鎶芥晝閸屾稓鍘遍梺闈涱槶閸ㄥ搫鈻嶉弮鍌滅＜闁规彃顑嗙�氾拷,invitedRoleId: "+invitedRoleId);
				}
				else if(!checkInvitedInNoTeam(invitedTeamId))
				{
					//闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂鍛殕闁归棿绀侀拑鐔兼煥濠靛棭妲搁崶鎾椤愩垺澶勯柡灞诲姂椤㈡棃鏁撻敓锟�?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄥ磼閵娿儍褰掓偐瀹割喖鍓抽梺鍛婄懄濞叉﹢濡甸崟顖氱闁瑰瓨绻嶆禒楣冩⒑閹惰姤鏁遍悽顖ょ節瀵鈽夐姀鐘电杸闂佺绻愰幗婊堟儎鎼淬劍鈷戦柛婵嗗閸庡繒绱掓径濠傤暢婵″弶鍔欓獮鎺楀箻鐎靛摜肖闂備礁鐤囧銊ヮ渻閹烘垟鏌︽い蹇撴绾捐棄霉閿濆懎顥忛柛搴㈢矒閺岀喖宕欓妶鍡楊伓?
					//psend(inviterRoleId, new STeamError(TeamError.ObjectInTeam));
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂鍛殕闁归棿绀侀拑鐔兼煥濠靛棭妲搁崶鎾椤愩垺澶勯柡灞诲姂椤㈡棃鏁撻敓锟�?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄥ磼閵娿儍褰掓偐瀹割喖鍓抽梺鍛婄懄濞叉﹢濡甸崟顖氱闁瑰瓨绻嶆禒楣冩⒑閹惰姤鏁遍悽顖ょ節瀵鈽夐姀鐘电杸闂佺绻愰幗婊堟儎鎼淬劍鈷戦柛婵嗗閸庡繒绱掓径濠傤暢婵″弶鍔欓獮鎺楀箻鐎靛摜肖闂備礁鐤囧銊ヮ渻閹烘垟鏌︽い蹇撴绾捐棄霉閿濆懎顥忛柛搴㈢矒閺岀喖宕欓妶鍡楊伓?,invitedRoleId: "+invitedRoleId);
					fire.pb.talk.MessageMgr.psendMsgNotify(inviterRoleId, 141191, null);
				}
				else if(!checkNotBeingInvited(invitedRoleId))
				{
					//闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂鍛殕闁归棿绀侀拑鐔兼煥濠靛棭妲搁崶鎾椤愩垺澶勯柡灞诲姂椤㈡棃鏁撻敓锟�?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄦ⒒椤栨稏浜滈柡鍥朵簼鐎氬綊鎮楃憴鍕缂佽鐗撳顐﹀箻鐎靛壊娴勯柣搴秵閸嬶拷闁归攱妞藉濠氬磼濮樺崬顣甸梺鍝勬噽閸嬬喓鍒掗崼顫嫹閿濆骸鏋熼柣鎾存礋閺岋繝宕掑┑鍥┿�婄紓浣哄Т椤兘寮婚妸銉㈡斀闁割偅绻�濡叉劙姊烘潪鎵槮闁哥喐娼欓悾鐑藉箳閹搭厽鍍垫俊鎻掓湰閻楁鈪堕梻鍌氬�搁崐椋庣矆娓氾拷楠炴牠顢曢敂钘変罕闂婎偄娲︾粙鎴﹀几娓氾拷閺岀喖姊荤�电濡介梺缁樻惈缂嶄線寮诲☉姘勃缂備降鍨瑰▓褔姊洪懡銈呮灈闁稿锕幃锟犲Ψ閳哄倻鍘遍梺鍝勬储閸斿矂宕㈤棃娴㈠綊鎮╅鑲╀紙濠殿喖锕ㄥ▍锝囧垝濞嗘挸绀岄柍銉ュ帠缁憋絾淇婇悙顏勶拷鏍垂闂堟耽娲敇閵忋垹绁﹂棅顐㈡处缁嬫帡宕戦幇顔剧＝濞达綀鍋傞幋锕�鐤柨婵嗩槹閳锋垹绱掔�ｎ偄顕滄繝锟介幍顔剧＜閻犲洦褰冮敓钘夋健閹即顢氶敓浠嬪极閹剧粯鏅搁柨鐕傛嫹 
//					psend(inviterRoleId, new STeamError(TeamError.BeingInvited));
					fire.pb.talk.MessageMgr.psendMsgNotify(inviterRoleId, 141202, null);
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂鍛殕闁归棿绀侀拑鐔兼煥濠靛棭妲搁崶鎾椤愩垺澶勯柡灞诲姂椤㈡棃鏁撻敓锟�?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄦ⒒椤栨稏浜滈柡鍥朵簼鐎氬綊鎮楃憴鍕缂佽鐗撳顐﹀箻鐎靛壊娴勯柣搴秵閸嬶拷闁归攱妞藉濠氬磼濮樺崬顣甸梺鍝勬噽閸嬬喓鍒掗崼顫嫹閿濆骸鏋熼柣鎾存礋閺岋繝宕掑┑鍥┿�婄紓浣哄Т椤兘寮婚妸銉㈡斀闁割偅绻�濡叉劙姊烘潪鎵槮闁哥喐娼欓悾鐑藉箳閹搭厽鍍垫俊鎻掓湰閻楁鈪堕梻鍌氬�搁崐椋庣矆娓氾拷楠炴牠顢曢敂钘変罕闂婎偄娲︾粙鎴﹀几娓氾拷閺岀喖姊荤�电濡介梺缁樻惈缂嶄線寮诲☉姘勃缂備降鍨瑰▓褔姊洪懡銈呮灈闁稿锕幃锟犲Ψ閳哄倻鍘遍梺鍝勬储閸斿矂宕㈤棃娴㈠綊鎮╅鑲╀紙濠殿喖锕ㄥ▍锝囧垝濞嗘挸绀岄柍銉ュ帠缁憋絾淇婇悙顏勶拷鏍垂闂堟耽娲敇閵忋垹绁﹂棅顐㈡处缁嬫帡宕戦幇顔剧＝濞达綀鍋傞幋锕�鐤柨婵嗩槹閳锋垹绱掔�ｎ偄顕滄繝锟介幍顔剧＜閻犲洦褰冮敓钘夋健閹即顢氶敓浠嬪极閹剧粯鏅搁柨鐕傛嫹,invitedRoleId: "+invitedRoleId);
				}
				else if(!checkNotInvitedIn30s(invitedRoleId, inviterRoleId, inviterTeamId))
				{
					//闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂鍛殕闁归棿绀侀拑鐔兼煥濠靛棭妲搁崶鎾椤愩垺澶勯柡灞诲姂椤㈡棃鏁撻敓锟�??30缂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑鐐闁芥ɑ绻堥弻鐔封枔閸喗鐏嶉梺鍝勬缁捇寮婚悢鍏煎�绘慨妤�妫欓悾鍫曟⒑閼测晩鐒剧紓宥咃躬瀵鎮㈤搹鍦紲闂侀潧绻掓慨鐢告倶閸儲鈷戦柛娑橆煬濞堟洖鈹戦悙璇ц含鐎殿喛顕ч埥澶愬閻樻鍟嬫繝寰锋澘锟窖囧箯閻戣姤鐓欓柧蹇ｅ亜婵洦銇勯銏㈢闁靛牞缍佸畷姗�鍩￠崘銊ョ闂傚倷鑳剁划顖炲礉閺嵮岀劷婵炲棙鎸搁崥瑙勩亜閹烘垵顏柣鎾存礋閹鏁愭惔婵囧�ｉ悗瑙勬偠閸庨潧鐣烽敓鐘崇劶鐎广儱妫涢崣鍡涙⒑閸濆嫬鏆欐繛璇х畵钘熷璺侯儍娴滄粓鏌￠崶锝忔嫹閹绘帗鍎撻梻浣芥硶閸犳洖螞閸曨厾涓嶇�广儱顦壕鍧楁煕濡ゅ啫锟斤絽鈽夊Ο婊勬瀹曘劑顢欑涵閿嬪闁肩鍚�缁诲棝鏌曢崼婵囧櫤闁革絾妞介弻锝夊箻鐠鸿　鏋呴梺鍝勫閸撴繂顕ラ崟顓ㄦ嫹閿濆簼鎲鹃柛銈咁儔濮婃椽妫冮埡鍐戦梺璇″枛閸婃悂锝炶箛鎾佹椽顢旈崟顓犲幀濠电姰鍨煎▔娑㈡儔婵傚憡鍋傚ù锝堟绾捐棄霉閿濆浂鐒鹃柨鐔绘閹芥粎鍒掗弮鍌︽嫹閻㈡鐒剧�殿喖寮舵穱濠囨倷椤忓嫸鎷烽弴鐘冲床闁归偊鍣幏宄邦潩椤撶喎锟芥劖顨ラ悙鑼妞わ妇澧楅幆鏃堫敍濞戞﹩浼撻梻浣瑰缁诲倹顨ラ崨濠冩珷妞ゆ牜鍋為崐鍨叏濮楀棗骞栭柛婵囨そ閺屸�崇暆鐎ｎ剛袦婵犲痉銈呯厫闁诡垱妫冮弫宥夊礋椤忓嫬顕х紓鍌氬�搁崐鐑芥嚄閼搁潧鍨旈柟缁㈠枛缁狀垶鏌ㄩ悤鍌涘
					//psend(inviterRoleId, new STeamError(TeamError.InvitedIn30s));
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂鍛殕闁归棿绀侀拑鐔兼煥濠靛棭妲搁崶鎾椤愩垺澶勯柡灞诲姂椤㈡棃鏁撻敓锟�??30缂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑鐐闁芥ɑ绻堥弻鐔封枔閸喗鐏嶉梺鍝勬缁捇寮婚悢鍏煎�绘慨妤�妫欓悾鍫曟⒑閼测晩鐒剧紓宥咃躬瀵鎮㈤搹鍦紲闂侀潧绻掓慨鐢告倶閸儲鈷戦柛娑橆煬濞堟洖鈹戦悙璇ц含鐎殿喛顕ч埥澶愬閻樻鍟嬫繝寰锋澘锟窖囧箯閻戣姤鐓欓柧蹇ｅ亜婵洦銇勯銏㈢闁靛牞缍佸畷姗�鍩￠崘銊ョ闂傚倷鑳剁划顖炲礉閺嵮岀劷婵炲棙鎸搁崥瑙勩亜閹烘垵顏柣鎾存礋閹鏁愭惔婵囧�ｉ悗瑙勬偠閸庨潧鐣烽敓鐘崇劶鐎广儱妫涢崣鍡涙⒑閸濆嫬鏆欐繛璇х畵钘熷璺侯儍娴滄粓鏌￠崶锝忔嫹閹绘帗鍎撻梻浣芥硶閸犳洖螞閸曨厾涓嶇�广儱顦壕鍧楁煕濡ゅ啫锟斤絽鈽夊Ο婊勬瀹曘劑顢欑涵閿嬪闁肩鍚�缁诲棝鏌曢崼婵囧櫤闁革絾妞介弻锝夊箻鐠鸿　鏋呴梺鍝勫閸撴繂顕ラ崟顓ㄦ嫹閿濆簼鎲鹃柛銈咁儔濮婃椽妫冮埡鍐戦梺璇″枛閸婃悂锝炶箛鎾佹椽顢旈崟顓犲幀濠电姰鍨煎▔娑㈡儔婵傚憡鍋傚ù锝堟绾捐棄霉閿濆浂鐒鹃柨鐔绘閹芥粎鍒掗弮鍌︽嫹閻㈡鐒剧�殿喖寮舵穱濠囨倷椤忓嫸鎷烽弴鐘冲床闁归偊鍣幏宄邦潩椤撶喎锟芥劖顨ラ悙鑼妞わ妇澧楅幆鏃堫敍濞戞﹩浼撻梻浣瑰缁诲倹顨ラ崨濠冩珷妞ゆ牜鍋為崐鍨叏濮楀棗骞栭柛婵囨そ閺屸�崇暆鐎ｎ剛袦婵犲痉銈呯厫闁诡垱妫冮弫宥夊礋椤忓嫬顕х紓鍌氬�搁崐鐑芥嚄閼搁潧鍨旈柟缁㈠枛缁狀垶鏌ㄩ悤鍌涘,invitedRoleId: "+invitedRoleId);
					fire.pb.talk.MessageMgr.psendMsgNotify(inviterRoleId, 141050, null);
				}
				else if(team != null)
				{
					//Team team = new Team(inviterTeamId,false);
					//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍥煏韫囨洖啸闁挎稓鍠栧娲捶椤撯剝顎楅梺鍝ュУ閻楃姴鐣烽妷褎鍠嗛柛鏇ㄥ幘閻﹀牊绻濋悽闈浶㈤柛濠勭帛閺呰泛鈽夐姀锛勫帗闂備礁鐏濋鍡楃暦瀹�鍕厸鐎癸拷鐎ｎ剛袦閻庢鍣崜鐔风暦瑜版帩鏁嬮柛娑卞枟椤旀垹绱撻崒姘拷椋庢閵堝绠�瑰嫭澹嬮弨浠嬫煟濡搫绾у璺哄閺岋綁骞樼捄鐑樼亪闂佸搫鏈ú妯兼崲濞戙垹鍨傛い鏃傚帶椤挻淇婇悙顏勶拷鏇灻瑰璺虹煑闁告劦鍠栭拑鐔哥箾閹寸偟鎳呯紒鈽呮嫹闂備胶顭堢悮顐﹀磹閺囥垹绀堥柟鎯板Г閳锋垿鏌ｉ悢鍛婄凡婵炲牃鏅犻弻鐔煎礄閵堝棗顏�?
					if(!checkInviterIsLeader(inviterRoleId, team))
					{
						//闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ｇ矆閸喓绠鹃柟瀛樼懃閻忣亪鏌涚�Ｑ冨⒉缂佺粯绻堝Λ鍐ㄢ槈閸楃偛澹夐梻浣虹帛閹稿鎯勯鐐茶摕婵炴垯鍨归崡鎶芥煏韫囧﹤澧查梺娆惧弮濮婅櫣鎷犻弻銉у椽闂傚倸瀚�氼厾绮氭潏銊х瘈闁告洦鍓欓悵浼存偡濠婂啰绠婚柟顕�绠栧畷褰掝敃閿濆懎浼庡┑鐘垫暩婵鎹㈤幋鐙呮嫹濮樼偓瀚�?(illegal)
						TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ｇ矆閸喓绠鹃柟瀛樼懃閻忣亪鏌涚�Ｑ冨⒉缂佺粯绻堝Λ鍐ㄢ槈閸楃偛澹夐梻浣虹帛閹稿鎯勯鐐茶摕婵炴垯鍨归崡鎶芥煏韫囧﹤澧查梺娆惧弮濮婅櫣鎷犻弻銉у椽闂傚倸瀚�氼厾绮氭潏銊х瘈闁告洦鍓欓悵浼存偡濠婂啰绠婚柟顕�绠栧畷褰掝敃閿濆懎浼庡┑鐘垫暩婵鎹㈤幋鐙呮嫹濮樼偓瀚�?,RoleId: "+inviterRoleId);
					}
					else if(!checkTeamNotFull(team))
					{
						//闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄩ懗鍫曀囪閳规垿鍩ラ崱妤冧户缂傚倸绉寸粔褰掑极閹邦厼绶為悗锝庡亝閻濇洟姊绘担钘壭撻柨姘亜閿旇法鐭欑�规洜鏁绘俊鑸靛緞鐎ｎ亷鎷烽崹顐闁绘劘灏欐禒銏ゆ煕閺冿拷绾板秵绌辨繝鍥舵晝闁挎繂瀛╅悾鐑芥⒑闁稓鈹掗柛鏃�鍨块妴浣肝旈崨顔芥婵炲濮撮鍡欑不閹烘鈷掑ù锝堝Г绾爼鏌涢敐蹇曠暤妤犵偛绻橀弫鎾绘晸閿燂拷?
						psendWhileCommit(inviterRoleId, new STeamError(TeamError.TeamFull));
						TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄩ懗鍫曀囪閳规垿鍩ラ崱妤冧户缂傚倸绉寸粔褰掑极閹邦厼绶為悗锝庡亝閻濇洟姊绘担钘壭撻柨姘亜閿旇法鐭欑�规洜鏁绘俊鑸靛緞鐎ｎ亷鎷烽崹顐闁绘劘灏欐禒銏ゆ煕閺冿拷绾板秵绌辨繝鍥舵晝闁挎繂瀛╅悾鐑芥⒑闁稓鈹掗柛鏃�鍨块妴浣肝旈崨顔芥婵炲濮撮鍡欑不閹烘鈷掑ù锝堝Г绾爼鏌涢敐蹇曠暤妤犵偛绻橀弫鎾绘晸閿燂拷?,TeamId: "+inviterTeamId);
					}
					else if(!checkTeamFilter(team, invitedRoleId))
					{
						TeamManager.logger.debug("FAIL:TeamFilter闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓绨绘俊鐐�栫敮鎺楀磹缂佹鈻旂�广儱顦伴悡娆撳级閸繂鈷旈柣锝堜含缁辨帡骞囬褎鐤侀梺鍝勮閸旀垿骞冮妶澶婄＜婵炴垶锕╂导锟�,TeamId: "+inviterTeamId);
					}
					else if(!checkTeamInviteNotFull(team))
					{
						//闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄩ懗鍫曀囪閳规垿鍩ラ崱妤冧户缂傚倸绉寸粔褰掑极閹邦厼绶為悗锝庡亝閻濇洟姊绘担钘壭撻柨姘亜閿旇法鐭欑�规洜鏁绘俊鑸靛緞鐎ｎ亷鎷烽崹顐闁绘劘灏欐禒銏ゆ煕閺冿拷绾板秶鎹㈠☉姘珰鐟滃繘鎮鹃悽鍛婄厵妞ゆ梹鍎虫禍鐐箾閻撳海绠诲┑鈩冩倐閺佸啴鏁撻挊澶樺殨闁割煈鍠掗弨浠嬫煟濡灝鐨哄ù鐘崇洴閺岀喖骞栨担铏规毇閻庤娲樺畝鎼佸箖瑜斿畷濂稿閵忋垺顫岄梻鍌欐祰濞夋洟宕板鍥у灊婵炲棙鎸堕敓鎴掔窔瀵噣宕煎┑瀣暪闂備胶绮弻銊╁箹椤愶絾鍙忛柨鐕傛嫹?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滈悡娑樏归敐鍥舵殰闁归鍏橀獮鎺懳旀担闀愮敾闂傚倸鍊搁悧鍡涙偉閵忋倕绀嬫い鎰╁�楅悰顕�姊绘担鍝ョШ闁稿锕畷婊冾潩閼搁潧锟藉灚銇勯幒鎴濐仾闁抽攱鍨块弻锝夋偄閸涘﹦鍑″┑鈩冨絻椤兘寮婚敓鐘查唶妞ゆ劑鍨归埛澶愭⒑闂堟稒澶勯柛鏃�锕㈣棟鐟滅増甯楅悡娑㈡倶閻愭彃鈷旀繛鍙夋尦閺屸剝鎷呯憴鍕３闂佽桨鐒﹂幑鍥极閹剧粯鏅搁柨鐕傛嫹?4濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨偓鎷锋繝姘ワ拷鍛村箵閹烘繃瀵岄柣搴秵娴滄粓顢楅姀掳浜滄い鎰剁稻缁�鍐磼缂佹绠炴俊顐㈠暙閳藉鈻庤箛鏇犲春闂傚倷绀佺壕顓犲垝椤栨凹娼栧┑鐘崇閺呮悂鏌﹀Ο渚Ш闁伙綆鍙冮弻娑欐償閵娿倖鍠氶梺璇″暙閸パ冭�垮┑鐐村灦閿氶柛瀣Ч濮婃椽宕烽鈩冾�楅梺鍝ュУ椤ㄥ﹪骞冮敓鐘插嵆闁靛骏绱曢崢鐢告⒒娓氬洤寮跨紒鐘冲灦閺呰埖瀵奸弶鎴炵�梺鍓插亖閸庢煡鍩涢幋鐘电＜閻庯綆浜滈惃锛勶拷瑙勬偠閸庢煡濡甸崟顖氱婵犻潧娲ら弸鐘参旈悩闈涗粶缂佺粯锕㈤獮鍐煛閸愵亞锛滃┑鈽嗗灣閸樠冾嚕閹惰姤鈷戦悹鍥ㄥ絻閸よ京绱撳鍛棦鐎规洘鍨垮畷鍗炩槈濡⒈妲遍梻浣稿悑娴滀粙宕曞畷鍥уК闁跨喕妫勯—鍐Χ鎼粹�茶埅闂佸摜濮甸〃鍫ユ晸閼恒儳鍟查柟鍑ゆ嫹?
						psend(inviterRoleId, new STeamError(TeamError.InviteingsFull));
						TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄩ懗鍫曀囪閳规垿鍩ラ崱妤冧户缂傚倸绉寸粔褰掑极閹邦厼绶為悗锝庡亝閻濇洟姊绘担钘壭撻柨姘亜閿旇法鐭欑�规洜鏁绘俊鑸靛緞鐎ｎ亷鎷烽崹顐闁绘劘灏欐禒銏ゆ煕閺冿拷绾板秶鎹㈠☉姘珰鐟滃繘鎮鹃悽鍛婄厵妞ゆ梹鍎虫禍鐐箾閻撳海绠诲┑鈩冩倐閺佸啴鏁撻挊澶樺殨闁割煈鍠掗弨浠嬫煟濡灝鐨哄ù鐘崇洴閺岀喖骞栨担铏规毇閻庤娲樺畝鎼佸箖瑜斿畷濂稿閵忋垺顫岄梻鍌欐祰濞夋洟宕板鍥у灊婵炲棙鎸堕敓鎴掔窔瀵噣宕煎┑瀣暪闂備胶绮弻銊╁箹椤愶絾鍙忛柨鐕傛嫹?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滈悡娑樏归敐鍥舵殰闁归鍏橀獮鎺懳旀担闀愮敾闂傚倸鍊搁悧鍡涙偉閵忋倕绀嬫い鎰╁�楅悰顕�姊绘担鍝ョШ闁稿锕畷婊冾潩閼搁潧锟藉灚銇勯幒鎴濐仾闁抽攱鍨块弻锝夋偄閸涘﹦鍑″┑鈩冨絻椤兘寮婚敓鐘查唶妞ゆ劑鍨归埛澶愭⒑闂堟稒澶勯柛鏃�锕㈣棟鐟滅増甯楅悡娑㈡倶閻愭彃鈷旀繛鍙夋尦閺屸剝鎷呯憴鍕３闂佽桨鐒﹂幑鍥极閹剧粯鏅搁柨鐕傛嫹?4濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨偓鎷锋繝姘ワ拷鍛村箵閹烘繃瀵岄柣搴秵娴滄粓顢楅姀掳浜滄い鎰剁稻缁�鍐磼缂佹绠炴俊顐㈠暙閳藉鈻庤箛鏇犲春闂傚倷绀佺壕顓犲垝椤栨凹娼栧┑鐘崇閺呮悂鏌﹀Ο渚Ш闁伙綆鍙冮弻娑欐償閵娿倖鍠氶梺璇″暙閸パ冭�垮┑鐐村灦閿氶柛瀣Ч濮婃椽宕烽鈩冾�楅梺鍝ュУ椤ㄥ﹪骞冮敓鐘插嵆闁靛骏绱曢崢鐢告⒒娓氬洤寮跨紒鐘冲灦閺呰埖瀵奸弶鎴炵�梺鍓插亖閸庢煡鍩涢幋鐘电＜閻庯綆浜滈惃锛勶拷瑙勬偠閸庢煡濡甸崟顖氱婵犻潧娲ら弸鐘参旈悩闈涗粶缂佺粯锕㈤獮鍐煛閸愵亞锛滃┑鈽嗗灣閸樠冾嚕閹惰姤鈷戦悹鍥ㄥ絻閸よ京绱撳鍛棦鐎规洘鍨垮畷鍗炩槈濡⒈妲遍梻浣稿悑娴滀粙宕曞畷鍥уК闁跨喕妫勯—鍐Χ鎼粹�茶埅闂佸摜濮甸〃鍫ユ晸閼恒儳鍟查柟鍑ゆ嫹?,TeamId: "+inviterTeamId);
					}
					else if(!checkTeamLeaderState(inviterRoleId))
					{
						//闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄩ懗鍫曀囪閳规垿鍩ラ崱妤冧户缂傚倸绉寸粔褰掑极閹邦厼绶為悗锝庡亝閻濇洟姊绘担钘壭撻柨姘亜閿旇法鐭欑�规洜鏁绘俊鑸靛緞鐎ｎ亷鎷烽崹顐闁绘劘灏欐禒銏ゆ煕閺冿拷绾板秶鎹㈠☉姘珰鐟滃繘鎮鹃悽鍛婄厵妞ゆ梹鍎虫禍鐐箾閻撳海绠诲┑鈩冩倐閺佸啴鏁撻挊澶樺殨闁割煈鍠掗弨浠嬫煟濡灝鐨哄ù鐘崇洴閺岀喖骞栨担铏规毇閻庤娲樺畝鎼佸箖瑜斿畷濂稿閵忋垺顫岄梻鍌欐祰濞夋洟宕板鍥у灊婵炲棙鎸堕敓鎴掔窔瀵噣宕煎┑瀣暪闂備胶绮弻銊╁箹椤愶絾鍙忛柨鐕傛嫹?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滈悡娑樏归敐鍥舵殰闁归鍏橀獮鎺懳旀担闀愮敾闂傚倸鍊搁悧鍡涙偉閵忋倕绀嬫い鎰╁�楅悰顕�姊绘担鍝ョШ闁稿锕畷婊冾潩閼搁潧锟藉灚銇勯幒鎴濐仾闁抽攱鍨块弻锝夋偄閸涘﹦鍑″┑鈩冨絻椤兘寮婚敓鐘查唶妞ゆ劑鍨归埛澶愭⒑闂堟稒澶勯柛鏃�锕㈣棟鐟滅増甯楅悡娑㈡倶閻愭彃鈷旀繛鍙夋尦閺屸剝鎷呯憴鍕３闂佽桨鐒﹂幑鍥极閹剧粯鏅搁柨鐕傛嫹?4濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨偓鎷锋繝姘ワ拷鍛村箵閹烘繃瀵岄柣搴秵娴滄粓顢楅姀掳浜滄い鎰剁稻缁�鍐磼缂佹绠炴俊顐㈠暙閳藉鈻庤箛鏇犲春闂傚倷绀佺壕顓犲垝椤栨凹娼栧┑鐘崇閺呮悂鏌﹀Ο渚Ш闁伙綆鍙冮弻娑欐償閵娿倖鍠氶梺璇″暙閸パ冭�垮┑鐐村灦閿氶柛瀣Ч濮婃椽宕烽鈩冾�楅梺鍝ュУ椤ㄥ﹪骞冮敓鐘插嵆闁靛骏绱曢崢鐢告⒒娓氬洤寮跨紒鐘冲灦閺呰埖瀵奸弶鎴炵�梺鍓插亖閸庢煡鍩涢幋鐘电＜閻庯綆浜滈惃锛勶拷瑙勬偠閸庢煡濡甸崟顖氱婵犻潧娲ら弸鐘参旈悩闈涗粶缂佺粯锕㈤獮鍐煛閸愵亞锛滃┑鈽嗗灣閸樠冾嚕閹惰姤鈷戦悹鍥ㄥ絻閸よ京绱撳鍛棦鐎规洘鍨垮畷鍗炩槈濡⒈妲遍梻浣稿悑娴滀粙宕曞畷鍥уК闁跨喕妫勯—鍐Χ鎼粹�茶埅闂佸摜濮甸〃鍫ユ晸閼恒儳鍟查柟鍑ゆ嫹?
						//psend(inviterRoleId, new STeamError(TeamError.InviteingsFull));
						TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈滈柡灞革拷鎰佸悑閹肩补锟藉磭顔愭繝娈垮枦椤鎮￠垾鎰佸殨闁割偅娲栭柋鍥ㄣ亜閹板灚绶氱紒銊ョ摠缁绘稓锟芥稒顭囬惌濠勭磽瀹ュ拑韬�殿喖顭烽幃銏ゆ偂鎼达絿鏆伴柣鐔哥矊缁夌懓顕ｉ搹顐ｇ秶闁靛绲肩花濠氭⒑闂堟稓澧曢柟鍐茬箻瀹曠敻宕堕浣哄幐閻庣櫢鎷烽悗锝庡墮閸╁矂鏌ф导娆戠М闁哄本鐩垾锕傚箣濠靛洨浜鹃梻浣告啞閿曨偊骞忛敓锟�?婵犵數濮烽弫鎼佸磻閻樿绠垫い蹇撴缁�濠傘�掑鐐闁芥鍠栭弻鐔煎礈瑜忕敮娑㈡煕鐎Ｑ冨⒉缂佺粯绻堝Λ鍐ㄢ槈閸楃偛澹夐梻浣虹帛閹哥偓绻涢敓浠嬫煛鐏炲墽顬肩紒鐘崇洴楠炴﹢寮堕幋鐑嗕槐闂傚倷鐒﹀鍧楀储娴犲鍋￠柍鍝勬噹閽冪喐绻涢幋鐐垫噮缂佲槄鎷烽梻浣侯焾鐞氼偊宕愰弴銏犵闁规儼濮ら埛鎴犳喐閻楀牆淇俊顐ｅ灥閳规垿鎮滈崶銊ヮ伓闂佽瀛╅鏍窗濡ゅ懎绠栭柛宀�鍋涢弸渚�鏌熼崜褏甯涢柡鍛倐閺屻劑鎮ら崒娑橆伓??");
					}
					else{
						if(!checkMap()){
							return false;
						}
						
						TeamManager.logger.debug("SUCC:婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌熺紒銏犳灈闁绘挾鍠栭弻鏇熷緞閸℃ɑ鐝旈柛銉︽尦濮婃椽宕ㄦ繝浣虹箒闂佸憡眉缁瑩骞冨锟藉畷鍗炩槈濞嗗本瀚藉┑鐐舵彧缁蹭粙骞夐敓鐘茬畾闁割偆鍠嗘禍婊堟煥閺冨浂鍤欏ù婊�鍗抽弻鈩冩媴鐟欏嫬纾抽梺鍦焾閿曘儱顕ラ崟顒傜瘈闁告洦鍨冲畷婊冣攽閿涘嫬浜奸柛濠冪墵瀹曟繈骞掗弬鍨亰濠电偛妫欓幐鎼佹嫅閻斿吋鐓忓┑鐐茬仢閸旀淇婇幓鎺斿濞ｅ洤锕、娑橆潩閸欐妾告俊鐐�曞ù姘跺矗閸愵喖绠栫�瑰嫰鍋婇悡銉╂煕閺囥劌澧伴柛鎴節閹鈻撻崹顔界亪婵犫拃鍐╂崳闁告帗甯為敓鏂ょ秵閸犳牜绮婚搹顐＄箚闁靛牆绻戠�氬綊鏌涢悜鍡楃仸婵﹥妞藉Λ鍐ㄢ槈鏉堛剱銈夋⒑缁嬪潡顎楅柛鐔锋健閹儳鈹戦崱蹇旑潔闂侀潧绻嗗褔骞忓ú顏呪拺闁告稑锕﹂埥澶愭煥閺囨ê锟芥繈骞冨锟介弫鍌炲箣閹烘梻鐣鹃梻浣虹帛閸旀﹢宕洪弽顓勫寰勯幇顒傤攨闂備緡鍓欑粔鐢告偂閵夆晜鐓涢柛鎰╁妽婢跺嫭銇勯妷銉Ч闁靛洤瀚板鎾灳閹绘帗鍎撻梻浣芥硶閸犳洖螞閸曨厾涓嶇�广儱顦壕鍧楁⒑椤掞拷閸楁洟宕堕澶嬫櫖闂佺粯鍔曢悺銊モ枍閵忋倖鈷戦柤鎭掑剭椤忓煻鍥ㄧ鐎ｎ亞锛熼梺纭呮彧闂勫嫰鎮″▎鎾寸厱闁瑰瓨鐟ラ敓鑺ョ墱閿熻姤鐔幏锟�? "+inviterTeamId);
						// 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌熺紒銏犳灈闁绘挾鍠栭弻鏇熷緞閸℃ɑ鐝旈柛銉︽尦濮婃椽宕ㄦ繝浣虹箒闂佸憡眉缁瑩骞冨锟藉畷鍗炩槈濞嗗本瀚藉┑鐐舵彧缁蹭粙骞夐敓鐘茬畾闁割偆鍠嗘禍婊堟煥閺冨浂鍤欏ù婊�鍗抽弻鈩冩媴鐟欏嫬纾抽梺鍦焾閿曘儱顕ラ崟顒傜瘈闁告洦鍨冲畷婊冣攽閿涘嫬浜奸柛濠冪墵瀹曟繈骞掗弬鍨亰濠电偛妫欓幐鎼佹嫅閻斿吋鐓忓┑鐐茬仢閸旀淇婇幓鎺斿濞ｅ洤锕、娑橆潩閸欐妾告俊鐐�曞ù姘跺矗閸愵喖绠栫�瑰嫰鍋婇悡銉╂煕閺囥劌澧伴柛鎴節閹鈻撻崹顔界亪婵犫拃鍐╂崳闁告帗甯為敓鏂ょ秵閸犳牜绮婚搹顐＄箚闁靛牆绻戠�氬綊鏌涢悜鍡楃仸婵﹥妞藉Λ鍐ㄢ槈鏉堛剱銈夋⒑缁嬪潡顎楅柛鐔锋健閹儳鈹戦崱蹇旑潔闂侀潧绻嗗褔骞忓ú顏呪拺闁告稑锕﹂埥澶愭煥閺囨ê锟芥繈骞冨锟介弫鍌炲箣閹烘梻鐣鹃梻浣虹帛閸旀﹢宕洪弽顓勫寰勯幇顒傤攨闂備緡鍓欑粔鐢告偂閵夆晜鐓涢柛鎰╁妽婢跺嫭銇勯妷銉Ч闁靛洤瀚板鎾灳閹绘帗鍎撻梻浣芥硶閸犳洖螞閸曨厾涓嶇�广儱顦壕鍧楁⒑椤掞拷閸楁洟宕堕澶嬫櫖闂佺粯鍔曢悺銊モ枍閵忋倖鈷戦柤鎭掑剭椤忓煻鍥ㄧ鐎ｎ亞锛熼梺纭呮彧闂勫嫰鎮″▎鎾寸厱闁瑰瓨鐟ラ敓鑺ョ墱閿熻姤鐔幏锟�?
						SInviteJoinTeam snd = new SInviteJoinTeam();
						snd.op = 0;
						snd.invitername = xtable.Properties.get(inviterRoleId).getRolename();
						snd.inviterlevel = xtable.Properties.get(inviterRoleId).getLevel();
						// 濠电姷鏁告慨鐑藉极閹间礁纾块柟瀵稿Т缁躲倝鏌﹀Ο渚＆婵炲樊浜濋弲婊堟煟閹伴潧澧幖鏉戯躬濮婅櫣绮欑捄銊т紘闂佺顑囬崑銈呯暦閹达箑围濠㈣泛顑囬崢顏呯節閻㈤潧浠ч柛瀣尭閳诲秹宕卞☉娆戝幗闂佺娅ｉ崑鐐碉拷姘炬嫹?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亜閸ㄦ棃鏌熺紒銏犳灈缂佺媭鍨堕弻銊╂偆閸屾稑顏�?,闂傚倸鍊搁崐椋庣矆娓氾拷楠炴牠顢曚綅閸ヮ剦鏁冮柨鏇嫹闁汇倗鍋撶换婵囩節閸屾粌顤�闂佺顑戠换婵嬪蓟瀹ュ浼犻柛鏇ㄥ墮濞咃綁姊婚崒姘簽闁搞劏娉涢～蹇撁洪鍕�銈嗘礀閹冲酣宕滈幎鑺モ拺鐎规洖娲ㄧ敮娑欐叏婵犲偆鐓奸柡浣规崌閹稿﹥寰勫畝锟介弳娑㈡⒑缁嬪潡顎楃�规洦鍓涢崣鍛存⒑閹稿孩绀�闁稿﹦顭堟晥闁哄被鍎抽崣鎾绘煕閵夛絽濡块柍鍙ョ窔閺屾稒绻濋崟顒佹瘓闂佽鍠栭崲鏌ュ煝鎼淬倗鐤�闁瑰灝鍟╃槐鎴炰繆閻愵亜锟窖呭緤閽樺鍤曢柤鍝ユ暩閳瑰秴鈹戦悩鍙夊闁稿﹦鍏橀弻鐔虹磼濡椽鍤嬮梺褰掝棑閸忔ê鐣疯ぐ鎺濇晩闁绘劦鍓氶鏇㈡⒒娴ｇ瓔娼愰柛搴ゅ椤ｉ箖姊虹捄銊ユ瀾闁哄宕电划濠氬箻閼姐倕绁﹂梺鍦劋椤ㄥ懐鐚惧澶嬬厱閻忕偠顕ч敓鑺ョ墪閺嗏晠姊婚崒姘拷鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢绘俊鐐�栭悧婊堝磻濞戙垹鍨傞柛灞剧◤娴滄粓鏌″鍐ㄥ闁靛棙甯楅妵鍕煛閸屾粌寮ㄩ梺鍝勭灱閸犳牠骞冨鍏剧喖鎮滈埡鍌氼伕闂傚倷鑳堕…鍫ヮ敄閸℃稒鍋嬫俊銈呮噹妗呴梺鍛婃处閸ㄦ壆绮诲☉銏＄厓閺夌偞濯介崗灞矫归悩灞傚仮闁诡喛娉涢～婵嬪础閻愬浜繝娈垮枛閿曘儱顪冮挊澶屾殾妞ゆ劧绠戠粈瀣亜閹伴潧澧悗姘辨嚀閳规垿鎮╃�圭姴顥濈紓浣哄Х婵烇拷闁哄瞼鍠栭獮鎴﹀箛椤掑倸甯挎俊鐐�ら崑鍛洪悢鐓庤摕鐎广儱顦敮閻熸粌绉电粋鎺懨洪鍛弳闂佺粯妫侀褑顣块梺姹囧焺閸亪鏁撻挊澶岋紞闁哄棴绠撻弻鏇熺箾瑜嶇粔鐢碉拷姘愁潐缁绘盯骞嬮悙鍨櫧闂佺粯甯為弲顐﹀箟閸濄儲鏆滄い鏃囨椤忥拷
						//濠电姷鏁告慨鐑藉极閹间礁纾块柟瀵稿Т缁躲倝鏌﹀Ο渚＆婵炲樊浜濋弲婊堟煟閹伴潧澧幖鏉戯躬濮婅櫣绮欑捄銊т紘闂佺顑囬崑銈呯暦閹达箑围濠㈣泛顑囬崢顏呯節閻㈤潧浠ч柛瀣尭閳诲秹宕卞☉娆戝幗闂佺娅ｉ崑鐐碉拷姘炬嫹?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滃洿婵犮垼娉涢敃銈囪姳閵夆晜鈷戦柛婵嗗椤箓鏌涙惔銊ゆ喚鐎殿喕鍗虫俊鐤檪闁归鍏橀幆鍌炲川婵犲偆浼撻梻鍌欑閹测�趁洪敃鍌氱婵鎷锋鐐村姍閺佹挻绂掔�ｎ偀鎷绘繛杈剧秬濞咃絿鏁☉銏＄厸閻忕偠顕ф俊浠嬫煛閸涙澘鐓愰柟顖涙閺佹劙宕堕埡鍐ㄥЦ闂傚倷娴囧▔鏇㈠闯閿曞倸绠柨鐕傛嫹
						team.getTeamInfo().getInvitingids().put(invitedRoleId,now);
						//濠电姷鏁告慨鐑藉极閹间礁纾块柟瀵稿Т缁躲倝鏌﹀Ο渚＆婵炲樊浜濋弲婊堟煟閹伴潧澧幖鏉戯躬濮婅櫣绮欑捄銊т紘闂佺顑囬崑銈呯暦閹达箑围濠㈣泛顑囬崢顏呯節閻㈤潧浠ч柛瀣尭閳诲秹宕卞☉娆戝幗闂佺娅ｉ崑鐐碉拷姘炬嫹?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滃洿婵犮垼娉涢敃銈囪姳閵夆晜鈷戦柛婵嗗椤箓鏌涙惔銊ゆ喚鐎殿喕鍗虫俊鐤檪闁归鍏橀幆鍌炲川婵犲偆浼撻梻鍌欐祰濞夋洟宕板鍥у灊婵炲棙鎸惧畵渚�鏌涢幇闈涙珮闁轰礁顑夐弻銊╂偄閸撲胶鐓撻梺闈涙缁舵艾顕ｉ幘顔碱潊闁斥晛鍟悵鏍⒒娴ｈ姤纭堕柛鐘茬Ф閸掓帒鈻庨幘铏�梺鐟板⒔缁垳锟界數濮撮…鍧楁嚋瀵版浜畷婊堝箮閼恒儮鎷洪悷婊呭鐢晛螞閹存績鏀介柣鎴濇处鐎氬綊姊绘担绛嬪殐闁哥姵鐗曢…鍥晸閻橆噯鎷锋担绯曟婵妫欏娲⒑閸撴彃浜為柛鐘查叄椤㈡棃宕奸弴鐔叉嫼闂佸憡绋戦敃銈嗘叏閿曞倹鐓曢柣妯诲墯濞堟粎锟芥鍠楅悡锟犮�佸Δ鍛妞ゆ帪鎷烽柨鐔绘閻栧ジ寮婚敐澶婄疀妞ゆ牗姘ㄩ崢顐㈩渻閵堝啫鍔氭い锔炬暬楠炲啯绂掔�ｅ灚鏅┑鈽嗗灠閹碱偅鎱ㄩ敃鍌涒拺闁告繂瀚悞璺ㄧ磽瀹ュ嫮绐旈柕鍡曠窔瀵噣宕煎┑鍫Ч闂傚倸鍊搁悧濠勭矙閹寸偟鐝剁�广儱妫旂换鍡涙煟閹板吀绨婚柨鐔奉潟閸婃繂鐣烽幋锕�绠婚柛鎾叉缁楀姊虹憴鍕妞ゆ泦鍥ㄥ珔闁绘柨鍚嬮悡銉╂煟閺囩偛锟藉湱锟芥熬鎷�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄥ垂閸岀偞鈷戞い鎺炴嫹缂佸鏁诲畷鎴﹀煛閸涱喒鎷哄銈嗗釜閹烽绱掓径灞炬毈闁糕晜鐩獮瀣晜閻ｅ苯寮抽梻浣虹帛濞叉牠宕愰崷顓ㄦ嫹濮樼偓瀚�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滈悡娑樏归敐鍥舵殰闁归鍏橀獮鎺楀籍閿熶粙宕伴崱娑欑厱闁哄洢鍔岄獮鎰版煛閿熶粙鎼归銈囩槇闂佹眹鍨藉褍鐡繝鐢靛仜閻即宕愬Δ鍐ㄥ灊濠电姵鑹剧粻鎶芥煙閹冪秮缂併劌顭峰娲传閸曨厜鐘绘煕閺傚潡鍙勯柛鈺嬮檮閹峰懘鎼归崷顓犳殽闂備胶顢婇幓顏堟⒔閸曨垰鐓曢柟杈鹃檮閻撴洘绻涢幋鐑囧叕闁告梻鍠栭弻娑㈡偄鐠囪尙姣㈢紓浣介哺鐢繝骞冮埡鍛闁肩⒈鍏涚槐婵嬫煟鎼淬値娼愭繛鍙夛耿閹兘鍩￠崨顓熺�悗骞垮劚椤︻垳绮堢�ｎ喗鐓犻柟闂寸劍濞懷勩亜韫囨碍纭鹃柍瑙勫灴閹瑩寮堕幋鐘辨婵＄偑鍊曞ù姘椤忓牄锟戒線寮崼婵堫槹闂佽鍨版惔婊堝箯閻戣棄閿ゆ俊銈勮兌閸欏棝姊虹紒妯荤闁稿﹤婀遍敓鑺ョ啲閹凤拷
						xbean.InviteInfo inviteInfo = xtable.Teaminvite.get(invitedRoleId);
						if(inviteInfo == null)
						{
							inviteInfo = xbean.Pod.newInviteInfo();
							xtable.Teaminvite.add(invitedRoleId, inviteInfo);
						}
						inviteInfo.setBeinginvited(true);
						inviteInfo.getInviting().setTeamid(inviterTeamId);
						inviteInfo.getInviting().setRoleid(inviterRoleId);
						inviteInfo.getInviting().setInvitetime(now);						
						inviteInfo.getInvited().add(inviteInfo.getInviting().copy());
						psendWhileCommit(inviterRoleId, new SInviteJoinSucc(invitedRoleId));
						MessageMgr.psendMsgNotify(inviterRoleId, 142358, null);
						// 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢婚梻浣瑰濞叉牠宕愰幖浣稿瀭闁稿瞼鍋為悡銉╂煟閺囩偛锟藉湱锟芥熬鎷�?婵犵數濮烽弫鎼佸磻閻愬搫绠板┑鐘崇閸嬪嫭銇勯幒鎴濐仼缂佺媭鍨堕弻锝夊箣閿濆憛鎾绘煟閹惧瓨绀�闁宠鍨块幃鈺呭箵閹哄秶鏁栭梻浣侯焾鐎涒晠宕归崸妤�钃熼柣鏃傚帶缁�鍕煏閸繃顥滄い蹇ユ嫹?
						mkdb.Procedure.psendWhileCommit(invitedRoleId, snd);
					}
			
				} else
				{
					//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偞鐗犻、鏇氱秴闁搞儺鍓﹂弫鍥煏韫囨洖啸闁挎稓鍠栧娲捶椤撯剝顎楅梺鍝ュУ閻楃姴鐣烽妷褎鍠嗛柛鏇ㄥ幘閻﹀牊绻濋悽闈浶㈤柛濠冩倐椤㈡棃顢曢敂鐣屽帗缂傚倷鐒﹁摫闁抽攱鍔欓弻鏇㈠炊瑜嶉顒傜磼閻樺磭娲存鐐达耿閹煎綊顢曢敐搴℃暭闂傚倸鍊烽悞锕�顪冮幐搴ｎ洸婵炲棙鍨甸崹婵囩箾閸℃ɑ灏柦鍐枛閺屻劌鈹戦崱鈺傂﹂柟顖滃枛濮婃椽妫冨☉杈ㄐら梺绋挎捣閸庛倗锟介潧銈稿畷姗�顢欑憴锝嗗缂傚倷绀侀鍛焊閸涱収鍟呴柕澶涜礋娴滄粓鏌熺�涙绠栭柛鐘成戦〃銉╂倷閼碱剛顔掗梺杞扮劍閹瑰洭寮幘缁樻櫢闁跨噦鎷�?
					if(!checkSingleInviteNotFull(inviterRoleId))
					{
						//闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄦ⒒椤栨稏浜滈柡鍥朵簼鐎氬綊鎮楃憴鍕缂佽鐗撳顐﹀箻鐎靛壊娴勯柣搴秵閸嬶拷闁归攱妞藉濠氬磼濮樺崬顣甸梺鍝勬噽閸嬬喓鍒掗崼顫嫹閿濆骸鏋熼柣鎾存礋閺岋繝宕橀幐搴☆伓闂備焦鎮堕崝宀勬倶濠靛鍋╅柣鎴ｆ缁犳稒銇勯弴鐐搭棡閻庢艾缍婇弻銊モ攽閸℃侗锟芥顭胯閸ㄥ爼骞冨Δ锟介～婵嬵敇閻愬弶鎳欓梻浣告惈閻瑩宕橀悙顒�鍏婃俊鐐�栫敮顏堝箯閻戣姤鐓ラ柣鏃傜帛椤ュ绱撳鍜冭含妤犵偛妫濆畷鍫曞Ω瑜滃ù鍕煟鎼搭垳绉甸柛瀣瀹曘垽宕ㄦ繝鍕啎闁哄鐗嗘晶浠嬪箖婵傚憡鐓欓柧蹇ｅ亝瀹曞本銇勯姀鈩冨碍妞ゎ厹鍔戝畷濂告偄閸濆嫬绠ュ┑鐘垫暩閸嬬姷浜搁鍫晩濠电姴娲﹂悞鑺ャ亜閺嶃劎鐜婚柟鐑筋棑閹叉挳宕熼鍌楁晬闂備胶鎳撻崵鏍箯閿燂拷?4濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨偓鎷锋繝姘ワ拷鍛村箵閹烘繃瀵岄柣搴秵娴滄粓顢楅姀掳浜滄い鎰剁稻缁�鍐磼缂佹绠炴俊顐㈠暙閳藉鈻庤箛鏇犲春闂傚倷绀佺壕顓犲垝椤栨凹娼栧┑鐘崇閺呮悂鏌﹀Ο渚Ш闁伙綆鍙冮弻娑欐償閵娿倖鍠氶梺璇″暙閸パ冭�垮┑鐐村灦閿氶柛瀣Ч濮婃椽宕烽鈩冾�楅梺鍝ュУ椤ㄥ﹪骞冮敓鐘插嵆闁靛骏绱曢崢鐢告⒒娓氬洤寮跨紒鐘冲灦閺呰埖瀵奸弶鎴炵�梺鍓插亖閸庢煡鍩涢幋鐘电＜閻庯綆浜滈惃锛勶拷瑙勬偠閸庢煡濡甸崟顖氱婵犻潧娲ら弸鐘参旈悩闈涗粶缂佺粯锕㈤獮鍐煛閸愵亞锛滃┑鈽嗗灣閸樠冾嚕閹惰姤鈷戦悹鍥ㄥ絻閸よ京绱撳鍛棦鐎规洘鍨垮畷鍗炩槈濡⒈妲遍梻浣稿悑娴滀粙宕曞畷鍥уК闁跨喕妫勯—鍐Χ鎼粹�茶埅闂佸摜濮甸〃鍫ユ晸閼恒儳鍟查柟鍑ゆ嫹?
						psend(inviterRoleId, new STeamError(TeamError.InviteingsFull));
						TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄦ⒒椤栨稏浜滈柡鍥朵簼鐎氬綊鎮楃憴鍕缂佽鐗撳顐﹀箻鐎靛壊娴勯柣搴秵閸嬶拷闁归攱妞藉濠氬磼濮樺崬顣甸梺鍝勬噽閸嬬喓鍒掗崼顫嫹閿濆骸鏋熼柣鎾存礋閺岋繝宕橀幐搴☆伓闂備焦鎮堕崝宀勬倶濠靛鍋╅柣鎴ｆ缁犳稒銇勯弴鐐搭棡閻庢艾缍婇弻銊モ攽閸℃侗锟芥顭胯閸ㄥ爼骞冨Δ锟介～婵嬵敇閻愬弶鎳欓梻浣告惈閻瑩宕橀悙顒�鍏婃俊鐐�栫敮顏堝箯閻戣姤鐓ラ柣鏃傜帛椤ュ绱撳鍜冭含妤犵偛妫濆畷鍫曞Ω瑜滃ù鍕煟鎼搭垳绉甸柛瀣瀹曘垽宕ㄦ繝鍕啎闁哄鐗嗘晶浠嬪箖婵傚憡鐓欓柧蹇ｅ亝瀹曞本銇勯姀鈩冨碍妞ゎ厹鍔戝畷濂告偄閸濆嫬绠ュ┑鐘垫暩閸嬬姷浜搁鍫晩濠电姴娲﹂悞鑺ャ亜閺嶃劎鐜婚柟鐑筋棑閹叉挳宕熼鍌楁晬闂備胶鎳撻崵鏍箯閿燂拷?4濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨偓鎷锋繝姘ワ拷鍛村箵閹烘繃瀵岄柣搴秵娴滄粓顢楅姀掳浜滄い鎰剁稻缁�鍐磼缂佹绠炴俊顐㈠暙閳藉鈻庤箛鏇犲春闂傚倷绀佺壕顓犲垝椤栨凹娼栧┑鐘崇閺呮悂鏌﹀Ο渚Ш闁伙綆鍙冮弻娑欐償閵娿倖鍠氶梺璇″暙閸パ冭�垮┑鐐村灦閿氶柛瀣Ч濮婃椽宕烽鈩冾�楅梺鍝ュУ椤ㄥ﹪骞冮敓鐘插嵆闁靛骏绱曢崢鐢告⒒娓氬洤寮跨紒鐘冲灦閺呰埖瀵奸弶鎴炵�梺鍓插亖閸庢煡鍩涢幋鐘电＜閻庯綆浜滈惃锛勶拷瑙勬偠閸庢煡濡甸崟顖氱婵犻潧娲ら弸鐘参旈悩闈涗粶缂佺粯锕㈤獮鍐煛閸愵亞锛滃┑鈽嗗灣閸樠冾嚕閹惰姤鈷戦悹鍥ㄥ絻閸よ京绱撳鍛棦鐎规洘鍨垮畷鍗炩槈濡⒈妲遍梻浣芥硶閸ｏ箓骞忛敓锟� "+inviterRoleId);
					}
					else if(!checkTeamFilter(inviterRoleId, invitedRoleId))
					{
						TeamManager.logger.debug("FAIL:TeamFilter闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓绨绘俊鐐�栫敮鎺楀磹缂佹鈻旂�广儱顦伴悡娆撳级閸繂鈷旈柣锝堜含缁辨帡骞囬褎鐤侀梺鍝勮閸旀垿骞冮妶澶婄＜婵炴垶锕╂导锟�,TeamId: "+inviterTeamId);
					}
					else
					{
						
						if(!checkMap()){
							return false;
						}
						
						TeamManager.logger.debug("SUCC:婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌熺紒銏犳灈闁绘挾鍠栭弻鏇熷緞閸℃ɑ鐝旈柛銉︽尦濮婃椽宕ㄦ繝浣虹箒闂佸憡眉缁瑩骞冨锟藉畷鍗炩槈濞嗗本瀚藉┑鐐舵彧缁蹭粙骞夐敓鐘茬畾闁割偆鍠嗘禍婊堟煥閺冨浂鍤欏ù婊�鍗抽弻鈩冩媴鐟欏嫬纾抽梺鍦焾閿曘儱顕ラ崟顒傜瘈闁告洦鍨冲畷婊冣攽閿涘嫬浜奸柛濠冪墵瀹曟繈骞掗弬鍨亰濠电偛妫欓幐鎼佹嫅閻斿吋鐓忓┑鐐茬仢閸旀淇婇幓鎺斿濞ｅ洤锕、娑橆潩閸欐妾告俊鐐�曞ù姘跺矗閸愵喖绠栫�瑰嫰鍋婇悡銉╂煕閺囥劌澧伴柛鎴節閹鈻撻崹顔界亪婵犫拃鍐╂崳闁告帗甯為敓鏂ょ秵閸犳牜绮婚搹顐＄箚闁靛牆绻戠�氬綊鏌涢悜鍡楃仸婵﹥妞藉Λ鍐ㄢ槈鏉堛剱銈夋⒑缁嬪潡顎楅柛鐔锋健閹儳鈹戦崱蹇旑潔闂侀潧绻嗗褔骞忓ú顏呪拺闁告稑锕﹂埥澶愭煥閺囨ê锟芥繈骞冨Ο缁樼秶闁靛鍊楃粻姘攽閿涘嫬浠ч柛妯犲嫭鍙忛柛宀�鍋為悡娑㈡倶閻愯鎷烽悢濂変純婵＄偑鍊ら崢褰掑礉閹存繄鏆﹂柣鏃傗拡閺佸洨鎲告惔銊︾叆闁靛牆妫涚弧锟介梺姹囧灲濞佳勭濠婂嫪绻嗘い鏍ㄧ啲閺�鑽ょ磼閸屾氨孝妞ゎ厹鍔戝畷濂告偄閸涘浠ч梻鍌欐祰婵倝鏁嬪銈忕細缁瑥鐣烽弴銏犵闁挎梻鏅崢鐢告⒑閸涘﹤鐏熼柛濠冪墱閿熻姤鐔幏锟�? "+inviterRoleId);
						// 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌熺紒銏犳灈闁绘挾鍠栭弻鏇熷緞閸℃ɑ鐝旈柛銉︽尦濮婃椽宕ㄦ繝浣虹箒闂佸憡眉缁瑩骞冨锟藉畷鍗炩槈濞嗗本瀚藉┑鐐舵彧缁蹭粙骞夐敓鐘茬畾闁割偆鍠嗘禍婊堟煥閺冨浂鍤欏ù婊�鍗抽弻鈩冩媴鐟欏嫬纾抽梺鍦焾閿曘儱顕ラ崟顒傜瘈闁告洦鍨冲畷婊冣攽閿涘嫬浜奸柛濠冪墵瀹曟繈骞掗弬鍨亰濠电偛妫欓幐鎼佹嫅閻斿吋鐓忓┑鐐茬仢閸旀淇婇幓鎺斿濞ｅ洤锕、娑橆潩閸欐妾告俊鐐�曞ù姘跺矗閸愵喖绠栫�瑰嫰鍋婇悡銉╂煕閺囥劌澧伴柛鎴節閹鈻撻崹顔界亪婵犫拃鍐╂崳闁告帗甯為敓鏂ょ秵閸犳牜绮婚搹顐＄箚闁靛牆绻戠�氬綊鏌涢悜鍡楃仸婵﹥妞藉Λ鍐ㄢ槈鏉堛剱銈夋⒑缁嬪潡顎楅柛鐔锋健閹儳鈹戦崱蹇旑潔闂侀潧绻嗗褔骞忓ú顏呪拺闁告稑锕﹂埥澶愭煥閺囨ê锟芥繈骞冨Ο缁樼秶闁靛鍊楃粻姘攽閿涘嫬浠ч柛妯犲嫭鍙忛柛宀�鍋為悡娑㈡倶閻愯鎷烽悢濂変純婵＄偑鍊ら崢褰掑礉閹存繄鏆﹂柣鏃傗拡閺佸洨鎲告惔銊︾叆闁靛牆妫涚弧锟介梺姹囧灲濞佳勭濠婂嫪绻嗘い鏍ㄧ啲閺�鑽ょ磼閸屾氨孝妞ゎ厹鍔戝畷濂告偄閸涘浠ч梻鍌欐祰婵倝鏁嬪銈忕細缁瑥鐣烽弴銏犵闁挎梻鏅崢鐢告⒑閸涘﹤鐏熼柛濠冪墱閿熻姤鐔幏锟�?
						xbean.Properties inviterProperty = xtable.Properties.get(inviterRoleId);
						SInviteJoinTeam snd = new SInviteJoinTeam();
						snd.op = 0;
						snd.invitername = inviterProperty.getRolename();
						snd.inviterlevel = xtable.Properties.get(inviterRoleId).getLevel();
						// 濠电姷鏁告慨鐑藉极閹间礁纾块柟瀵稿Т缁躲倝鏌﹀Ο渚＆婵炲樊浜濋弲婊堟煟閹伴潧澧幖鏉戯躬濮婅櫣绮欑捄銊т紘闂佺顑囬崑銈呯暦閹达箑围濠㈣泛顑囬崢顏呯節閻㈤潧浠ч柛瀣尭閳诲秹宕卞☉娆戝幗闂佺娅ｉ崑鐐碉拷姘炬嫹?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亜閸ㄦ棃鏌熺紒銏犳灈缂佺媭鍨堕弻銊╂偆閸屾稑顏�?,闂傚倸鍊搁崐椋庣矆娓氾拷楠炴牠顢曚綅閸ヮ剦鏁冮柨鏇嫹闁汇倗鍋撶换婵囩節閸屾粌顤�闂佺顑戠换婵嬪蓟瀹ュ浼犻柛鏇ㄥ墮濞咃綁姊婚崒姘簽闁搞劏娉涢～蹇撁洪鍕�銈嗘礀閹冲酣宕滈幎鑺モ拺鐎规洖娲ㄧ敮娑欐叏婵犲偆鐓奸柡浣规崌閹稿﹥寰勫畝锟介弳娑㈡⒑缁嬪潡顎楃�规洦鍓涢崣鍛存⒑閹稿孩绀�闁稿﹦顭堟晥闁哄被鍎抽崣鎾绘煕閵夛絽濡块柍鍙ョ窔閺屾稒绻濋崟顒佹瘓闂佽鍠栭崲鏌ュ煝鎼淬倗鐤�闁瑰灝鍟╃槐鎴炰繆閻愵亜锟窖呭緤閽樺鍤曢柤鍝ユ暩閳瑰秴鈹戦悩鍙夊闁稿﹦鍏橀弻鐔虹磼濡椽鍤嬮梺褰掝棑閸忔ê鐣疯ぐ鎺濇晩闁绘劦鍓氶鏇㈡⒒娴ｇ瓔娼愰柛搴ゅ椤ｉ箖姊虹捄銊ユ瀾闁哄宕电划濠氬箻閼姐倕绁﹂梺鍦劋椤ㄥ懐鐚惧澶嬬厱閻忕偠顕ч敓鑺ョ墪閺嗏晠姊婚崒姘拷鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢绘俊鐐�栭悧婊堝磻濞戙垹鍨傞柛灞剧◤娴滄粓鏌″鍐ㄥ闁靛棙甯楅妵鍕煛閸屾粌寮ㄩ梺鍝勭灱閸犳牠骞冨鍏剧喖鎮滈埡鍌氼伕闂傚倷鑳堕…鍫ヮ敄閸℃稒鍋嬫俊銈呮噹妗呴梺鍛婃处閸ㄦ壆绮诲☉銏＄厓閺夌偞濯介崗灞矫归悩灞傚仮闁诡喛娉涢～婵嬪础閻愬浜繝娈垮枛閿曘儱顪冮挊澶屾殾妞ゆ劧绠戠粈瀣亜閹伴潧澧悗姘辨嚀閳规垿鎮╃�圭姴顥濈紓浣哄Х婵烇拷闁哄瞼鍠栭獮鎴﹀箛椤掑倸甯挎俊鐐�ら崑鍛洪悢鐓庤摕鐎广儱顦敮閻熸粌绉电粋鎺懨洪鍛弳闂佺粯妫侀褑顣块梺姹囧焺閸亪鏁撻挊澶岋紞闁哄棴绠撻弻鏇熺箾瑜嶇粔鐢碉拷姘愁潐缁绘盯骞嬮悙鍨櫧闂佺粯甯為弲顐﹀箟閸濄儲鏆滄い鏃囨椤忥拷
						//濠电姷鏁告慨鐑藉极閹间礁纾块柟瀵稿Т缁躲倝鏌﹀Ο渚＆婵炲樊浜濋弲婊堟煟閹伴潧澧幖鏉戯躬濮婅櫣绮欑捄銊т紘闂佺顑囬崑銈呯暦閹达箑围濠㈣泛顑囬崢顏呯節閻㈤潧浠ч柛瀣尭閳诲秹宕卞☉娆戝幗闂佺娅ｉ崑鐐碉拷姘炬嫹?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滃洿婵犮垼娉涢敃銈囪姳閵夆晜鈷戦柛婵嗗椤箓鏌涙惔銊ゆ喚鐎殿喕鍗虫俊鐑藉煛閸屾熬鎷烽崼鏇熺厽闁归偊鍘肩徊濠氭煃闁垮顥堥柡灞界Ф缁辨帒螣閻戔晜瀚婚梻渚�娼уú銈囷拷姘煎灣缁鈽夐姀鐘殿啋闂佹儳娴氶崑鍛搭敊婢舵劖鈷掑ù锝堫潐閵囩喎霉濠婂嫮鎳呴柛鎺撳笒閳诲氦绠涢敐鍡欑▉婵犵數鍋涘Ο濠冪濠靛鐤鹃柟闂寸劍閻撱儵鏌ｉ弴鐐诧拷鍦拷姘炬嫹?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囩喓绡�闁靛骏绲介悡鎰版煕閺冿拷濞叉繄鎹㈠鑸碘拻濞达綀濮ょ涵鍫曟煕閿濆繒鐣垫鐐茬箻閺佹捇鏁撻敓锟�
						xbean.SingleInvitings singleInvitings = xtable.Singleinviting.get(inviterRoleId);
						if(singleInvitings == null)
						{
							singleInvitings = xbean.Pod.newSingleInvitings();
							xtable.Singleinviting.add(inviterRoleId, singleInvitings);
						}
						singleInvitings.getInvitingids().put(invitedRoleId, now);
						//濠电姷鏁告慨鐑藉极閹间礁纾块柟瀵稿Т缁躲倝鏌﹀Ο渚＆婵炲樊浜濋弲婊堟煟閹伴潧澧幖鏉戯躬濮婅櫣绮欑捄銊т紘闂佺顑囬崑銈呯暦閹达箑围濠㈣泛顑囬崢顏呯節閻㈤潧浠ч柛瀣尭閳诲秹宕卞☉娆戝幗闂佺娅ｉ崑鐐碉拷姘炬嫹?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滃洿婵犮垼娉涢敃銈囪姳閵夆晜鈷戦柛婵嗗椤箓鏌涙惔銊ゆ喚鐎殿喕鍗虫俊鐤檪闁归鍏橀幆鍌炲川婵犲偆浼撻梻鍌欐祰濞夋洟宕板鍥у灊婵炲棙鎸惧畵渚�鏌涢幇闈涙珮闁轰礁顑夐弻銊╂偄閸撲胶鐓撻梺闈涙缁舵艾顕ｉ幘顔碱潊闁斥晛鍟悵鏍⒒娴ｈ姤纭堕柛鐘茬Ф閸掓帒鈻庨幘铏�梺鐟板⒔缁垳锟界數濮撮…鍧楁嚋瀵版浜畷婊堝箮閼恒儮鎷洪悷婊呭鐢晛螞閹存績鏀介柣鎴濇处鐎氬綊姊绘担绛嬪殐闁哥姵鐗曢…鍥晸閻橆噯鎷锋担绯曟婵妫欏娲⒑閸撴彃浜為柛鐘查叄椤㈡棃宕奸弴鐔叉嫼闂佸憡绋戦敃銈嗘叏閿曞倹鐓曢柣妯诲墯濞堟粎锟芥鍠楅悡锟犮�佸Δ鍛妞ゆ帪鎷烽柨鐔绘閻栧ジ寮婚敐澶婄疀妞ゆ牗姘ㄩ崢顐㈩渻閵堝啫鍔氭い锔炬暬楠炲啯绂掔�ｅ灚鏅┑鈽嗗灠閹碱偅鎱ㄩ敃鍌涒拺闁告繂瀚悞璺ㄧ磽瀹ュ嫮绐旈柕鍡曠窔瀵噣宕煎┑鍫Ч闂傚倸鍊搁悧濠勭矙閹寸偟鐝剁�广儱妫旂换鍡涙煟閹板吀绨婚柨鐔奉潟閸婃繂鐣烽幋锕�绠婚柛鎾叉缁楀姊虹憴鍕妞ゆ泦鍥ㄥ珔闁绘柨鍚嬮悡銉╂煟閺囩偛锟藉湱锟芥熬鎷�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄥ垂閸岀偞鈷戞い鎺炴嫹缂佸鏁诲畷鎴﹀煛閸涱喒鎷哄銈嗗釜閹烽绱掓径灞炬毈闁糕晜鐩獮瀣晜閻ｅ苯寮抽梻浣虹帛濞叉牠宕愰崷顓ㄦ嫹濮樼偓瀚�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滈悡娑樏归敐鍥舵殰闁归鍏橀獮鎺楀籍閿熶粙宕伴崱娑欑厱闁哄洢鍔岄獮鎰版煛閿熶粙鎼归銈囩槇闂佹眹鍨藉褍鐡繝鐢靛仜閻即宕愬Δ鍐ㄥ灊濠电姵鑹剧粻鎶芥煙閹冪秮缂併劌顭峰娲传閸曨厜鐘绘煕閺傚潡鍙勯柛鈺嬮檮閹峰懘鎼归崷顓犳殽闂備胶顢婇幓顏堟⒔閸曨垰鐓曢柟杈鹃檮閻撴洘绻涢幋鐑囧叕闁告梻鍠栭弻娑㈡偄鐠囪尙姣㈢紓浣介哺鐢繝骞冮埡鍛闁肩⒈鍏涚槐婵嬫煟鎼淬値娼愭繛鍙夛耿閹兘鍩￠崨顓熺�悗骞垮劚椤︻垳绮堢�ｎ喗鐓犻柟闂寸劍濞懷勩亜韫囨碍纭鹃柍瑙勫灴閹瑩寮堕幋鐘辨婵＄偑鍊曞ù姘椤忓牄锟戒線寮崼婵堫槹闂佽鍨版惔婊堝箯閻戣棄閿ゆ俊銈勮兌閸欏棝姊虹紒妯荤闁稿﹤婀遍敓鑺ョ啲閹凤拷
						xbean.InviteInfo inviteInfo = xtable.Teaminvite.get(invitedRoleId);
						if(inviteInfo == null)
						{
							inviteInfo = xbean.Pod.newInviteInfo();
							xtable.Teaminvite.add(invitedRoleId, inviteInfo);
						}
						inviteInfo.setBeinginvited(true);
						if(inviterTeamId == null)
							inviterTeamId = -1L;
						inviteInfo.getInviting().setTeamid(inviterTeamId);
						inviteInfo.getInviting().setRoleid(inviterRoleId);
						inviteInfo.getInviting().setInvitetime(now);						
						inviteInfo.getInvited().add(inviteInfo.getInviting().copy());
						
						// 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢婚梻浣瑰濞叉牠宕愰幖浣稿瀭闁稿瞼鍋為悡銉╂煟閺囩偛锟藉湱锟芥熬鎷�?婵犵數濮烽弫鎼佸磻閻愬搫绠板┑鐘崇閸嬪嫭銇勯幒鎴濐仼缂佺媭鍨堕弻锝夊箣閿濆憛鎾绘煟閹惧瓨绀�闁宠鍨块幃鈺呭箵閹哄秶鏁栭梻浣侯焾鐎涒晠宕归崸妤�钃熼柣鏃傚帶缁�鍕煏閸繃顥滄い蹇ユ嫹?
						psendWhileCommit(inviterRoleId, new SInviteJoinSucc(invitedRoleId));
						MessageMgr.psendMsgNotify(inviterRoleId, 142358, null);
						mkdb.Procedure.psendWhileCommit(invitedRoleId, snd);
					}
				}
					
				return true;
			}
			
			private boolean checkMap(){

				//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢婚梻浣瑰濞叉牠宕愰幖浣稿瀭闁稿本鍩冮弨浠嬫煕鐏炲墽鐭ら柣鎺戝⒔缁辨帡鎮╁畷鍥у绩闂佸搫琚崝宀勫煘閹达箑骞㈡慨妤�妫欓敓銉︿繆閻愵亜锟芥劙寮查鍫濈闁跨噦鎷�?
				final fire.pb.map.Role  invitMaprole = fire.pb.map.RoleManager.getInstance().getRoleByID(inviterRoleId);
				final fire.pb.map.Role  desMaprole = fire.pb.map.RoleManager.getInstance().getRoleByID(invitedRoleId);
				if(invitMaprole == null || desMaprole == null){
					return true;
				}
				int srcMapId = invitMaprole.getMapId();
				MapConfig cfg = ConfigManager.getInstance().getConf(MapConfig.class).get(srcMapId);
				
				int desMapId = desMaprole.getMapId();
				MapConfig descfg = ConfigManager.getInstance().getConf(MapConfig.class).get(desMapId);
				
				//闂傚倸鍊搁崐鎼佸磹妞嬪孩顐芥慨姗嗗墻閻掍粙鏌ゆ慨鎰拷鏍拷姘煼閺岋綁寮崒姘粯缂備緤鎷峰璺虹焿閹风兘鎯傞崨濠傤伓闂備礁鎲″ú锕傚礈濞嗘劗顩峰┑鍌氭啞閳锋垿姊婚崼鐔峰礋闁割偁鍎遍悿鐐箾閹寸偞鐨戦柣顓炴閺屾稑鐣濋敓浠嬪磻閻愮儤鍋傞煫鍥ㄦ尨閺�浠嬫煟閹邦垰鐨哄ù鐘灲閺屾盯寮敓鐣屽垝閹捐钃熸繛鎴欏灩閸楁娊鏌曡箛瀣伄闁哄棭鍋婂娲传閸曨剚鎷遍梺鐑╂櫓閸ㄨ泛顕ｉ锕�绠荤紓浣股戝▍銏ゆ⒑鐠恒劌娅愰柟鍑ゆ嫹? 濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姳鍗抽弻娑樷攽閸曨偄濮㈤梺娲诲幗閹瑰洭寮婚敐澶婎潊闁绘ê鍟块弳鍫ユ⒑缁嬫鍎忔い鎴濐樀閻涱噣寮介‖銉ラ叄椤㈡鏁撴禒瀣�块柣鎴烆焽缁犻箖鏌涢鐘茬仾婵炲懏娲熼弻銊╂偄閻戞ɑ鐝┑鐐叉噷閸ㄤ粙鐛箛娑欏�婚柤鎭掑劤閸欏棝姊虹紒妯烩拻闁稿簺鍊曢埢宥夊即閵忥紕鍘遍梺鍦劋閹稿摜绮幒鎾变簻闁规儳鍟块幃鎴狅拷鍨緲鐎氼噣鏁撻弬銈嗭拷銉╁礋椤愩倖袧?
				if(cfg == null || descfg == null){
					return true;
				}
				if(cfg.getSafemap() == descfg.getSafemap() && cfg.getSafemap() == 1){
					return true;
				}
				
				
				return true;	
			}
		};
		createTeamP.submit();
	}
	
	// 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄥ磼閵娾晜鐓熼柨婵嗘噽閻掑潡鏌熷畡鏉挎Щ妞ゎ偅绻堥、姗�鎮╅幓鎺斿摋闂傚倷娴囬鏍窗濞戞ǚ鏋栨繛鎴緛缂嶆牗绻濋棃娑卞剱闁稿鍊块獮鏍拷娑欘焽缁犳捇鏌＄�ｎ亞澧︽慨濠勭帛閹峰懏绗熼婊冨Ъ闂備焦瀵уú蹇涘磹濠靛锟戒線寮介鐐靛�炲銈嗗釜閹烽绱掗悪锟介崹鍫曞蓟閿濆憘鐔兼嚃閳轰胶顐奸梻浣侯焾椤戞劖绂嶉鍫濊摕闁靛ň鏅滈崑鍡涙煕鐏炲墽鈽夋い蹇ユ嫹?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄥ磼閵娿儍褰掓偐瀹割喖鍓扮紒鐐劤缂嶅﹤顫忓ú顏嶆晢闁跨喓鏅划鏃堟偨閸涘﹤浜楀┑鐐村灟閸ㄦ椽鎮￠弴銏＄厵濞寸厧鐡ㄥ☉褎顨ラ悙鎼畼闁汇儺浜、姗�鎮╅煫顓烆棜缂傚倷鑳剁划顖滄崲閸儱鏋侀柟鎯ь嚟椤╃兘鎮楅敐鍛粵闁哄懏绮撳铏瑰寲閺囩偛鈷夐梺鑽ゅ櫐缁犳捇寮澶嬫櫢闁跨噦鎷�??闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢绘俊鐐�栭悧妤冪矙閹炬眹锟藉懘寮婚妷锔惧弳濠电娀娼уΛ顓炍ｉ崫銉х＜闁跨喍绮欏畷鎺戔槈濞嗗繐浼庢繝寰锋澘锟芥洟顢栭崱娆欐嫹濮橆剛绉洪柟顔筋殘閹叉挳宕熼鍌ゆФ闂備胶顭堢换鎴︽晝閵忕姷鏆﹂柣鎴灻欢鐐烘煙闁箑澧版い鏂挎嚇濮婄儤瀵煎▎鎴濐嚤缂備焦妫忛弻鍗島re濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
	private boolean checkOnline(long invitedRoleId, long inviterRoleId)
	{
		if(StateCommon.isOnline(invitedRoleId))
			return true;
		else
		{
			//闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鎳為柆宥嗗殐闁宠桨鑳剁粵蹇旂節閻㈤潧校闁绘棏鍓涚槐鐐哄冀瑜滈悢鍡涙煠閹间焦娑у┑顔兼喘閺岋箓宕橀鍕亪闂佸搫鐭夌紞浣割嚕椤掑嫬绠伴幖娣灩閺嬫垿姊绘担鍝ワ紞缂侇噮鍨伴～蹇旂節濮橆厽娅㈤梺鑺ッˇ閬嶆偩椤撱垺鐓曢幖娣妺閹茬偓顨ラ悙璇ч練缂佺姵绋戦埥澶婎潩椤掞拷缁茬偓淇婇悙顏勶拷鏍暜閹烘纾归柤濮愬�曢ˉ姘攽閸屾碍鍟為柣鎾卞劦閺岋綁寮撮悙璇ф嫹閸︻叏鎷峰鐐?
			MessageMgr.sendMsgNotify(inviterRoleId, 141701, null);
			return false;
		}
	}	
	
	//闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄦ儗濡ゅ懎绠圭紒顔炬嚀閻忔娊鏌ㄥ┑鍡╂Ц缁绢叏鎷烽梻浣筋嚙缁绘鐣烽悽绋跨疇闁瑰墽鍎甸敓鏂ょ畵婵℃悂鍩℃担渚О婵＄偑鍊栧ú鏍箯閹达箑绠�瑰嫭瀚堥弮鍫濈闁宠桨鐒﹂悗楣冩⒒娴ｅ憡鎯堟い锔诲灦閹ê鈹戦崼銏★紡閻熸粌绻掑Σ鎰板箳濡わ拷绾惧吋绻涢幋鐐嗘垹鎷犻悙瀵哥瘈缁炬澘顦辩壕鍧楁煛鐏炵瓔妯�閽樻繈鏌熺紒銏犳灍闁绘挾鍠愰妵鍕箻鐠哄搫澹夐梺绋垮濮婂綊骞堥妸锔剧瘈闁稿被鍊楅崥瀣倵鐟欏嫭绀冮柨鏇樺灲閵嗕線寮崼婵堫槹濡炪倖甯掗崐椋庤姳閺夋垟鏀介柣妯虹仛閺嗏晠鏌涚�ｎ偆娲撮柟顔ㄥ嫮绡�闁搞儜鍐拷顓㈡⒑缁夊棗瀚峰▓鏃傜磼閻樺磭澧甸柡灞界Ч瀹曨偊宕熼锟藉▍銈夋⒑閹肩偛锟芥洟顢栨径鎰摕闁靛ň鏅滈崑鍡涙煕鐏炲墽鈽夋い蹇ユ嫹?婵犵數濮烽弫鎼佸磻閻愬搫绠板┑鐘崇閸ゅ苯螖閿濆懎鏆為柡鍛箞閺屻劑寮撮悙璇ф嫹閸濄儲鍠嗛柨鏃傚亾閸犳劙鏌ｅΔ锟介悧鍡欑箔濮樿埖鐓熼柟鎯у船閸旀粎绱掔紒妯兼创妤犵偛顑夐幃婊堝幢濞嗗繐楔婵犵數濮幏鍐吋婢跺锟藉秶绱撴担铏瑰笡缂佸鎹囧畷鐗堢節閸パ呯厬濠碘槅鍨伴崥瀣疾婵傚憡鈷掑ù锝呮啞鐠愶繝鏌熼搹顐ｅ暗闁跨喕濮ら惌顕�宕￠幎鑺ュ仒妞ゆ梹鎷濋幏鐑芥晲鎼存繄鎸夐梺鐚存嫹濞寸姴顑嗛悡鏇㈡煏婢舵稓鍒板┑陇娉曢幉鎼佸级鐠恒剱褎鎱ㄦ繝鍕笡缂佹鍠栭弫鎾绘寠婢舵鍔烽悷婊冪Х閻忓姊洪崫鍕殭闁稿﹤缍婇、鏇㈡嚍閵夛箑寮垮┑鈽嗗灣閳峰牊瀵奸崒姘肩唵闁兼悂娼ф慨鍫ユ煛閸涱喚鍙�闁哄本鐩俊鐑芥晲閸涱収鐎冲┑鐐差嚟婵數鏁敓鐘茶摕闁挎繂鐗忛悿锟介梺鍝勬川閸嬫稒绔熺�ｎ喗鈷戦柣鐔告緲濞堚晠鏌熼崙銈嗗?婵犵數濮烽弫鎼佸磻閻樿绠垫い蹇撴缁躲倝鏌涜閵囨盯鏁撻弬銈囩暤鐎规洖銈告慨锟介柕蹇嬪灮閸斿爼姊虹拠鎻掑毐缂傚秴妫濋弫鎾存叏閹邦剛浼勯梺纭呮珪閹瑰洭鍨鹃敃鍌毼╅柍杞扮閼板灝鈹戦埥鍡楃仸婵炵厧顭烽獮蹇涙倻閽樺顦ㄥ銈嗘⒒閺咁偊宕㈤棃娴虫棃鎮╅棃娑楃捕闂佽绻戠换鍫ュ箖濮楋拷閹崇娀顢楁繝鍐伓闁荤喐鐟ョ�氼厾绮堥崘顏嗙＜閻犲洩灏欐晶锔撅拷娈垮櫘閸嬪嫰顢橀崗鐓庣窞濠电姴瀚峰Σ瑙勪繆閻愵亜锟芥牠骞愭ィ鍐ㄧ獥闁圭増婢樼壕鎸庛亜閺嶎偄浠﹂柍閿嬪笒闇夐柨婵嗘祩閻掗箖鏌ｉ…鎺旂瘈闁哄瞼鍠栧畷娆撳Χ閸℃浼�?
	private boolean checkInviterStatus(long inviterRoleId)
	{
		BuffAgent buffagent = new BuffRoleImpl(inviterRoleId,true);
		if(!buffagent.canAddBuff(BuffConstant.StateType.STATE_TEAM))
		{
			TeamManager.logger.info("闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛鎾茬閸ㄦ繃銇勯弽銊с�掗柣婵嗙埣閺岋繝宕堕妷銉т患闂佹眹鍊楅崑鎾舵崲濞戙垹绠ｆ繛鍡楃箳閸旀挳姊烘潪鎵槮闁挎洦浜濠氬Ω閳哄倸浜為梺绋挎湰缁嬫垿顢旈敓锟�(roleId=" + inviterRoleId+")濠电姷鏁告慨鐑藉极閸涘﹥鍙忓ù鍏兼綑閸ㄥ倿鏌ｉ幘宕囧哺闁哄鐗楃换娑㈠箣閻愰潧鏆￠梺鐟板槻閸㈡煡锝炲┑瀣拻閻庨潧鎲￠弲濂告⒒娴ｇ鎮戞俊鐐跺Г缁傚秹宕奸弴姗堟嫹娴ｈ倽鏃�鎷呴悷閭︼拷鎾绘煟閻愬鈻撻柛鎾寸箞閹﹢宕橀鐣屽幗闁硅壈鎻槐鏇㈡偩椤撱垺鐓曢幖娣妺閹查箖鏌熼銊ユ搐楠炪垺绻涢幋鐏活亪宕戝澶嬬厽閹兼番鍔嶅☉褔鏌熼懞銉х煂濠㈣娲熼幐濠冪珶濠靛棛绉洪柡浣瑰姍瀹曞爼宕滄担绋啃┑锛勫亼閸婃洖霉濮樿泛鍌ㄩ柤鎭掑劤閳瑰秴鈹戦悩鎻掝仾閻庢碍姘ㄩ幉姝岀疀濞戞瑥浠奸梺姹囧灩閹诧繝鎮″▎鎰╀簻闁哄秲鍔忔竟姗�鏌￠崱顓犳偧闁跨喎锟界噥娼愭繛鍙夌矒瀹曚即寮介婊愭嫹娴ｅ壊娼ㄩ柨鐔剁矙楠炲啫鈻庨幘宕囩杸闂佸憡鎸烽懗鍫曞汲閵堝鈷戦柛婵嗗閻忛亶鏌涢悩宕囧⒌鐎殿噮鍋婇獮妯肩磼濡粯顏熼梻浣芥硶閸ｏ箓骞忛敓锟�?");
			return false;
		}
		return true;
	}
	
	//闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂鍛殕闁归棿绀侀拑鐔兼煥濠靛棭妲搁崶鎾椤愩垺澶勯柡灞诲姂椤㈡棃鏁撻敓锟�?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄦ儗濡ゅ懎绠圭紒顔炬嚀閻忔娊鏌ㄥ┑鍡╂Ц缁绢叏鎷烽梻浣筋嚙缁绘鐣烽悽绋跨疇闁瑰墽鍎甸敓鏂ょ畵婵℃悂鍩℃担渚О婵＄偑鍊栧ú鏍箯閹达箑绠�瑰嫭瀚堥弮鍫濈闁宠桨鐒﹂悗楣冩⒒娴ｅ憡鎯堟い锔诲灦閹ê鈹戦崼銏★紡閻熸粌绻掑Σ鎰板箳濡わ拷绾惧吋绻涢幋鐐嗘垹鎷犻悙瀵哥瘈缁炬澘顦辩壕鍧楁煛鐏炵瓔妯�閽樻繈鏌熺紒銏犳灍闁绘挾鍠愰妵鍕箻鐠哄搫澹夐梺绋垮濮婂綊骞堥妸锔剧瘈闁稿被鍊楅崥瀣倵鐟欏嫭绀冮柨鏇樺灲閵嗕線寮崼婵堫槹濡炪倖甯掗崐椋庤姳閺夋垟鏀介柣妯虹仛閺嗏晠鏌涚�ｎ偆娲撮柟顔ㄥ嫮绡�闁搞儜鍐拷顓㈡⒑缁夊棗瀚峰▓鏃傜磼閻樺磭澧甸柡灞界Ч瀹曨偊宕熼锟藉▍銈夋⒑閹肩偛锟芥洟顢栨径鎰摕闁靛ň鏅滈崑鍡涙煕鐏炲墽鈽夋い蹇ユ嫹?婵犵數濮烽弫鎼佸磻閻愬搫绠板┑鐘崇閸ゅ苯螖閿濆懎鏆為柡鍛箞閺屻劑寮撮悙璇ф嫹閸濄儲鍠嗛柨鏃傚亾閸犳劙鏌ｅΔ锟介悧鍡欑箔濮樿埖鐓熼柟鎯у船閸旀粎绱掔紒妯兼创妤犵偛顑夐幃婊堝幢濞嗗繐楔婵犵數濮幏鍐吋婢跺锟藉秶绱撴担铏瑰笡缂佸鎹囧畷鐗堢節閸パ呯厬濠碘槅鍨伴崥瀣疾婵傚憡鈷掑ù锝呮啞鐠愶繝鏌熼搹顐ｅ暗闁跨喕濮ら惌顕�宕￠幎鑺ュ仒妞ゆ梹鎷濋幏鐑芥晲鎼存繄鎸夐梺鐚存嫹濞寸姴顑嗛悡鏇㈡煏婢舵稓鍒板┑陇娉曢幉鎼佸级鐠恒剱褎鎱ㄦ繝鍕笡缂佹鍠栭弫鎾绘寠婢舵鍔烽悷婊冪Х閻忓姊洪崫鍕殭闁稿﹤缍婇、鏇㈡嚍閵夛箑寮垮┑鈽嗗灣閳峰牊瀵奸崒姘肩唵闁兼悂娼ф慨鍫ユ煛閸涱喚鍙�闁哄本鐩俊鐑芥晲閸涱収鐎冲┑鐐差嚟婵數鏁敓鐘茶摕闁挎繂鐗忛悿锟介梺鍝勬川閸嬫稒绔熺�ｎ喗鈷戦柣鐔告緲濞堚晠鏌熼崙銈嗗?婵犵數濮烽弫鎼佸磻閻樿绠垫い蹇撴缁躲倝鏌涜閵囨盯鏁撻弬銈囩暤鐎规洖銈告慨锟介柕蹇嬪灮閸斿爼姊虹拠鎻掑毐缂傚秴妫濋弫鎾存叏閹邦剛浼勯梺纭呮珪閹瑰洭鍨鹃敃鍌毼╅柍杞扮閼板灝鈹戦埥鍡楃仸婵炵厧顭烽獮蹇涙倻閽樺顦ㄥ銈嗘⒒閺咁偊宕㈤棃娴虫棃鎮╅棃娑楃捕闂佽绻戠换鍫ュ箖濮楋拷閹崇娀顢楁繝鍐伓闁荤喐鐟ョ�氼厾绮堥崘顏嗙＜閻犲洩灏欐晶锔撅拷娈垮櫘閸嬪嫰顢橀崗鐓庣窞濠电姴瀚峰Σ瑙勪繆閻愵亜锟芥牠骞愭ィ鍐ㄧ獥闁圭増婢樼壕鎸庛亜閺嶎偄浠﹂柍閿嬪笒闇夐柨婵嗘祩閻掗箖鏌ｉ…鎺旂瘈闁哄瞼鍠栧畷娆撳Χ閸℃浼�?
	private boolean checkInvitedStatus(long invitedRoleId)
	{
		BuffAgent buffagent = new BuffRoleImpl(invitedRoleId,true);
		if(!buffagent.canAddBuff(BuffConstant.StateType.STATE_TEAM))
		{
			TeamManager.logger.info("闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛鎾茬閸ㄦ繃銇勯弽銊с�掗柣婵嗙埣閺岋繝宕堕妷銉т患闂佹眹鍊楅崑鎾舵崲濞戙垹绠ｆ繛鍡楃箳閸旀挳姊烘潪鎵槮闁挎洦浜濠氬Ω閳哄倸浜為梺绋挎湰缁嬫垿顢旈敓锟�(roleId=" + invitedRoleId+")濠电姷鏁告慨鐑藉极閸涘﹥鍙忓ù鍏兼綑閸ㄥ倿鏌ｉ幘宕囧哺闁哄鐗楃换娑㈠箣閻愰潧鏆￠梺鐟板槻閸㈡煡锝炲┑瀣拻閻庨潧鎲￠弲濂告⒒娴ｇ鎮戞俊鐐跺Г缁傚秹宕奸弴姗堟嫹娴ｈ倽鏃�鎷呴悷閭︼拷鎾绘煟閻愬鈻撻柛鎾寸箞閹﹢宕橀鐣屽幗闁硅壈鎻槐鏇㈡偩椤撱垺鐓曢幖娣妺閹查箖鏌熼銊ユ搐楠炪垺绻涢幋鐏活亪宕戝澶嬬厽閹兼番鍔嶅☉褔鏌熼懞銉х煂濠㈣娲熼幐濠冪珶濠靛棛绉洪柡浣瑰姍瀹曞爼宕滄担绋啃┑锛勫亼閸婃洖霉濮樿泛鍌ㄩ柤鎭掑劤閳瑰秴鈹戦悩鎻掝仾閻庢碍姘ㄩ幉姝岀疀濞戞瑥浠奸梺姹囧灩閹诧繝鎮″▎鎰╀簻闁哄秲鍔忔竟姗�鏌￠崱顓犳偧闁跨喎锟界噥娼愭繛鍙夌矒瀹曚即寮介婊愭嫹娴ｅ壊娼ㄩ柨鐔剁矙楠炲啫鈻庨幘宕囩杸闂佸憡鎸烽懗鍫曞汲閵堝鈷戦柛婵嗗閻忛亶鏌涢悩宕囧⒌鐎殿噮鍋婇獮妯肩磼濡粯顏熼梻浣芥硶閸ｏ箓骞忛敓锟�?");
			return false;
		}
		return true;
	}
	
	// 闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂鍛殕闁归棿绀侀拑鐔兼煥濠靛棭妲搁崶鎾椤愩垺澶勯柡灞诲姂椤㈡棃鏁撻敓锟�?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄥ垂閸岀偞鐓欓柟顖涙緲琚氶梺绋垮椤ㄥ﹪骞冨Δ鍛櫜閹肩补鍓濋悘宥夋⒑閹惰姤鏁遍悽顖ょ節瀵鈽夐姀鐘电杸闂佺绻愰幗婊堟儎鎼淬劍鈷戦柛婵嗗閸庡繑绻涢幘顕呮婵″弶鍔欓獮鎺楀箻鐎靛摜肖闂備線娼ч…鍫ュ磿閾忣偄顕辩�癸拷閸曨剙锟界敻鎮峰▎蹇擃仾缂侊拷閸愨斂浜滈柕濞垮劵瀹搞儵鏌ｉ敐鍛Щ妞ゎ偅绮撻弫鎾寸鐎ｎ剙绁﹂梺瑙勫礃椤曆呯不閹惰姤鐓欓悗鐢殿焾閸撻亶鏌涘顒夊剶婵﹤顭峰畷鎺戔枎閹烘垵甯梻浣侯攰濞呮洟骞戦崶顒�绠栨俊顖欒濞尖晠鎮规ウ鎸庮仩妞ゆ柨娲娲川婵犲嫮绱伴梺绋垮閻擄繝鏁愰悙鍝勫嵆闁靛骏绱曢崣鍡涙⒑缂佹ɑ绀�闁稿﹤婀遍敓鑺ョ啲閹凤拷?闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢绘俊鐐�栭悧妤冪矙閹炬眹锟藉懘寮婚妷锔惧弳濠电娀娼уΛ顓炍ｉ崫銉х＜闁跨喍绮欏畷鎺戔槈濞嗗繐浼庢繝寰锋澘锟芥洟顢栭崱娆欐嫹濮橆剛绉洪柟顔筋殘閹叉挳宕熼鍌ゆФ闂備胶顭堢换鎴︽晝閵忕姷鏆﹂柣鎴灻欢鐐烘煙闁箑澧版い鏂挎嚇濮婄儤瀵煎▎鎴濐嚤缂備焦妫忛弻鍗島re濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
	private boolean checkInvitedTeamFuctionEnable(long invitedRoleId)
	{
		//缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴闇夐柨婵嗘搐閻ㄦ垿鏌熷畡鏉挎Щ妞ゎ偅绻堥、姗�鎮㈤崫鍕闂備礁鎲￠〃濠冪閸洖钃熼柕濞炬櫅閸楄櫕銇勮箛鎾村櫣妞ゅ繗鍩栨穱濠囨倷椤忓嫸鎷烽弽顬℃椽鍩￠崨顓狀唵闂佽法鍣﹂幏锟�?闂傚倸鍊搁崐鎼佸磹妞嬪孩顐芥慨姗嗗墻閻掕棄鈹戦悩瀹犲缂佺媭鍨堕弻銊╂偆閸屾稑顏�?
//		if(fire.pb.SystemSettingConfig.checkRoleSetting(invitedRoleId, fire.pb.SysSetType.AcceptTeam)<=0)
//			return false;
//		else
			return true;
	}
	
	// 闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂鍛殕闁归棿绀侀拑鐔兼煥濠靛棭妲搁崶鎾椤愩垺澶勯柡灞诲姂椤㈡棃鏁撻敓锟�?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ｇ矆閸喓绠鹃柟瀛樼懃閻忣亪鏌涚�Ｑ冨⒉缂佺粯绻堝Λ鍐ㄢ槈閸楃偛澹夐梻浣虹帛閹歌煤閻旂厧钃熼柕濞炬櫅濡﹢鏌熺粙鍨劉闁稿孩鎸荤换婵嗏枔閸喗鐏堥梺绋匡龚椤绮氭潏銊х瘈闁告洦鍓欓悵浼存偡濠婂嫭鐓ユい顒�锕、姘舵晸娴犲绠栨俊銈呮噺閸嬨劑姊婚崼鐔衡槈濞寸姵锚椤啴濡堕崱妯虹闂侀潧鐗忛…鍫ユ偩閻戣姤鍋勭痪鎷岄哺閺呪晠姊虹紒妯诲碍婵炲鍏橀幃楣冩焼瀹ュ棌鎷婚梺绋挎湰閻熝囧礉瀹ュ鍊电紒妤佺☉閹虫劙鎯屽▎鎾寸厵闁硅鍔﹂崵娆戠磼閹邦収娈滄鐐寸墪鑿愭い鎺炴嫹闁跨喕濮ら崹鍓佺矉瀹ュ鎹舵い鎾跺枎閺嬫垿姊洪崫鍕殭闁绘妫涚划濠氭偐閸忓懐绠氶梺闈涚墕閹冲繘宕冲ú顏呭�甸柣銏ゆ涧瀛濆銈庡弨濞夋洟骞戦崟顒傜懝妞ゆ牗鑹炬竟宥夋⒒娴ｅ憡鍟炴慨妯稿妼椤斿繒绮╅。鏄猠dure濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
	private boolean checkInvitedInNoTeam(Long invitedTeamId)
	{
		if(invitedTeamId == null)
			return true;
		else
			return false;
	}
	
	// 闂傚倸鍊搁崐宄懊归崶褏鏆﹂柣銏㈩焾绾惧鏌ｉ幇顒佹儓缂侊拷閸曨厽鍠愰柣妤�鐗嗙粭鎺旂棯閹规劦鍤欓柍瑙勫灴閹晠宕ｆ径瀣�风紓浣哄亾閸庡磭绱炴繝鍥х畺婵°倕鎳忛弲鏌ュ箹缁櫢鎷烽幇浣规祰闂備浇顕х�涒晝鍠婂鍛殕闁归棿绀侀拑鐔兼煥濠靛棭妲搁崶鎾椤愩垺澶勯柡灞诲姂椤㈡棃鏁撻敓锟�?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ｇ玻濡や焦鍙忔慨妤�妫楁晶缁樼箾閸忚偐澧摶鏍煥濠靛棙鍣归柡鍡欏仱閺岋綁骞樼�靛憡鍒涢梺鍝勬湰閻╊垶銆侀弴銏℃櫜闁搞儮鏅╅崥瀣節瀵版灚鍊曢拕鍏笺亜椤愩埄妯�濠碉紕鏁诲畷鐔碱敍濮橀硸鍞洪梻浣筋潐閸庤櫕鏅舵惔銊﹀亗濠㈣埖鍔栭崐鐢告偡濞嗗繐顏紒锟介崼銉︾厱闊洦鏋忛幋鐐碘攳濠电姴娲ょ粻鐟懊归敐鍫殝闁归鍏橀弫鍐磼濮橀硸鍚呴梻浣虹帛閸旀﹢宕洪弽褉鏋嶉柟杈鹃檮閳锋帡鏌涚仦鎹愬闁跨喍绮欓ˉ鎾斥枎閵忋倕围濠㈣泛锕﹂鍡涙⒑鐠恒劌娅愰柟鍑ゆ嫹?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滃洿婵犮垼娉涢敃銈夊箚閻愮儤鈷戦柛婵嗗閳诲鏌涚�ｎ亝鍤囬柨婵堝仱瀵挳濮�閿涘嫬骞楅梻渚�娼х换鍫ュ春閸曨垱鍊垮Δ锝呭暞閻撶喐銇勯幘璺烘珡婵炲牊娲熼弻鏇㈠炊瑜嶉顒傜磼閻樺磭娲存鐐搭焽閿熻姤绋掕摫闁稿﹦鍏樺缁樻媴閸涘﹤鏆堥柦鍐憾閺岀喖宕ㄦ繝鍌楁灆閻庢鍠涢褔鍩ユ径鎰潊闁斥晛鍟悵鏇㈡⒒娴ｈ棄鍚归柛鐘冲姈缁旂喓锟斤綆鍠栭惌妤冪棯閻愵剚鍓慶edure濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
	private boolean checkNotBeingInvited(long invitedRoleId)
	{
		xbean.InviteInfo inviteInfo = xtable.Teaminvite.get(invitedRoleId);
		
		if (inviteInfo == null)//濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閿熻棄鍊圭粋鎺旓拷锝庡亝濞呫垽姊洪懞銉冾亪藝椤栫偛姹查梺顒�绉甸悡銉╂煟閺冨倻甯涙い銉ヮ槺缁辨挸顓奸崪鍐惈濡ょ姷鍋涢崯顐ョ亽闁荤姴娲╃亸娆戠玻閻愬绡�闁汇垽娼ф禒褔鏌涚�ｎ偅宕岄柟顕嗙節婵拷闁靛牆妫岄幏娲⒑閸濆嫬锟藉爼宕曢幓鎺嗘瀺闁告稑鐡ㄩ悡鏇㈡煟閺囨氨顦﹂柣蹇ョ悼缁辨帡顢欑喊杈╁悑濡ょ姷鍋炵敮鎺曠亙婵炶揪缍侀弲鏌ュ礌閺嵮�鏀介柣鎰煐瑜把呯磽瀹ュ繑瀚规俊鐐�ら崑鍕囬崡鐐╂瀻闁靛繈鍊栭崵鎴炪亜閹烘垵锟藉鏁嶅┑瀣�垫鐐茬仢閸旀岸鏌熼搹顐㈠闁哄懌鍎靛缁樻媴閼恒儯锟藉啰绱掗敓鑺ユ媴閾忓湱鐓嬮梺鍦檸閸犳宕戦埡鍌滅瘈闂傚牊渚楅崕蹇曠磼閿熶粙宕橀鐣屽弳闂佸搫鍊搁悘婵嬪箖閹达附鍊垫慨姗嗗墰缁夋椽鏌＄仦鍓ф创妤犵偛娲畷妤呭传閵夛附娅﹂梻鍌欑劍濡炲潡宕㈤悡骞稑鈹戦崱鈺佹闂佸壊鍋呭ú姗�宕愰悜鑺ョ厸濠㈣泛顑呴悞鐐繆椤愩垺顥㈡慨濠傛惈鐓ら悹鍥ㄥ絻缁犳煡姊虹粙鍖℃敾缂佽鐗嗛锝嗙節濮橆厽娅㈤梺缁樕戦悡锟犲船鐠轰警娓婚柕鍫濇婵拷闂佸憡鎸荤换鍫ョ嵁閹达附鏅查柛婊�鐒︾�靛矂姊洪棃娑氬濡ょ姴鎲＄粋宥夊礈瑜忕壕濂告煟濡寧鐝�规洖鐬奸敓鑺ヮ問閸犳牠鈥﹂悜钘夋瀬闁瑰墽绮弲鎼佹煥閻曞倹瀚�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囩喓绡�闁靛骏绲剧涵楣冩煛閸偄澧柣锝囧厴瀵濡烽敂鎯у汲闂備胶绮ú鏍磹閸︻叏鎷峰鐐
			return true;
		if(!inviteInfo.getBeinginvited())
		{
			//濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閿熻棄鍊圭粋鎺旓拷锝庡亝濞呫垽姊洪懞銉冾亪藝椤栫偛姹查梺顒�绉甸悡銉╂煟閺冨倻甯涙い銉ヮ槺缁辨挸顓奸崪鍐惈濡ょ姷鍋涢崯顐ョ亽闁荤姴娲╃亸娆戠玻閻愬绡�闁汇垽娼у瓭闁诲孩绋堥弲娑€�呮總绋课╅柍鍝勫�甸幏娲⒑閸︻収鐒炬繛鎾棑缁骞樼紒妯煎幍闂佸憡鍔樼亸娆戠不婵犳碍鐓熼柟鍨暙婢у瓨銇勯姀鈽嗘疁鐎规洜鍠栭、鏍嚍閵夈儺浼栭梻鍌氬�峰ù鍥р枖閺囥垹闂柨鏇炲�哥粻顖炴煥閻曞倹瀚�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滈悡娑樏归敐鍥舵殰闁归鍏橀獮鎺懳旈敓浠嬪箲閼哥偣浜滈柟鎹愭硾鍟稿銈忓瘜閸ㄨ泛顫忓ú顏勫窛濠电姳鑳剁换渚�姊洪崫銉バｇ�癸拷閹间礁鏄ラ柕蹇嬪�曠猾宥夋煕鐏炲墽鐭岄柨娑欑矒濮婃椽骞愭惔锝傛闁诲孩姘ㄩ崗妯虹暦闂堟稈鏌︾痪鐐暫闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏃�鎷濋幏椋庣箔濞戞ɑ鍣介柣顓熺懇閺岀喐娼忔ィ鍐╊�嶉梺绋垮椤ㄥ懘濡撮幒鎴僵闁绘劦鍓欓鍫曟煟鎼淬値娼愭繛鍙夛耿瀹曡鎷呴崘顏冪胺闂傚倷绀侀幉锟犲礉閺嶎偓鎷风粭娑樻嫅閹峰嘲顫濋鍌溞ㄩ梺璇″枛閸㈡煡鍩㈡惔銈囩杸闁瑰灝鍟╃槐鎴︽⒒娴ｈ櫣甯涢柟灏栨櫊瀹曠懓鐣烽崶顭戞綗闂佸湱鍎ら崵锕傚籍閸喐娅㈡繛瀵稿Т閻熴倝宕堕锟界痪褎绻涢崱妯哄姢婵炲牜鍋婂娲川婵犲啫顦╅梺鎼炲妽婢瑰棛鍒掗崼顫嫹閿濆骸浜栧ù婊勭矒閻擃偊宕堕妸锕�闉嶅銈冨劗閿熻姤鍓氶悢鍡涙偡濞嗗繐顏甸柤鏉挎健閺屸�崇暆鐎ｎ剛袦闂佽鍠楅悷鈺侇嚕閸洖绠ｆ繝闈涙川濡叉姊婚崒娆掑厡妞ゎ厼鐗撻、鏍川鐎涙ɑ娅囧銈呯箰鐎氼噣寮抽敃鍌涚厵闂侇叏绠戝▍娆撴煙妞嬪骸鍘撮柡浣瑰姈閹棃鍨鹃幇浣规祰闂備浇顕х�涒晝鍠婂澶嬪殞濡わ絽鍟犻敓鑺ユ瀹曟﹢顢旀惔銏狀伓闂佹寧绻傜花濂告焽椤栨稏浜滈幖娣焺濞堟绱掗鍛籍妤犵偛顑夐弫鍌滄喆閿濆棗顏归梻浣藉吹婵潙煤閻樼粯鏅搁柦妯侯槸閺嗚鲸顨ラ悙鏉戝缂佽鲸鎸婚幏鍛存偩鐏炵晫澧梻浣侯焾閿曘儵銆冮崨顓炵カ闂備礁缍婇崑濠囧礂濮楋拷瀵劍绂掔�ｎ偆鍘遍梺鏂ユ櫅閸燁偅鎱ㄨ閺岀喐顦版惔鈥冲箣濡ょ姷鍋炵敮鎺曠亙闂佽法鍠曞Λ鍕敊韫囨挴鏀介悗锝庡亜閿熻棄鐏氱换娑㈠箣閻愬灚鍣介梺缁樺笧閺咁偊骞夐幖浣瑰亱闁割偅绻勬导宀勬⒑閸濆嫬顦柛鎾寸箓椤曘儵宕熼姘�垮┑鈽嗗灥瀹曚絻銇愰崨顔剧瘈闁汇垽娼ф禒鈺傘亜閺囩喓鐭岀紒顔碱煼楠炲鏁傞懞銉︾彇闂備線娼х换鍫ュ磹閺嶎厼鐤鹃柟闂寸劍閻撶喐淇婇婵囶仩闁挎稑绉归弻娑㈠籍閹炬潙顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亜閸ㄦ棃鏌熺紒銏犳灈缂佺媭鍨堕弻銊╂偆閸屾稑顏�?
			cleanTimeoutInvites(inviteInfo.getInvited());
			return true;
		}
		else if ((now - inviteInfo.getInviting().getInvitetime()) > TeamManager.MAX_INVITE_TIMEOUT)
		{
			//濠电姷鏁告慨鐑藉极閸涘﹥鍙忓ù鍏兼綑閸ㄥ倿鏌ｉ幘宕囧哺闁哄鐗楃换娑㈠箣閻愰潧鏆￠梺鐟板槻閸㈡煡锝炲┑瀣拻閻庨潧鎲￠弲濂告⒒娴ｇ鎮戞俊鐐跺Г缁傚秹宕奸弴姗堟嫹娴ｈ倽鏃堝川椤撶媭妲规俊鐐�栫敮鎺楀磹閸涘﹥鍙忛柨鐕傛嫹?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜堕弫鍥煃鐠虹儤鎯堟い锔炬暬閻涱喖螣绾攱瀚规繛鎴烆仾椤忓嫷鍤曢柛褎顨嗛埛鎴犳喐閻楀牆绗氶柨娑氬枔缁辨帡鏁撻懞銉﹀闁惧繘锟芥稓鐟濋梻浣烘嚀閻°劎缂撻崸妤佹櫢闁兼亽鍎辩粭鎺撱亜椤愶絿绠炴い銏☆殕缁绘繈宕掑鍏兼祮缂傚倸鍊搁崐椋庢閵堝绠�瑰嫰鍋婇悢鍡涙偣妤﹁￥锟斤拷婵′勘鍔庨幉鎼佹偋閸繄鐟查梺鍝勬噺閻擄繝寮诲☉妯锋闁告鍋為悵顔尖攽閳藉棗浜愰柨鐔诲Г閺嬪ジ寮ㄦ禒瀣挃闁搞儮鏅欓悞濠冪箾閸℃ɑ灏ㄩ柨鐔告灮缁犳挸鐣锋總绋课ㄦい鏃囧Г濞呮捇姊绘繝搴′簻婵炶濡囩划娆撳箳濡わ拷閸氬綊鏌熺�电浜煎ù婊勭矒閺岀喖鎮滃Ο铏逛淮闂佽法鍠庨敓鐣屽櫏閸ゆ瑦銇勯銏㈢闁靛牞缍佸畷姗�鍩￠崘銊ョ闂傚倷鐒﹂弸濂稿疾濞戙垹鐤い鎰╁�楃粻鏃堟煙閻戞﹩娈曢柣鎾寸懇閺屾盯骞囬姘辨缂備胶濮锋晶妤呭Φ閸曨垼鏁傞柛鏇ㄥ亝濞堝鎮楃憴鍕閻㈩垽绻濋獮鍐ㄢ枎閹搭垱瀚规繛鎴烆伆閹达附鍋熸い鎰堕檮閻撶喖骞栨潏鍓хɑ妞ゅ繒鍠栭弻鐔割槹鎼粹�冲箣闂佸搫鏈惄顖氼嚕閹绢喖惟闁靛鍎辩粻鎵磽閸屾瑧璐伴柛锝庡櫍瀹曞綊宕奸弴鐐舵憰闂佹寧绻傞ˇ浼村磻閸曨垱鐓曟繛鎴烇公閸旂喖鏌ㄥ☉娆戞创婵﹨娅ｇ槐鎺懳熷ú顏勬疂缂傚倷鑳舵慨鐢稿垂瑜版帒鐭楅柛娑樼摠閳锋垹绱掓径濠冾棞閻庢艾鍢查埢鎾诲籍閿熻姤绌辨繝鍥舵晝闁挎繂绻楅敓钘夋健閺屸�崇暆閿熶粙宕版惔銊﹀仼闁跨喓濮寸粻銉︺亜閺冿拷閸庤櫕鎱ㄩ崗鑲╃瘈闁汇垽娼ф禒褔鏌涘Ο鐘叉处閸嬪鏌ｉ幘鍐茬槰婵炲吋鐗楃换娑橆啅椤旇崵鍑归梺鍝勬噺閹倿寮婚妸鈺傚亞闁稿本绋戦锟�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄥ垂閸岀偞鐓欐繛鍫濈仢閺嬨倝鏌熼崘鍙夊殗婵﹤顭峰畷鎺戔枎閹邦喓鍋樻俊鐐�栧ú姗�鎮ч悩鑼殾婵°倧鎷烽柍钘夘槸椤粓宕卞Ο铏规В闂傚倷绀佸﹢閬嶅磿閵堝拋娼栭柛锔诲弿閹峰嘲顫濋澶屽悑闂佸搫鐭夌紞浣割嚕椤掑嫬绠伴幖娣灩閺嬫垿姊绘担鍝ワ紞缂侇噮鍨伴～蹇旂節濮橆厽娅㈤梺鑺ッˇ閬嶆偩椤撱垺鐓曢幖娣妺閹茬偓顨ラ悙鑼闁跨喐鏋荤紞鍡涙晸缁涘寮跨紓宥勭閻ｇ兘鏁撻悩鍐诧拷鍫曟煠婵劕锟芥牠宕甸敓钘夘渻閵堝骸骞戦柛鏃�鍨甸悾宄邦潨閿熶粙宕洪埄鍐╁閻熸瑥瀚▓顒佺節绾板纾块柛瀣灴瀹曟劙濡舵径濠勶紱闂佽鍎虫晶搴㈢▔瀹ュ鐓欓柟瑙勫姦閸ゆ瑩鏌﹂崘顏勬灈闁哄被鍔戦幃銈夊磼濞戞﹩浼�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜堕弫鍥煃鐠虹儤鎯堟い锔炬暬閻涱喖螣绾攱瀚规繛鎴烆仾椤忓嫷鍤曢柛褎顨嗛埛鎴犳喐閻楀牆绗氶柨娑氬枔缁辨帡鏁撻懞銉﹀闁惧繘锟芥稓鐟濋梻浣烘嚀閻°劎缂撻崸妤佹櫢闁兼亽鍎辩粭鎺撱亜椤愶絿绠炴い銏☆殕缁绘繈宕掑鍏兼祮缂傚倸鍊搁崐椋庢閵堝绠�瑰嫰鍋婇悢鍡涙煠閹间焦娑у┑顔肩墦閺岋綁骞樼�涙顦ㄩ梺閫涚┒閸斿矂锝炲鍫濆耿婵°倧鎷锋い顐簻閳规垿鎮崨顔碱伓闂備胶绮〃鍛存偋閸涱垱宕查柛鈩冪♁閻撶喖鏌熼柇锕�骞栫紒鎻掝煼閺屻劑鎮㈢拠娈嬫捇鏌熼鐓庯拷瑙勭┍婵犲洤绠绘い鏃囧亹椤斿﹤鈹戞幊閸娧囧箯妞嬪函鎷烽悷鐗堝暈缂佽鐗撻獮鍐ㄎ旈敓浠嬪煡婢跺ň鏋庢俊顖滃帶婵椽鏌ｉ悢鍝ョ煂濠⒀勵殜瀹曞綊宕稿Δ锟介拑鐔兼煃閳轰礁鏆欑紒鍓佸仱閺屾盯鍩勯崗鈺傚灴閹敻寮惔鎾存杸闂佺粯鍔欓·鍌炲吹鐎ｎ剛纾奸柣妯哄暱閻忔挳鏌℃担绋挎殻濠殿噯鎷烽梺闈涚墕濡瑥鈻嶉姀銈嗏拺缂備焦鈼ら鍡楊棜妞ゆ挶鍨圭粈澶愭煥閻曞倹瀚�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亜閸ㄦ棃鏌熺紒銏犳灈缂佺媭鍨堕弻銊╂偆閸屾稑顏�?
			inviteInfo.setBeinginvited(false);
			cleanTimeoutInvites(inviteInfo.getInvited());
			return true;
		}
		else
			return false;
	}
	
	//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓缂佺姳鍗抽弻鐔兼⒒鐎靛壊妲紓浣哄Х婵灚绌辨繝鍥舵晬婵犻潧瀚搁幏鐑芥晸娴犲鐓涢悗锝庝簽鏁堝Δ鐘靛仦閻楁洝褰佸銈嗗釜閹峰嘲鈹戦垾鑼煓闁哄矉缍侀獮鎺楁倷閺夋埈浼�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囩喓绡�闁靛骏绲介悡鎰版煕閺冿拷濞叉繄鎹㈠鑸碘拻濞达絽鎲￠崯鐐烘煕閺傝法绠荤�殿喗褰冮埞鎴狅拷锝庝簽閸樻椽姊洪崫鍕灕闁归鍏橀弻鏇㈠炊瑜嶉顓燁殽閻愭惌鐒介柟鐟板閹嫰骞掗悙鐢敌滈梺鍝勭焿缂嶄線寮幇顓炵窞濠㈣泛顑呴弸銈夋煟鎼淬埄鍟忛柛鐘崇墵閹儲绺界粙鎸庢К闂佹枼鏅涢崯顖涘垔閹绢喗鐓熼柣鏃傚帶娴滅増淇婇懠鍫曞摵缂佺粯绻堥幃浠嬫濞戞唻鎷烽幘缁樼厵濡炲楠搁崢鎾煛鐏炶濮傞柟顔哄灲瀹曨偊宕熼幋顖滅М闁哄矉缍侀獮鎺楁倷閺夋埈浼�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亜閸ㄦ棃鏌熺紒銏犳灈缂佺媭鍨堕弻銊╂偆閸屾稑顏�?,闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢绘俊鐐�栭悧妤冪矙閹炬眹锟藉懘寮婚妷锔惧弳濠电娀娼уΛ顓炍ｉ崫銉х＜闁跨喍绮欏畷鎺戔槈濞嗗繐浼庢繝寰锋澘锟芥洟顢栭崱娆欐嫹濮橆剛绉洪柟顔筋殘閹叉挳宕熼鍌ゆФ闂備胶顭堢换鎴︽晝閵忕姷鏆﹂柣鎴灻欢鐐烘煙闁箑澧版い鏂挎嚇濮婄儤瀵煎▎鎴濐嚤缂備焦妫忛弻鍗島re濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
	private void cleanTimeoutInvites(java.util.List<xbean.TeamInvite> invites)
	{
		java.util.List<xbean.TeamInvite> timeoutList = new java.util.ArrayList<xbean.TeamInvite>();
		for (xbean.TeamInvite invite : invites)
		{
			if ((now - invite.getInvitetime()) > TeamManager.MAX_INVITE_TIMEOUT)
				timeoutList.add(invite);
		}
		invites.removeAll(timeoutList);
	}

	// 闂傚倸鍊搁崐椋庣矆娓氾拷楠炴牠顢曚綅閸ヮ剦鏁冮柨鏇嫹闁汇倗鍋撶换婵囩節閸屾粌顤�闂佺顑戠换婵嬪蓟閺囥垹閱囨繝鍨姈鏁堥梻浣虹帛閹告悂宕愰崷顓熷床婵犻潧娲ㄧ弧锟介梺绋挎湰缁矂路閿熶粙姊绘担铏瑰笡閻㈩垼浜獮蹇涙晸閿燂拷?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜堕弫鍥煏韫囨洖啸闁告繃顨婂缁樼瑹閸パ冾潻缂備礁顦遍弫璇茬暦閺囩喎绶為柟閭﹀幘閸樺崬鈹戦悙鏉戠仸闁荤噦濡囩槐鐐哄箣閿旇棄锟藉灚鎱ㄥ鍡楀⒒婵℃彃鎲￠妵鍕敇閳╁啰銆婇梺鍦嚀鐎氭澘鐣烽锕�绀嬫い鎾跺晿閻愬绡�闁汇垽娼ф禒褔鏌涘Ο鐘叉处閸嬪鏌ｉ幘鍐茬槰婵炲吋鐗曢埞鎴︽偐鐎圭姴顥濈紓渚婃嫹闁告劏鏂傛禍婊堢叓閸ャ劍灏い蹇ｄ邯閺岋絾鎯旈妶鍡╀哗缂備浇椴搁幐濠氬箯閸涙潙绠ｉ柟鐑樺灦閸庢捇姊绘担渚劸妞ゆ垵鍟村畷鎰攽鐎ｎ偄浠掑銈嗘⒐閹锋繈骞忛悜鑺ユ櫜閹肩补鍓濋悘鍫ユ⒑閸涘﹤濮ч柟椋庡厴濮婄粯鎷呴懞銉с�婇梺闈╃秶缁犳捇鐛箛娑欐櫢闁跨噦鎷�?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ｇ矆閸儲鐓熼柡鍐ㄥ�哥敮鍫曟煕濮橆剛绉洪柟顔筋殜閺佹劖鎯旈娑橆伓闂侀潧绻堥崹娲吹閿熻棄顪冮妶搴″箲闁告梹鍨甸悾宄邦潨閿熶粙宕洪敓鐘茬＜婵﹩鍓欓ˉ鎺撶節閻㈤潧啸闁轰礁鎲￠崚濠囧箻椤旇偐顔嗛梺缁樺灱婵倝鎮￠妷鈺傜厽闁哄洨鍋涢敓钘夋贡閿熻姤鐔幏锟�30缂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑鐐闁芥ɑ绻堥弻鐔封枔閸喗鐏嶉梺鍝勬缁捇寮婚悢鍏煎�绘慨妤�妫欓悾鍫曟⒑閼测晩鐒剧紓宥咃躬瀵鎮㈤搹鍦紲闂侀潧绻掓慨鐢告倶瀹ュ鈷戠紓浣姑柌婊堟煙閸戙倖瀚�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囩喓绡�闁靛骏绲剧涵楣冩煛閸偄澧柣锝囧厴瀵濡烽敂鎯у箞闂備線锟芥稑宓嗘繛浣冲洤鍑犻柣鏂垮悑閻撴盯鏌涘锟界粈浣规櫠閹绢喗鐓涚�癸拷鐎ｎ剛袦閻庢鍣崜鐔风暦瑜版帩鏁婇柛娆樺亐閺呮盯鍩為幋锔藉�烽柡澶嬪灦閻︽垿姊洪幖鐐插姌闁告柨閰ｅ畷銏°偅閸愨晝鍘介柟鑲╄ˉ閸撴繄鎷归垾鏂ユ斀妞ゆ梻鍋撻弳顒勬寠閻斿鐔嗛悹杞拌閸庢垹绱掗埥鍛闂傚倷娴囧▔鏇㈠窗瀹ュ洤鍨濇繛鍡樻尭缁犳牗銇勮箛鎾搭棤缂佹唻绠撻弻锝夋偐濞堣法鍙恊dure濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
	private boolean checkNotInvitedIn30s(long invitedRoleId, long inviterRoleId, Long inviterTeamId)
	{
		xbean.InviteInfo inviteInfo = xtable.Teaminvite.get(invitedRoleId);
		if(inviteInfo!=null)
		{
			java.util.List<xbean.TeamInvite> timeoutList = new java.util.ArrayList<xbean.TeamInvite>();
			boolean result = true;
			for (xbean.TeamInvite invited : inviteInfo.getInvited())
			{
				if ((now - invited.getInvitetime()) < TeamManager.MAX_INVITE_TIMEOUT)
				{
					if (!result)
						continue;// 濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閿熻棄鍊圭粋鎺旓拷锝庡亝濞呫垽姊洪懞銉冾亪藝椤栫偛姹查梺顒�绉甸悡銉╂煟閺冨倻甯涙い銉ヮ槺缁辨挸顓奸崪鍐惈濡ょ姷鍋涢崯顐ョ亽闁荤姴娲╃亸娆戠玻閻愬绡�闁汇垽娼у瓭婵°倗濮甸幃鍌氼嚕閺屻儲鍋愮紓浣骨氶幏娲⒑閸忚偐銈撮柡鍌欑窔楠炲繘鏁撻悩宕囧幈闂佽鍎抽顓灻洪幘顔界厵妞ゆ牓鍊栫�氬綊姊绘担鍛婂暈缂佸鍨块幃娲Ω閳哄倸浜楀┑鐐叉閹稿鎮￠弴鐔翠簻妞ゆ挾鍠庨悘銉ッ瑰鍕煉闁哄本鐩顒傛嫚鐠囇勫婵犻潧顑呴拑鐔哥箾閹存瑥鐏╅柣鎾寸☉闇夐柨婵嗙墛椤忕娀鏌涢弮鎴濈仸婵﹦鍎ゅ顏堝箥椤曞懏袦缂傚倷绀侀ˇ閬嶅箠閹剧粯鍋╅柣鎴ｆ缁犵懓霉閿濆洦鍤�濞寸姴鎼—鍐Χ鎼存繄鏁栭梺浼欑秵閹界憙 == false闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏃�鎷濋幏椋庣箔濞戞ɑ鍣介柣顓熺懇閺岀喎鈻庨垾宕囨勾闁告梹鍨垮顐﹀箻缂佹ê浠奸悗鐧告嫹闁跨喓鏅竟鏇熺附缁嬭法楠囬梺鍓插亝缁嬫垶淇婄捄銊х＜闁绘绉鍫熺畳婵犵數濮撮敃銈夊疮椤栫偛鐤柣鎰嚟缁犻箖鏌ｉ幘铏崳缂佺姾顕ч埞鎴﹀焺閸愵亝鎲欏銈忛檮婵炲﹪寮诲澶嬬叆閻庯綆鍋嗛ˇ鏉库攽閳藉棗浜滈柟铏耿閵嗕線寮撮姀鐙�娼婇梺鏂ユ櫅閸燁垶宕愰悜鑺モ拻濞达絼璀﹂弨鐗堢箾閸涱喗绀嬫鐐村灴瀹曞爼顢楅敓鍊熺箽闂備礁鎲＄粙鎴︽偤閵娾晛鐤炬繝濠傜墛閻撶娀鏌熼鐔风瑨闁告梹鐟﹂幈銊ヮ潨閸垻鏆犻梺瀹狀潐閸ㄥ潡骞冨▎鎾崇骇闁瑰濮冲鎾剁磽閸屾瑧璐伴柛鐘崇缁绘盯鏁撻悾宀嬫嫹濞堝灝鏋旈柛鏂跨Ф缁骞掗弮鎾村闁挎繂楠告禍鐐烘煕濡搫鑸归柍瑙勫灴椤㈡瑩寮妶鍕繑闂備礁鎲￠幐楣冨窗閺嵮呮殾闁挎繂顦粈瀣亜閹烘垵锟藉顢欓弴銏♀拻闁稿本鑹鹃敓鐣屾嚀椤洤鈻庤箛鏇熸闂佺硶鍓濈粙鎺楁偂濞嗘劑浜滈柡宥冨姀婢规﹢鏌￠崱顓犳偧闁跨喎锟界噥娼愭繛鍙夌矒瀹曚即寮介婊愭嫹娓氾拷瀵挳濮�閻欙拷濞煎﹤顪冮妶搴′航闁告ê澧界划鍫ュ礋椤栨稈鎷婚梺绋挎湰閻熝囁囬敃鍌涚厵缁炬澘宕禍鎵拷瑙勬礃閸ㄥ灝鐣烽崡鐐╂婵☆垰鎼禍鍫曟⒒娴ｇ懓鍔ょ紒缁樺浮閵嗕焦绻濋崘鈺佸伎闂佽鍎兼慨銈夋偂閵夆晜鐓熼柡鍥╁仜閿熻棄婀遍敓鑺ョ啲閹凤拷
					else if (invited.getRoleid() == inviterRoleId)
						result = false;// roleid闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ礀绾惧潡鏌ｉ姀銏╃劸闁汇倗鍋撶换娑㈠箣濞嗗繒浠肩紓浣哄Х閸庛倗鎹㈠┑鍥╃瘈闁稿本绮岄·锟介梻浣侯焾椤戝啴宕愬┑瀣摕闁靛ň鏅滈崑鍡涙煕鐏炲墽鈽夋い蹇ユ嫹
					else if (inviterTeamId != null && invited.getTeamid() == inviterTeamId)
						result = false;// inviterTeamId闂傚倸鍊搁崐宄懊归崶顒夋晪鐟滃繘鏁撻懞銉р枔闁哄懏绻勯崚鎺戔枎閹惧磭顔婂┑掳鍊撻悞锕�鈻嶉弬搴撴斀闁绘ê鐏氶弳鈺佲攽椤栨稒灏︽鐐茬箻閺屻劎锟斤絻鍔嬬花濠氭椤愩垺澶勯柟鍝ュ亾閺呭爼濮�椤喗瀚归悷娆忓鐏忣偆绱掗懜闈涘摵鐎殿喖顭烽弫鎾绘偐閺屻儱鏁归梻渚�娼х换鍡涘礈濠靛柊鎺楀礋椤栨稈鎷洪梺鐓庮潟閸婃洟寮搁弮鍫熺厵闁告瑥顦卞畷婕歮Id闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ礀绾惧潡鏌ｉ姀銏╃劸闁汇倗鍋撶换娑㈠箣濞嗗繒浠肩紓浣哄Х閸庛倗鎹㈠┑鍥╃瘈闁稿本绮岄·锟介梻浣侯焾椤戝啴宕愬┑瀣摕闁靛ň鏅滈崑鍡涙煕鐏炲墽鈽夋い蹇ユ嫹
				} else
					timeoutList.add(invited);// 闂傚倸鍊搁崐鐑芥嚄閸洖纾块柣銏㈩焾缁�鍫熺節闂堟稓澧涢柡鍡樼矒閺岀喖鎮滃鍡樼暥缂備胶濮锋繛锟介柡宀�鍠栭獮鎴﹀箛椤掑倸甯块柣搴ゎ潐濞叉﹢鎮￠敓鐘茶摕闁靛ň鏅滈崑鍡涙煕鐏炲墽鈽夋い蹇ユ嫹30缂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑鐐闁芥ɑ绻堥弻鐔封枔閸喗鐏嶉梺鍝勬缁捇寮婚敐澶婄疀妞ゆ挾濮伴崑鐐烘⒑閸濆嫷鍎愭俊顐㈠暣瀵鎮㈤悮瀛樺闁汇垺顔栭悞鎯归悪鍛暠闂囧绻濊閻忔繈鏁撻懞銉х疄鐎殿喛顕ч埥澶愬閻樻牓鍔嶉妵鍕冀閵娿儱姣堝┑鐐叉▕閸樺墽妲愰幘瀛樺闁荤喐婢橀～宥咁渻閵堝啫濡奸柟铏耿瀹曟椽濡烽敃锟界欢鐐烘煙闁箑骞楁繛鍛灲濮婅櫣鎹勯妸銉︾彚闂佺懓鍤栭幏锟�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繒锟藉箍鍎遍ˇ顖滅矆閸愵喗鐓忓┑鐐�ч幏鐑芥煃閸濆嫭鍣洪柍閿嬪灴閺岀喖鎳栭埡浣风捕婵犲痉銈呬汗缂佽鲸鎸搁濂稿椽閸愩劋绱ｆ俊鐐�ら崑鍕崲濮楋拷瀵偊骞樼紒妯绘闂佽法鍣﹂幏锟�?
			}
			inviteInfo.getInvited().removeAll(timeoutList);
			return result;
		}
		else
		{
			return true;
		}
	}
	

	// 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ｇ玻濡や椒绻嗛柕鍫濇噹閺嗙喖鏌熼崘鍙夊殗婵﹤顭峰畷鎺戭潩椤掑﹥瀚归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈滈柡灞革拷鎰佸悑閹肩补锟藉磭顔愭繝娈垮枦椤鎮￠垾鎰佹綎婵炲樊浜堕弫鍡涙煥閻旂儤娅曠紒顔芥閹晫绮欑捄銊︾叄婵＄偑鍊栫敮鎺旓拷姘煎弮閹繝鎮㈤崗鑲╁幐闂佺鏈銊︾閵忊�茬箚闁肩⒈鍓涚敮娑氱磼缂佹娲存鐐诧工閻ｏ繝鎮ч崼婵愭П闂備胶绮幐鐐箾閿熶粙鏌熼绛嬫疁鐎规洜鍏橀、姗�鎮欓幇鍓佺ɑ闁靛洤瀚版俊鐑藉Ψ椤斿彨褏绱撴担铏瑰笡缂佽鐗撳顐﹀箻鐎靛壊娴勯柣搴秵閸嬪嫭绂嶉懖鈺冪＝濞达綀濮ら鐘绘煙閸濄儳顑俥dure濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
	private boolean checkInviterIsLeader(long inviterRoleId , Team team)
	{
		if(team.getTeamInfo().getTeamleaderid() == inviterRoleId)
			return true;
		else
			return false;
	}

	// 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鏁嶉崟顓犵厯闂佺鎻梽鍕磻閵堝鐓忓┑鐘叉捣閸樻盯鏌℃径灞藉妺缂佺粯绻堥幃浠嬫濞戞鎹曟俊鐐�栧ú锕傚矗閸愩劎鏆﹂柕蹇ョ秵濡插墽绱撴笟鍥ф灍婵☆偄鍟悾宄拔熺悰鈩冪亖闁诲函绲鹃弻銊э拷姘煎墰濞嗐垽鎮欓悜妯煎幍闂備緡鍙忕粻鎴炴櫠椤栫偞鐓熼幖鎼灡鐎氾拷?<5? 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢绘俊鐐�栭悧妤冪矙閹炬眹锟藉懘寮婚妷锔惧弳濠电娀娼уΛ顓炍ｉ崫銉х＜闁跨喍绮欏畷鎺戔槈濞嗗繐浼庢繝寰锋澘锟芥洟顢栭崱娆欐嫹濮橆剛绉洪柟顔筋殘閹叉挳宕熼鍌ゆФ闂備胶顭堢换鎴︽晝閵忕姷鏆﹂柣鎴灻欢鐐烘煙闁箑澧版い鏂挎嚇濮婄儤瀵煎▎鎴濐嚤缂備焦妫忛弻鍗島re濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
	private boolean checkTeamNotFull(Team team)
	{
		if (team.getTeamInfo().getMembers().size() < 4)
			return true;
		else
			return false;
	}
	

	private boolean checkTeamFilter(Team team, long roleId)
	{
		TeamFilter filter = team.getFilter();
		if(filter == null)
			return true;
		return filter.checkInviteJoin(team.getTeamLeaderId(), roleId);
	}
	
	private boolean checkTeamFilter(long inviterId, long roleId)
	{
		TeamFilter filter = TeamManager.getActiveFilter(inviterId);
		if(filter == null)
			return true;
		return filter.checkInviteJoin(inviterId, roleId);
	}
	
	// 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鏁嶉崟顓犵厯闂佺鎻梽鍕磻閵堝鐓忓┑鐘叉捣閸樻盯鏌℃径灞藉妺缂佺粯绻堥幃浠嬫濞戞鎹曟俊鐐�栧ú锕傚矗閸愩劎鏆﹂柕蹇ョ秵濡插墽绱撴笟鍥ф灍婵﹤顭烽獮鎴﹀礋椤撶喎浠掗梺鏂ユ櫅閸熺増绂嶉弽顓熲拻濞达絼璀﹂弨浼存煙濞茶閭慨濠佺矙瀹曠喖顢涘☉姗堟嫹閸ф鐓ラ柣鏇炲�圭�氾拷?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜堕弫鍥煏韫囨洖啸闁告繃顨婂缁樼瑹閸パ冾潻缂備礁顑勭欢姘嚕椤愶箑绀冮柕濞垮灪閺傦拷闂備胶顭堥張顒傚垝閻樼粯鍊垮Δ锝呭暞閻撴盯鎮楅敐鍫濈厫閻庢熬鎷�?<4? 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢绘俊鐐�栭悧妤冪矙閹炬眹锟藉懘寮婚妷锔惧弳濠电娀娼уΛ顓炍ｉ崫銉х＜闁跨喍绮欏畷鎺戔槈濞嗗繐浼庢繝寰锋澘锟芥洟顢栭崱娆欐嫹濮橆剛绉洪柟顔筋殘閹叉挳宕熼鍌ゆФ闂備胶顭堢换鎴︽晝閵忕姷鏆﹂柣鎴灻欢鐐烘煙闁箑澧版い鏂挎嚇濮婄儤瀵煎▎鎴濐嚤缂備焦妫忛弻鍗島re濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
	private boolean checkTeamInviteNotFull(Team team)
	{
		//闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ磵閿熸枻绠撳畷濂稿閳ュ啿绨ラ梻浣筋潐婢瑰棙鏅跺Δ鍛；閻庯綆浜栭弨浠嬫煟濡绲绘い蹇ｅ亰閺屾稑螖娴ｈ棄顥濋梺瀹狀潐閸ㄥ潡骞冮埡浣烘殾闁搞儴鍩栧▓褰掓⒒娴ｄ警鐒炬い鎴濇处缁绘盯鏁撴禒瀣厸閻忕偛澧藉ú鎾煕閳轰礁顏�规洘锕㈤崺锟犲礃閳哄﹤鎮嬬紓鍌氬�搁崐鐑芥嚄閼稿灚鍙忛柣銏犳啞閸嬪鏌ｅΟ娆惧殭闁藉啰鍠栭弻銊╂偄閸濆嫅銏ゆ⒑閸楃偞鍠橀柡灞炬礉缁犳盯寮撮悙鎰剁秮閺岋綀绠涢幘璺衡叺濠殿喖锕ㄥ▍锝囧垝濞嗘挸绀岄柍銉ュ帠缁憋絾淇婇悙顏勶拷鏍垂闂堟耽娲敇閵忋垹绁﹂棅顐㈡处缁嬫帡寮查幖浣圭叆闁绘洖鍊圭�氾拷?
		cleanTimoutInvitings(team.getTeamInfo().getInvitingids());
		if (team.getTeamInfo().getInvitingids().size() < 4)
			return true;
		else
			return false;
	}
	
	// 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄥ垂閸岀偞鐓欐繛鍫濈仢閺嬨倝鏌熼崘鍙夊殗婵﹤顭峰畷鎺戔枎閹邦喓鍋樻俊鐐�栧ú姗�鎮ч悩鑼殾婵°倧鎷烽柍钘夘槸椤粓宕卞Ο铏规В闂傚倷绀佸﹢閬嶅磿閵堝拋娼栭柤濮愬�楁稉宥夋煛閸屾侗鍎ラ柣鏂挎閺屻倝骞栨担瑙勯敪婵犳鍠栧ú銊ф閹烘鏅稿ù鐘差儏绾惧吋鎱ㄩ敐搴″箹缂傚秴锕顐﹀箛閺夎法鍊為梺鍐叉惈閸婂綊宕幒妤佲拻濞达絽鎲￠幉鎼佹煕閿濆繒鐣垫鐐茬箻閺佹捇鏁撻敓锟�? 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢绘俊鐐�栭悧妤冪矙閹炬眹锟藉懘寮婚妷锔惧弳濠电娀娼уΛ顓炍ｉ崫銉х＜闁跨喍绮欏畷鎺戔槈濞嗗繐浼庢繝寰锋澘锟芥洟顢栭崱娆欐嫹濮橆剛绉洪柟顔筋殘閹叉挳宕熼鍌ゆФ闂備胶顭堢换鎴︽晝閵忕姷鏆﹂柣鎴灻欢鐐烘煙闁箑澧版い鏂挎嚇濮婄儤瀵煎▎鎴濐嚤缂備焦妫忛弻鍗島re濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
	private boolean checkTeamLeaderState(long inviterRoleId)
	{
		BuffAgent buffagent = new BuffRoleImpl(inviterRoleId);
		return buffagent.canAddBuff(OperateType.TEAM_INVITE);
	}
	
	// 闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣椤愪粙鏌曢崼婵愭Ц缂佺媭鍨堕弻銊╂偆閸屾稑顏�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜滄儫闂佸疇妗ㄥù鍥箺閺囥垺鈷戦悹鎭掑妼濞呮劙鏌熼崙銈嗗?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ㄥ垂閸岀偞鈷戞い鎺炴嫹缂佸鏁诲畷鎴﹀煛閸涱喒鎷哄銈嗗釜閹烽绱掓径灞炬毈闁糕晜鐩獮瀣晜閻ｅ苯寮抽梻浣虹帛濞叉牠宕愰崷顓ㄦ嫹濮樼偓瀚�?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繘鏌℃径瀣婵炲樊浜堕弫鍥煏韫囨洖啸闁告繃顨婂缁樼瑹閸パ冾潻缂備礁顑勭欢姘嚕椤愶箑绀冮柕濞垮灪閺傦拷闂備胶顭堥張顒傚垝閻樼粯鍊垮Δ锝呭暞閻撴盯鎮楅敐鍫濈厫閻庢熬鎷�?<4? 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢绘俊鐐�栭悧妤冪矙閹炬眹锟藉懘寮婚妷锔惧弳濠电娀娼уΛ顓炍ｉ崫銉х＜闁跨喍绮欏畷鎺戔槈濞嗗繐浼庢繝寰锋澘锟芥洟顢栭崱娆欐嫹濮橆剛绉洪柟顔筋殘閹叉挳宕熼鍌ゆФ闂備胶顭堢换鎴︽晝閵忕姷鏆﹂柣鎴灻欢鐐烘煙闁箑澧版い鏂挎嚇濮婄儤瀵煎▎鎴濐嚤缂備焦妫忛弻鍗島re濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
	private boolean checkSingleInviteNotFull(long inviterRoleId)
	{
		xbean.SingleInvitings singleInvitings = xtable.Singleinviting.get(inviterRoleId);
		//闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ磵閿熸枻绠撳畷濂稿閳ュ啿绨ラ梻浣筋潐婢瑰棙鏅跺Δ鍛；閻庯綆浜栭弨浠嬫煟濡绲绘い蹇ｅ亰閺屾稑螖娴ｈ棄顥濋梺瀹狀潐閸ㄥ潡骞冮埡浣烘殾闁搞儴鍩栧▓褰掓⒒娴ｄ警鐒炬い鎴濇处缁绘盯鏁撴禒瀣厸閻忕偛澧藉ú鎾煕閳轰礁顏�规洘锕㈤崺锟犲礃閳哄﹤鎮嬬紓鍌氬�搁崐鐑芥嚄閼稿灚鍙忛柣銏犳啞閸嬪鏌ｅΟ娆惧殭闁藉啰鍠栭弻銊╂偄閸濆嫅銏ゆ⒑閸楃偞鍠橀柡灞炬礉缁犳盯寮撮悙鎰剁秮閺岋綀绠涢幘璺衡叺濠殿喖锕ㄥ▍锝囧垝濞嗘挸绀岄柍銉ュ帠缁憋絾淇婇悙顏勶拷鏍垂闂堟耽娲敇閵忋垹绁﹂棅顐㈡处缁嬫帡寮查幖浣圭叆闁绘洖鍊圭�氾拷?
		if(singleInvitings == null)
			return true;
		cleanTimoutInvitings(singleInvitings.getInvitingids());
		if (singleInvitings.getInvitingids().size() < 4)
			return true;
		else
			return false;
	}
	
	//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佹儓缂佺姳鍗抽弻鐔兼⒒鐎靛壊妲紓浣哄Х婵灚绌辨繝鍥舵晬婵犻潧瀚搁幏鐑芥晸娴犲鐓涢悗锝庝簽鏁堝Δ鐘靛仦閻楁洝褰佸銈嗗釜閹峰嘲鈹戦垾鑼煓闁哄苯绉归弻銊э拷锝庡亜绾炬娊姊洪崫鍕効缂傚秳绀侀锝夘敆閸曨偄鐎銈嗘礀閹冲繐鈻撻搹鍦＝闁稿本鐟х粵蹇涙煙瀹勬澘妲婚柍瑙勫灴閹晠宕ｆ径濠庢П闂備胶绮幐璇裁哄Ο鍏煎床婵犻潧娲ㄧ弧锟介梺绋挎湰绾板秴鈻撻鐑嗘富闁靛牆鍟俊浠嬫煟閻斿弶娅呮い顐㈢箰鐓ゆい蹇撳閻撴垶绻濋姀锝嗙【闁活剙銈搁幃鈩冩媴閾忓湱锛濇繛杈剧悼椤牓鏁撻挊澶嬫喐缂侇喗姊婚敓鐣屾暩椤牆顕ｉ崣澶夌箚闁绘劦浜滈敓鑺ユ礈閹广垽骞囬鍡樺婵﹩鍘介崐鎰殽閻愯尙绠叉い锔惧閹棃顢涘☉姗嗕紦闂備焦瀵х换鍌涱殽閸涘﹥娅犳い鏍仦閸婂灚鎱ㄥ鍡楀箹闁告繃妞介弻鈥崇暆鐎ｎ剛袦婵犵鍓濋崕鑲╃不濞戙垹妫樻繛鍡楀綖缁憋拷?闂傚倸鍊搁崐椋庣矆娓氾拷楠炲鍩勯崘顏嗘嚌濠德板�曢幊搴ｇ矆閸喓绡�闂傚牊渚楅崕蹇涙煕鐏炶濡介柕鍥у楠炴帡骞嬪┑鎰棯闂備胶绮幐楣冨窗閺嶎厼钃熼柡鍥╁枔缁犻箖鏌涢…鎴濇灈濠殿喖楠搁—鍐Χ閸涱喚顩伴梺鍛婃尰缁嬫挸危閹版澘绠抽柡鍐挎嫹閻庢碍宀搁弻鐔虹磼濡櫣鐟插┑鐐茬墕椤兘骞冨Δ锟介埢鎾诲垂椤旂晫浜鹃梻浣芥〃缁�渚�鈥﹂悜鐣屽祦闁告劦鍠栭～鍛存煏閸繃顥滃ù婊勵殜閺岀喖宕楅崗鐓庡壒闂佹悶鍔忔禍顒勬晸閼恒儴澹樼紓宥咃躬楠炲啫螖閸涱喗娅滈柟鑲╄ˉ閿熻姤鍓氬浠嬫⒑鐠囨彃顒㈤柣鏃戝墴楠炲繘鏁撻敓锟�?
	private void cleanTimoutInvitings(java.util.Map<Long,Long> invitings)
	{
		Object[] keys = invitings.keySet().toArray();
		for(int i = 0; i <keys.length;i++)
		{
			if ((now - invitings.get(keys[i])) > TeamManager.MAX_INVITE_TIMEOUT)
			invitings.remove(keys[i]);
		}
	}

	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 794493;

	public int getType() {
		return 794493;
	}

	public long roleid; // 被邀请者角色ID

	public CFInviteJoinTeam() {
	}

	public CFInviteJoinTeam(long _roleid_) {
		this.roleid = _roleid_;
	}

	public final boolean _validator_() {
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		_os_.marshal(roleid);
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		roleid = _os_.unmarshal_long();
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CFInviteJoinTeam) {
			CFInviteJoinTeam _o_ = (CFInviteJoinTeam)_o1_;
			if (roleid != _o_.roleid) return false;
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		_h_ += (int)roleid;
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append(roleid).append(",");
		_sb_.append(")");
		return _sb_.toString();
	}

	public int compareTo(CFInviteJoinTeam _o_) {
		if (_o_ == this) return 0;
		int _c_ = 0;
		_c_ = Long.signum(roleid - _o_.roleid);
		if (0 != _c_) return _c_;
		return _c_;
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

