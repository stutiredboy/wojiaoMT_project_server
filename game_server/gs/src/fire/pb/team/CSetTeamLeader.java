
package fire.pb.team;
import fire.pb.StateCommon;
import fire.pb.buff.BuffAgent;
import fire.pb.buff.BuffConstant;
import fire.pb.buff.BuffRoleImpl;


// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CSetTeamLeader__ extends mkio.Protocol { }

// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

/***
 * 闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亝閸欏繒锟借娲栧ú銊╂儗閸℃褰掓晲閸偅缍堝┑鐐叉噽婵挳婀侀梺缁樏Ο濠囧磿閹扮増鐓曢悗锝呭悁闁垶鏌＄仦鍓ф创闁糕晛瀚板畷姗�顢旀担璇★拷鍥⒒娴ｇ懓鈻曢柡锟介柆宥呯闁搞儺鍓欓拑鐔兼煥濠靛棭妲告俊顐ｏ耿閺屾盯鈥﹂幋婵囩亶闂佺顭崹浼村煘閹达富鏁嬮柛鈩冪懅鑲栭梻浣烘嚀閸ゆ牠骞忛敓锟�
 * @author changhao
 *
 */
public class CSetTeamLeader extends __CSetTeamLeader__ {
	private long now = 0L;//procedure闂傚倸鍊峰ù鍥敋瑜嶉湁闁绘垵顫曢敓钘夊�块、姘舵晸娴犲宓侀煫鍥ㄧ♁閺呮悂鏌ㄩ悤鍌涘?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣銏犲閺佸﹪鏌″搴″箹缂佹劖顨婇弻鈥愁吋鎼粹�冲闂佽桨绀佺�氫即寮诲☉銏犵労闁告劗鍋撻鐟扳攽閻愬瓨灏い顓犲厴瀵鈽夊顐ｅ媰闂佸憡鎸嗘笟濠冨闁圭儤顨嗛悡鍐煟閻旂顥嬮弽锛勭磽娴ｈ櫣甯涚紒璇茬墕铻為柛鎰╁妷濡插牊绻涢崱妯曟垿鏁撻妷鈺傗拻濞达絽鎲＄拹锟犳煛閸滀礁浜濋柟渚垮姂楠炴﹢顢欓懖鈺佸绩濠电姰鍨奸崺鏍礉閺嶎厼鐤鹃柟闂寸劍閻撱儵鏌ｉ弴鐐诧拷鍦拷姘炬嫹?濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨偓鎷锋繝姘ワ拷鍛村矗婢跺瞼鐦堟繝鐢靛Т閸婂綊宕抽悾宀�纾奸柨鐔诲Г缁绘繈宕堕妸銉嫹閻㈠憡鐓ユ繝闈涙椤庢鏌＄�ｎ偆銆掔紒杈ㄥ浮閺佹挻绂掔�ｎ亪鍞跺銈庡亽閸犳锟芥俺顫夐〃銉╂倷閼碱兛铏庨梺鍛婃⒐绾板秵绌辨繝鍥舵晝闁挎繂娲﹂崳浼存煢濡崵绠橀柟鍙夋倐瀵剙鈻庨悙顒傜▉濠电姷鏁告慨鐢告嚌閸撗冾棜闁稿繗鍋愮弧锟介梻鍌氱墛缁嬫帡骞栭幇顓犵闁瑰啿鍢查幊鎰閽樺褰掓晲閸曨厾鐓撻梺鍛婄箚濞咃絿妲愰幒鏃�瀚氶柟缁樺笚濞堝墎绱撴笟鍥ф灍鐎癸拷缁嬭法鏆﹂柨鐔哄У閸婄兘鏌嶉崫鍕拷褰掑级缁嬪簱鏀介柣妯虹仛閺嗏晛鈹戦纰卞殶闁跨喕濮ら崙褰掑矗閸愵喗鏅查柣鎰▕閸氬鏌涘☉鍙樼凹闁哄偊鎷峰┑锛勫亼閸婃牕顫忔繝姘柧妞ゆ劑鍊楁稉宥夋煏婢舵稓绱扮紒璇叉閺屾稑鈻庤箛锝嗏枔闂佸憡姊瑰Ο鍧坋dure濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺绋胯閸旀垿寮婚敃锟借灒濞撴凹鍨遍埢鎾斥攽閻愬瓨灏い顓犲厴瀵鈽夊Ο鍏兼畷闂佽法鍠嶇划娆忕暦閹达附鍊烽柛婵嗗閸橀亶姊洪崷顓炲妺妞ゃ劌妫濆畷鎰版偨閸涘ň鎷婚梺鍓插亞閸犳捇鍩︽笟锟介弻娑㈡偄閸濆嫪妲愰梺鍝勭焿缂嶄線寮幇鏉块唶婵犲﹤鍟崕鎾剁磽閸屾瑦绁板瀛樻倐楠炴劖绻濆顒傤唵闂佸憡绋掑娆愬閻樼粯鐓曢柡鍥ュ妼婢т即鏌ㄩ悢鍑ゆ嫹閻斿壊浠╃紓浣介哺閹稿骞忛崨顖涘枂闁告洏鍔嶇�氬姊绘担鐑樺殌闁规祴鍓濈换娑欑節閸ャ劌浠掑銈嗘穿閹风兘鏌℃担瑙勫磳闁轰焦鎹囬弫鎾绘晸閿燂拷?
	
	Team team;
	@Override
	protected void process() {
		// protocol handle
		TeamManager.logger.debug("Enter: " + this.getClass());
		final long oldLeaderRoleId = gnet.link.Onlines.getInstance().findRoleid(this);
		if (oldLeaderRoleId < 0)
			return;
		final long newLeaderRoleId = roleid;
		mkdb.Procedure setTeamLeaderP = new mkdb.Procedure()
		{

			@Override
			protected boolean process()
			{
				//lock start 
				Long teamId = xtable.Roleid2teamid.select(oldLeaderRoleId);
				//闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ磵閿熸枻绠撳畷濂稿閳ュ啿绨ラ梻浣筋潐婢瑰棙鏅跺Δ鍛；閻庯綆鍠楅悡娆撴煕閹炬鎳庣粭锟犳⒑缁嬫鍎愰拑杈╃磼缂佹娲寸�规洖宕灒闁惧繘锟芥稒顢橀梻浣筋嚙鐎涒晝鍠婂澶嬪殞濡わ絽鍟繚闂佸湱鍎ら崺鍫濐焽閳哄懏鐓熼柟浼存涧婢ь喗銇勮箛姘厫缂佺粯绻傞銉╁几椤愵澁鎷烽妶澶婂惞閻庯綆鍠楅埛鎺楁煕閺囥劌浜滄い蹇ｅ亰閺屻劑鎮㈤悜妯荤彧闂佽桨鐒﹂幃鍌氱暦閵忥綆妯勫銈冨灪钃辩紒铏规櫕缁瑩宕归鍖℃嫹閸喒鏀介柍钘夋閻忥綁鏌涙惔銏犵仼缂侇喖顭烽獮妯兼嫚閼艰埖鎲版繝鐢靛仦閸ㄥ爼鏁冮埡渚囩劷闁冲搫鎳忛悡鏇㈡煙閻愵剦娈旈柟铏姍閹即濡烽埡鍌楁嫼闂佺厧顫曢崐鏇熺墡闂備礁鎲″褰掋�冩繝鍌滄殾濞村吋娼欑粻濠氭偣閸濆嫭鎯堥柣蹇擄躬濮婅櫣鎹勯妸銉︾彚闂佺懓鍤栭幏锟�?
				if(teamId != null)
					team = new Team(teamId,false);
				else
					return true;
				if(!team.isTeamLeader(oldLeaderRoleId))
					return true;//濠电姷鏁告慨鎾儉婢舵劕绾ч柛鏍ゅ墲鐎氳淇婇妶鍕妽闁告瑥绻橀弻鐔虹磼閵忕姵鐏嶉梺绋垮椤ㄥ懘濡撮幒鎴僵闁绘劦鍓欓鍫曟⒒娴ｇ瓔鍤冮柛顭戝灦閹偤鏁冮敓浠嬵敋閵夆晛绀嬫い鏍ㄦ皑閻わ拷婵＄偑鍊栫敮顏堝箯閻戣姤鐓曢悗锝庝簽鏁堝┑顔硷龚濞咃絿妲愰幒鎳崇喖鎳￠妶鍛辈闂傚倷绀侀幉锟犳嚌妤ｅ喚鏁勯柛顐犲剬閻戣棄纾奸柣鎰ˉ閹峰姊虹粙鎸庢拱闁煎湱鍋撶粋宥嗗鐎涙鍘垫俊鐐差儏妤犳悂宕㈤幘顔界厸鐎癸拷閿熶粙宕伴幘璺哄灊婵炲棙鎸搁崹鍌涖亜閺囩偞鍣瑰┑锟狀棑缁辨挻鎷呯拠鈩冪暦闂佹悶鍔岄悘婵嬶綖韫囨拋娲敂閸曨偆鐛╁┑鐘垫暩婵锟芥凹鍓熷鎶芥晬閸曨厾锛濇繛杈剧到閹碱偅鐗庨梺姹囧焺閸ㄦ娊宕戦妶澶屽祦闁硅揪绠戦～鍛存煏閸繃鍣圭�规挸妫濆娲濞戞氨顔婃繝娈垮枟濞兼瑩顢氶敐鍛殝闂侇叏闄勭�靛矂姊洪棃娑氬婵☆偅绋掗弲鍫曟焼瀹ュ棛鍘遍柣搴秵閸撴瑦绂掗埡鍌樹簻闁靛牆鎳庨敓鑺ユ倐閸╃偤骞嬮敂钘夛拷椋庯拷鐟板閸犳牕鈻撻崼鏇熲拺闁告稑顭悞濂告煕濞戝崬鐏ｉ柣鎾愁儔閺岋綁鎮╅懡銈囩獥闂侀潧妫撮幏鐑芥⒑閸濆嫷鍎愭俊顐㈠暣瀵鎮㈤崨濠勭Ф婵°倧绲介崯顖烆敁瀹ュ鈷戦柟鎯板Г閺侀亶鏌熼悷鐗堝枠鐎殿喖顭烽弫鎰緞婵犲喚妫熼梻浣稿閻撳牓宕板Δ鍛９妞ゆ牗鍩冮弨鑺ャ亜閺囩偞顥犵紒澶婄埣閺岀喖宕欓妶鍡楊伓
				if(!team.isInTeam(newLeaderRoleId))
					return true;//濠电姷鏁告慨鎾儉婢舵劕绾ч柛鏍ゅ墲鐎氳淇婇妶鍕妽闁告瑥绻橀弻鐔虹磼閵忕姵鐏嶉梺绋垮椤ㄥ懘濡撮幒鎴僵闁绘劦鍓欓鍫曟⒒娴ｇ瓔鍤冮柛顭戝灦閹偤鏁冮敓浠嬵敋閵夆晛绀嬫い鏍ㄦ皑閻わ拷婵＄偑鍊栫敮濠勬閳ユ緞娑㈡偄鐏忎焦鏂�闂佺粯鍔曞Ο濠囧吹閻斿吋鐓曟俊顖滃Т濞诧箓宕戦妶澶嬬厪濠电姴娴烽崢娑㈡煛婢跺銇濇慨濠傤煼瀹曟帒顫濋濠冨闁归棿绀佺壕璇测攽閻樺弶鎼愮紒鐙�鍨堕弻锝夊箣閿濆憛鎾绘煟閹惧鎳呯紒杈ㄥ笧閿熸枻缍嗘禍鐐寸閵徛颁簻闁瑰搫顑呴悘顔剧磼椤曞懎寮鐐差儔閺佸倻鎲撮敐鍡楊伖闂傚倷绀侀幉锛勭矙閹达附鏅濋柨鏇炲�搁悿顕�鏌ょ喊鍗炲缁炬儳銈搁弻锝呂熼崫鍕瘣闂佽绻堥崕鐢稿蓟閵娾晛鍗虫俊顖濇娴煎牆顪冮妶鍐ㄧ仾婵☆偄鍟悾閿嬬附閸涘﹤浜滈梺鍛婄懃椤︻垶鎯佽濮婂宕掑▎鎺戝帯缂備緡鍣崹璺侯嚕婵犳艾惟闁挎棁濮ら悵鐑芥煙閼圭増褰х紒鎻掓健閹矂宕卞缁樻杸闂佺粯蓱瑜板啴鏁撴禒瀣锭閸楅亶鏌涢鐘插姕闁绘挶鍎甸弻锝夊即閻愯鎷烽崷顓ㄦ嫹濮樼偓瀚�?
				Long[] roleids = new Long[2];
				if(oldLeaderRoleId < newLeaderRoleId)
				{
					roleids[0] = oldLeaderRoleId;
					roleids[1] = newLeaderRoleId;
				}
				else
				{
					roleids[0] = newLeaderRoleId;
					roleids[1] = oldLeaderRoleId;
				}
				this.lock(mkdb.Lockeys.get(xtable.Locks.ROLELOCK,(Object[])roleids));
				//lock end

				now = System.currentTimeMillis();

				if (checkPvP(oldLeaderRoleId, newLeaderRoleId) != 0) {
					return true;
				}

				if(!checkLeaderOnline(oldLeaderRoleId))
				{
					//闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�归崕鎴犳喐閻楀牆绗掗柛銊ュ�婚幉鎼佹偋閸繄鐟查梺绋款儛娴滎亪寮诲☉銏犖ㄦい鏃傚帶閳锋帡姊烘潪鎵槮妞ゆ垵妫濇俊鐢稿礋椤栨氨顔婇梺鐟扮摠缁诲秵绂掓ィ鍐┾拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬礃缁矂鍩ユ径鎰潊闁炽儱鍘栭悽缁樼節閻㈤潧鈻堟繛浣冲浂鏁勯柛鈩冪♁閸嬪倿鏌￠崶銉ョ仾闁绘挶鍎甸弻锟犲磼濞戞﹩鍤嬮梺璇″灠閻楀棝鍩為幋锕�鐏抽柧蹇ｅ亜娴犳挳姊洪崫鍕拱闁烩晩鍨辨穱濠囧醇閺囩偛绐涢梺鍝勵槹閸ㄧ敻宕ｆ繝鍥ㄢ拻濞达綀濮ら妴鍐磼閿熻姤鎷呴搹鍦厠闂佽崵鍠愭竟鍡涘汲閿曞倹鐓欓梻鍌氼嚟椤︼箓鏌涘▎蹇ュ姛缂佽鲸甯掗埥澶婎潩閸忚偐绉礸al闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗ù锝堟〃閻掑﹪鏌涘☉娆愮稇缂佺媭鍨堕弻銊╂偆閸屾稑顏�?
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�归崕鎴犳喐閻楀牆绗掗柛銊ュ�婚幉鎼佹偋閸繄鐟查梺绋款儛娴滎亪寮诲☉銏犖ㄦい鏃傚帶閳锋帡姊烘潪鎵槮妞ゆ垵妫濇俊鐢稿礋椤栨氨顔婇梺鐟扮摠缁诲秵绂掓ィ鍐┾拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬礃缁矂鍩ユ径鎰潊闁炽儱鍘栭悽缁樼節閻㈤潧鈻堟繛浣冲浂鏁勯柛鈩冪♁閸嬪倿鏌￠崶銉ョ仾闁绘挶鍎甸弻锟犲磼濞戞﹩鍤嬮梺璇″灠閻楀棝鍩為幋锕�鐏抽柧蹇ｅ亜娴犳挳姊洪崫鍕拱闁烩晩鍨辨穱濠囧箚閹殿喚鏉搁梺鍝勫�归娆愬閿燂拷,LeaderID: " +oldLeaderRoleId);
				}
				else if(!checkTeamStatusValid(team))
				{
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閻斿吋鐓欓梺顓ㄧ畱楠炴绱撳鍡楃仼缂佽鲸甯″畷婊勬媴闂�鎰潟闂備礁鎼張顒勬儎椤栨凹鍤曢柟缁㈠枛鎯熼梺闈涚墕濞诧箓寮叉總鍛娾拻濞达綀妫勯ˉ宥嗐亜椤愩埄妯�鐎规洘娲熼獮搴ㄦ寠婢跺苯寮ㄥ┑鐘灱閸╂牠宕濋弴鐘典笉闁煎鍊ч幏椋庢喆閸曨剛顦ュ┑鐐差檧缁犳挻鎱ㄩ敓浠嬫煏韫囧鎷烽搹顐わ拷楣冩⒒娴ｅ憡鎯堟い锔诲灦閹ê鈹戦崼銏★紡閻熸粌绻掑Σ鎰板箳濡わ拷绾惧吋绻涢幋鐐嗘垹鎷犻悙瀵哥瘈缁炬澘顦辩壕鍧楁煕韫囨棑鑰跨�殿噮鍋婂畷姗�顢欓懞銉︻仧闂備礁鍚嬫禍浠嬪磿閺屻儱纾块柣鏂跨殱閺�浠嬫煟濡搫绾у璺哄閺屽秹鏌ㄧ�ｎ亝璇為梺鍝勬湰閻╊垶鐛崶顒�绀傞柛婵勫劤濞夊潡姊绘担鍛婃儓妞ゆ垵妫濋幆鍕敍閻愯尪鎽曢梺璺ㄥ枔婵挳鐛姀锛勭闁瑰鍎愬▓鏇㈡煕閻樺啿鍝烘慨濠呮閹风娀鍨惧畷鍥﹀摋闂備礁鎽滈崰鎰焽濞嗘挻鍋╅柣鎴ｅГ閸嬪嫮鐥幏宀勫摵闁哄拑缍佸铏圭磼濡搫顫嶉梺鍛婃灝閸涱垯绗夐梺瑙勫礃椤曆囨嫅閻斿吋鐓熼柡鍐ㄥ�甸幏锟犳煛娴ｇ顏柟顔肩秺楠炰線骞掗幋婵愮�烽梻浣哄劦閸撴繈鈥﹂崶鈺傤潟闁规儳鐡ㄦ刊鏉懨归悩宸剰闁圭晫鏁诲娲嚒閵堝懏姣愰梺鍝勬噽婵烇拷闁诡喕鍗抽、娆撳箻閸涱喖顏堕梺鎸庣箓閸戜粙骞忛悜绛嬫晣闁绘ê寮堕悘浣虹磽娴ｄ粙鍝洪悽顖涘笩閻忔帡姊婚崒姘拷鎼佹偤閵娾晛绐楁慨姗嗗幘缁★拷闂佹眹鍨藉褎绂掗敃鍌涚厱闁靛鍎抽崺锝嗩殽閻愬澧甸柛鈺嬬節瀹曘劑顢橀悙韫喚闂傚倷鐒﹂崕宕囨崲閹邦剨鑰块弶鍫氭櫇娑撳秹鏌￠崒娑卞劌闁绘柨妫濋弻銈夊箹娴ｈ閿繝娈垮枛閻楁捇寮诲☉銏犖ч柛娑卞弾娴煎啴姊洪崫鍕潶闁稿﹥绻堥悰顔界瑹閿熶粙鐛幒妤�绠ｆ繝闈涙－濞兼盯姊绘担鐑樺殌闁告艾顑呴…鍥р枎閹惧瓨娅囧銈呯箰鐎氬嘲顭囬弽褉鏀介柣妯虹枃婢规绱掗敓浠嬪礃閳瑰じ绨婚棅顐㈡处閹告悂顢旈鍫熺厽闊洦鎸炬晶锔芥叏婵犲啯銇濈�规洦鍋婂畷鐔碱敆婢跺绱楁繝鐢靛仜閻°劎鍒掑畝鍕亯闁绘挸瀵掗崵鏇熴亜閹板爼妾柡鍛倐閺屻劑鎮ら崒娑橆伓?(illegal)
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閻斿吋鐓欓梺顓ㄧ畱楠炴绱撳鍡楃仼缂佽鲸甯″畷婊勬媴闂�鎰潟闂備礁鎼張顒勬儎椤栨凹鍤曢柟缁㈠枛鎯熼梺闈涚墕濞诧箓寮叉總鍛娾拻濞达綀妫勯ˉ宥嗐亜椤愩埄妯�鐎规洘娲熼獮搴ㄦ寠婢跺苯寮ㄥ┑鐘灱閸╂牠宕濋弴鐘典笉闁煎鍊ч幏椋庢喆閸曨剛顦ュ┑鐐差檧缁犳挻鎱ㄩ敓浠嬫煏韫囧鎷烽搹顐わ拷楣冩⒒娴ｅ憡鎯堟い锔诲灦閹ê鈹戦崼銏★紡閻熸粌绻掑Σ鎰板箳濡わ拷绾惧吋绻涢幋鐐嗘垹鎷犻悙瀵哥瘈缁炬澘顦辩壕鍧楁煕韫囨棑鑰跨�殿噮鍋婂畷姗�顢欓懞銉︻仧闂備礁鍚嬫禍浠嬪磿閺屻儱纾块柣鏂跨殱閺�浠嬫煟濡搫绾у璺哄閺屽秹鏌ㄧ�ｎ亝璇為梺鍝勬湰閻╊垶鐛崶顒�绀傞柛婵勫劤濞夊潡姊绘担鍛婃儓妞ゆ垵妫濋幆鍕敍閻愯尪鎽曢梺璺ㄥ枔婵挳鐛姀锛勭闁瑰鍎愬▓鏇㈡煕閻樺啿鍝烘慨濠呮閹风娀鍨惧畷鍥﹀摋闂備礁鎽滈崰鎰焽濞嗘挻鍋╅柣鎴ｅГ閸嬪嫮鐥幏宀勫摵闁哄拑缍佸铏圭磼濡搫顫嶉梺鍛婃灝閸涱垯绗夐梺瑙勫礃椤曆囨嫅閻斿吋鐓熼柡鍐ㄥ�甸幏锟犳煛娴ｇ顏柟顔肩秺楠炰線骞掗幋婵愮�烽梻浣哄劦閸撴繈鈥﹂崶鈺傤潟闁规儳鐡ㄦ刊鏉懨归悩宸剰闁圭晫鏁诲娲嚒閵堝懏鐝㈡繝纰橈拷铏窛闁告帗甯￠、姗�濮�閳ュ厖绨婚梻浣虹帛閼归箖鎮洪妸褝鎷峰顒傜Ш闁哄被鍔岄埞鎴﹀幢濞嗗繐姣堥梻浣侯攰鐏忔瑩宕戦幘鑸靛床婵炴垶鐭▽顏堟煕鐏炲墽鍟查柟椋庡厴瀵挳鍩楅埡瀣闁哄啫鐗嗙粈鍐┿亜韫囨挸顒㈤悗姘秺閺屻劌鈹戦崱娑憋拷妤�顭胯閸犳牠婀侀梺缁橈供閸嬪懎鈻嶉崱娑欑厪闁搞儜鍐句純婵犳鍣幏鐑芥⒑閻愯棄鍔氱痪缁㈠幗鐎佃偐浠﹂崜褏鐦堢紒鍓у閿曨偊骞忓畡鎵殾闁搞儯鍔嶉崰鏍⒒娴ｇ儤鍤�闁搞垺鐓￠獮濠傤潨閿熶粙鐛崘顔藉�婚柦妯侯槺椤撶厧顪冮妶鍡橆梿鐎规洜鏁婚獮鎴﹀即閵忊檧鎷婚梺绋挎湰閻熝囁囬敃鍌涚厵缁炬澘宕禍鎵拷瑙勬礃閸旀﹢濡甸幇鏉跨閻庯綀鍩栫�氬綊鏌涢幇闈涙灈缂佺姵绋掗妵鍕籍閸屾粍鎲樺┑鐐跺亹閸犳牕顫忛搹瑙勫磯闁靛鍎查悵銏ゆ⒑閻熸澘娈╅柟鍑ゆ嫹,teamId: " +teamId);
				}
				else if(!checkTeamNotInSwitchStatus(team))
				{
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閻斿吋鐓欓梺顓ㄧ畱楠炴绱撳鍡楃仼缂佽鲸甯″畷婊勬媴闂�鎰潟闂備礁鎼張顒勬儎椤栨凹鍤曢柟缁㈠枛鎯熼梺闈涚墕濞诧箓寮叉總鍛娾拻濞达絽鎼敮鍓佺磽瀹ュ拑鍔熺紒顔碱煼瀵粙顢橀悙鑸垫啺闂備浇娉曢崰鎾存叏閹绢喗鍊峰┑鐘插閸犳劙鐓崶銊р槈缂佺姵妞介弻锝呂熺喊杈ㄦ闂佸湱鍏橀ˉ鎾诲箟閹绢喖绀嬫い鎺戝亞濡蹭即姊绘担铏瑰笡闁瑰憡鎸抽弫鎾绘嚍閵夈儱顫┑鐐插悑閻楁洟鍩為幋锕�纾兼慨姗嗗幖閺嗗牓姊虹粙娆惧剰閻庢矮鍗冲璇测槈濠婂懐鏉搁梺瑙勫礃濞呮洟宕愰鐐粹拺濞村吋鐟ㄩ铏圭磽瀹ュ嫮顦︽い顐㈢箻瀹曨偊宕熼幊宄版搐閻愬﹦鎲歌箛鏃傤浄濠靛倸鎲￠埛鎴炴叏閻熺増鎼愰柨鐔诲Г濞叉牜鍙呭銈嗘尨閸嬫捇鏁撻幋鎺旑槮妞ゎ偅绻冮敍鎰攽閸ャ劍鐝滈梻鍌欑閹测�趁洪敃鍌氱婵炲棙鍔楅々鑼喐閻楀牆绗氶柍閿嬪灥閳规垿宕掑顓炴殘婵炲瓨鍤庨崐婵嬪蓟閻旂厧绀勯柕鍫濇椤忥拷??
					//psend(oldLeaderRoleId, new STeamError(TeamError.InChangeLeaderStatus));
					fire.pb.talk.MessageMgr.psendMsgNotify(oldLeaderRoleId, 141210, null);
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閻斿吋鐓欓梺顓ㄧ畱楠炴绱撳鍡楃仼缂佽鲸甯″畷婊勬媴闂�鎰潟闂備礁鎼張顒勬儎椤栨凹鍤曢柟缁㈠枛鎯熼梺闈涚墕濞诧箓寮叉總鍛娾拻濞达絽鎼敮鍓佺磽瀹ュ拑鍔熺紒顔碱煼瀵粙顢橀悙鑸垫啺闂備浇娉曢崰鎾存叏閹绢喗鍊峰┑鐘插閸犳劙鐓崶銊р槈缂佺姵妞介弻锝呂熺喊杈ㄦ闂佸湱鍏橀ˉ鎾诲箟閹绢喖绀嬫い鎺戝亞濡蹭即姊绘担铏瑰笡闁瑰憡鎸抽弫鎾绘嚍閵夈儱顫┑鐐插悑閻楁洟鍩為幋锕�纾兼慨姗嗗幖閺嗗牓姊虹粙娆惧剰閻庢矮鍗冲璇测槈濠婂懐鏉搁梺瑙勫礃濞呮洟宕愰鐐粹拺濞村吋鐟ㄩ铏圭磽瀹ュ嫮顦︽い顐㈢箻瀹曨偊宕熼幊宄版搐閻愬﹦鎲歌箛鏃傤浄濠靛倸鎲￠埛鎴炴叏閻熺増鎼愰柨鐔诲Г濞叉牜鍙呭銈嗘尨閸嬫捇鏁撻幋鎺旑槮妞ゎ偅绻冮敍鎰攽閸ャ劍鐝滈梻鍌欑閹测�趁洪敃鍌氱婵炲棙鍔楅々鑼喐閻楀牆绗氶柍閿嬪灥閳规垿宕掑顓炴殘婵炲瓨鍤庨崐婵嬪蓟閻旂厧绀勯柕鍫濇椤忥拷??,teamId: " +teamId);
				}
				else if(!checkTeamNoSuccSwitchIn2min(team))
				{
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閵夆晜鐓熼柡鍥╁仜閿熻棄婀遍敓鑺ョ啲閹凤拷2闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣告贡閸庛倝宕甸敃锟介埥澶娢熼柨瀣澑闂佽鍑界紞鍡樼閻愪警鏁婇柛銉墯閳锋垿鎮峰▎蹇擃仼缂侊拷閸愨斂浜滈柡鍥ф閹虫劙鎯岄崱娑欑厱闁逛即娼ч弸鐔兼煟閹惧瓨绀冪紒缁樼洴楠炲鈹戦崱姘厴闂備礁鎼鍡涙儎椤栫偛钃熼柨婵嗙墢閻わ拷闂佸湱鍋撳娆撳几閻樼粯鈷戦柛婵嗗濠�浼存煟閳哄﹤鐏犳い鏇秮椤㈡岸鏁撻挊澶屾殾闁圭儤鍩堝鈺傘亜閹捐泛顎撻柟椋庡厴楠炲棜顦柡锟芥禒瀣厽闁归偊鍘界紞鎴犵磼閼碱剛甯涚紒缁樼〒濞戝灚顦版惔锝囨闂備胶绮笟妤呭闯閿濆宓侀悗锝庡枟閺呮繈鏌ㄩ悢鍓佺煓闁挎繄鍋ゅ畷銊э拷娑欘焽閸欏棗鈹戦悩缁樻锭婵☆偅鐟ラ蹇撯攽鐎ｎ偆鍘介梺鎸庣箓濡瑩濡靛┑鍥ㄥ弿濠电姴鍋嗛悡鑲╋拷瑙勬礃鐢帡锝炲┑瀣垫晢濞达綀顕栭崯锟介梻鍌氬�风粈渚�骞楀鍕弿闁汇垹鎲￠崑瀣煟濡儤鈻曢柛銈嗘礋閺岀喖骞嗛弶鍟冩捇鏌￠崨顔藉�愰柡灞诲姂閹倝宕掑☉姗嗕紦
					//psend(oldLeaderRoleId, new STeamError(TeamError.ChangeLeaderInCD));
					fire.pb.talk.MessageMgr.psendMsgNotify(oldLeaderRoleId, 141209, null);
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閵夆晜鐓熼柡鍥╁仜閿熻棄婀遍敓鑺ョ啲閹凤拷2闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣告贡閸庛倝宕甸敃锟介埥澶娢熼柨瀣澑闂佽鍑界紞鍡樼閻愪警鏁婇柛銉墯閳锋垿鎮峰▎蹇擃仼缂侊拷閸愨斂浜滈柡鍥ф閹虫劙鎯岄崱娑欑厱闁逛即娼ч弸鐔兼煟閹惧瓨绀冪紒缁樼洴楠炲鈹戦崱姘厴闂備礁鎼鍡涙儎椤栫偛钃熼柨婵嗙墢閻わ拷闂佸湱鍋撳娆撳几閻樼粯鈷戦柛婵嗗濠�浼存煟閳哄﹤鐏犳い鏇秮椤㈡岸鏁撻挊澶屾殾闁圭儤鍩堝鈺傘亜閹捐泛顎撻柟椋庡厴楠炲棜顦柡锟芥禒瀣厽闁归偊鍘界紞鎴犵磼閼碱剛甯涚紒缁樼〒濞戝灚顦版惔锝囨闂備胶绮笟妤呭闯閿濆宓侀悗锝庡枟閺呮繈鏌ㄩ悢鍓佺煓闁挎繄鍋ゅ畷銊э拷娑欘焽閸欏棗鈹戦悩缁樻锭婵☆偅鐟ラ蹇撯攽鐎ｎ偆鍘介梺鎸庣箓濡瑩濡靛┑鍥ㄥ弿濠电姴鍋嗛悡鑲╋拷瑙勬礃鐢帡锝炲┑瀣垫晢濞达綀顕栭崯锟介梻鍌氬�风粈渚�骞楀鍕弿闁汇垹鎲￠崑瀣煟濡儤鈻曢柛銈嗘礋閺岀喖骞嗛弶鍟冩捇鏌￠崨顔藉�愰柡灞诲姂閹倝宕掑☉姗嗕紦,teamId: " +teamId);
				}
				else if(!checkNewLeaderNormal(team, newLeaderRoleId))
				{
					//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偞鐗犻、鏇㈡晝閿熺晫澹曡ぐ鎺撶厽闁硅揪绲鹃ˉ澶岀棯椤撱劍瀚归梻鍌欑閹诧繝宕濋弴鐑嗗殨妞ゆ帒瀚弲鎻掝熆鐠轰警鍎愭繛鍛喘濮婅櫣绮欓幐搴㈡嫳缂備礁顑呴悧鎾荤嵁韫囨洘鍠嗛柛鏇ㄥ幘閻﹀牓姊洪棃娑㈢崪缂佹彃澧藉☉鍨偅閸愨晝鍘甸梺鍏间航閸庢娊鎯岄幒妤佺厵妞ゆ梻鍘уΣ濠氭煃鐟欏嫬鐏寸�规洟浜堕崺锟犲礃閵婏附姣勯梻鍌欐祰瀹曞灚鎱ㄩ幘顔肩妞ゆ劧绠戠粻瑙勩亜閹拌泛鐦滈柡浣稿�婚幉姝岀疀閺囩噥娼熼梺鍦劋閵囨盯鏁撻弬銈囩暤妤犵偛顑呴埞鎴﹀幢閳哄倷姘︽繝纰夌磿閸嬫垿宕愰妶澶婄；濞撴熬鎷风�规洝顫夌粋鎺旓拷锝庝簼閻庮剟姊洪崷顓烆暭婵犮垺锚椤斿繐鈹戦崶銉ょ盎闂佸搫绉查崝宥夋儍閹达附鐓曟慨妤�妫楁晶瀛樻叏婵犲嫮甯涢柟宄版嚇閹煎綊鎮烽幍顕呭仹濠碉紕鍋戦崐銈夊储婵傚憡鍋嬮柟鎯х－閺嗭附绻涘顔荤凹闁哄懏鎮傞弻銊╂偆閸屾稑顏�??(闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偞鐗犻、鏇㈠煑閼恒儳鈽夐摶鏍煕濞戝崬骞橀柨娑欑懄缁绘繈鎮介棃娴讹綁鏌涢埡浣告殻闁轰焦鎹囬幊鐐哄Ψ瑜嶉埛宀勬倵鐟欏嫭绀�闁绘牕銈搁妴浣肝旈崨顔芥闂佺锕﹂崰鎾剁不閼恒儳绡�闁汇垽娼ф禒鈺呮煙濞茶绨界�垫澘锕幊鏍煛閸屾凹锟藉繘姊洪幐搴㈢闁稿﹤缍婂畷鎰版偨閸涘﹦鍘剧紒鐐緲瀹曨剚鏅堕幍顔炬／闁诡垎浣镐划闂佸搫鐬奸崰鎾诲箟閹绢喖绀嬫い鎰╁焺濞兼梻绱撴担楦挎闁告ê銈搁幃銉︾附缁嬭儻鎽曢梺鎸庣箓椤︻垶鎮炲ú顏呯厱闁规壋鏅涙俊鍨归悡搴ｇ劯婵﹨娅ｉ幏鐘诲灳閾忣偆浜愰梻浣告惈閹虫劖绻涢敓鑺ヮ殽閻愯宸ユい顓滃姂瀹曞ジ鎮㈤崨濠庝户闂傚倷娴囧▔鏇㈠闯閿曞倸绠柨鐕傛嫹??)闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏃�鎷濋幏椋庣箔濞戞ɑ鍣介柣顓熺懇閺岀喓锟芥稒顭囩粻銉╂煟閹哄秶鐭欓柡宀嬬秮楠炴帡寮幘鏉戭伓闂佸搫瀚▍姒ｉ梻鍌氬�搁崐鎼佸磹妞嬪海鐭嗗ù锝堟〃閻掑﹪鏌涘☉娆愮稇缂佺媭鍨堕弻銊╂偆閸屾稑顏�?
					psend(newLeaderRoleId, new STeamError(TeamError.MembersNotNormal));
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偞鐗犻、鏇㈡晝閿熺晫澹曡ぐ鎺撶厽闁硅揪绲鹃ˉ澶岀棯椤撱劍瀚归梻鍌欑閹诧繝宕濋弴鐑嗗殨妞ゆ帒瀚弲鎻掝熆鐠轰警鍎愭繛鍛喘濮婅櫣绮欓幐搴㈡嫳缂備礁顑呴悧鎾荤嵁韫囨洘鍠嗛柛鏇ㄥ幘閻﹀牓姊洪棃娑㈢崪缂佹彃澧藉☉鍨偅閸愨晝鍘甸梺鍏间航閸庢娊鎯岄幒妤佺厵妞ゆ梻鍘уΣ濠氭煃鐟欏嫬鐏寸�规洟浜堕崺锟犲礃閵婏附姣勯梻鍌欐祰瀹曞灚鎱ㄩ幘顔肩妞ゆ劧绠戠粻瑙勩亜閹拌泛鐦滈柡浣稿�婚幉姝岀疀閺囩噥娼熼梺鍦劋閵囨盯鏁撻弬銈囩暤妤犵偛顑呴埞鎴﹀幢閳哄倷姘︽繝纰夌磿閸嬫垿宕愰妶澶婄；濞撴熬鎷风�规洝顫夌粋鎺旓拷锝庝簼閻庮剟姊洪崷顓烆暭婵犮垺锚椤斿繐鈹戦崶銉ょ盎闂佸搫绉查崝宥夋儍閹达附鐓曟慨妤�妫楁晶瀛樻叏婵犲嫮甯涢柟宄版嚇閹煎綊鎮烽幍顕呭仹濠碉紕鍋戦崐銈夊储婵傚憡鍋嬮柟鎯х－閺嗭附绻涘顔荤凹闁哄懏鎮傞弻銊╂偆閸屾稑顏�??,newLeaderRoleId: " +newLeaderRoleId);
				}
				else if(StateCommon.isTrusteeshipState(newLeaderRoleId)) //濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴濐潟閿熻棄鍊圭粋鎺旓拷锝庡亝濞呫垽姊洪懞銉冾亪藝椤栫偛姹查梺顒�绉甸悡銉╂煟閺冨倻甯涙い銉ヮ槺缁辨挸顓奸崪鍐惈濡ょ姷鍋涢崯顐ョ亽闁荤姴娲╃亸娆戠玻閻愮儤鈷戠憸鐗堝笒娴滀即鏌涢幘纾嬪闁伙綁娼ч鍏煎緞鐎Ｑ勫闂傚倸鍊搁悧濠冪瑹濡ゅ懏鍋傛い鎾卞灪閳锋帡鏌涢弴銊ヤ簻妞ゅ浚鍙冮弻鐔碱敋閸℃瑧鐦堥梺杞扮劍閹歌崵绮嬮幒鏃撴嫹閿濆骸浜愰柟宄邦煼濮婅櫣绮欓幐搴㈡嫳闂佺厧缍婄粻鏍ь嚕閹惰姤鍋勯柛蹇氬亹閸橀亶姊虹紒妯忣亞澹曢鐔告珷闁汇垻顣幏宄扳枔閸喗鐏嶆繝鐢靛仜閿曨亜顕ｆ繝姘耿婵°倕锕ら幃鎴︽⒑閸涘﹣绶遍柛鐘崇墱缁﹪宕奸弴鐔叉嫽婵炴挻鐔幏閿嬬箾娴ｅ啿娲犻敓鏂ょ畵椤㈡﹢鎮╅崗鍝ョ憹闂備胶顢婇幓顏嗘媼閿濆洨绀婇柡宥庡幗閻撳繐鈹戦悙鎴濆暞閸ｄ粙鏌ㄥ☉娆戠煉婵﹨娅ｇ槐鎺懳熼崗鐓庢珣闂備胶顢婂▍鏇㈠礉濡や胶鐝堕柡鍥ュ灩閸ㄥ倹銇勯弮鍥舵綈闁哄偊鎷峰┑锛勫亼閸婃牕螞娴ｈ鍙忛柕鍫濐槸绾惧綊鏌熼柇锕�寮炬繛鍫滅矙閺岋綁骞嬪┑鍥ь槱闁诲孩姘ㄩ幊鎾诲煘閹达附鍊烽柤鎼佹涧濞懷呯磽娴ｇ懓绲绘繛灏栵拷鎰佸殨缂備焦锚缁剁偤鏌熼柇锕�澧柛瀣Ч濮婅櫣鎹勯妸銉︾彚闂佺懓鍤栭幏锟� by changhao
				{
					fire.pb.talk.MessageMgr.psendMsgNotify(oldLeaderRoleId, 160408, null);
				}
				else
				{
					BuffAgent buffagent = new BuffRoleImpl(newLeaderRoleId);
					if (!buffagent.canAddBuff(BuffConstant.StateType.STATE_TEAM_LEADER))
					{
						// 闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偞鐗犻、鏇㈡晝閿熺晫澹曡ぐ鎺撶厽闁硅揪绲鹃ˉ澶岀棯椤撱劍瀚归梻鍌欑閹诧繝宕濋弴鐑嗗殨妞ゆ帒瀚弲鎻掝熆鐠轰警鍎愭繛鍛喘濮婅櫣绮欓幐搴㈡嫳缂備礁顑呴悧鎾荤嵁韫囨哎浜归柟鐑樻尨閹锋椽姊洪崨濠冨磩閻忓繑鐟╁畷銏犫槈閵忥紕鍘遍梺鎸庣箓妤犳悂寮稿☉銏犵闂侇剙绉甸悡鏇熶繆閵堝懎鏆曠紒杈ㄥ▕閺岋綁鎮㈤悡搴濆枈闂佺粯鎸堕崕鐢稿蓟濞戙垹绠涢柛蹇撴憸閻╁酣姊洪幖鐐诧拷銈夊礈濞戞碍顫曢柟鎯х摠婵挳鎮归崶锝呭⒉闁伙綀娉涢—鍐Χ韫囨搩娲梺杞扮椤兘鎮伴鐣岀瘈闁稿濮ゅΛ鍐ㄧ暦閵娾晩鏁婇柤娴嬫櫆椤庡秵绻濋悽闈浶為柛銊у帶閳绘柨鈽夐姀鈥冲壎闂佺绻楅崑鎰板箹瑜版帗鈷掗柛灞捐壘閿熻姤鎮傚畷鎰板箹娴ｅ摜锛欓梺褰掓？缁�渚�鎮块娴庡綊宕楅崗鑲╃▏缂備焦鍔栭〃濠囧蓟閳ユ剚鍚嬮幖绮癸拷宕囶啇婵犳鍠涢～澶愭偂閳ユ剚娼栨繛宸憾閺佸棝鏌ㄩ悢鐑樻珪缂侇喗妫冮幃鐣岀矙鐠侯煉绱甸柣搴＄畭閸庨亶藝娴煎瓨鍋傞柡鍥ュ灪閻撴盯鏌涢妷锝呭姎濠碘�冲悑椤ㄣ儵鎮欑�电鈷堢紓渚囧櫘閸欏啴鐛�ｎ喗鏅滈悷娆欑稻鐎氬ジ姊绘担鐣屾瘒闁告劏鏅涢弳鍫ユ煟鎼淬垻鍟查柟鍑ゆ嫹?
						TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偞鐗犻、鏇㈡晝閿熺晫澹曡ぐ鎺撶厽闁硅揪绲鹃ˉ澶岀棯椤撱劍瀚归梻鍌欑閹诧繝宕濋弴鐑嗗殨妞ゆ帒瀚弲鎻掝熆鐠轰警鍎愭繛鍛喘濮婅櫣绮欓幐搴㈡嫳缂備礁顑呴悧鎾荤嵁韫囨哎浜归柟鐑樻尨閹锋椽姊洪崨濠冨磩閻忓繑鐟╁畷銏犫槈閵忥紕鍘遍梺鎸庣箓妤犳悂寮稿☉銏犵闂侇剙绉甸悡鏇熶繆閵堝懎鏆曠紒杈ㄥ▕閺岋綁鎮㈤悡搴濆枈闂佺粯鎸堕崕鐢稿蓟濞戙垹绠涢柛蹇撴憸閻╁酣姊洪幖鐐诧拷銈夊礈濞戞碍顫曢柟鎯х摠婵挳鎮归崶锝呭⒉闁伙綀娉涢—鍐Χ韫囨搩娲梺杞扮椤兘鎮伴鐣岀瘈闁稿濮ゅΛ鍐ㄧ暦閵娾晩鏁婇柤娴嬫櫆椤庡秵绻濋悽闈浶為柛銊у帶閳绘柨鈽夐姀鈥冲壎闂佺绻楅崑鎰板箹瑜版帗鈷掗柛灞捐壘閿熻姤鎮傚畷鎰板箹娴ｅ摜锛欓梺褰掓？缁�渚�鎮块娴庡綊宕楅崗鑲╃▏缂備焦鍔栭〃濠囧蓟閳ユ剚鍚嬮幖绮癸拷宕囶啇婵犳鍠涢～澶愭偂閳ユ剚娼栨繛宸憾閺佸棝鏌ㄩ悢鐑樻珪缂侇喗妫冮幃鐣岀矙鐠侯煉绱甸柣搴＄畭閸庨亶藝娴煎瓨鍋傞柡鍥ュ灪閻撴盯鏌涢妷锝呭姎濠碘�冲悑椤ㄣ儵鎮欑�电鈷堢紓渚囧櫘閸欏啴鐛�ｎ喗鏅滈悷娆欑稻鐎氬ジ姊绘担鐣屾瘒闁告劏鏅涢弳鍫ユ煟鎼淬垻鍟查柟鍑ゆ嫹?,newLeaderRoleId: " + newLeaderRoleId);
					} else
					{
						TeamManager.logger.debug("SUCC:闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢绘俊鐐�栭悧婊堝磻濞戙垹鍨傞柛灞剧◤娴滄粓鏌″鍐ㄥ闁靛棙甯楅妵鍕煛閸屾粌寮ㄩ梺鍝勭灱閸犳牠骞冨鍐炬建闁糕剝顭囬弳銉╂⒒娴ｈ銇熼柛妯圭矙閵嗗啯绻濋崶褑鎽曢梺缁樻⒒鐏忋劑骞忓畡鎵虫婵炲棙顭囬崝椋庣磽娴ｅ搫校闁圭顭烽獮鍫ュΩ閳哄倹娅滈梺鍛婄矆閻掞箓鍩㈤崼銉︹拺闁告繂瀚悞璺ㄧ磼缂佹绠撻柣锝囧厴楠炲棝鏌囬敂鍙剟姊绘担鍛婅础闁哄拋鍋呴幈銊╂倻閼恒儲娅㈤梺绋匡功閸ｃ儱顭囬幇顓犵闁告瑥顧�閼板潡鏌熼鍡欑瘈闁搞劑绠栭獮鍥ㄦ媴閸︻厾鈻夋繝鐢靛█濞佳囧磹閹间礁绠熼柨鐔哄Т绾惧鏌涢弴銊ョ仭闁绘挻娲熼悡顐﹀炊閵婏箑纰嶉梺璇″枟閸ㄥ潡寮婚敐澶嬫櫆闁兼祴鏅濊ⅵ婵犳鍠栭敃锔惧垝椤栨粎绠旈柣鏂挎憸缁★拷闂佸憡鍔﹂悡鍫熷閿燂拷?闂傚倸鍊搁崐宄懊归崶褏鏆﹂柛顭戝亜閸ㄦ棃鏌熺紒銏犳灈缂佺媭鍨堕弻銊╂偆閸屾稑顏�?,teamId: " + teamId);
						team.getTeamInfo().setSwitchleaderid(newLeaderRoleId);
						team.getTeamInfo().setSwitchleadertime(now);
						SAskforSetLeader sAskforSetLeader = new SAskforSetLeader();
						sAskforSetLeader.leaderid = oldLeaderRoleId;
						
						TeamManager.getInstance().delTeamMatch(oldLeaderRoleId); //濠电姷鏁告慨鐑藉极閹间礁纾绘繛鎴欏灪閸嬨倝鏌曟繛鐐珔闁告艾缍婇獮鏍庨锟芥俊鑲╃棯閹呯Ш闁哄备锟藉磭鏆ゆい鏂垮悑閸ｇ儤绻涢崼銉х暫婵﹥妞藉畷顐﹀礋椤曞懏钑夐梻浣侯焾鐎涒晠鎮￠敓鐘叉槬婵炴垯鍨圭粻鑽ょ磽娴ｈ鐒介柛妯圭矙濮婃椽宕崟顐嫹閹间焦鍊舵繝闈涱儏缁犳牠鏌熺�电浠﹂柛娆忕箻閺屻劌鈹戦崱姗嗘婵犳鍠栭ˇ杈╂閹烘挻缍囬柕濞垮劜鐠囩偤鎮楃憴鍕閻㈩垱甯￠崺鐐哄箣閿曪拷缁犳稒銇勯幒宥囪窗闁哥偠灏欑槐鎾诲磼濮橆剨鎷峰畡鎳婂綊宕堕妸锝勭矒闂佸綊妫跨粈渚�宕归崒鐐寸厱妞ゎ厽鍨甸弸銈夋煛閸☆厾鐣甸柡宀嬬到铻ｉ悹浣哥枃閸╁懏绻涚�涙鐭婄紓宥咃躬瀵鎮㈤崗鐓庯拷缁樹繆椤栨繃顏犲ù鐘虫尦閺岋綁鎮╁▎蹇曅ｉ悗姘炬嫹 by changhao
						
						psendWhileCommit(oldLeaderRoleId, new SRequestSetLeaderSucc(newLeaderRoleId));
						psendWhileCommit(newLeaderRoleId, sAskforSetLeader);
						fire.pb.talk.MessageMgr.psendMsgNotifyWhileCommit(oldLeaderRoleId, 141251, null);
					}
				}

				return true;
			}
		};
		setTeamLeaderP.submit();
		
	}

	// 婵犵數濮烽弫鍛婃叏閻戝锟藉倿鎸婃竟鈺嬬秮瀹曠喖顢涘槌栧數闂備浇娉曢崳锕傚箯閿燂拷?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柟闂寸绾惧鏌ｉ幇顒佲枙闁绘帟濮ょ换娑㈠幢濡纰嶉梺缁樻尰閿曘垽寮婚悢鐑樺磯妞ゎ厽鍨堕锟�
	private static int checkPvP(long oldLeaderRoleId, long newLeaderRoleId) {
		// 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸婂潡鏌ㄩ弴姘舵濞存粌缍婇弻娑㈠箛閸忓摜鏁栭梺娲诲幗閹瑰洭寮婚敐澶婎潊闁靛繆鏅濋崝鎼佹⒑閽樺鏆熼柛鐘查叄閸╃偤骞嬮敂钘変汗闂佸湱绮敮鈺傜閻愵剛绡�婵炲牆鐏濋悘鐘绘煏閸喐鍊愮�殿喛顕ч埥澶愬閻樻鍟嬫繝寰锋澘锟窖囧箯閻戣姤鐓欓柛鎰皺缁犲鏌熼绛嬫疁妞ゃ垺锕㈡慨锟介柍鎾呮嫹闁瑰嘲顭峰铏圭矙閹稿孩鎷遍梺鐓庣秺缁犳牕顕ｉ幎鑺ュ亜闁稿繗鍋愰崢閬嶆⒑缂佹◤顏嗗椤撶喐娅犻柣銏㈩暜閹峰嘲鈻撻崹顔界亶婵犵數鍋涢敃顏勵嚕椤愶箑绠荤紓浣股戝▍銏ゆ⒑鐠恒劌娅愰柟鍑ゆ嫹
		return fire.pb.battle.pvp.PvPTeamHandle.onSetTeamLeader(oldLeaderRoleId, newLeaderRoleId);
	}

//	// 闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�归崕鎴犳喐閻楀牆绗掗柛銊ュ�婚幉鎼佹偋閸繄鐟查梺绋款儛娴滎亪寮诲☉銏犖ㄦい鏃傚帶閳锋帡姊烘潪鎵槮妞ゆ垵妫濇俊鐢稿礋椤栨氨顔婇梺鐟扮摠缁诲秵绂掓ィ鍐┾拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬礃濠㈡鐏冮梺鍛婂姦娴滄繈宕抽灏栨斀闁绘ê鐏氶弳鈺呮煕鐎ｎ剙浠辩�规洜鍎ょ换婵嬪炊瑜忛鍡涙⒑鐠恒劌娅愰柟鍑ゆ嫹?濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨偓鎷锋繝姘ワ拷鍛村矗婢跺牅绨婚棅顐㈡处閹告悂鎮电�ｎ喗鐓ユ繝闈涙－濡插綊鏌￠崨顔剧煉闁哄矉绠戣灒濞撴凹鍨遍埢鎾绘⒑閹肩偛锟芥垿宕愬┑瀣畺婵°倕鎳愬畵渚�鏌涢…鎴濇灈濠殿喖楠搁埞鎴︽倷妫版繂娈濈紓浣哄У閹瑰洭鐛崘鈹垮亝闁告劏鏅濋崝鍫曟倵楠炲灝鍔氭俊顐㈢焸楠炲繑绻濆顓涙嫼闂佸憡绋戦敃銈嗘叏閿曪拷闇夋繝濠傚閻帞锟芥鍠氶…鍫ュ煡婢舵劕顫呴柨娑樺楠炴劙姊绘担铏广�婇柛鎾寸箘缁瑩骞囬弶璺ㄧ枀婵°倧绲介崯顖炴偂濞戞◤褰掓晲閸涱喗鍠愰柡浣哥墦濮婅櫣鎷犻垾铏亖闂佹悶鍔岀紞濠囧箖妤ｅ啯鏅搁柣妯哄暱娴滈亶姊洪崜鎻掍簴闁稿孩鐓″鍐差潨閿熻棄顫忔繝姘＜婵炲棙甯掗崢锟犳⒑閸涘鐒奸柛銉ｅ妼娴犻箖姊洪幖鐐插姶闁诲繑绋戦埥澶愬閻樻妲规俊鐐�栭崝锕傚礈濠靛鏅搁柦妯侯槹閸嬨儵鏌″畝瀣埌闁宠閰ｉ獮瀣晲閸涱厾鐣眔cedure濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
//	private boolean checkOldLeaderInTeam(long leaderRoleId,Team team)
//	{
//		if(team.getTeamInfo().getTeamleaderid() == leaderRoleId)
//			return true;
//		else
//			return false;
//	}
	
	// 闂傚倸鍊搁崐鎼佸磹閻戣姤鍊块柨鏇炲�归崕鎴犳喐閻楀牆绗掗柛銊ュ�婚幉鎼佹偋閸繄鐟查梺绋款儛娴滎亪寮诲☉銏犖ㄦい鏃傚帶閳锋帡姊烘潪鎵槮妞ゆ垵妫濇俊鐢稿礋椤栨氨顔婇梺鐟扮摠缁诲秵绂掓ィ鍐┾拺闁硅偐鍋涢敓绐栧洤绠柣鎴ｅГ閳锋帒霉閿濆懏鍟為柛鐔哄仜閵嗘帒顫濋褎鐤侀悗瑙勬磸閸ㄨ櫣绮嬮幒鏃撴嫹閿濆骸澧憸鏉挎椤啴濡堕崱妤冪懆闂佺锕ㄥ畷鍨珶閺囩喓闄勯柛娑橈功閸欏棝姊虹紒妯荤闁稿﹤婀遍敓鑺ョ啲閹凤拷??闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閸愯弓鐢绘俊鐐�栭悧妤冪矙閹炬眹锟藉懘寮婚妷锔惧弳濠电娀娼уΛ顓炍ｉ崫銉х＜闁跨喍绮欏畷鎺戔槈濞嗗繐浼庢繝寰锋澘锟芥洟顢栭崱娆欐嫹濮橆剛绉洪柟顔筋殘閹叉挳宕熼鍌ゆФ闂備胶顭堢换鎴︽晝閵忕姷鏆﹂柣鎴灻欢鐐烘煙闁箑澧版い鏂挎嚇濮婄儤瀵煎▎鎴濐嚤缂備焦妫忛弻鍗島re濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
	private boolean checkLeaderOnline(long leaderRoleId)
	{
		if(StateCommon.isOnline(leaderRoleId))
			return true;
		else
			return false;
	}
	
	//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閻斿吋鐓欓梺顓ㄧ畱楠炴绱撳鍡楃仼缂佽鲸甯″畷婊勬媴闂�鎰潟闂備礁鎼張顒勬儎椤栨凹鍤曢柟缁㈠枛鎯熼梺闈涚墕濞诧箓寮叉總鍛娾拻濞达絽鎼敮鍓佺磽瀹ュ拑鍔熺紒顔碱煼瀵粙顢橀悙鑸垫啺婵犵數鍋為崹鎯板綔闂佸搫顑呯�涒晜绌辨繝鍥舵晬婵犻潧娴傛禒鈺傜箾鐎电顫掗柛鏇ㄥ幘椤旀洟鏌ｆ惔銏⑩檨妞ゎ厼娲幆宀�锟斤綆鍠楅崑銊︺亜閺嶃儱锟芥寮ч敓浠嬫⒑缂佹ü绶遍柛锝忕秮閻涱喚锟斤綆鍠楅弲婵嬫煥閻斿墎鐭欓柨婵堝仱瀹曘劎锟芥稒顭囬崢顏堟⒑閸撴彃浜濈紒璇插暣閹繝鏁撴禒瀣拺闁告繂瀚崒銊╂煕閵婏附銇濋柛鈺傜洴楠炴帒螖娴ｅ搫寮抽梻浣虹帛濮婂宕曢妶鍛瀺闁哄洢鍨洪悡娆撴煟閻斿憡绶叉い蹇ｅ幖閳规垿鍩勯崘鈺侊拷鎰版煛娴ｇ锟藉潡骞冨▎鎿冩晢濞撴艾娲ら弲鐘绘⒒閸屾艾锟芥悂宕愰悜鑺ュ殑闁告挷绀侀崹婵囥亜閺嶎偄浜归柨鐔告灮缁犳挸鐣锋總绋课ㄩ柕澶涢檮琚ｉ梻鍌欐祰濞夋洟宕抽敃鍌氱闁跨噦鎷�?婵犵數濮烽弫鎼佸磻閻愬搫绠板┑鐘崇閸ゅ苯螖閿濆懎鏆為柡鍛箞閺屻劑寮撮悙璇ф嫹閸濄儲鍠嗛柨鏃傚亾閸犳劙鏌ｅΔ锟介悧鍡欑箔濮樿埖鐓熼柟鎯у船閸旀粎绱掔紒妯兼创妤犵偛顑夐幃婊堝幢濞嗗繐楔婵犵數濮幏鍐吋婢跺锟藉秹姊洪棃娑欐悙閻庢氨澧楁穱濠囨倻缁涘鏅┑鐘诧工鐎氼剚绂掕ぐ鎺撯拻濞达絿鐡旈崵鍐煕閻樻剚娈旀い顓炵仢椤粓鏁撴禒瀣畺闁诡垎锟介弨浠嬫煕椤愵偄澧悗姘秺閺屻劌鈹戦崱娑憋拷妤�顭胯婢ф濡甸崟顖涙櫆閻犲洤寮堕悵婵嗏攽椤旂》鏀绘俊鐐扮矙楠炲啴鎮滈挊澶岊吋濡炪倖妫佹慨銈夊窗閺嶎厽鈷戦柦妯侯槸閺嗭絽霉濠婂啰鍩ｇ�殿喖顭烽弫宥夊礋閼搁潧顏堕梺鎸庣箓妤犲憡鏅堕锟介弻锛勶拷锝庡亜閻忊晝绱掓潏銊ョ闁跨喐鏋荤紞鍡樼鐠轰綍鐔兼晸閽樺娓婚柕鍫濆暙閻忣亪鏌ㄥ鑸电厓閻熸瑥瀚悘瀵革拷瑙勬礀閵堝憡鎱ㄩ敓浠嬫煃閵夈劍鐝柣蹇ユ嫹闂傚倸鍊搁崐鎼佸磹閻戣姤鍤勯柛顐ｆ礀閸屻劎鎲搁弮鍫濈畺闁秆勵殔閻愬﹪鏌曟繝蹇曠暠鐎殿喖娼″娲濞戞艾顣洪梺纭呮珪閸旀瑥顕ｉ幎鑺ユ櫇闁稿本绋撻崢鎼佹煟韫囨洖浠╂い鏇嗗洤绀夋繝濠傜墛閻撳啴姊洪崹顕呭剱鐎规洖鐭傞弻鈥崇暆鐎ｎ剛袦閻庢鍣崜鐔风暦瑜版帩鏁婇柦妯侯檧閹风兘顢涘锝嗘杸濡炪倖娲栧Λ娑氱矙婵犳碍鐓曢柡鍐挎嫹闁荤啿鏅涢锝嗙節濮橆儵鈺呮煏婢跺牆鐏い顐㈢Т閳规垿鍩ラ崱妤冧淮闂佺顑嗛崝娆忕暦濠靛鏁婇柛鎾楀拑绱冲┑鐐舵彧缂嶏拷婵炲拑绲块弫顔尖槈濞嗘垹顔曢梺鑲┾拡閸撴瑩寮告惔鈧簻闁哄浂浜炵粔顔撅拷瑙勬礀缂嶅﹪銆侀弴銏狀潊闁靛繈鍨诲畵浣圭節閻㈤潧啸闁轰礁鎲￠幈銊╁箻椤旇偐锛欓梺鍛婄缚閸庢煡顢曢懞銉ｄ簻闁规崘娉涢弸鏃傜磼閻樿崵鐣洪柟顔筋殜閹棄鈻撶捄銊ュЪ闂佸搫绋勭换婵嗩潖閾忓湱纾兼慨妤�妫欓悾椋庣磽娓氬洤鏋涚紒澶婄秺閻涱噣宕奸妷銉庘晠鏌嶆潪鎷屽厡妞ゆ梹鍔栫换娑欐綇閸撗冨煂闂佺濮ょ划鎾诲箖閻愵剚缍囬柕濞у拋鍟庨梺鍝勵槸閻楀棙鏅舵禒瀣濞寸厧鐡ㄩ悡娆撴偣閸ュ洤鎳愰惁鍫ユ倵鐟欏嫭绀冮柛銊ョ秺閺佹捇寮妶鍥┬ｉ梺鍝ュУ椤ㄥ﹪骞冮敓鐘参ㄩ柨鏂垮⒔椤旀洟姊洪悷閭﹀殶闁稿濮电粩鐔肺熼懡銈囶啎闂佸憡渚楅崰鏍ㄦ叏婢跺瞼纾奸弶鍫涘妼濞搭喗顨ラ悙宸Ш闁跨喐鏋荤紞鍡涘磻閸曨垼鏁傞柨鐕傛嫹
	private boolean checkTeamStatusValid(Team team)
	{
		BuffAgent buffagent = new BuffRoleImpl(team.getTeamLeaderId());
		int conflictId = buffagent.checkCanAddBuff(BuffConstant.StateType.STATE_TEAM_LEADER);
		return conflictId == 0;
	}
	
	//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閻斿吋鐓欓梺顓ㄧ畱婢у鏌涢妶鍥ф灈闁哄苯绉剁槐鎺懳熼悜鈺傚闂備浇娉曢崰鏇炍涢崟顓犱笉鐎广儱顦壕鍧楁⒑椤掞拷缁夊绮婚鐐村�甸柨婵嗗嚱閹风兘顢橀妸褏袦閻庤娲╃换婵嬪箖濮楋拷閹筹繝濡堕崱妤佺暚婵＄偑鍊ら崢褰掑礉閹存繄鏆︽慨妤嬫嫹闁炽儻绠撻獮瀣攽閸狀喓鍔岄埞鎴︽偐閸偅姣勯梺绋款儑閸嬬娀濡甸幇鏉跨妞ゎ厽鍨归崝鐑芥⒑鐠恒劌鏋斿┑顔煎槻閻ｅ灚绗熼敓浠嬪蓟閻斿憡缍囬柛鎾楀懏娈告俊鐐�ら崑鍕箠濮楋拷瀵寮撮姀鐘诲敹濠电娀娼уú銊╁储閹扮増鈷戦柛婵嗗閸屻劑鏌涢妸锔姐仢闁糕晜鐩獮鎺懳旀担鍝勫汲闂備胶绮濠氬磿閵堝應鏋嶉柡鍥ュ灪閻撴瑩鏌ｉ悢鍛婄凡妞ゅ浚鍘奸埞鎴﹀焺閸愨晛锟芥劙鏌℃担绋匡拷鍧楀箠閻愬搫唯妞ゆ柨鍚嬪▍鏇㈡⒒閸屾艾锟藉嘲霉閸パ呮殾闁割煈鍋呴崣蹇涙煛婢跺娈繛宸憾閺佸洭鏌嶇捄鐑樻儓妞わ妇鏁婚悰顔嘉熺涵閿嬪婵炴垶顏鍕靛殨闁秆勵殕閳锋垹鎲搁悧鍫濈瑲闁挎稓鍠撶槐鎺楁晸閼恒儲濯撮柧蹇涳拷娑氱憹闂備胶鎳撻悺銊х紦閸ф鏅搁柤鎭掑劚缁楁帗銇勯锝囩疄妞ゃ垺顨嗙换婵嬪磼濮樺吋娴嗛梻鍌氬�风粈渚�骞夐敓鐘冲亜妞ゆ帒瀚粻顖炴煥閻曞倹瀚�
	private boolean checkTeamNotInSwitchStatus(Team team)
	{
		if(team.getTeamInfo().getSwitchleaderid() == -1)
			return true;
		else if((now - team.getTeamInfo().getSwitchleadertime()) > TeamManager.MAX_INVITE_TIMEOUT )
		{
			team.getTeamInfo().setSwitchleaderid(-1);
			return true;
		}
		else
			return false;
	}
	
	//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮闁汇値鍠栭湁闁稿繐鍚嬬紞鎴犵磼閹邦収娈橀柨鐔绘缁犲秹宕曢崡鐏绘椽鏁冮崒锔剧◤闂佸搫娲㈤崹娲偂閵夆晜鐓熼柡鍥╁仜閿熻棄婀遍敓鑺ョ啲閹凤拷2闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫宥夊礋椤掍焦顔囬梻浣告贡閸庛倝宕甸敃锟介埥澶娢熼柨瀣澑闂佽鍑界紞鍡樼閻愪警鏁婇柛銉墯閳锋垿鎮峰▎蹇擃仼缂侊拷閸愨斂浜滈柡鍥ф閹虫劙鎯岄崱娑欑厱闁逛即娼ч弸鐔兼煟閹惧瓨绀冪紒缁樼洴楠炲鈹戦崱姘厴闂備礁鎼鍥窗閹剧粯鏅搁柤鎭掑労閸熷繘鏌涢悩鎰佹疁妤犵偞鍨垮畷鍫曨敆閿熶粙鎷戦悢鍏肩叆闁绘柨鎼瓭闂佺粯鍔曢敃锕傚箟濮濆瞼鐤�婵炴垶顭囬鎴︽⒑缂佹﹩鐒芥い锝庡櫍楠炲繑顦版惔銏犳瀭闂佸憡娲﹂崜娑⑺囬妷鈺傚�垫繛鍫濈仢閺嬶附绻涙径瀣创闁炽儻绠撳畷鍫曞Ω瑜忛惁鍫濃攽椤旀枻渚涢柛鎾寸洴瀹曟劙鎮欏顔藉瘜闂侀潧鐗嗗Λ妤冪箔閸屾粎纾奸柟缁樺笚閸嬨儳锟芥鍠楅幐铏叏閿熶粙鏌嶉幘鍛闂佺懓鍢查…宄邦潖閾忚宕夐柕濞垮劜閻庤櫣绱撴笟鍥ф灍闁荤喆鍎甸幃楣冩倻閼恒儱浜圭紓鍌欑劍钃辨繛鍛墵濮婃椽宕ㄦ繝鍐槱闂佺顑呴幊妯虹暦閺囥垺鏅搁柨鐕傛嫹
	private boolean checkTeamNoSuccSwitchIn2min(Team team)
	{
		if((now - team.getTeamInfo().getSuccessswitchtime()) > TeamManager.MIN_SUCCESS_SWITCH_LEADER_PERIOD )
			return true;
		else
			return false;
	}
	
	//闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偞鐗犻、鏇㈡晝閿熺晫澹曡ぐ鎺撶厽闁硅揪绲鹃ˉ澶岀棯椤撱劍瀚归梻鍌欑閹诧繝宕濋弴鐑嗗殨妞ゆ帒瀚弲鎻掝熆鐠轰警鍎愭繛鍛喘濮婅櫣绮欓幐搴㈡嫳缂備礁顑呴悧鎾荤嵁韫囨哎浜归柟鐑樻尨閹锋椽姊洪崨濠冨磩閻忓繑鐟╁畷銏犫槈閵忥紕鍘遍梺鎸庣箓妤犳悂寮稿☉銏犵闂侇剙绉甸悡鏇熶繆閵堝懎鏆曠紒杈ㄥ▕閺岋綁鎮㈤悡搴濆枈闂佺粯鎸堕崕鐢稿蓟濞戙垹绠涢柣銏ゆ涧鐢儵姊洪崨濠冪叆妞わ富鍨堕垾鏃堝礃椤斿槈褔鏌涢埄鍐炬畼闁荤喕灏欑槐鎾寸瑹閸パ勭亪闂備礁搴滅徊浠嬵敋閿濆鏁冮柨鏃傜帛閺咁亪姊虹捄銊ユ灆婵☆偄瀚伴幃楣冩倻缁涘鏅濋梺鎸庢穿閹风兘宕鐐粹拺闂傚牊渚楀Σ褰掓煕閺傜偛鎳愭稉宥夋煙閹规劦鍤欓柦鍐枛閺岋綁寮崒妤佸珱闂佽桨绀佺�氫即骞冭ぐ鎺戠畳闁圭儤鍨甸‖瀣⒑閻戔晛澧叉い顓炴川濡叉劙骞樼�涙ê顎撻梺鐟扮摠鐢帡骞嗛崼銉︹拺閺夌偟澧楃粊鐗堛亜閺囧棗娲﹂崑鈺呮煟閹达絽袚闁哄懏褰冮…鍧楁嚋閻亝鍨垮鎻掝煥閸啿鎷洪梺纭呭亹閸嬫盯宕濋敓浠嬫⒑閸涘﹤濮傞柛鏂块叄椤㈡ê煤椤忓應鎷婚梺绋挎湰閻熝呯玻閺冿拷缁绘盯鎮℃惔顔惧悑闂佺娅曢悷褔骞夐幘顔肩妞ゆ帊鑳惰ぐ鎸庝繆閻愵亙绱橀柛娑卞灠缁�涔dure濠电姷鏁告慨鐑藉极閹间礁纾婚柣鎰惈閸ㄥ倿鏌涢锝嗙缂佺姴缍婇弻宥夊传閸曨剙娅ｉ梺娲诲幗椤ㄥ﹪寮婚妸鈺傚亜閻犲洦鐣幘缁樼厪闁搞儜鍐句純濡炪們鍨哄ú鐔笺�佸Δ鍛櫢濞寸姴顑冮敓钘夋嚇椤㈡宕熼鍌氬箥濠电娀娼ч崐鎼佀囬娑氼洸闁规鍣幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡欑崺婵＄偑鍊栧濠氭偤閺冨牆瑙﹂柨鐕傛嫹
	private boolean checkNewLeaderNormal(Team team, long memberRoleId)
	{
		for(xbean.TeamMember member: team.getTeamInfo().getMembers())
		{
			if(member.getRoleid() == memberRoleId)
			{
				if(member.getState() == TeamMemberState.eTeamAbsent)
					return false;
				else
					return true;
			}
		}
		return false;
	}
	
	
	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 794444;

	public int getType() {
		return 794444;
	}

	public long roleid;

	public CSetTeamLeader() {
	}

	public CSetTeamLeader(long _roleid_) {
		this.roleid = _roleid_;
	}

	public final boolean _validator_() {
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		_os_.marshal(roleid);
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		roleid = _os_.unmarshal_long();
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CSetTeamLeader) {
			CSetTeamLeader _o_ = (CSetTeamLeader)_o1_;
			if (roleid != _o_.roleid) return false;
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		_h_ += (int)roleid;
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append(roleid).append(",");
		_sb_.append(")");
		return _sb_.toString();
	}

	public int compareTo(CSetTeamLeader _o_) {
		if (_o_ == this) return 0;
		int _c_ = 0;
		_c_ = Long.signum(roleid - _o_.roleid);
		if (0 != _c_) return _c_;
		return _c_;
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

