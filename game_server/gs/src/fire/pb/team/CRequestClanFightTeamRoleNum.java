
package fire.pb.team;

// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CRequestClanFightTeamRoleNum__ extends mkio.Protocol { }

// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}
/***
 * 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊為悷婊冪箻瀵娊鏁冮崒娑氬幈濡炪値鍘介崹鍨濠靛鐓曟繛鍡楃箳缁犲鏌＄仦绋垮⒉鐎垫澘瀚敓鏂ょ秵娴滄繈顢欓崨顓涙斀闁绘劕寮堕埢鏇灻瑰鍐煟鐎殿噮鍋婂畷鍫曨敆娴ｅ搫甯鹃梻濠庡亜濞诧箑煤閺嵮勬瘎闂傚倷绀侀幉锛勬崲閸愵喓锟藉啯绻濋崒銈嗙稁缂傚倷鐒﹂…鍥偡瑜版帗鐓曢柕澶嬪灥閸犳艾顭囬懡銈囩＝闁稿本鐟чˇ锔姐亜閿曞倷鎲剧�殿噮鍋嗛幏鐘绘嚑椤掍焦顔曢梻浣告惈濞层垽宕归崷顓犱笉闁挎繂妫涚弧锟介梺闈涢獜缁辨洜绮婚幘鍓佺＝鐎广儱鎷戝銉╂煟閿濆懎妲婚摶鏍煕濞戝崬骞樻い蟻鍥ㄢ拺闁稿繗鍋愰妶鎾煛閸涱喚绠為柛鈹垮灱缁犳盯寮撮悩纰夌闯闂備胶顭堥張顒勬偡瑜忕划浣冪疀濞戞瑧鍘垫俊鐐差儏妤犳悂宕㈤幘顔界厸閻忕偛澧介妴鎺懨归悪鍛暤鐎规洘绮忛ˇ顔戒繆椤愮姴濡界紒缁樼〒閿熻姤绋掗…鍥儗鐎ｎ剛纾兼い鏃囧Г瀹曞瞼锟芥鍠栭…鐑藉箖閵忋倕宸濆┑鐘插鑲栭梻鍌欑閹诧繝骞愰崱娑樿Е闂佸灝顑呴悘鈺冪磼鏉堛劌绗х紒杈ㄥ浮婵拷闁绘灏欓鎰攽閻橆偅濯伴柛鎰ㄦ櫆瀹曞啿鈹戦垾鍐茬骇闁告梹鐟╅悰顕�骞掗幊铏閺佹捇鎮惧畝锟芥稉宥嗙箾閹寸偟鎳�濞存粍绮撻弻鐔兼倷椤掑鐣堕柣搴㈠嚬閸ｏ絽顕ｉ幆鑸汗闁圭儤鎸撮幏缁樼箾鏉堝墽鍒伴柟璇х節楠炲棝宕奸妷锔惧幗濡炪倖甯幏鐑芥煏閸埄鐒鹃柣锝夋敱鐎靛ジ寮堕幋鐙�鍟嬬紓鍌氬�烽悞锕佹懌濠电偛鎳岄崹钘夘潖濞差亜绀傞梻鍌滎棎閸╁懘姊虹粙鍨劉濠电偛锕畷娲晜閻ｅ瞼鎳濋梺璺ㄥ枍缁瑥顕ｇ拠宸悑闁搞儮鏅濋悾鍫曟⒑閸涘﹦绠撻悗姘倐楠炲繐鐣￠幍铏杸闁诲函缍嗛悡澶愬箯闁垮鐟归柨鐔绘椤曪綁顢氶敓钘夌暦閻撳簶鏀介柛鈩冪懅瀹曞搫鈹戦敍鍕杭闁稿﹥鐗曢～蹇旂節濮橆剙鍋嶉悷婊冩捣閿熶粙娼ч崥瀣箚閺冨牆惟闁挎棁顫夌�氳棄鈹戦悩鍨毄濠殿喖鐡ㄩ〃銉╁川婵犲嫷娲稿┑鐘诧工鐎氼喚绮绘ィ鍐╁仯闁搞儱娲ら幊鎰板汲閻樼粯鐓熼柟鎯у船閿熻姤鐗犻獮鍫ュΩ閵夊孩姊婚敓鏂ょ秵閸嬪嫰顢旈崼鏇熺厽閹兼番鍊ゅ鎰箾閸欏鐏寸�规洩绻濆畷姗�鎳犻浣诡啎闂備礁鎲￠〃鍫ュ磻閹邦儵锝夊醇閻旇櫣顔曢梺绯曞墲閿氶柣蹇嬪劜椤ㄣ儵鎮欓懠顑勬叏婵犲嫮甯涢柟宄版嚇閹煎綊鎮烽幍顕呭仹闂傚倷鐒﹂幃鍫曞礉瀹ュ纾垮┑鍌滎焾缁犵儤銇勯幇鈺侊拷妤冨閽樺锟芥帒顫濋濠冩暰闁诲孩鑹剧紞濠傤潖閾忚宕夐柕濞垮劜閻忓棗鈹戦埥鍡椾簻閻庢矮鍗抽崹楣冨籍閸繄顦ㄥ銈嗘煥濡插牐顦归柡灞剧洴楠炲洭鍩℃担鍓茬�冲┑鐘愁問閸犳牕霉妞嬪孩顫曢柟鎯х摠婵挳鏌ц箛鏇熷殌缂佹绻濆娲箰鎼淬垻锛橀梺鎼炲妼缂嶅﹪銆佸鑸垫櫜闁搞儯鍔岄悵鏉库攽閻愬瓨缍戞い鎴濇閿濈偛顓奸崨顏呮杸濡炪倖姊婚悺鏂库枔閺冿拷娣囧﹪顢曢敐鍥ㄥ垱閻庤娲╃紞浣哥暦閸楃偐妲堟繛鍡楁湰鐎氬ジ姊绘担鍛婂暈缂佸鍨块弫鍐Χ閸℃ê寮块梺鎸庢穿閹风兘妫佹径瀣瘈濠电姴鍊归崳鐟懊归悩杞板惈闁跨喎锟界噥娼愭繛鍙夘焽閹广垽宕奸妷锝忔嫹娴ｇ硶妲堟慨妤�妫欓崓鐢告⒑閹稿海绠撴俊顐ｇ懇瀵爼骞栨担鍏夋嫽闂佺鏈懝楣冾敂閳哄倻绠剧�瑰壊鍠栧顕�鏌曢崱鏇狀槮妞ゎ偅绻堥、妤佸緞鐏炶棄姹查梻鍌欑婢瑰﹪宕戦崱娑樼柈闁秆勵殔缁犱即鏌涢幇闈涙灍闁抽攱鍨块弻娑樷槈濮楀牊鏁炬繝銏ｆ硾鐎氫即寮诲☉妯锋瀻闊洦娲滈鎺懳旈悩闈涗粶缂佺粯锕㈤獮鍐煥閸喎娈熼梺闈涱槶閸庢壆绱撻幘缁樷拻闁稿本鑹鹃敓鑺ユ倐閹勭節閸曨厾鐓撻梺鐟邦嚟閸嬬喖銆呴柨瀣╃箚妞ゆ牗鐟ㄩ鐔哥箾閹炬剚鐓奸柡灞炬礋瀹曠厧鈹戦崶鑸碉紒闂佽绻愬ù姘跺矗閸愵喖钃熼柡鍥ュ灩闁卞洭鏌曡箛濠冩珖闁告梹鎮傚鐑樺濞嗘垶鍋ч梺绋跨箲閿氶柣锝囧厴閺佹捇鎮╅崘璇ф嫹妞嬪函鎷烽獮鍨姎婵炲眰鍊濆鍛婃償閵婏箑浜楅梺闈涚墕椤︿即宕戦敐澶嬬厱闁靛鍨甸崯鐗堫殽閸パ�鏀介柣鎰级閸ｅ綊鏌涢悢鍛婄稇妞ゎ偄绻戠换婵嗩潩椤掑偊绱叉繝娈垮枟閿曗晠宕滈妸鈺佺闁绘垼妫勭粻鐟懊归敐鍛喐闁挎稒鐟︽穱濠囨倷瀹割喖鍓伴柣搴㈢▓閺呯娀銆侀弴鐔侯浄閻庯綆鍋嗛崢顏堟⒑閸撴彃浜濈紒璇茬Т鍗遍柛婵勫劤绾惧ジ鏌ｅ▎娆愬闂佹悶鍔岄悥鐓庮嚕婵犳艾惟闁冲搫鍊告禍鐐烘⒑缁嬫寧婀扮紒瀣灴椤㈡棃鏁撻敓锟�? by changhao
 *
 */
public class CRequestClanFightTeamRoleNum extends __CRequestClanFightTeamRoleNum__ {
	@Override
	protected void process() {
		// protocol handle
		// protocol handle
		final long roleid = gnet.link.Onlines.getInstance().findRoleid(this);
		if (roleid < 0)
		{
			return;
		}
		
		mkdb.Procedure r = new mkdb.Procedure()
		{
			@Override
			protected boolean process()
			{
				int side = 0;
				Long c1 = xtable.Roleid2clanfightid.select(roleid); //濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣濠垫劖缍楅梺璺ㄥ枙濡嫰宕愰崸妤�绠板┑鐘插暟閻濆爼鏌嶉崫鍕靛剳缂佸鍠氶敓鍊燁潐濞叉粓宕伴弽顓滐拷浣糕槈濮楀棙鍍垫俊鎻掓湰閻楁洟寮幖浣光拻闁稿本鐟︾粊鐗堢箾婢跺绀嬬�规洘濞婇弫鍐磼濮橀硸鍞甸梻浣芥硶閸ｏ箓骞忛敓锟�?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ゆい顓犲厴瀵鏁愭径濠勭杸濡炪倖甯婄拋鏌ュ几濞嗘挻鈷戠紓浣姑粭鈺佲攽椤斿搫锟芥骞戦姀鐘闁靛繒濮撮懓鍨攽閳藉棗鐏ｇ紒顕呭灦瀹曟洘鎯旈妸锔规嫼闁哄鍋炴竟鍡浰囬敃鍌涘�垫慨姗嗗亜瀹撳棛锟芥鍠涢褔鍩ユ径鎰潊闁绘﹢娼ф慨鍫曟⒒娴ｅ憡鍟為柛鏂炲懐纾芥慨妯跨簿婵娊鏌ｉ姀鐘冲暈闁抽攱鍨块弻鐔虹矙閹稿孩宕崇紓浣哄У閹稿濡甸崟顖涙櫆閻犲洩灏欐禒顖滅磽娓氬洤鏋涙い顓犲厴楠炲啴鎮滈挊澶岀枃婵犵數濮撮崐鑽ょ矓濞差亝鐓涘ù锝囨嚀婵秶锟借娲栧畷顒勫煝鎼淬劌绠涙い鎾跺仦濞呫垽姊绘担钘夊惞闁稿鍋熼崰濠傤吋閸ャ劌搴婇梺鍓插亝缁诲秴顭囬弽顐ょ＝濞达綀鍋傞幋鐐插灁闁圭虎鍠楅悡鐔兼煟閺冨倸甯跺ù婊�鍗抽弻娑㈠Χ閸滀礁鍓伴梺瀹狀潐閸ㄥ潡骞冨▎鎴嫹閸偅鍋犻柛瀣仱濮婃椽宕崟顒�娅ф繝鐢靛剳閹风兘姊虹紒妯圭繁闁哥姵绋撶划璇测槈濡攱顫嶅┑鐐叉閸ㄩ潧顕ｉ幎鑺モ拺閻犲洦褰冮崵杈╃磽瀹ュ懏顥㈢�规洘绮岄埥澶愬閳ュ啿澧鹃梻浣稿閸嬩線宕曢弻銉ョ厱闁硅揪闄勯崑锝夋煙椤撶喎绗掑┑鈥炽偢閺岋紕锟斤綆浜炶倴缂備浇椴哥敮锟犮�佸▎鎾村仼閻忕偞鍎冲▍姘舵⒒娓氾拷濞佳兾涢弮鍌涱偨婵﹩鍓﹂崵鏇熴亜閺囶亝瀚归悗瑙勬礈閸樠囧煘閹寸媴鎷烽敐搴濈凹闁哄棭浜滈埞鎴︽偐閸偅姣勬繝鐢靛剳閹峰嘲鈹戦悙鏉垮皟闁搞儯鍔屾禍鍗炩攽閻樿宸ラ柣妤�妫涢幉鎾晝閸屾稓鍘卞┑鐐村灥瀹曨剟寮搁妶鍥╃＜闁宠棄鎳忕�氬湱绱撻崒娆戭槮濠⒀嗗Г閺呰泛螖閸曨剚鍣峰┑锛勫亼閸娿倝宕戦崟顖涙櫇妞ゅ繐鐗嗛拑鐔哥箾閹存瑥鐏╅幆鐔兼⒑閹稿孩绌块柟椋庡厴閺屽秶绱掑Ο鑽ゎ槶闂佽法鍠庨敓鐣屽櫏濞兼劖绻涢崣澹濐亞鍙呴梺缁樻閺呰尙鎹㈤崱娑欑厱妞ゆ劧绲剧粈锟介梺缁樺姇閿曘儵濡甸崟顔剧杸闁规儳纾ぐ鍛存⒑閻愯棄鍔滈柡瀣偢瀵劑鎳為妷锝勭盎闂佸搫鍠涢幏鐑芥煛鐎ｎ剛甯涚紒妤冨枎閳藉濮�閿涘嫬骞堥梻濠庡亜濞诧箓寮搁崒鐑嗘晜闁告洦鍋嗛妶顐︽⒒閸屾瑧顦﹀鐟帮躬瀹曟垶绗熼敓钘夌暦閺囥垹钃熼柕澶涚畱娴滄姊洪棃娑辨Т闁哄懏绮撻幃锟犳偄閸忚偐鍘搁梺鎼炲劗閺呮稒绂掑鍫熺叆闁绘梻绮ˉ澶嬬節閿熶粙鏌嗗鍡樻闂佸吋浜介崕鎶藉疮閺屻儲鐓欓柛鎴欏�栫�氾拷? by changhao
				if (c1 == null)
				{
					return false;
				}
			
				fire.pb.clan.fight.ClanFightBattleField bf = fire.pb.clan.fight.ClanFightFactory.getClanFightBattleField(c1, true);
				if (bf != null)
				{
					Long clanid = xtable.Roleidclan.select(roleid);
					if (clanid == null)
					{
						return false;
					}
					
					if (clanid == bf.getClanfightBean().getClanid1())
					{
						side = 0;
					}
					else if (clanid == bf.getClanfightBean().getClanid2())
					{
						side = 1;
					}
					else
					{
						return false;
					}
					
					SRequestClanFightTeamRoleNum msg = new SRequestClanFightTeamRoleNum();
					java.util.Map<Long, Integer> v = bf.getClanroleidsByWhich(side);
					if (v != null)
					{
						java.util.Set<Long> teamidset = new java.util.HashSet<Long>();
						for (Long e : v.keySet())
						{
							Long teamid = xtable.Roleid2teamid.select(e);
							if (teamid != null)
							{
								if (!teamidset.contains(teamid))
								{
									msg.teamnum ++;
								}
								
								teamidset.add(teamid);
							}
							else
							{
								msg.rolenum ++;
							}
						}						
					}
					
					mkdb.Procedure.psendWhileCommit(roleid, msg);
				}
				
				return true;
			}
		};
		
		r.submit();	
	}

	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 794561;

	public int getType() {
		return 794561;
	}


	public CRequestClanFightTeamRoleNum() {
	}

	public final boolean _validator_() {
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CRequestClanFightTeamRoleNum) {
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append(")");
		return _sb_.toString();
	}

	public int compareTo(CRequestClanFightTeamRoleNum _o_) {
		if (_o_ == this) return 0;
		int _c_ = 0;
		return _c_;
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

