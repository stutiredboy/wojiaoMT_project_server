
package fire.pb.team;
import fire.pb.main.ConfigManager;
import fire.pb.talk.MessageMgr;



// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CRequestTeamMatch__ extends mkio.Protocol { }

/** 最新加入功能 by changhao
*/
// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

/***
 * 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬫盯藝閻㈢鍨傚Δ锝呭暙缁犳稑霉閿濆懏璐＄紒瀣╄兌缁辨捇宕掑顒婃嫹閻戣姤鍊块柨鏇氱劍閹冲矂姊绘担鍛婂暈闁荤喆鍎抽幑銏狀潨閿熻棄顕ｆ繝姘亜闁惧繐婀遍敍婊堟⒑闂堟稓绠冲┑顔炬暬閹﹢宕奸妷锔规嫼濠电偠灏褔鐛Δ浣典簻闁靛鍎婚煬顒傦拷娈垮枦椤曆囧煡婢舵劕顫呴柣姗�娼ф慨鍫曟⒒娴ｅ憡鍟為柛鏃撻檮缁傚秹寮介‖顒婄秮瀹曞ジ濮�閵忣澁绱冲┑鐐存尰閼归箖鏁冮妷褝鎷峰顒傜Ш闁诡喗顨婇幆鍌炲川婵犲偆浼撻梻鍌欐祰濞夋洟宕板鍥у灊婵炲棙鎸惧畵浣割熆閼搁潧濮囩紒鐘垫嚀闇夐柨婵嗘处閸わ拷婵炲瓨绮撴禍璺侯潖濞差亜绀堥柟缁樺笂缁ㄨ偐绱撴担绛嬪殭閻庢矮鍗抽獮鍐倻閽樺）鈺呮煃閸濆嫬锟藉宕㈡禒瀣拺闂傚牊绋撶粻姘舵煛閸涱喚娲撮柟顔斤耿瀵濡烽敂鎯у箥闂備礁鎲￠崹顖炲磹閺嶎偓鎷峰鐐
 * @author changhao
 *
 */
public class CRequestTeamMatch extends __CRequestTeamMatch__ {
	@Override
	protected void process() {
		
		final long roleid = gnet.link.Onlines.getInstance().findRoleid(this);
		if (roleid < 0)
			return;
		mkdb.Procedure requestteammatch = new mkdb.Procedure()
		{
			@Override
			/*闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬫盯藝閻㈢鍨傚Δ锝呭暙缁犳稑霉閿濆懏璐＄紒瀣╄兌缁辨捇宕掑顒婃嫹閻戣姤鍊块柨鏇炲�甸敓鏂ょ畵瀹曞爼鍩￠崘褏鐟濆┑掳鍊х徊浠嬪疮椤栫偞鍋傞柕澶嗘櫆閻撶喖鏌￠崒姘变虎妞わ絾濞婇弻锝夘敇閻旂儤鍣伴梺鍝勫閿熻棄纾弳鍡涙倵閿濆骸澧伴柣锕�鐗撳鐑樻姜閹殿喖濡介梺瑙勭摃瀹曠數鍒掔�ｎ喖绠抽柡鍐╂尰鐎氬綊鏌ㄥ┑鍡涱�楀ù婊勭箖缁绘盯宕ㄩ鍓х厜濠殿喖锕ㄥ▍锝夊礌閺嶎厼鍗抽柣鎰ゴ閹枫倝姊绘担鍛婂暈婵﹤婀遍弫顕�鎮欓悜妯烘疅闁哄鐗勯崝搴ｅ姬閿熻棄鈹戦鏂や緵闁告ɑ鎮傞獮蹇撁洪鍛嫼闂佸憡绋戦敃锕傚煡婢舵劖鐓ラ柡鍥朵簻椤╊剛绱掗纰辩吋妤犵偞顭囩槐鎺懳熼悮瀛樺闁割煈鍋呴崣蹇斾繆椤栨粌甯堕悽顖氱埣閺岋紕锟斤絻鍔岄敓鑺ョ箞瀵鈽夐姀鈥充汗闁荤姴娉ч崱妤佸創闂傚倷娴囧銊╂倿閿曞倸绠查柛銉墮閺嬩線鏌熼崜褏甯涢柡鍛倐閺屻劑鎮ら崒娑橆伓 team->roleid->match by changhao*/
			protected boolean process()
			{	
				if (!checkLevel()) //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁跨喕妫勯崐鍧楀箰婵犲啰鐝堕柍鍝勵儑缁夘喚锟借娲滈崰鏍�佸☉姗嗘僵濡插本鐗曢弫鎼佹⒒閸屾瑦绁版繛澶嬫礋瀹曟娊鏁冮崒姘鳖唵闂佽法鍣﹂幏锟�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬬偤鎮ч悩姹囷拷渚�寮撮姀鐘栄囨煕閳╁啨浠︾紒顔瑰墲娣囧﹪鎮欓鍕舵嫹閺嶎厼绀夌憸蹇曞垝婵犳艾绠ｉ柣妯烘▕濡粓姊虹粔鍡楀濞堟洟鏌ｉ幘瀵告噰闁哄瞼鍠栭、娑樷槈濞嗘垵鍤掗柣鐐寸瀹�绋款潖閾忓湱鐭欐繛鍡樺劤閸擃參姊虹粙鍖℃敾缂佽鐗嗛锝嗙節濮橆厼浜滈梺缁樿壘閻°劎锟芥艾缍婇弻锝夊閳藉棗鏅遍梺缁樺浮缁犳牕鐣烽婊呯煓閹煎瓨鎸婚弬锟介梻浣哥枃濡嫬螞濡や胶顩插Δ锝呭暞閻撴瑩鏌涢幋娆忥拷鏍拷姘炬嫹? by changhao
				{
					psend(roleid, new STeamError(TeamError.LevelError));
					TeamManager.logger.debug("FAIL:CRequestTeamMatch闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬫盯藝閻㈢鏋侀柟鍓х帛閸嬫劙鏌涢幇顖氱处缂傚啯娲熷缁樻媴閸涘﹥鍎撳┑鐐茬湴閸斿秹骞堥妸锔绘Ч閹艰揪绲块悞鍏肩節閻㈤潧孝闁稿﹦鏁诲銊︾鐎ｎ偆鍘藉┑鈽嗗灠閹碱偆鐥閺岀喖宕楅悡搴☆潚闂佸搫鏈粙鎾寸閿旂偓瀚氶柟缁樺俯濞煎酣姊绘担鍛婃儓闁哄牜鍓欑叅闁绘棃顥撻弳锕傛煟閹惧磭宀搁柡锟芥禒瀣厱闁靛鍨甸幊鎰暦閻戞绡�缁炬澘顦辩壕鍧楁煕鐎ｎ剙鏋涙鐐诧躬楠炴鎷犻懠顒佺劸闂備胶顫嬮崟鈺�绮堕梺璺ㄥ枑閺嬬粯淇婇崶顒�绠查柛鏇ㄥ灠鎯熼梺鎸庢穿閹烽鐥紒銏犵仸婵﹥妞介獮鍡氼槾缂佺姷澧楃换婵嬫晸娴犲鐒肩�广儱鎳愰ˇ顔碱渻閵堝棛澧遍柛瀣仱閸╂盯骞嬮悩鐢碉紳婵炶揪缍�椤曟牠鎮炴禒瀣厓闁告瑣鍎崇粣鏃堟煛瀹�锟介崰鏍箖閻戣姤鍋嬮柛顐ｇ箖閻忓孩淇婇妶鍥ラ柛瀣洴瀹曨垱瀵奸弶鎴犵枀闂佸湱铏庨崰鏍矆鐎ｎ偁浜滈柟铏瑰仦鐎氱懓顪冮妶鍛劉闁圭澧藉Σ鎰板箻鐎涙ê顎撻梺鍛婃尰瑜板啴宕滈幍顔剧＝濞达綁娼ф慨鍌毭瑰鍐煟闁绘侗鍣ｉ獮鍥级鐠侯煈妲版俊鐐�栧Λ浣筋暰闂佺懓鍢查幖顐﹀煘閹达富鏁婇柣鎰靛墮濞堝苯鈹戦悙鑼勾闁稿﹥绻堝顐﹀箻缂佹ê娈熼梺闈涱檧婵″洭藝閵夆晜鐓ｉ柤濮愬�曟禒锔剧磼缂佹绠炴俊顐㈠暙閳藉宕￠悙鎻掝棈闂傚倷娴囧Λ鍕疮娴兼潙绐楅柡宥庡幖閽冪喖鏌￠崶鈺佹灁缂佺娀绠栭弻娑⑩�﹂幋婵囩亪婵犳鍠栭ˇ闈涱潖濞差亜浼犻柛鏇㈡涧閸撲即姊绘担绋跨盎缂傚秳绀侀锝嗙節濮橆厼浜滈梺绋跨箳閸樠囨晸閻ｅ瞼甯涘ǎ鍥э躬椤㈡稑鈹戦崱鏇熺潖闂備椒绱紞浣割焽瑜旈崺鐐哄箣閿旇棄锟界兘鏌ょ喊鍗炲闁冲嘲锕娲偡閺夋寧顔�闂佺懓鍤栭幏锟� "+roleid);
					return true;					
				}
				
				if (fire.pb.fushi.Module.GetPayServiceType() == 1) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛銈呭閺屾盯骞橀懠顒夋М闂佹悶鍔嶇换鍐Φ閸曨垰鍐�妞ゆ劦婢�缁墎绱撴笟濠冨婵犮垼娉涢鍕崲閸℃稒鐓忛柛顐ｇ箖閸ｆ椽鏌涢敐鍛础缂佽鲸甯￠幃鈺呮濞戞帗鐎伴梻浣告惈閻ジ宕伴弽顓犲祦闁糕剝鍑瑰Σ楣冩⒑閹稿海鈽夌紒澶婄秺瀵鏁撻悩鎻掕�垮銈嗘尵婵兘寮抽妶鍛斀妞ゆ梻銆嬮弨缁樹繆閻愭壆鐭欓柕鍡曠铻栭柛娑卞枟濞呫垽姊烘导娆戝埌闁活剙銈搁幆宀勫箻缂佹ê锟界敻鏌ｉ姀鐘冲暈濞存嚎鍊濋弻鐔风暋閺夋寧些濡炪値鍋呯换鍫ャ�佸Δ浣哥窞閻庯絾鎸堕崝鎴濐潖閾忚宕夐柕濞垮劜閻忓棗鈹戦埥鍡椾簻閻庢凹鍠氶崚鎺旀嫚瀹割喖鎮戞繝銏ｆ硾閿曪箓鏁嶉悢鍏尖拻濞撴艾娲ゆ晶顔剧磼婢跺鍤熺紒顔碱煼閹晝鎷犻懠顒夊晣闂備礁婀遍埛鍫ュ储妤ｅ啫鍌ㄦ繝濠傛噽绾剧晫锟藉箍鍎卞Λ娑欐櫠閻㈠憡鐓涢悘鐐靛亾缁�瀣拷瑙勬礈閸樠囧煘閹达箑绠涙い鎾筹紡閸ャ劉鎷虹紓鍌欑劍钃遍悘蹇曞缁绘盯鎳犻锟介弸娑氾拷娈垮枛椤攱淇婇幖浣哥厸闁稿本鐭花浠嬫⒒娴ｄ警鐒鹃柡鍫墰缁瑩骞嬮敂缁樻櫆闂佽法鍣﹂幏锟�? by changhao
				{
					DSTeamMatchInfo config = ConfigManager.getInstance().getConf(DSTeamMatchInfo.class).get(targetid);
					if (config == null)
					{
						psend(roleid, new STeamError(TeamError.NoTarget));
						TeamManager.logger.debug("FAIL:CRequestTeamMatch:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛銈呭閺屾盯顢曢敐鍡欘槬缂佺偓鍎冲锟犲蓟閿濆顫呴柕蹇婃櫇閸旀悂姊哄Ч鍥э拷婵堢不閺嶎厼钃熺�广儱顦导鐘绘煕閺囥劌澧繛鍜冪悼缁辨挻鎷呴悷鏉款潔濡炪們鍔屽Λ娆戠矚鏉堛劎绡�闁搞儺鐏涜閺屾稑鈽夐崡鐐寸亪濠电偛鎳岄崐婵嗩潖閾忓湱鐭欐繛鍡樺劤閸撴澘顪冮妶蹇曠窗闁告娅曟穱濠囨偨缁嬭法顦板銈嗙墬椤曡精顦归柡灞剧☉閳藉宕￠悙鍏稿寲闂備胶绮幐璇参涢崘顭戞綎濠电姵鑹剧壕鍏兼叏濮楀棗澧鹃柟椋庡厴楠炴牗鎷呴崫銉串闂備胶绮崹鍏兼叏閵堝纾归柛褎顨嗛悡銉╂煛閸愭寧瀚归梺褰掓敱缁诲牓鐛箛鏃戞Ч閹艰揪绲块悾璺衡攽閻愭潙鐏﹂拑鍗烆熆鐠哄搫顏柡灞剧〒閿熸枻绲芥晶搴ｅ姬閿熶粙姊洪崫鍕拱婵炲弶顭囬幑銏犫槈閵忊�筹拷閿嬨亜閹哄秷鍏岀憸鎵枛濮婄粯鎷呴懞銉ｏ拷鍐磼閿熻姤绗熼敓浠嬨�侀弽銊ョ窞闁归偊鍓濋幗鏇㈡⒑闂堟单鍫ュ疾濠婂牆纾婚柛鈩冪♁閻撴洟鎮橀悙鎻掆挃闁宠棄顦伴妵鍕疀閵夛箑顏� "+roleid);
						return true;					
					}						
				}
				else
				{
					STeamMatchInfo config = ConfigManager.getInstance().getConf(STeamMatchInfo.class).get(targetid);
					if (config == null)
					{
						psend(roleid, new STeamError(TeamError.NoTarget));
						TeamManager.logger.debug("FAIL:CRequestTeamMatch:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛銈呭閺屾盯顢曢敐鍡欘槬缂佺偓鍎冲锟犲蓟閿濆顫呴柕蹇婃櫇閸旀悂姊哄Ч鍥э拷婵堢不閺嶎厼钃熺�广儱顦导鐘绘煕閺囥劌澧繛鍜冪悼缁辨挻鎷呴悷鏉款潔濡炪們鍔屽Λ娆戠矚鏉堛劎绡�闁搞儺鐏涜閺屾稑鈽夐崡鐐寸亪濠电偛鎳岄崐婵嗩潖閾忓湱鐭欐繛鍡樺劤閸撴澘顪冮妶蹇曠窗闁告娅曟穱濠囨偨缁嬭法顦板銈嗙墬椤曡精顦归柡灞剧☉閳藉宕￠悙鍏稿寲闂備胶绮幐璇参涢崘顭戞綎濠电姵鑹剧壕鍏兼叏濮楀棗澧鹃柟椋庡厴楠炴牗鎷呴崫銉串闂備胶绮崹鍏兼叏閵堝纾归柛褎顨嗛悡銉╂煛閸愭寧瀚归梺褰掓敱缁诲牓鐛箛鏃戞Ч閹艰揪绲块悾璺衡攽閻愭潙鐏﹂拑鍗烆熆鐠哄搫顏柡灞剧〒閿熸枻绲芥晶搴ｅ姬閿熶粙姊洪崫鍕拱婵炲弶顭囬幑銏犫槈閵忊�筹拷閿嬨亜閹哄秷鍏岀憸鎵枛濮婄粯鎷呴懞銉ｏ拷鍐磼閿熻姤绗熼敓浠嬨�侀弽銊ョ窞闁归偊鍓濋幗鏇㈡⒑闂堟单鍫ュ疾濠婂牆纾婚柛鈩冪♁閻撴洟鎮橀悙鎻掆挃闁宠棄顦伴妵鍕疀閵夛箑顏� "+roleid);
						return true;					
					}					
				}
				
				Long clanfightid = xtable.Roleid2clanfightid.select(roleid);
				if (clanfightid != null)//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛銈呭閺屾盯顢曢敐鍡欙紩闂佽法鍠愰弸鑽ょ不閹惧磭鏆﹂柣鎾冲瘨閻斿棙绻濋棃娑氬闁搞倧鎷锋俊鐐�ら崑鍛崲閸曨垰绠查柛鏇ㄥ灡閹偤鎮归崶锝呭⒉鐞氀勭節閻㈤潧啸闁轰焦鎮傚畷鎴︽倷閸濆嫬鐎梺鍛婃尫缁�渚�寮搁崼顫嫹楠炲灝鍔氭い褝鎷风紓鍌氱У閻楃娀寮婚敓鐘茬倞闁崇尨鎷风紒鍗炵－閹叉悂鎮ч崼婵堢懆缂備緤鎷烽柛宀�鍋為悡鏇㈢叓閸ャ劏澹樺ù婊冩贡缁辨帞锟斤綆浜濆婵堢磼鏉堛劍灏伴柟宄版嚇瀹曨偊宕熺喊澶嬪闁规儳澧庣壕濂告煠绾板崬澧ù婊冨⒔缁辨帒鐣濋崘顔兼懙缂備胶绮换鍫濈暦閸洘鍤嬮柛顭戝亝閻濐偄鈹戦悩鍨毄濠殿喗鎸抽弫鍐Χ婢跺﹦鏌堝銈嗗姧缁茶偐鎹㈤崱娑欑叄闊洦鎸荤拹锛勭棯閹规劖顥夐棁澶愭煥濠靛棭妲规繛鎳峰啠鏀介柍銉ㄥ皺閻瑩鏌＄仦璇诧拷娑㈠Φ閹版澘绠抽柡鍐ㄥ�瑰В鍥⒒娴ｈ櫣銆婇柡鍌氬�垮畷鏇㈠箵閹烘繂娈梺鍛婃处閸ㄦ壆绮诲☉娆嶄簻闁圭儤鍨垫禍鐐烘煕閻旈鐒告慨濠勭帛閹峰懘宕ㄦ繝鍌涙畼闂備礁鎲″褰掑垂閸喚鏆︽繝闈涙閺嗗棝鏌ㄩ悢鐑樻珪闁告帗甯為幏鐘绘嚑椤掍焦顔曢梻浣规偠閸庮噣寮插┑瀣櫖婵犻潧娲ㄧ粻楣冨级閸繂鈷旂紒澶樺墯閵囧嫰寮撮悢鍝勨吂闂佸磭绮幑鍥ь嚕椤曪拷閺佹挻绂掔�ｎ�箓鏌涢弴銊ョ仭闁哄懏绮撻弻锝夊箛闂堟稑顫┑顕嗙到閻楀棜鐏冮梺缁橈耿濞佳勭濠婂牊鐓ラ柡鍥敓鑺ョ洴閹﹢宕橀瑙ｆ嫼闂佸憡绋戦敃锝囨闁秵鐓曟慨妤嬫嫹缂佺姵鐗犲顐㈩吋閸涱亝鐎婚梺鐟板⒔鐞涖儵骞忛搹鍦＝闁稿本鐟ч崝宥夋嫅鏉堛劊浜滈柕澶堝劤婢э箓鏌″畝瀣瘈闁轰焦鎸荤粋鎺旓拷锝庡亞閸斿爼鎮楅獮鍨姎閻庢稈鏅犲鏌ュ煛閸涱喒鎷洪梺纭呭亹閸嬫盯宕濋幘顔界厱闁圭偓娼欓崫娲煕閳哄倻娲存鐐差儔閺佸倿鎮剧仦钘夌疄濠电姷鏁搁崑鐐哄垂閸洘鏅濇い鎰剁畱缂佲晛鈹戦悩宕囶暡闁绘挾鍠栭弻鐔煎箲閹邦厾銆愰梺鍝勵儐閻╊垶寮婚敍鍕勃闁告挆鍕灡闁诲孩顔栭崳顕�宕滃☉銏犵闁告洦鍨版儫閻熸粌鐬煎Σ鎰熺悰鈩冩杸闂佺粯鍔樼亸娆撳箺閻樼數纾兼い鏃囧亹鏁堝Δ鐘靛仜閸熸潙鐣烽幒妤佸�锋い蹇撳鐎氱懓霉閿濆懎顥忔繛灏栨櫊閺屻倗绮欑捄銊ょ驳濠电偛鎳岄崹铏规崲濞戞熬鎷烽悽娈跨劸鐎涙繂顪冮妶鍡楃仴闁硅櫕锕㈤獮蹇涘箣閿旇棄浜滈梺绋跨箺閸嬫劙宕ｉ崱娑欌拺缂備焦蓱缁�锟介梺绋匡工濠�閬嶆晸閼恒儳鍟查柟鍑ゆ嫹? by changhao
				{ 
					fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 410040, null);
					return true;
				}
								
				Long teamid = xtable.Roleid2teamid.select(roleid);
				
				Team team = null;
				
				final java.util.ArrayList<Long> roleids = new java.util.ArrayList<Long>();
				if(teamid != null)
				{
					team = TeamManager.getTeamByTeamID(teamid);	//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬬偤鎮ч悩姹囷拷渚�寮撮姀鈩冩珕闂佽姤锚椤︻喚绱旈弴銏♀拻濞达綀娅ｉ妴濠囨煕閹惧绠為柟钘夊�婚敓鏂ょ秵閸犳牠鎮欐繝鍐︿簻闁瑰搫绉剁拹鐗堜繆椤愩垹鏆欓柍瑙勫灴閹瑥顔忛鍏碱啀婵＄偑鍊栫敮鐔轰焊濞嗘垶顫曢柣鎰嚟閻熷綊鏌ㄩ悢缁橆棄妞ゆ洩缍侀、鏇㈡晝閿熺晫绮堥崘鈹夸簻闁哄啫娲ゆ禍褰掓煥濞戞瑧鐭婇柍瑙勫灴椤㈡瑩寮妶鍫嫹鐠恒劎妫い鎾跺閻掗箖宕℃潏銊ｄ簻闁哄稁鍋勬禒锕傛煃闁垮绗掗棁澶愭煥濠靛棙绁╅柣鎺斿亾閵囧嫰濡烽妷褏顔掗梺鍝勬湰缁嬫捇鏁撻弬銈囩У濞存粍绻堣棢闁靛浚婢侀幏椋庢喆閸曨剛顦繝鈷�鍕垫疁妤犵偛妫濆顕�宕煎┑鎰秱闂備胶绮摫鐟滄澘鍟撮敐鐐寸節閸ャ劉鎷婚梺绋挎湰閼归箖鏁撻懞銉﹀�愮�规洘鍔欓獮鏍ㄦ媴閸濄儻绱梻浣哥秺濡法绮堟担鍝勵棜鐟滅増甯楅悡娆撴⒒閸屾凹鍤熸い锔肩畵閺岋綁濡舵惔鈩冪亪闂傚洤顦甸弻娑滅疀閹捐櫕鍊紓鍌氱У閸ㄥ湱妲愰幒妤�绠涙い鎾楀嫮鏆梻浣芥硶閸犳洖螞閸曨厾涓嶇�广儱顦壕鍧楁煕濡ゅ啩绱虫繛宸簼閺呮繈鏌涘畝瀣洭缂佸绻樺娲传閸曨剙鍋嶉梺鎼炲妽濡炰粙骞冮敓鐘冲亜闁稿繗鍋愰崢鐢告⒒娓氬洤寮跨紒鐘冲灴瀵鈽夐姀锛勫幈闂佸搫鍊归娆撳磿閺冨牊鐓涚�癸拷鐎ｎ剛袦濡ょ姷鍋為敃銏犵暦閿熺姵鍊烽柟缁樺俯濞兼盯姊婚崒姘拷绋棵洪妶澹﹀洭鎮界粙鑳憰闂侀潧顭堥崕顕�寮ㄦ禒瀣厱闁虫拝鎷烽柡鍛矒閸┿垽骞橀弬銉︽杸闂佸疇妫勫Λ妤佺濠靛鐓曢柕濞垮劜鐠愨剝淇婇崣澶婂妤犵偞甯￠獮妯虹暦閸モ晝宓佸┑鐘垫暩閸嬬偤宕归崼鏇熷仭闁靛鏅╅弫鍌炴煥閻曞倹瀚� by changhao
					
					if (!team.isTeamLeader(roleid))
					{
						psend(roleid, new STeamError(TeamError.SelfNOtLeader));
						TeamManager.logger.debug("FAIL:CRequestTeamMatch:濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝夊箛椤掍焦鍎撻梺鎼炲妼閸婂潡寮诲☉銏╂晝闁挎繂妫涢ˇ銉х磽娴ｅ搫小闁告濞婂璇测槈濡攱鏂�闂佸憡娲﹂崑鍕叏閵忋倖鈷戞繛鑼额嚙楠炴鏌熼悷鐗堟悙妞ゎ偄绻戠换婵嗩潩椤掑嫬鏁归梻浣虹帛閺屻劑宕查弻銉у祦闊洦绋掗埛鎴︽煙缁嬫寧鎹ｇ紒鐘虫尰閵囧嫰鏁傜拠鑼化缂備緡鍠栭…鐑藉箖閻戣棄绠犲┑鐘插�荤粔娲煛娴ｇ懓濮嶇�规洏鍔戦、姗�鎮欓崜浣侯��闂傚倸鍊风粈浣虹礊婵犲偆鐒藉┑鐘宠壘缁狀垶鏌ｉ幋锝呅撻柍閿嬪浮閺屾稓浠﹂崜褎鍣梺绋跨箰閻偐妲愰幒妤婃晪闁告侗鍘炬禒鎼佹倵濞堝灝鏋涙い顓㈡敱娣囧﹪骞栨担鍝ュ幐婵炶揪绲借ぐ銊╁即閵忥紕鍘介柟鍏兼儗閸ㄥ磭绮旈悽鍛婄叆闁绘棁娅ｉ幗鍌炴煕閵娿劋鍚柡渚囧櫍閺佹捇鎮╅棃娑氥偊闂備焦鎮堕崕娲礈閿曞倸鏋侀柛鏇ㄥ灡閻撶娀鏌熼鐔风瑨闁告柨鐡ㄧ换娑㈠礂閸忕⒈妫冨┑顔硷功缁垶骞忛崨顖滈┏閻庯綆鍋嗙粔鐑芥⒒娴ｄ警鐒惧Δ鐘叉憸婢规洟顢橀悢铏瑰骄闂佸搫娲㈤崺鍕极閸ヮ剚鐓熼柟閭﹀墰閹界娀鏌ｉ敃锟介柊锝咁潖婵犳艾纾兼慨姗嗗墾閹风兘鎮滈懞銉ユ畱闂佸壊鍋呭ú宥夋晸閺傘倗鐣电�规洖銈告慨锟介柍銉ュ暱缁ㄣ儵姊绘担渚敯闁规椿浜浠嬪礋椤栨氨鏌у┑鐘绘涧椤戝棝鎮¤箛娑氬彄闁搞儜灞藉壈闂佽法鍠曟慨銈吤哄鍛灊濠电姵纰嶉崑鎰拷瑙勬礀濞层劑顢欓弴銏♀拺闁荤喐澹嗛幗鐘绘煟閻旀潙鍔﹂柟顔惧仜鐓ゆい蹇撴噽閸樺憡绻涙潏鍓ф偧妞ゎ厼鐗撻弫鎾绘寠婢跺浠撮悗娈垮枦椤曆囧煡婢舵劕顫呴柣妯诲絻缁侇噣姊绘笟锟藉褔鈥﹂崼銉ョ？濠电姵鑹剧粻顖炴煟閹达絽袚闁哄懏鐓￠弻娑樷槈濡尨鎷烽悷鎷旀盯宕橀妸褎娈鹃梺闈浥堥弲鈺呭极婵犲洦鐓欐い鏍ф閸熶即鎮块崟顖涒拻闁稿本鑹鹃敓浠嬵棑缁牊绗熼敓浠嬬嵁閺嶎収鏁冮柕鍫濇閻濅即姊虹紒妯哄闁圭⒈鍋勯蹇撯攽閸ャ儰绨婚梺鍝勮癁閸曨偅顏為梻浣告啞濮婂綊宕归悽闈╃稏闊洦鎷嬪ú顏嶆晜闁告洦鍋嗛悰鈺佲攽閻樺灚鏆╁┑顔碱嚟閹广垽骞囬弶璺ㄧ厬闂佸搫娲㈤崹娲煕閹达附鐓熼柣鏂挎啞缁跺弶绻涢崼姘珚闁哄瞼鍠栧畷娆撳Χ閸℃浼� "+roleid);
						return true;						
					}
					else if (team.getTeamInfo().getMembers().size() >= TeamManager.MAX_MEMBER_COUNT)
					{
						psend(roleid, new STeamError(TeamError.TeamFull));
						TeamManager.logger.debug("FAIL:CRequestTeamMatch:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顕�姊哄Ч鍥э拷銈夊窗閺嶎厽绠掗梻浣侯焾缁绘劙宕ョ�ｎ剛绀婇柟瀵稿Х绾惧ジ鏌熼柇锕�寮炬繛鍫燂耿閺屻劑鎮㈢紒姗嗘缂備胶濮寸粔鐟扮暦閺囥垹纭�闁诲繒绮浠嬪极閸愵喖纾奸柨鏂垮⒔閳笺倝姊绘担鍛婃儓婵炲眰鍨藉畷鐟懊洪鍛簵闂佺粯鏌ㄩ崥瀣偂濞嗘挻鈷戞い鎾卞妿閻ｅ崬顭胯閸ㄥ爼寮诲鍥╃＜婵☆垵宕甸ˇ浼存⒑閸濆嫮鐒跨紓宥勭窔閻涱喖顫滈敓钘夌暦閿熺姵鍊烽柟缁樺醇閺囥垺鈷掑ù锝呮啞閹牓鏌ゅú璇茬仯缂侇喗姊婚幉鎾礋椤忓棛鐣鹃梻浣虹帛閸ㄧ厧螞閸曨剙鍔旈梻鍌欑窔濞佳囨晬韫囨稑绀嬮梻鍫熺♁閻ｉ亶姊婚崒姘拷鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偞顨呴…銊╁醇濠靛锛楅梻浣瑰濞叉牠宕愰崫銉т笉妞ゆ牜鍋為悡銉╂煟閺囩偛锟藉湱锟芥熬鎷� "+roleid);
						return true;						
					}
					
					team.getTeamInfo().setTargetid(targetid);
					team.getTeamInfo().setMinlevel(levelmin);
					team.getTeamInfo().setMaxlevel(levelmax);
					
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚泛鈹戦悩娈挎殰缂佺粯绻傞…鍥樄闁挎繄鍋涢…銊╁醇閻斿憡顏熷┑鐐差嚟婵挳顢栭崨顖滀笉闁哄稁鍘介悡鐔兼煙闁箑鏋涢柛鏂款儔閺岋繝宕ㄩ鍓х厜闂佸搫琚崐婵嬬嵁娓氾拷楠炴帡骞嬪┑鍡╂渐闂傚倷鑳剁划顖滄崲閸曨垰绀傛慨妤嬫嫹妤犵偛鍟灃闁告侗鍨扮粊锕傛⒑閸撹尙鍘涢柛鐘崇墬閹便劍鎯旈埥鍡樺瘜闂侀潧鐗嗙换鎰版儊濠婂牊鐓曢柕濠忕畱閳绘洟鏌℃担瑙勫磳闁瑰磭鍋ゆ俊鐑藉Ω閵夘喗顥ゅ┑锛勫亼閸娧咃拷闈涚焸瀹曞綊宕奸弴鐐典紜闂佹寧姊婚崑鎾崇暦婢舵劖鐓忓┑鐘茬箳閻ｈ京鐥紒銏犵仭缂佺粯鐩獮姗�寮堕幋婵囩槗闂備焦鎮堕崝蹇斻仈閹间礁鐤鹃柕澶嗘櫆閳锋帡鏌涚仦鍓ф噮闁告柨绉垫穱濠囨倷閺夋埈鍤嬬紓浣稿�哥粔褰掑箖濠婂牊瀵犲璺虹焾閸炵敻姊绘担鑺ョ《闁革綇绠撻獮蹇涙晸閿燂拷  by changhao
					roleids.addAll(team.getAllMemberIds());
					this.lock(xtable.Locks.ROLELOCK, roleids);
				}
				else
				{
					roleids.add(roleid);
				}
				
				Long roleidteamId = xtable.Roleid2teamid.get(roleid);
				if (teamid != roleidteamId)
				{
					psend(roleid, new STeamError(TeamError.UnkownError));
					TeamManager.logger.debug("FAIL:CRequestTeamMatch:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顕�姊哄Ч鍥э拷銈夊窗閺嶎厽绠掗梻浣侯焾缁绘劙宕ョ�ｎ剛绀婇柟瀵稿Х绾惧ジ鏌熼柇锕�寮炬繛鍫燂耿閺屻劑鎮㈢紒姗嗘缂備胶濮寸粔鐟扮暦閺囥垹纭�闁诲繒绮浠嬪极閸愵喖纾奸柨鏂垮⒔閳笺倝姊绘担鍛婃儓婵炲眰鍔戝畷浼村箻鐠哄搫袣闂佽法鍠嶇划娆忣潖閸濆嫅褔宕惰娴犲ジ姊虹拠鑼鐎癸拷閹间礁绠栨繛鍡樻尭缁犺櫕淇婇妶鍕唹闁瑰嘲顭峰铏圭矙閹稿孩鎷遍梺鑽ゅ暀閸ヤ礁娲弫鍐磼濞戞艾骞嶇紓浣哄亾濠㈡ê鐣烽浣侯洸濞寸厧鐡ㄩ悡娆愩亜閺傝濡兼繛灞傚�濋悰顕�濮�閿涘嫮顔曢柣搴㈢♁钃辩紒璺哄级缁绘稑顔忛鐓庣睄闂侀潧妫旂粈渚�鍩ユ径濞㈢喖鏌ㄧ�ｎ偅婢戦梻鍌欑閹测�趁洪敂鐣岊洸婵犻潧顑嗛崕鎾荤叓閸ャ劍灏ㄩ柡锟芥禒瀣厽婵妫楅弸娑㈡煟韫囨稐鎲鹃柡灞剧洴閸╋繝宕掑鍐ｆ嫲闁诲氦顫夊ú妯兼崲閸繍鍤曢柟缁㈠枟閸嬫劙鏌ｉ姀銏℃毄闁告柨鐖煎缁樻媴閼恒儳銆婇梺闈╃秶缁犳捇鐛箛娑欐櫢闁跨噦鎷�? "+roleid);
					return true;
				}
				
				if (!checkTeamState(team, roleid)) //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁跨喕妫勯崐鍧楀箰婵犲啰鐝堕柍鍝勵儑缁夘喚锟借娲滈崰鏍�佸☉姗嗘僵濡插本鐗曢弫鎼佹⒒閸屾瑦绁版繛澶嬫礋瀹曟娊鏁冮崒姘鳖唵闂佽法鍣﹂幏锟�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬬偤鎮ч悩姹囷拷渚�寮撮姀鐘栄囨煕閳╁啨浠︾紒顔瑰墲娣囧﹪鎮欓鍕舵嫹閺嶎厼绀夌憸蹇曞垝婵犳艾绠ｉ柣妯烘▕濡粓姊虹粔鍡楀濞堟洟鏌嶉柨瀣诞闁哄本鐩、鏇㈠Χ閸涱喚锟藉姊洪崨濠庣劷闁稿繑锕㈠濠氬Ω閵夈垺鏂�闂佺硶妾ч弲婊勬櫏闂傚倷绀侀幖顐﹀箠韫囨洖鍨濋柟鎹愵嚙閽冪喖鏌ㄩ弴顏呭闁句紮绲介妴鎺戭潩閻撳海浠梺宕囩帛閹瑰洤顫忓ú顏勭闁绘劘顕滈幏鐑藉箣閿曪拷绾捐绻濋棃娑卞剰缂佺姵鐗楁穱濠囧Χ閸涱喖娅ч悗瑙勬尫缁舵岸寮诲☉鈶╋拷锕傚箣濠靛洨浜┑鐘愁問閸犳牗顨ラ幖浣哥厴闁硅揪闄勯崐鐑芥煠绾板崬澧柛鏇㈢畺濮婅櫣绮欓崠鈩冩暰濡炪們鍔岄敃顏堢嵁閸愵喗鍋い鏍电稻閳诲本绻濆▓鍨灈闁挎洩濡囬崚鎺楊敍閻愯尙顔嗛梺鍛婄☉閻°劑宕愮紒妯诲弿婵°倧鎷锋俊顐ｆ楠炲鎮滈懞銉㈡嫽婵炶揪绲块崕銈夊吹閿熶粙姊洪幖鐐诧拷鏍偋閻樿崵宓侀煫鍥ㄧ♁閺呮悂鏌ㄩ悤鍌涘? by changhao
				{
					psend(roleid, new STeamError(TeamError.TeamStateError));
					TeamManager.logger.debug("FAIL:CRequestTeamMatch缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂傚洤顦甸弻銊モ攽閸℃ɑ鎮欓梺姹囧妽閸ㄥ潡寮婚悢椋庢殝闁哄瀵т簺婵＄偑鍊ら崑鍛崲閸儯锟戒礁顫滈敓浠嬪箖閵忋倕浼犻柛鏇ㄥ亝椤撳ジ姊婚崒娆戭槮闁硅绻濋妴鍐╃節閸愵亶娲搁梺鍓插亝濞叉牠鎷戦悢鍏肩厪濠电偟鍋撳▍鍛存煕濡や礁鈻曢柡宀嬬秮楠炲洭顢涢敐鍛杺闂備礁缍婇ˉ鎾诲礂濡櫣鏆︽い鎰剁畱鍞悷婊冪箻閹偞绺介崨濠傦拷鐢告煟瑜嶉幉锛勶拷姘秺濮婅櫣鎹勯妸銉︾�虹紓渚囧枟閻熲晠鎮伴钘夌窞闁归偊鍓涢鎰箾鏉堝墽鎮奸柟铏尰缁傚秹鏌嗗鍡忔嫼闂佸憡鎸昏ぐ鍐╃濠靛牏纾奸悹鍥ㄥ絻椤忣參鏌熼鎯у幋濠碘剝鎮傞崺锟犲磼濠婂啫绠洪梻鍌欑窔濞佳呮崲閸℃稑鐤炬繛鎴欏灪閸婂爼鏌嶉妷锔界伇闁猴拷娴犲鐓熼柟閭﹀灱閸ゅ妫呴澶婂妞ゃ劊鍎甸幃娆撳箵閹烘挻顔勯梺鍓х帛閻楃娀寮诲☉妯锋闁告鍋熸禒鈺冪磽娴ｉ绛忕紒鐘虫尭椤繐煤椤忓嫮顦梺鑲┾拡閸撴瑧鏁妷鈺傗拺闁告縿鍎辨牎缂佺偓婢樼粔鍓佸垝鐎ｎ喖绠抽柟鎯у船娴滄繈姊洪崨濠傚闁哄倷绶氶獮蹇涙惞閸︻厾锛濇繛鎾磋壘濞层倝鎮橀埄鍐闁告瑥顥㈤鍫濈厺鐎广儱顦獮銏＄箾閸℃ê鐏╅柨娑欑矒閺岋絾鎯旈婊呅ｉ梺绋款儏閹虫劖绂嶉幖浣瑰仺闁告稑锕﹂崢閬嶆⒑閸︻厼鍔嬮柟鍝ヮ焾闇夋い鏇嫹闁哄本鐩崺锛勶拷锝庡墰閻﹀牓鎮楃憴鍕濞存粍绻堥獮蹇涘川椤栨稑鏋傞梺鍛婃处閸撴稖銇愰妸锔剧瘈闁汇垽娼у暩闂佽桨鐒﹂幃鍌氱暦閹达附鍊烽柛婵嗗閻庮參姊洪崜鎻掍簼婵炲弶锕㈠畷鎴︽晬閸曨剙鏋戦梺鍝勫暙閻楀棛绮婚弽顓熺厱鐟滃酣銆冮崱娑樼柧缂佸锛曡ぐ鎺撳亹鐎瑰壊鍠栭崜閬嶆⒑閹惰姤鏁遍悽顖涘浮濠�渚�姊洪幐搴ｇ畵闁瑰啿绻樺畷顖炴倷閻戞鍘遍梺缁樻煥閹碱偅绂掗柆宥嗙厸閻忕偤娼婚幏宄扮暦閸ャ劍鐣烽梺璇插嚱缂嶅棝宕滃☉銏″剨闁割偁鍎查埛鎴﹀级閻愭潙顥嬮柛鏂跨Ч閺岀喖鎮烽悧鍫熸倷闂佷紮绲块崗姗�鐛崶顒佸亱闁割偅绻�缁ㄥ姊绘担鍛婂暈缂佸搫娼″畷鏇㈠础閻愨晜顫嶉悷婊勬煥椤繒绱掑Ο璇差�撻梺鎯х箳閹虫挾绮敍鍕＝濞达絽鎲￠幆鍫熺箾鐏忔牭鎷峰畷鍥ㄦ闂佸湱澧楀姗�宕￠幎鑺ョ厪闊洦娲栧暩闂佸憡鐟遍幏閿嬬節閻㈤潧袨闁搞劌銈稿畷娲冀椤撶偟顦梺鍝勬川婵攱绋夊澶嬬厾濠殿喗鍔曢敓绐栧洤绠瀣閸犲棝鏌涢弴銊ュ妞わ负鍎遍埞鎴︽倷瀹割喗顎嗙紓浣哄У閹稿骞堥妸鈺傛櫢濞寸姴顑嗛悡蹇涙煕椤愶絿绠栨い銉у█閺屾稑顫滈敓钘夘焽瑜旈垾鏃堝礃椤斿槈褔鏌涢埄鍐夸緵婵﹥瀵х换婵嗏枔閸喗鐏侀梺绋匡攻椤ㄥ棛绮嬪澶婄濞撴艾娲﹂弲锝夋⒑缂佹ɑ鈷掔紒缁樼箘閼鸿京鎷犲顔藉瘜闂侀潧鐗嗗Λ妤佹叏閿曞倹鐓曢柟鎯х摠閻ㄦ垿鏌ㄩ悢璇残撻柣鏃戝墴楠炲繘鏁撻敓锟�? "+roleid);
					return true;
				}
				
				if (!checkTeamMemberNum(team)) //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁跨喕妫勯崐鍧楀箰婵犲啰鐝堕柍鍝勵儑缁夘喚锟借娲滈崰鏍�佸☉姗嗘僵濡插本鐗曢弫鎼佹⒒閸屾瑦绁版繛澶嬫礋瀹曟娊鏁冮崒姘鳖唵闂佽法鍣﹂幏锟�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬬偤鎮ч悩姹囷拷渚�寮撮姀鐘栄囨煕閳╁啨浠︾紒顔瑰墲娣囧﹪鎮欓鍕舵嫹閺嶎厼绀夌憸蹇曞垝婵犳艾绠ｉ柣妯烘▕濡粓姊虹粔鍡楀濞堟洟鏌嶉柨瀣诞闁哄本鐩、鏇㈠Χ閸涱喚锟藉姊洪崨濠庣劷闁稿繑锕㈠濠氬Ω閵夈垺鏂�闂佺硶妾ч弲婊勬櫏闂傚倷绀侀幖顐﹀箠韫囨洖鍨濋柟鎹愵嚙閽冪喖鏌ㄩ弴顏呭闁句紮绲介妴鎺戭潩閻撳海浠梺宕囩帛閹瑰洤顫忓ú顏勭闁绘劘顕滈幏鐑藉箣閿曪拷绾捐绻濋棃娑卞剰缂佺姵鐗楁穱濠囧Χ閸涱喖娅ч悗瑙勬尫缁舵岸寮诲☉鈶╋拷锕傚箣濠靛洨浜┑鐘愁問閸犳牠鏌婇敐澶婅摕闁挎繂妫欓崕鐔兼煏韫囨洖孝婵絽鐗撳娲川婵犲嫭鍣ч梺鍝ュ枑閹告娊鎮伴锟藉畷鍗炩槈濡厧锟界偤姊洪棃娴ゆ稓浠﹂崜褋鍋掗梻鍌欐祰椤曆囧礄閻ｅ瞼绀婇柛鈩冪☉绾惧鏌涢埄鍐槈闁稿被鍔戦弻鐔兼⒒鐎电濡介梺鎶芥敱閸ㄥ潡骞冭ぐ鎺戠畳闁圭儤鍨甸‖鍫濃攽閻愬弶鍣洪柛鏃�鐟╁濠氭偄閻撳海顦╅梺闈涚墕濡顢旈敓锟�? by changhao
				{
					psend(roleid, new STeamError(TeamError.TeamEnoughFull));
					TeamManager.logger.debug("FAIL:CRequestTeamMatch闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顕�姊哄Ч鍥э拷銈夊窗閺嶎厽绠掗梻浣侯焾缁绘劙宕ョ�ｎ剛绀婇柟瀵稿Х绾惧ジ鏌熼柇锕�寮炬繛鍫燂耿閺屻劑鎮㈢紒姗嗘缂備胶濮寸粔鐟扮暦閺囥垹纭�闁诲繒绮浠嬪极閸愵喖纾奸柨鏂垮⒔閳笺倝姊绘担鍛婃儓婵炲眰鍨藉畷鐟懊洪鍛簵闂佺粯鏌ㄩ崥瀣偂濞嗘挻鈷戞い鎾卞妿閻ｅ崬顭胯閸ㄥ爼寮诲鍥╃＜婵☆垵宕甸ˇ浼存⒑閸濆嫭婀伴柣鈺婂灦楠炲啴濮�閵堝棛鍙嗛柣搴秵娴滄繈鎮炬繝姘拻濞达絽鎲￠幆鍫ユ偠濮樼厧浜扮�规洘鍔曡灃闁告侗鍘鹃悰銉︾節閻㈤潧孝婵炲眰鍊楀☉鐢告晸娴犲鈷戠紓浣姑慨鍥ㄤ繆椤栨熬宸ユい顓炴处閵堬綁宕橀埞鐐濠电偠鎻徊钘夛耿閸楃儑鑰垮ù鐘差儐閻撴洟骞栧ǎ顒�濡洪柟鑼亾椤ㄣ儵鎮欑拠褑鍚Δ鐘靛仜濞差參銆佸▎鎴犻┏閻庯綆鍋嗙粙鎰版⒒閸屾瑦绁版い顐㈩樀瀹曟洟骞庨懞銉ヤ槐闂侀潧顭粻鎴﹀垂閺冨牊鍊甸梻鍫熺♁閹插摜鐥幆褋鍋㈤柟顔筋殜閺佹劖鎯旈垾鑼跺焻闂備胶顭堢花娲磿闁秵绠掗梻浣虹帛椤牆鐣烽悽鍛婂仼婵炲樊浜濋悡娆愩亜閺冨倻鎽傛繛鍫熸閺屽秶绱掑Ο璇茬３閻庤娲栫紞濠囥�佸▎鎾村仼閻忕偛锟界噥鍞归梻鍌氬�搁崐鐑芥嚄閸洖绠犻柟鎹愵嚙閸氬綊鏌″搴″箹缂佺媭鍨堕弻銊╂偆閸屾稑顏� "+roleid);
					return true;												
				}
				
				if (!checkFaction(roleid)) //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁跨喕妫勯崐鍧楀箰婵犲啰鐝堕柍鍝勵儑缁夘喚锟借娲滈崰鏍�佸☉姗嗘僵濡插本鐗曢弫鎼佹⒒閸屾瑦绁版繛澶嬫礋瀹曟娊鏁冮崒姘鳖唵闂佽法鍣﹂幏锟�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬬偤鎮ч悩姹囷拷渚�寮撮姀鐘栄囨煕閳╁啨浠︾紒顔瑰墲娣囧﹪鎮欓鍕舵嫹閺嶎厼绀夌憸蹇曞垝婵犳艾绠ｉ柣妯烘▕濡粓姊虹粔鍡楀濞堟洟鏌嶉柨瀣诞闁哄本鐩、鏇㈠Χ閸涱喚锟藉姊洪崨濠忚�块柡锟芥潏鈺傚床婵炴垯鍨圭粻锝嗙箾閸℃绠抽柛鏃�鎸冲鐑樻姜閹殿噮妲┑鈽嗗亝缁诲牆顕ｆ繝姘╅柍鍝勫�告禍婊堟⒑缂佹ê鐏﹂拑閬嶆煟濠垫劒閭慨濠冩そ瀹曘劍绻濋崟顒�娈忛梻浣烘嚀閸ゆ牠骞忛敓锟�? by changhao
				{
					psend(roleid, new STeamError(TeamError.NoFaction));
					TeamManager.logger.debug("FAIL:CRequestTeamMatch婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劕鐏氶崳褏绱撴担绋款暢闁稿鍊濆璇测槈閵忕姈銊︺亜閺冨倸甯舵い顐熸櫇缁辨挻绗熸繝鍐伓闂備礁澹婇崑鍡涘窗閹捐泛濮柨鐔剁矙濮婂宕掑鍗烆杸缂備礁顑嗙敮锟犲极瀹ュ绫嶉柛顐ゅ枔閸橀箖姊洪崫鍕垫Ъ婵炲娲樼粋鎺楀閵堝棭姊挎繝銏ｅ煐閸旀牠鎮￠妷锔剧瘈闂傚牊绋掗ˉ鐐烘煕閿濆牜娼愰柕鍥у婵＄兘濡疯椤旀帡姊洪崫鍕拱闁烩晩鍨堕獮鍐閵堝棛鍙嗛柣搴秵娴滄繈鎮炬繝姘拻濞达絽鎲￠幆鍫ユ煛閸偄澧悡銈嗕繆椤栨瑨顒熼柛銈嗩殜閺屾盯寮撮妸銉т哗闂備礁宕ú锔炬崲濠靛鍨傛い鎰剁到闂夊秹鏌ｆ惔顫孩妞ゎ偄顦扮粚杈ㄧ節閸ヮ灛褔鏌涘☉鍗炲箺婵炲牆鐖煎铏圭磼濡偐鐓�濡炪値鍘鹃崗妯侯嚕婵犳艾惟闁冲搫鍊告禍鐐烘⒑缁嬫寧婀扮紒瀣灴椤㈡棃鏁撻敓锟� "+roleid);
					return true;					
				}
				
				if (!checkActiveTime()) //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁跨喕妫勯崐鍧楀箰婵犲啰鐝堕柍鍝勵儑缁夘喚锟借娲滈崰鏍�佸☉姗嗘僵濡插本鐗曢弫鎼佹⒒閸屾瑦绁版繛澶嬫礋瀹曟娊鏁冮崒姘鳖唵闂佽法鍣﹂幏锟�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬬偤鎮ч悩姹囷拷渚�寮撮姀鐘栄囨煕閳╁啨浠︾紒顔瑰墲娣囧﹪鎮欓鍕舵嫹閺嶎厼绀夌憸蹇曞垝婵犳艾绠ｉ柣妯烘▕濡粓姊虹粔鍡楀濞堟洟鏌ｉ幘瀵告噮缂佽鲸鎸婚幏鍛叏閹搭厺绨肩紒宀勪憾椤㈡稑鈽夊槌栧晭闂備礁婀遍崑鎾诲礈濮樿埖鍋傚┑鍌氭啞閻撴盯鎮橀悙鎻掆挃妞ゎ剙鍚嬮妵鍕晝娴ｅ湱褰ч梺闈涙搐鐎氱増淇婇幖浣肝ㄩ柨鏇嫹婵炲憞鍛＝濞撴艾娲ら弸娑㈡煟濡わ拷閿曘倝顢氶妷鈺佺妞ゆ牗姘ㄩ悿锟芥俊鐐�栭幐鐐叏鐎靛憡鏆滈柟顖嗭拷閺�浠嬫煟濡櫣浠涢柡鍡忔櫊閺屾稓锟斤綆鍋嗗ú鎾煙椤旂煫顏堝煘閹寸媴鎷烽敐搴濈敖妞わ富鍣ｅ娲濞戞艾顣哄┑鐐茬湴閸斿矁鐏嬪銈嗙墱閸嬬偤鎮″▎鎰╀簻闁哄诞鍕垫闂佹椿鍓欓妶绋跨暦閵壯嶆嫹閿濆骸鏋熼柍閿嬪灴閺屾稑鈹戦崱妤婁紑闂佺粯甯熷▔鏇犳閹烘梻纾兼俊顖濆亹閻ゅ嫰鎮楀▓鍨珮闁稿锕悰顔嘉熺涵閿嬪闂傚牊绋戦ˉ蹇旂箾閺夋垵顏柡宀嬬稻閹棃顢涘鍛咃綁姊虹粙娆惧剰閻庢矮鍗冲顐﹀箻鐎靛壊娴勯柣搴秵閸嬪懘寮抽悩缁樷拺闂傚牊绋掗幖鎰版倵濮橆偄宓嗛柣娑卞櫍楠炴帡骞嬮鐐村�梻浣规偠閸庣儤绂嶉悙鐑樺仒闁靛濡囩弧锟界紒鍓у閿曨偊骞忛悜鑺ユ優妞ゆ劗鍠愰悘鍡涙⒒娴ｈ鍋犻柛鏂跨箰閳绘柨鈽夐～顔剧◤闂婎偄娲﹀鑽ゅ姬閿熻棄鈹戦鏂や緵闁告挻鐩弫宥咁煥閸啿鎷洪梺鍦焾鐎涒晠藟閸℃ü绻嗘い鎰╁灩椤忣厽銇勯姀鈩冾棃闁轰焦鎹囬弫鎾绘晸閿燂拷? by changhao
				{
					psend(roleid, new STeamError(TeamError.ActiveNotOpen));
					TeamManager.logger.debug("FAIL:CRequestTeamMatch婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鐐劤椤兘寮婚敐鍛傜喖宕崟顒�锟藉酣姊虹紒妯虹瑨闁挎洏鍎垫俊鐢稿礋椤斿墽鏉搁梺瑙勫礃濞夋盯鍩涢崼銉︹拺閺夌偞澹嗛ˇ锔姐亜閹存繃鍠樻鐐差樀瀹曘劍绻濋崘銊ュΤ闂備線娼ч…鍫ュ磿閹惰姤鍋柛鏇ㄥ灡閳锋垿姊婚崼鐔峰礋闁割偁鍎遍悿鐐箾閹存瑥鐏柛瀣�圭换娑㈠箣濞嗗繒浠鹃梺缁樻尰濞叉鎹㈠☉銏犵婵犻潧妫滈崺鐐参旈悩闈涗沪闁绘濞�瀵鏁愰崨顏呮杸闂佹悶鍊曟竟濠冪椤忓牆鐏抽柡鍐ㄧ墕缁�鍐┿亜閺傛寧顫嶇憸鏃堝蓟濞戞ǚ妲堥柛妤冨仧娴狀垰顪冮妶鍡樼叆婵炲樊鍙冨濠氭晲閸℃ê鍔呴梺闈涚箳婵潙袙閸儲鈷戦柛婵勫劚鏍＄紒鐐緲缁夊墎鍒掗埡鍛亜闁绘挸楠稿畵鍡涙⒑缂佹ɑ顥嗘繛鍜冪秮閹線宕煎┑鍐╂杸濡炪倖姊归弸缁樼瑹濞戙垺鐓曟慨妤嬫嫹缂佺姵鐗曢悾鐑藉閵堝懐顔愭繛杈剧到閸樻粓骞忓ú顏呯厽闁绘ê鍘栭懜顏堟煕閺傝儻瀚伴柍璇茬Ч楠炲洭鎮ч崼銏犲箥闂備礁鎲￠崹顖炲磹閺嶎偓鎷峰鐐? "+roleid);
					return true;						
				}
				
				/*if (fire.pb.buff.Module.existState(roleid,
						BuffConstant.StateType.STATE_INSTANCE_ZONE)) {
					psend(roleid, new STeamError(TeamError.SelfInUnteamState));
					TeamManager.logger.debug("FAIL:闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亜顒㈡い鎰Г閹便劌顫滈崱妤�鈷掗梺缁樺笂缁瑩寮婚妶鍡樺弿闁归偊鍓ㄩ幏鐑藉冀椤愵剚瀚规慨姗嗗墻閻撳ジ鏌″畝瀣М鐎殿噮鍣ｅ畷鎺戭潩椤戣法甯涚紓鍌氬�风欢銈夊箯瀹勯偊鐔嗛柤鎼佹涧婵牓鏌涙繝鍌滃煟闁哄矉缍侀獮鍥敇閻愮數銈烽梻浣瑰▕閺�鍗炍涢崘顔艰摕闁挎繂鎳夐弨浠嬫煕閳╁啰鎳冮柣鎾跺枛濮婃椽宕崟顒佹嫳闂佺儵鏅╅崹杈ㄧ┍婵犲洦鍊荤紒娑橆儐閺呪晠姊虹紒妯诲碍閻庡灚甯掗…鍥ㄧ節濮橆厸鎷洪柣鐘叉处瑜板啴顢楅姀銈嗙厾鐟滅増甯為悾娲寠濠靛枹褰掑礂閸忚偐绋囨俊妤�鎳樺娲川婵犲啫顦╅梺鎼炲妽婢瑰棛鍒掓繝姘櫜濠㈣泛顑囬崣鍡椻攽閻樼粯娑ф俊顐ｇ懇瀹曟娊鎮烽幍铏杸濡炪倖姊归崕鎶藉储鐎涙ɑ鍙忓┑鐘插暞閵囨繄锟借娲忛崝宥囨崲濠靛﹦鐤�閹艰揪缍�缁绘垿姊婚崒娆戭槮闁硅绻濋獮鎰偅閸愩劎鐛ラ梺鍝勮癁鐏炶姤顓块梺鑽ゅТ濞诧妇绮婇弶鎳筹綁宕奸妷锔惧帾闂婎偄娲ら敃銈嗘櫠閸欏绠鹃柛娑卞亜閻忓弶鎱ㄦ繝鍛仩闁圭懓瀚版俊鎼佸Ψ閿旀儳缍掗梻鍌欒兌閹虫捇宕甸弽顓炵闁跨噦鎷�? "+roleid);
					return true;
				}*/

				if (checkPvP(roleid) != 0) {
					return true;
				}

				addTeamMatch(roleid, roleidteamId); //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬫盯藝閻㈢鍨傚Δ锝呭暙缁犳稑霉閿濆懏璐＄紒瀣╄兌缁辨捇宕掑顒婃嫹閻戣姤鍊块柨鏇氱劍閹冲矂姊绘担鍛婂暈闁荤喆鍎抽幑銏ゅ箳濡や焦娅㈤梺绋匡功閸ｃ儱顭囬幇顓犵闁告瑥顦辨晶顏堟偂閵堝鐓忓┑鐐靛亾濞呭懐鐥銊﹀濠电姵顔栭崰妤呪�﹂崼銉ユ槬闁哄稁鍘肩壕褰掓煕椤垵浜炵紒鐘荤畺閺岀喓锟界數顭堟禒褔鏌熼搹顐㈠闁哄矉缍侀獮鎺戭吋閸モ晝鍘梻浣告惈閼活垳绮旈崜浣诡潟闁圭儤鍤﹂悢鍏煎�婚柍鍝勫�搁鎼佹⒒閸屾瑧绐旀繛浣冲厾娲Χ閸ラ攱瀚规慨妯煎帶閻忥絿绱掗娆惧殭闁宠棄顦垫慨锟介柣妯活問閸熷姊绘担鍝ョШ妞わ綇绠戦—鍐箳濡わ拷缁犳牠鏌ㄥ┑鍡╂Ч闁抽攱甯掗湁闁挎繂鐗婇鐘绘偨椤栨稓娲撮柡宀嬬到铻栭柛鎰╁壉閿濆洨纾奸柛灞炬皑鑲栭梺鍦嚀鐎氼厾绮悢纰辨晬婵炴垶姘ㄩ埢澶娾攽閻樺灚鏆╅柛瀣☉铻ｅ┑鐘插暟椤╁弶绻濇繝鍌涘櫧婵☆偒鍨抽幉鎼佸籍閸繄鐣洪悷婊呭鐢帞绮婚幒妤佺厵闁绘垶锚閻忋儲銇勯妷銉╁弰婵﹥妞藉Λ鍐ㄢ槈濮樿京鏉介梻浣侯焾閿曘儵鎮ч悩璇茬畺闁跨喓濮撮崡鎶芥煏韫囥儳纾块柛妯绘崌閺屸剝寰勭仦鎴掓勃婵犳鍨划娆忕暦濡わ拷閻ｆ繈宕熼鍌氬箺闂傚鍋勫ú锔剧矙閹版澘绠熷Δ锝呭暞閻撴稓锟界櫢鎷烽柨鐔剁矙瀹曚即寮介婊愭嫹娴ｅ壊娼╅悹鍝勬惈閼板灝鈹戦埥鍡楃仧閻狅拷閿旇棄顕遍柨鐕傛嫹? by changhao
								
				SRequestTeamMatch msg = new SRequestTeamMatch();
				msg.levelmin = levelmin;
				msg.levelmax = levelmax;
				msg.targetid = targetid;
				msg.typematch = typematch;
				
				for (Long roleid : roleids)
				{
					mkdb.Procedure.psendWhileCommit(roleid, msg);					
				}
				
				return true;
			}
			
		};
		requestteammatch.submit();	
	}
	
	private void addTeamMatch(long roleid, Long teamid)
	{
		xbean.TeamMatch teammatch = xbean.Pod.newTeamMatch();
		
		teammatch.setRoleid(roleid);
		teammatch.setLevelmin(this.levelmin);
		teammatch.setLevelmax(this.levelmax);
		teammatch.setTargetid(this.targetid);
		teammatch.setMatchtype(typematch);
		teammatch.setOnekeytimestamp(0);
		teammatch.setTimestamp(0);
		
		TeamManager.getInstance().addTeamMatch(teammatch, teamid);			
	}
	
	private boolean checkTeamState(Team team, long roleid) //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁跨喕妫勯崐鍧楀箰婵犲啰鐝堕柍鍝勵儑缁夘喚锟借娲滈崰鏍�佸☉姗嗘僵濡插本鐗曢弫鎼佹⒒閸屾瑦绁版繛澶嬫礋瀹曟娊鏁冮崒姘鳖唵闂佽法鍣﹂幏锟�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬬偤鎮ч悩姹囷拷渚�寮撮姀鐘栄囨煕閳╁啨浠︾紒顔瑰墲娣囧﹪鎮欓鍕舵嫹閺嶎厼绀夌憸蹇曞垝婵犳艾绠ｉ柣妯烘▕濡粓鏌ｉ悩杈劅闁绘挸顦甸獮蹇旑槹鎼淬垹鏋傞梺鍛婃处閸撴盯藝閵夈儮鏀介柣鎰皺濠�鎾煕婵犲啰绠撻柣锝囧厴閹兘骞嶉搹顐ｆ澑闂備礁澹婇崑鎺楀礈濮樻唻鎷峰鎰佹綈妞ゃ劊鍎甸幃娆撴嚑椤戣儻妾搁梻浣告啞濮婂湱鍠婂澶娢﹂柛鏇ㄥ灡閺呮粓鏌涢…鎴濇灈缂佷緡鍣ｅ铏瑰寲閺囩喐鐝曢梺鐑╂櫓閸ㄥ爼鎮伴鍢夌喖鎳栭埡鍐跨床婵犵妲呴崹鎶藉储瑜旈悰顔嘉旈崨顔规嫽婵炶揪绲介幉锟犲箚閸儲鐓曞┑鐘插�圭拹锟犳煥閻旂儤娅曢柣鐔稿▕瀹曟儼顦撮柣锝夌畺濮婃椽宕滈幓鎺嶇按闂佹悶鍔忓畷鐢靛垝婵犳艾绫嶉柛顐ゅ枔閸樼敻鏌℃径濠勫ⅵ缂佺姵鐗曢‖濠囶敋閿熶粙寮诲澶嬬叆閻庯綆浜炴导宀勬⒑鐠団�虫灈缂傚秴锕ら悾鐑藉醇閺囩喐娅滈棅顐㈡处閺屻劑顢旈崼鏇熲拺闁告稑锕ゆ慨鍫㈡喐閺夊灝鏆熺紒顔碱煼楠炲秹顢欓崜褝绱抽梻浣侯焾閺堫剟鎮疯缁絻绠涘☉娆戝幍閻庣懓瀚妯何ｆ繝姘厪闁糕剝锚缁楁帗銇勯锝囩疄闁诡喗鐟╅、妤呮晸娴犲鏁傞柤绋垮悁缁诲棝鏌曢崼婵囨悙閸熸悂姊虹粙娆惧剱缂佸鎹囬獮鎴﹀閻欙拷濞笺劑鏌ㄩ悢鍓佺煓闁诡喕鍗抽、娆戝枈閸楃偞鍊┑鐘灱閸╂牞鎽梺鍝勬媼娴滎亜顫忛搹鐟板闁哄洨鍋涢埛澶愭⒑閹稿海顣查柕鍥у缁犳稑顫濋鐘拷鎰版煣缂佹澧甸柡宀嬬到椤粓鏁撻挊澶樼劷鐟滃海绮嬮幒鎴叆闁割偆鍠撻崢浠嬫椤愩垺澶勬慨濠呭吹缁鎮欓悜妯煎幍濡炪倖姊归弸濠氭嚀閹稿簺浜滈柕蹇婂墲椤ュ牏锟借娲栭妶鎼佸箖閵忋倕浼犻柛鏇ㄥ亞閻ゅ嫰姊婚崒姘拷椋庣矆娓氾拷瀹曨垶宕稿Δ锟界粻瑙勩亜閹板墎鐣辩痪鍓ф嚀閳规垿鎮╃�圭姴顥濋弶鈺傜箞濮婃椽宕烽鐐插濠殿喖锕ㄥ畷鍨珶閺囥垹绀傜紒妤勬〃缁ㄥ姊洪崫鍕殭婵炴潙鍊搁…鍥箛椤撶姷顔曢梺鍛婁緱閸欏繘寮ㄦ繝姘厪闁搞儜鍐句純婵犳鍣幏鐑芥⒑閹稿海鈽夐悗姘�鍏撅綁宕奸妷锔规嫼闁诲骸婀辨慨鐢杆夋径瀣ㄤ簻闁挎棁顕ч悘锕傛煕閳瑰灝鐏╂い鎾冲悑瀵板嫮锟斤綆浜欑划锟犳⒑鐠囨煡鍙勬繛浣冲洤绠烘繝濠傜墕濮规煡鏌曢崼婵愭Ч闁抽攱鍨块弻娑樷攽閸℃浠惧┑鐙呮嫹闁规鍠氱壕濂告倵閿濆骸浜滈柣蹇旀尦閺屻劌鈹戦崼婵呯捕闂佸疇顫夐崹褰掓晸閺傘倗绉靛ù婊呭仱钘濇い鎾卞灪閸嬧剝绻濇繝鍌氭殶缂佺姾宕甸敓鑺ヮ問閸犳绻涙繝鍥х畺闁冲搫鍟扮壕鍏间繆椤栨粌甯舵鐐搭殜濮婄粯绻濇惔鈥茬盎濠电偠顕滅粻鎾荤嵁閹扮増鍤掗柕鍫濇川閻掑潡鏌ｆ惔顖滅У闁哥姵顨婇幃锟犲即閵忥紕鍙嗗┑鐘绘涧濡稓绮诲畷鍥╃＜濠㈣埖锚閺嬨倝鏌ㄩ悢璇残撴い鏃�鐗犲畷浼村冀椤撴冻鎷烽敃鍌涘�婚柦妯侯槹閻庮剟姊洪悷鏉库挃缂侇噮鍨跺鏌ュ箹娴ｅ湱鍙嗛梺缁樻礀閸婂湱锟芥熬鎷�? by changhao
	{
		if (this.typematch == 0 && team == null)
		{			
			return true;
		}
		
		if (this.typematch == 1 && team != null)
		{
			return team.isTeamLeader(roleid);
			
		}
		
		return false;
	}
	
	private boolean checkLevel() //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁跨喕妫勯崐鍧楀箰婵犲啰鐝堕柍鍝勵儑缁夘喚锟借娲滈崰鏍�佸☉姗嗘僵濡插本鐗曢弫鎼佹⒒閸屾瑦绁版繛澶嬫礋瀹曟娊鏁冮崒姘鳖唵闂佽法鍣﹂幏锟�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬬偤鎮ч悩姹囷拷渚�寮撮姀鐘栄囨煕閳╁啨浠︾紒顔瑰墲娣囧﹪鎮欓鍕舵嫹閺嶎厼绀夌憸蹇曞垝婵犳艾绠ｉ柣妯烘▕濡粓姊虹粔鍡楀濞堟洟鏌ｉ幘瀵告噰闁哄瞼鍠栭、娑樷槈濞嗘垵鍤掗柣鐐寸瀹�绋款潖閾忓湱鐭欐繛鍡樺劤閸擃參姊虹粙鍖℃敾缂佽鐗嗛锝嗙節濮橆厼浜滈梺缁樿壘閻°劎锟芥艾缍婇弻锝夊閳藉棗鏅遍梺缁樺浮缁犳牕鐣烽婊呯煓閹煎瓨鎸婚弬锟介梻浣哥枃濡嫬螞濡や胶顩插ù鐘差儐閻撴洟鏌曟繝蹇曠暠闁崇粯娲橀〃銉╂倷瀹割喗笑濡炪値鍋侀崹褰掓偩濠靛鏅稿ù鐘差儐閸嬵亪鏌ㄩ悢鍓佺煓婵﹥妞介幃鐑藉级鐠恒劎鈼ゆ繝鐢靛仦濞兼瑥煤椤撱垺鏅查柣鎰綑缁剁偛鈹戦悩鏌ヮ�楁繛鍫亰濮婃椽宕ㄦ繝鍐槱闂佹悶鍔嶆竟鍡欏垝鐠囨祴妲堟繛鍡楃С缁ㄥ姊洪崷顓炲妺闁搞劌鐏氱粋宥夋倷缂堢姷绠氶悗鐟板閸犳牠鎮橀敂鑺ュ弿濠电姴瀚敮娑㈡煙瀹勭増鍣界紒顔炬暩閿熸枻缍嗛崑鍡欑矓閻戣姤鈷掑ù锝勮閻掓儳螖閻樿櫕鍊愮�规洏鍎抽敓鏂ょ秵閸犳牜绮婚悙鐑樼厪濠电偟鍋撳▍鍛村炊鐎涙绡�闁靛骏绲剧涵楣冩煥閺囶亞鐣电�殿喗妲掗ˇ瑙勬叏婵犲啯銇濈�规洘锕㈠畷锝嗗緞鐎ｎ亜澹嶉梻鍌欒兌閹虫捇宕捄銊﹀床婵☆垵娅ｉ弳锕傛煙鏉堥箖妾柡鍛絻椤法鎹勬笟顖氬壋闂佸憡鐟ュΛ婵嗩潖閾忓湱纾兼俊顖濆吹椤︺儵姊虹粙鍖″伐婵狅拷闁秵鏅搁柤鎭掑劤閸熸煡鏌熼崙銈嗗? by changhao
	{
		if (this.levelmin > this.levelmax)
		{
			return false;
		}
		
		if (this.levelmin <= 0 || this.levelmax <= 0)
		{
			return false;
		}
		
		//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬫盯藝閻㈢鏋侀柟鍓х帛閸嬫劙鏌涢幇顖氱处闁汇垹顭峰缁樻媴閻熼偊鍤嬪┑鐐插级閻楃姴鐣烽幇顖樹汗闁圭儤鍨归敍娑㈡煟鎼搭垳绉甸柛鐘愁殜閹繝鎮㈤崗鑲╁幍闂備緡鍙忕粻鎴炴櫠椤栫偞鐓欐い鏍ㄦ皑婢ф稒绻涢懝閭﹀殭闁宠鍨归敓鏂ょ秵閸嬶拷闁归攱妞藉娲川婵犲嫧妲堥梺鎸庢磸閸婃牠骞堥妸鈺傛櫇闁稿本绋撻崢閬嶆⒑缂佹◤顏嗗椤撶喐娅犻柣銏㈩暜閹峰嘲鈻撻崹顔界亪闂佺顕滅槐鏇犲垝椤撱垺鍋勯柛蹇撳悑濞呫垺绻涚�电孝妞ゆ垵鎳橀幏鎴︽偄閸忚偐鍙嗗┑鐘绘涧濡瑩宕幒妤佺厸闁告劑鍔庢晶娑㈡煛閸涱垼鐒鹃棁澶愭煟濡儤鈻曢柛搴㈠姍閺屾稓锟斤綆浜堕崕鏃堟煛鐏炲墽娲撮柛鈺佸瀹曟﹢顢旈崨顓熺彯闂傚倷鐒﹀鍧楀储婵傚憡鍋嬮柟鎹愵嚙閽冪喖鏌曟繛鐐珔缂侇偄绉归弻銊╂偄閸撲胶鐓撻悗瑙勬礈閹虫捇鍩為幋锕�閱囬柣鏂垮槻缁ㄣ儵姊绘担铏广�婇柛鎾寸箘缁瑩骞掑Δ浣镐簵闂侀潧顦弲婊堟偂閻斿吋鐓涢柛銉㈡櫅娴犳粓鏌ㄩ悢缁橆棄婵狅拷闁秵鏅搁柤鎭掑劤閸熸煡鏌熼崙銈嗗?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬬偤鎮ч悩姹囷拷渚�寮撮姀鐘栄囨煕閳╁啨浠︾紒顔瑰墲娣囧﹪鎮欓鍕舵嫹閺嶎厼绀夌憸蹇曞垝婵犳艾绠ｉ柣妯烘▕濡粓姊虹粔鍡楀濞堟洟鏌ｉ幘瀵告噮缂佽鲸鎸婚幏鍛叏閹搭厺閭�规洖缍婂畷鎺楁倷鐎电寮虫繝鐢靛█濞佳兾涢鐐嶏綁宕妷褏锛滈梺缁樏悘姘跺吹閿熶粙姊婚崶褜妯�闁哄被鍔岄埞鎴﹀幢濮楀棙锟ラ梻浣侯攰濡嫰宕导鏉戠畺妞ゆ柨鐨烽弨浠嬫倵閿濆骸浜愰柟椋庣帛缁绘稒娼忛崜褎鍋ч梺纭呮珪閹瑰洭銆佸顒夌叆闁告洦鍘鹃鏇㈡⒑閸涘﹦鎳冩い锔诲灦閹﹢鍩￠崘顏嗭紲濡炪倖妫侀崑鎰櫠濞戞氨纾兼俊銈呭暙閺嬫盯鏌℃担瑙勫鞍缂佸倹甯為敓鏂ょ秵娴滅偤鎮鹃悙顒傜闁规儳顕崯鏌ユ煙妞嬪骸鍘撮柡宀嬬磿娴狅箓鎳為妷顔筋棧婵＄偑鍊栭幐鎼佸Χ缁嬭法鏆﹂柛妤冨亹閺嬪酣鐓崶銊﹀暗闁汇倕瀚板濠氬磼濮橆剨鎷锋搴㈩偨婵﹩鍓﹂悞鐣屾喐閺冨倻妲甸梻浣芥硶閸犲秶鍒掑▎蹇ｆ綎濠电姵鑹剧粈瀣亜閹扳晛鐒哄ù纭锋嫹缂傚倸鍊峰ù鍥ㄧ椤掑嫬纾婚柕鍫濐槺瀹撲線鎮楅敐搴℃灍闁哄懏绮撻弻锝夋晲閸涙澘顏Δ鐘靛仜閻楁挸顫忕紒妯诲闁惧繒鎳撶粭锟犳⒑閹肩偛濮傛繛浣冲懎寮查梻浣瑰濮婂綊骞忓┑瀣鐎瑰嫰鍋婂鈺呮煟閹伴潧澧い蹇ユ嫹 by changhao
		
		return true;
	}
	
	private boolean checkTeamMemberNum(Team team) //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁跨喕妫勯崐鍧楀箰婵犲啰鐝堕柍鍝勵儑缁夘喚锟借娲滈崰鏍�佸☉姗嗘僵濡插本鐗曢弫鎼佹⒒閸屾瑦绁版繛澶嬫礋瀹曟娊鏁冮崒姘鳖唵闂佽法鍣﹂幏锟�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬬偤鎮ч悩姹囷拷渚�寮撮姀鐘栄囨煕閳╁啨浠︾紒顔瑰墲娣囧﹪鎮欓鍕舵嫹閺嶎厼绀夌憸蹇曞垝婵犳艾绠ｉ柣妯烘▕濡粓姊虹粔鍡楀濞堟洟鏌ｉ幘瀵糕槈妞ゎ叀娉曢幑鍕偖鐎涙ɑ鏆版繝鐢靛仜閹冲骸煤閵娾晛绠熼柛娑橈攻閸庣喖鏌嶉挊澶嬵棞婵炲牜鍋婂娲川婵犲啫顦╅梺鎼炲妽婢瑰棛鍒掔拠娴嬫婵炲棗绉崇花濠氭⒑閻熺増鎯堢紒澶屽厴瀹曟鐣濋崟顒傚弳闂佺粯鏌ㄩ幉锟犳倶椤曪拷閺岀喖宕欓妶鍡楊伓? by changhao
	{
		return true;	
	}
	
	private boolean checkFaction(long roleid) //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁跨喕妫勯崐鍧楀箰婵犲啰鐝堕柍鍝勵儑缁夘喚锟借娲滈崰鏍�佸☉姗嗘僵濡插本鐗曢弫鎼佹⒒閸屾瑦绁版繛澶嬫礋瀹曟娊鏁冮崒姘鳖唵闂佽法鍣﹂幏锟�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬬偤鎮ч悩姹囷拷渚�寮撮姀鐘栄囨煕閳╁啨浠︾紒顔瑰墲娣囧﹪鎮欓鍕舵嫹閺嶎厼绀夌憸蹇曞垝婵犳艾绠ｉ柣妯烘▕濡粓姊虹粔鍡楀濞堟洟鏌嶉柨瀣仸闁靛洤瀚伴獮鎺楁倷閺夋埈浼撶紓鍌氬�风粈渚�藝娴兼潙绠伴柟鎯版缁犳岸鎮橀悙璺衡枏闁哄啫鐗嗗婵囥亜閺冿拷閸庢娊鐛幇鐗堚拻濞达綀顫夐崑鐘绘煕鎼搭喖娅嶇�殿喗褰冮埥澶愬閻樻彃娈ら梺纭呭亹鐞涖儵宕戦幘瀵割洸婵犲﹤鐗婇悡娑㈡煕閵夆晩妫戠紒鈽呮嫹闂備礁鎲＄换鍐渻娴犲钃熼柣鏂挎憸閻熷綊鏌涢…鎴濇灈妞ゎ剙鐗撻弻褎瀵煎▎鎴犘滈梺鍝勬湰缁嬫牠藝閾忣偁浜滈柕濞垮劜閸ゅ洦顨ラ悙鎼疁闁诡喕绮欓幃浠嬫偨绾板闂繝鐢靛仩閹活亞绱炴笟锟借棢闁规崘顕х粈澶岋拷骞垮劚椤︿即鎮￠悢鍏肩厵闁割煈鍠栭顐ょ磼閳藉懏瀚归梺璇插椤旀牠宕板☉銏╂晪鐟滄棃宕洪妷锕�绶為柟閭﹀墻濞煎﹪姊洪弬銉︽珔闁哥噥鍨堕、鏃堟偄閸忓皷鎷绘繛杈剧秬婵倗娑甸崼鏇熺厱闁挎繂绻掗悾鍨殽閻愯尙绠婚柡浣规崌閺佹捇鏁撻敓锟�? by changhao
	{
		return true;
	}
	
	private boolean checkActiveTime() //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁跨喕妫勯崐鍧楀箰婵犲啰鐝堕柍鍝勵儑缁夘喚锟借娲滈崰鏍�佸☉姗嗘僵濡插本鐗曢弫鎼佹⒒閸屾瑦绁版繛澶嬫礋瀹曟娊鏁冮崒姘鳖唵闂佽法鍣﹂幏锟�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬬偤鎮ч悩姹囷拷渚�寮撮姀鐘栄囨煕閳╁啨浠︾紒顔瑰墲娣囧﹪鎮欓鍕舵嫹閺嶎厼绀夌憸蹇曞垝婵犳艾绠ｉ柣妯烘▕濡粓姊虹粔鍡楀濞堟洟鏌ｉ幘瀵告噮缂佽鲸鎸婚幏鍛叏閹搭厺绨肩紒宀勪憾椤㈡稑鈽夊槌栧晭闂備礁婀遍崑鎾诲礈濮樿埖鍋傚┑鍌氭啞閻撴盯鎮橀悙鎻掆挃妞ゎ剙鍚嬮妵鍕晝娴ｅ湱褰ч梺闈涙搐鐎氱増淇婇幖浣肝ㄩ柨鏇嫹婵炲憞鍛＝濞撴艾娲ら弸娑㈡煟濡わ拷閿曘倝顢氶妷鈺佺妞ゆ牗姘ㄩ悿锟芥俊鐐�栭幐鐐叏鐎靛憡鏆滈柟顖嗭拷閺�浠嬫煟濡櫣浠涢柡鍡忔櫅閳规垿顢欑喊鍗炴闂佺懓绠嶉崹纭呯亽婵炴挻鍑归崹鎶芥晸閸婄喎鐓愰柕鍥у瀵剙鈻庨悙顒傜◥濠电偛鐡ㄧ划宥囧垝閹捐鏋侀幖娣灮缁★拷濠殿喗锕╅崜娑㈠磹閻愮儤鈷戦梻鍫熶緱閻掗箖鏌涢妸銊︻仩闁跨喕濮ら惌顔惧垝濞嗗浚娼栫紓浣股戞刊鎾煠閹帒鍔ら柕鍡楋躬濮婃椽妫冮埡鍐ょ紓浣哄У閹瑰洭鎮伴璺ㄧ杸婵炴垶鐟﹀▍銏ゆ⒑鐠恒劌娅愰柟鍑ゆ嫹? by changhao
	{
		
		return true;
	}

	// 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋婵愭綗闁跨喕妫勯崐鍧楀箰婵犲啰鐝堕柍鍝勵儑缁夘喚锟借娲滈崰鏍�佸☉姗嗘僵濡插本鐗曢弫鎼佹⒒閸屾瑦绁版繛澶嬫礋瀹曟娊鏁冮崒姘鳖唵闂佽法鍣﹂幏锟�?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鐐劤椤兘寮婚敐澶婄疀妞ゆ帊璁查弸娆撴⒑缂佹ê绗╁┑顔哄�楅幑銏犫槈閵忕姴鑰垮┑鈽嗗灥椤曆呭枈瀹ュ鈷戠紓浣股戠亸浼存煥閺囨ê鐏茬�殿喖顭烽幃銏ゆ倻濡櫣锛忔俊鐐�ら崢浠嬪垂閸洦鏁侀柨鐕傛嫹
	private static int checkPvP(long roleId) {
		// 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭�瑰嫭鍣磋ぐ鎺戠倞鐟滃繘寮抽敃鍌涚厱妞ゎ厽鍨垫禍婵嬫煕濞嗗繒绠婚柡灞稿墲瀵板嫮锟斤綆浜濋鍛攽閻愬弶鈻曞ù婊冪埣瀵偊宕堕浣哄帾闂婎偄娲﹀ú鏍ф毄闂備礁鎲＄换鍐�冩繝鍌ゆ綎缂備焦顭囬悷褰掓煕閵夋垵鍠氬鑽ょ磽閸屾瑧顦︽い锕備憾瀵偆鎷犻懠顒佹闂佸搫娲㈤崹鍦不閿濆棛绡�闁靛骏绱曠粻鎾剁磽瀹ュ拑韬鐐插暣閸╁嫰宕橀埡浣稿Τ闂備焦瀵х换鍌毼涘▎鎾崇獥闁哄稁鍘介埛鎺懨归敐鍫綈闁稿濞�閺屾稒绻濋崘鈺冾槹闂佽桨绀侀崯瀛樹繆閻戣棄鐓涘ù锝呭缁犳捇寮诲☉銏犲嵆闁靛鍎查悘鎾绘⒑濮瑰洤锟窖囧箯閻戣姤鈷掑ù锝呮啞鐠愶繝鏌涚�ｎ偅宕岀�规洘绮岄～婵嬵敇閻欙拷濞村嫭绻濋棃娑橈拷鎼佸箟閿熺姴纾婚柣妯挎珪閸欏繑淇婇姘儓闁肩缍婇弻锛勶拷锝庡亞閳句線鏌熸笟鍨缂佺粯绻堝畷姗�鍩炴径姝屾闂佽姘﹂～澶娒鸿箛娑樼鐎广儱娲﹀畷鍙夌節闂堟侗鍎忕紒锟界�ｎ偁浜滈柟閭﹀枛閺嬪酣鏌熼鍏煎櫧缂佽鲸鎹囧畷鎺戭潩椤掑﹥瀚归柟闂寸绾惧綊鏌涘┑鍕姢闁活厽鎹囬弻鐔虹磼閵忕姵鐏嶉梺鍝勬噺缁诲啴濡甸崟顔剧杸闁圭偓鍓氭导锟介梻浣告惈濡绮婚幘璇茶摕闁哄浄绱曢悿锟介柣搴秵娴滅兘骞忛悜钘夊唨妞ゆ挾鍋熼弻褔姊鸿ぐ鎺擄紵闁绘帪绠撻幃锟犲Ψ閳哄倻鍘介梺鍝勬川閸嬫盯鏁撻挊澶嬭础闁跨喕濮ら悢顒勫箯閿燂拷
		return fire.pb.battle.pvp.PvPTeamHandle.onRequestTeamMatch(roleId);
	}

	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 794494;

	public int getType() {
		return 794494;
	}

	public int typematch; // 类型为0是个人组队匹配1是队伍匹配 by changhao
	public int targetid; // 目标id by changhao
	public int levelmin; // 等级下限 如果是个人匹配这个忽略 by changhao
	public int levelmax; // 等级上限 如果是个人匹配这个忽略 by changhao

	public CRequestTeamMatch() {
	}

	public CRequestTeamMatch(int _typematch_, int _targetid_, int _levelmin_, int _levelmax_) {
		this.typematch = _typematch_;
		this.targetid = _targetid_;
		this.levelmin = _levelmin_;
		this.levelmax = _levelmax_;
	}

	public final boolean _validator_() {
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		_os_.marshal(typematch);
		_os_.marshal(targetid);
		_os_.marshal(levelmin);
		_os_.marshal(levelmax);
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		typematch = _os_.unmarshal_int();
		targetid = _os_.unmarshal_int();
		levelmin = _os_.unmarshal_int();
		levelmax = _os_.unmarshal_int();
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CRequestTeamMatch) {
			CRequestTeamMatch _o_ = (CRequestTeamMatch)_o1_;
			if (typematch != _o_.typematch) return false;
			if (targetid != _o_.targetid) return false;
			if (levelmin != _o_.levelmin) return false;
			if (levelmax != _o_.levelmax) return false;
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		_h_ += typematch;
		_h_ += targetid;
		_h_ += levelmin;
		_h_ += levelmax;
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append(typematch).append(",");
		_sb_.append(targetid).append(",");
		_sb_.append(levelmin).append(",");
		_sb_.append(levelmax).append(",");
		_sb_.append(")");
		return _sb_.toString();
	}

	public int compareTo(CRequestTeamMatch _o_) {
		if (_o_ == this) return 0;
		int _c_ = 0;
		_c_ = typematch - _o_.typematch;
		if (0 != _c_) return _c_;
		_c_ = targetid - _o_.targetid;
		if (0 != _c_) return _c_;
		_c_ = levelmin - _o_.levelmin;
		if (0 != _c_) return _c_;
		_c_ = levelmax - _o_.levelmax;
		if (0 != _c_) return _c_;
		return _c_;
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

