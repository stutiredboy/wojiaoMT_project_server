
package fire.pb.clan;

import java.util.Arrays;
import java.util.List;

import fire.log.enums.YYLoggerTuJingEnum;
import fire.pb.PropRole;
import fire.pb.clan.srv.ClanManage;
import fire.pb.ranklist.RankType;
import fire.pb.ranklist.proc.PRoleZongheRankProc;
import fire.pb.talk.MessageMgr;




// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CChangeClanName__ extends mkio.Protocol { }

// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

public class CChangeClanName extends __CChangeClanName__ {
	@Override
	protected void process() {
		final long roleid = gnet.link.Onlines.getInstance().findRoleid(this);
		if (roleid < 0 || newname == null)
			return;
		
		final int userid = ((gnet.link.Dispatch) this.getContext()).userid;
		
		int resultCode = fire.pb.util.CheckName.checkValid(newname);
		if (resultCode == fire.pb.util.CheckName.WORD_ILLEGALITY) {
			fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 142260, null);
			return;
		} else if (resultCode == fire.pb.util.CheckName.SPECIAL_WORD_TOO_MANY) {
			fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 142294, null);
			return;
		} else if (resultCode == fire.pb.util.CheckName.NONE_CHARACTER) {
			fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 146238, null);
			return;
		}

		if (!fire.pb.util.StringValidateUtil.checkIllegalWord(newname)) {
			fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 145025, null);
			return;
		}
		int chineseCnt = 0;
		int otherCnt = 0;
		for (int i = 0; i < newname.length(); i++) {
			// 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ偆娲撮挊婵嬫煟閵忋埄鐒鹃柡瀣╃窔閺岀喖宕滆鐢盯鏌涚�ｎ偄濮嶉柡灞剧洴楠炲洭顢涘鍗烆槱缂傚倸鍊搁崯顖毭洪悢濂夋綎缂備焦蓱婵挳鏌涘☉姗堟敾闁稿孩鎸搁埞鎴︽倷閼碱剚鍕鹃梺鍛婃煥缁夊綊鐛崼銉ノ╅柨鏃傜帛鏁堥梺纭呭閹活亞寰婇崸妤佸�块柛蹇氬亹缁★拷闂佹眹鍨藉褍鐡梻浣侯焾閿曪箓寮拠宸殨闁靛濡囬々鐑芥倵閿濆骸浜為柛妯挎閳规垿鍩ラ崱妤冧哗闂佸湱鈷堥崑鍡涙儉椤忓浂妯勯梺鍝勭灱閸犳牕鐣峰Δ鍛亗閹肩补妲呭姘舵⒒娴ｅ憡鎯堥柡鍫墰缁瑩骞樼�靛壊娴勯梺鎸庢⒒閸嬫挾锟芥碍宀搁弻鐔虹磼濡桨鍒婂┑鐐靛帶闁帮絽顫忕紒妯诲闁告稑锕ラ崕鎾绘⒑閸濆嫮澧遍柛鎾寸懅閸欏懘姊虹紒妯活棃妞ゃ儲鎹囧鎶芥晝閸屾稓鍘介梺瑙勫劤绾绢厼鐣濋幖浣圭厸闁跨喕濮ょ粋鎺旓拷锝庡亞閸橀亶姊洪棃娑辨Ч闁搞劎鏁搁敓鑺ュ嚬閸欏啴銆侀弮鍫澪у璺侯儌閹锋椽姊洪悡搴綗闁稿﹥娲熷鎼佸箣閻樼數锛滃銈嗘煥閸氬锕㈤悧鍫涗簻闁靛绲介崝锔筋殽閻愬澧紒妤冨枛瀹曞爼濡搁敂鐣屽剑闂傚倸鍊风欢姘焽瑜旇棟妞ゆ劧绠戦悿鐐箾閹寸偞鐨戦柣顓炴閹鏁愭惔鈥茬按婵炲瓨绮嶇划鎾诲蓟閻斿吋鍊绘俊顖濇娴犳挳姊虹捄銊ユ灆婵☆偄瀚伴垾锕傛倻閽樺鐣炬繛鎾寸啲閹烽锟借娲栭妶鍛婁繆閻戣姤鏅滈悷娆忓椤忓綊姊婚崒娆戭槮闁硅绱曠划娆撳箣閿旇姤娅囬梺闈涱檧缁犳垹娆㈤悙鐑樼厱闁哄洢鍔岄悘锟犳煟閹惧瓨绀嬮柡宀�鍠栭幃娆擃敆娴ｈ櫣鈻忛梻浣告啞缁诲棗鈻嶉敐澶嬫櫢闁稿﹦鍣ュ鎰箾閸欏鐏寸�规洩绻濋獮搴ㄦ寠婢跺锟筋剟姊洪悷鏉库挃缂侇噮鍨跺鏌ュ箹娴ｅ湱鍙嗛梺缁樻礀閸婂湱锟芥熬鎷�
			String regexStr = fire.pb.util.CheckName.getRegexStr();
			if (newname.substring(i, i + 1).matches(regexStr)) {
				chineseCnt++;
			} else {
				otherCnt++;
			}
		}
		double total = chineseCnt + otherCnt / 2.0;
		int factionNameLen = 5;
		if (total < 2 || total > factionNameLen) {
			fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 145088, null);
			return;
		}
		
		new mkdb.Procedure() {
			@Override
			protected boolean process() throws Exception {
				
				if (!mkdb.util.UniqName.allocate("clan", newname)) {
					fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 142402, null);
					return false;
				}
				
				xbean.ClanInfo clanInfo = ClanUtils.getClanInfoById(roleid, false);
				if (clanInfo == null) {
					fire.pb.talk.MessageMgr.psendMsgNotify(roleid, 145077, null);
					return false;
				}
				//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ偆娲撮挊婵嬫煟閵忋埄鐒鹃柡瀣╄兌閿熻棄绠嶉崕閬嵥囬婊呯焼閻庯綆鍋佹禍婊堟煙閸濆嫮肖闁告柨绉甸妵鍕棘閹稿骸鏋犲┑顔硷功缁垶骞忛崨顖涘枂闁告洦鍋傞崫妤呮⒒娴ｄ警鐒鹃悗娑掓櫅椤啴鎸婃径灞炬濠电姴锕ら崯鐘诲几鎼淬劍鐓欓悗娑欘焽缁犮儲淇婇锝囩煉闁诡喖鍢查…銊╁川椤撗勬瘔闂佹眹鍩勯崹閬嶃�冩繝鍥х畺闁炽儲鏋煎Σ鍫熸叏濡厧浜鹃悗姘愁潐椤ㄣ儵鎮欓懠顑胯檸闂佸憡姊归懝鎹愮亙闂佺粯顭堝▍鏇㈠磹閹扮増鐓熸繛鎴濆船濞呭秶锟芥鍠曠划娆撱�佸锟介幃銏ゅ传閸曨偆鐫勯梻鍌氬�风粈渚�骞夐敓鐘茬闁挎梻鏅々鍙夌節婵犲倻澧曢柛鎴犲У缁绘盯骞嬪▎蹇曚痪闂佺粯鎸婚惄顖炲箖濮楋拷閹瑩骞撻幒鍡樺瘱婵犵數鍋涘璺侯焽濞嗘挸鐓橀柟杈鹃檮閺咁剟鏌涢弴銊ヤ簻妤犵偛顑夊鐑樻姜閹殿喖濡介梺鍛婃⒐閻熴儵鎮鹃悜钘壩╅柍鍝勶攻閺咃綁鎮峰鍐闁轰焦鎹囬幃鍓т沪閽樺绠ｆ繝娈垮枛閿曪妇鍒掗鐐茬闁告稒娼欐导鐘绘煏婢舵ê鐏ｇ紒锟芥繝鍥ㄢ拻濞达絼璀﹂弨鐗堢箾閸涱喗绀嬫鐐村姍瀹曟粏顦查柛銊︾箞閺岋繝宕橀妸褍顤�闂佺顑冮崝搴ｆ閹烘棑鎷烽敐搴″季闁搞倧绠撻弻銊╁即閻愯鎷疯ぐ鎺撳亗闁哄洢鍨洪悡娑㈡煕閵夛絽鍔氬┑鈥炽偢閺岋綀绠涢弴鐐愩儳绱掓潏銊ユ诞妞ゃ垺娲熸慨锟介柍璺虹仌閸ャ劎鍘搁柣蹇曞仜婢ц棄煤閺夋垟鏀介柨娑樺閸樺瓨銇勯姀锛勬噰鐎规洩缍佹俊鐑藉Ω閿斾紮鎷峰Δ鍛拻闁稿本鐟ㄩ崗宀勬煙閾忣偅灏伴柡鍛埣閹墽浠﹂挊澶屼喊婵＄偑鍊栭悧婊堝磻閻愬搫纾婚柛灞剧〒缁犻箖鏌熺�涙鎳冮柣蹇ｄ邯閺岋綁骞樼�涙顦伴梺鍝勮嫰缁夊綊鐛锟藉畷銊╊敊绾板彉绱﹂梻鍌氬�风粈渚�骞栭锕�绠犻煫鍥ㄦ礈閻瑩鏌熸潏鎯х槣闁轰礁顑夐弻銊モ攽閸♀晜鈻撻梺杞扮椤戝寮婚妸鈺傚亜闁告挷鑳堕悡鎾绘倵濞堝灝鏋涙い顓犲厴瀵偄顓兼径濠勵槹濡炪倕绻愰幊搴㈠垔閹殿喚纾介柛灞剧懅椤︼附銇勯幋婵囧殗闁诡喗锚閳规垹锟斤綆浜為崢杈ㄧ節閵忥絽鐓愰柛鏃�鐗犲畷鎰版偨閸涘﹦鍘卞銈庡幗閸ㄥ灚绂嶅┑鍫㈢＜闁煎摜鏁搁崣锟介梺璇″枟椤ㄥ懘锝炲┑瀣亗閹艰揪绱曢鎺楁⒒娴ｇ儤鍤�缂佺姴绉瑰畷纭呫亹閹烘垹鍘撮梺鐟邦嚟婵挳骞忛悜鑺ユ櫜閹煎瓨绻勯弫鏍⒑閹稿海鈾佺紒顔肩焸閸╃偤骞嬮敂钘夛拷鐑芥煛婢跺鐏╁ù鐘虫倐濮婃椽鎳￠妶鍛彙闂佹悶鍔忓▔娑㈡偩閻戠瓔鏁嶆繝濠冨姈鐎氬綊鏌ㄥ┑鍡欏嚬缂併劍鎸抽弻锟犳晸閼恒儳顩烽悗锝庡亞閸樿棄鈹戦埥鍡楃仭婵＄偛娼″畷顖濈疀濞戞瑧鍘搁梺绯曞墲椤洭鎯屽畝锟界槐鎺撴綇閵娿儳鐟插┑鐐靛帶缁绘ɑ淇婇幖浣规櫆缂備降鍨烘晥闂備浇顕у锕傦綖婢跺♁鍝勵潨閿熻棄鐣疯ぐ鎺戦敜婵°倕鍟粊锕�鈹戦绛嬫闁圭兘鏀遍〃銉╂倷閸欏顦╅梺鐟板槻閹虫﹢骞冮悜钘夌妞ゆ柨褰ㄩ幒鎴旀斀闁绘ê鐏氶弳鈺呮煕鐎ｎ偆娲存い銏″哺椤㈡﹢鎮㈢粙鍨紟闂備礁婀遍搹搴ㄥ闯椤曪拷瀵偊宕熼娑氬幈濠电偞鍨堕悷锔剧礊閹达附鐓曢柟瀵稿Т瀛濋梻鍥ь樀閺屻劌鈹戦崱妯绘倷闂佹眹鍔嶉崹鍧楀蓟閻斿壊妲归幖绮癸拷鍐茬闂備胶绮笟妤呭闯閿濆懐鏆︾憸鐗堝俯閺佸﹪鏌ｉ幘鍐茬槰婵炲吋绋戦埞鎴︽偐閸偅姣勯梺绋款儑婵烇拷妞ゃ垺鑹鹃…銊╁川椤撶姷鐡樺┑鐐差嚟婵挳顢栭崨瀛樺亗婵犻潧鏋硅ぐ鎺撳亹鐎瑰壊鍠栭崜楣冩⒑鏉炴壆顦﹂柛濠傛健瀵鈽夐姀鈺傛櫇闂侀潧鐗嗛幊蹇涙倶娓氾拷濮婃椽宕ㄦ繝鍕櫑闂佸摜鍣ラ崑濠囧春閻愬搫绠ｉ柨鏇嫹闁绘搫绻濋弻娑㈠焺閸愮偓鐣兼繛瀵稿閸ャ劎鍘介梺缁樼懃閹冲繒锟芥艾缍婂娲箰鎼淬垻鈹涢梺褰掝棑閸忔ê鐣烽埄鍐╃秶闁冲搫鍊搁弸鎴︽⒑缂佹﹩娈旈柣妤�妫涚划顓烆潩閼哥數鍘撻梻浣哥仢椤戝懘鎮橀敂鍓х＜缂備焦顭囧ú瀵革拷瑙勬礀瀹曨剝鐏掗梺鍛婄箓鐎氼剝顣介梻浣筋嚙鐎涒晠顢欓弽顓為棷妞ゆ洩鎷风�规洘婢樿灃闁告侗鍘鹃悿鍕⒑闂堟侗鐓┑鈥虫川瀵囨晸娴犲鈷戦柛娑橈工婵拷闂佸搫鍊搁崐鍦矉閹烘顫呴柕鍫濇閿熺晫鏁婚幃宄扳枎韫囨搩浠炬繝銏ｆ硾鐎氫即寮诲☉姘炬嫹閿濆簼鎮嶇�规悶鍎甸弻锝夋晲閸パ冨箣闂佽鍠撻崹濠氬窗婵犲啯缍囬柕濠忛檮閻濇繈姊婚崒娆掑厡缂侇噮鍨跺畷褰掓濞磋櫕绋戦埢搴☆嚗椤栨稑娴�规洘鍎奸ˇ顕�鏌￠敓鑺ョ鐎ｎ偆鍙嗗┑鐐村灦閿氭い蹇婃櫅闇夋繝濠傚暔閸嬨垽鏌＄仦鍓р檨缂佺粯绋栭ˇ鏌ユ煙闁垮鐏存鐐茬箻閹粓鎳為妷顔筋棃婵犵數鍋為崹璺侯潩閵娾晛绀夋い鏍仦閸婄敻鎮峰▎蹇擃仾缂侊拷閸愨晝绡�闁靛繆妲勯懓鍧楁煥濠靛牆浠滈柍瑙勫灩閿熸枻绲介悘姘跺疾閻愮儤鈷戦柛鎰级閹牊銇勯幋婵囧窛缂侇喗妫冮、娆戠驳鐎ｎ偒鍟嶉梻浣虹帛閸旀洖顕ｉ崼鏇炵獥婵☆垱鐪规禍婊堟煏韫囧﹥顫夐柤鏉挎健閺岀喖顢欓悾宀�鐓夐悗瑙勬礀瀹曨剝鐏冩繛鎾磋壘濞层倝寮查锔解拻闁稿本鑹鹃敓钘夊槻闇夐柛銉墻閺佸鎲歌箛娑欐櫢闁兼亽鍎抽埢鎾绘煛閸涱喚绠橀柛鎺撳笒閳诲酣骞樺畷鍥跺敽闂備礁鎼ú銊╁磻閻旇櫣鐭欏┑鐘叉处閳锋帡鏌涚仦鍓ф噯闁稿繐鐭傞弻鐔兼惞椤愶絽纾抽悗瑙勬礃閻擄繝骞婇悩娲绘晢闁稿本绮犲Σ绋库攽閻樺灚鏆╁┑顔芥尦瀹曟垿宕卞Δ濠勫姺闂佸搫绉查崝搴ｇ不閸撗嶆嫹閻熸澘顥忛柛鐘虫礈閼洪亶鎳￠妶鍥╋紲闂佽法鍠嶇划娆忕暦婵傜唯闁挎梹鍎抽獮妯肩磽娴ｅ搫浜炬繝銏∶悾鐑筋敆娴ｈ鐝峰銈嗘穿閹风兘鏌熼鑽ょ煓妞ゃ垺绋戣灒闁告繂瀚濠电姵顔栭崰鏍晝閵夈儺娓婚柦妯侯槺閺嗭附銇勯幇鍓佺暠閸烆垶姊洪棃娑辨Ч闁告枮鍛濞撴熬鎷风�殿喖顭烽弫鎰板川閸屾稒鈷愰柟宄版嚇閹煎綊宕烽鐐茶緟婵犲痉鏉匡拷妤佹叏閻戣棄纾绘繛鎴炵瀹曟煡鏌熼悜姗嗘畷闁哄懏鎮傞弻锟犲磼濡尨鎷峰Δ鍐煋闁汇垹鎲￠悡鏇㈡煟濡櫣锛嶅褑浜槐鎺楊敊绾拌京鍚嬮梺璇″枙缁瑥鐣烽妸锔剧瘈闁告洦鍋勭粻銉╂⒒娴ｈ棄鍚归柛鐘冲姍閹兘濡疯閹峰嘲顫濋锟藉Σ濠氭煃缂佹ɑ宕岀�殿噮鍣ｅ畷鎺戭煥閸滃啰闂梺璇查缁犲秹宕曢柆宥呯闁硅揪濡囬崣鏇熴亜閹哄秶璐版繛鍫滅矙閺岋綁骞囬鐐电シ闂佸搫妫寸紞渚�寮诲☉銏犵厸閻庯綆鍓涢惁鍫ユ倵鐟欏嫭澶勫ù婊勭箞楠炲繘宕ㄩ娑樻瀭闂佸憡娲﹂崜娑溿亹閻斿吋鈷掗柛灞捐壘閿熺晫鍏橀幊妤呭礈娴ｇ鐏婂銈嗙墱閸嬫稓绮绘导瀛樼厱婵炴垶锕╅悡顒佺箾閸粎鐭欓柡宀�鍠栧鑽わ拷闈涙憸閻℃绱撻崒姘毙ｉ柣妤冨█瀵鎮㈤崗鐓庯拷缁樻叏濡わ拷濡瑩鎮鹃悜鑺モ拺闁规儼濮ら弫閬嶆偨椤栨稑娴┑鈩冩尦楠炴帡骞嬮鐔峰厞闂備胶绮崝锕傚礈濞嗘搩鏁傞柛顐ｆ礃閳锋帒霉閿濆牆袚缁绢厼鐖奸弻娑㈡偐閾忣偆顦ㄩ梺閫涚┒閸旀垶淇婇崼鏇炵倞闁冲搫鍟伴崢顖炴⒒娴ｇ瓔娼愮�规洘锕㈤、姘愁樄闁诡喒锟芥剚娼ㄩ柨鐔剁矙瀵鎮㈤崗鐓庯拷缁樻叏濡わ拷濡瑩鎮鹃悜鑺モ拺缂備焦蓱鐏忕増绻涢懠顒�鏋涚�殿喖顭烽弫鎾绘偐閼碱剦妲伴梻浣告贡椤牊顨ラ幖渚囨晜闁割偅娲橀埛鎺懨归敐鍫綈闁稿濞�閺屾盯寮崸妤�寮伴悗娈垮櫘閸嬪懐鎹㈠┑鍡╂僵闁靛鍨辩�氱懓霉閿濆懎顥忔繛灏栨櫊閺屻倗绮欑捄銊ょ驳濠电偛鎳忕划宥囨崲濠靛顫呴柨婵嗘閵嗘劕顪冮妶鍡楃仴婵☆偅顨婇崺銏狀吋婢跺娼婇梺闈涚墕濡矂骞忓ú顏呯厽闁绘ê鍘栭懜顏堟煕閺傝儻瀚伴柍璇茬Ч楠炲洭鎮ч崼銏犲箥闂備礁鎲￠崹顖炲磹閺嶎偓鎷峰鐐?
				if (clanInfo.getClanmaster() != roleid) {
					fire.pb.talk.MessageMgr.psendMsgNotify(roleid, 150127, null);
					return false;
				}
				clanInfo.setOldclanname(clanInfo.getClanname());// 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氼參宕崇壕瀣ㄤ汗闁圭儤鍨归崐鐐差渻閵堝棗绗掓い锔垮嵆瀵煡顢旈崼鐔蜂画濠电姴锕ら崯鎵不缂佹﹩娈介柣鎰綑閻忔潙鈹戦鍡樺闂備線娼ч悧鍡涘箠閹扮増鍋柨鐔诲Г娣囧﹪鎮欓鍕舵嫹閺嶎灛娑欐媴閼叉繃鐩畷鐔碱敆娴ｇ濡冲┑鐘垫暩婵潙煤閿曞倸鐓曢柟瀵稿У閸犳劙鏌ｅΔ锟介悧鍡欑箔閹烘嚚鐟邦煥閿熶粙宕￠幎钘夎摕婵炴垶鐟﹂崕鐔兼煏婵犲繘妾梺娆惧弮濮婅櫣锟藉湱濮甸ˉ澶嬨亜閿旇鐏ラ柣蹇斿笒閳规垿鎮╃拠褍浼愰柣搴㈠嚬閸欏啳妫㈤梺鍓插亽濠線骞忔搴㈠枂闁告洦鍓涢ˇ銊╂⒑閹稿孩纾搁柛銊ょ矙婵″瓨绗熼敓钘夘嚕椤曪拷瀹曠厧鈹戦崱姘炬嫹閸ф鈷戦柛鎰级閹牓鏌涙繝鍐ㄥ闁轰礁鍟村畷鎺戔槈閹烘挸顏烘繝鐢靛仩閹活亞寰婇崸妤佸仱闁哄啫鐗嗛崥瑙勭箾閸℃ɑ灏伴柣鎾存礋閺岀喓锟界數顭堟牎濠电偛鎳忓ú婊呮閹烘挻缍囬柍杞版濡叉劙鎮楃憴鍕鐎规洦鍓熼崺銉﹀緞婵炪垻鍠栭幊鏍煛娴ｅ搫锟界偤姊婚崒姘拷椋庣矆娓氾拷楠炴牠顢曢妶鍥╃厯婵炴挻鐔幏椋庯拷瑙勬礃閸ㄥ灝鐣烽崡鐐╂婵炲棗绻愭竟鎺楁⒒娴ｈ櫣銆婇柛鎾寸箘缁瑩骞掑Δ浣镐簵闂佸搫娲ㄩ崰鍡樼濠婂牊鐓欏ù鐓庣摠濞懷兠瑰鍕畼缂佽鲸甯￠幊婊堟偨閸偄鍨遍梻浣告惈閻ジ宕伴幇鍏洭鎮ч崼鐔峰妳闂佺偨鍎遍崯璺ㄧ不閿濆鈷掑ù锝堟鐢稑銆掑顓ф疁鐎规洘濞婇弫鎰板川椤栨稒顔曢柣鐔哥矌婢ф鏁埡鍛瀬濠电姴娲﹂悡鐔兼煙閹冩毐闁伙负鍔嶇换娑㈠礂閼测晜鍒涘┑顔硷工椤嘲鐣烽幒鎴旀瀻闁圭儤鍨电敮顖炴⒒娴ｄ警鏀版繛鍛礋楠炴垿宕惰閺嗭附銇勯弽顐粶闁搞劌鍊归妵鍕即閻愭潙娅ら梺绋跨Ф閺佽顫忓ú顏勭閹兼番鍨婚ˇ銉╂⒑缁嬪尅宸ラ柟璇х節閵嗕焦绻濋崶銊㈡嫽婵炶揪绲介幉锛勬嫻閳ユ剚鐔嗙憸搴ㄣ�冮崨绮癸拷锕傚垂椤曞懏寤洪梺璺ㄥ枍缁瑩骞冩导鎼晪闁跨喕濮ら幈銊╂晸娴犲鐓冮柕澶堝妼閻ㄨ櫣绱掗悩鍐插摵婵﹨娅ｇ槐鎺懳熼崫鍕垫綋闂備礁顓介弶鍨瀷缂備緡鍠栭悧鎾诲极閹剧粯鍋╃�癸拷閿熺晫澹曟禒瀣厱閻忕偟鍋撻惃鎴狅拷娑欑箞濮婃椽骞愭惔銏紭闂佺锕ョ换鍫ョ嵁閸愵喖绠氱憸蹇涘汲鐎ｎ喗鐓欓梺鍨儐閳锋劖淇婇銏犳殭闁伙絿鍏樻俊鎼佸煛婵犲啯娅撻梻浣侯焾缁绘宕戦幇鏉跨骇濞寸姴顑嗛埛鎺楁煕鐏炲墽鎳呮い锔肩畵閺岀喓鍠婇崡鐐板枈闁芥ɑ绻傞湁闁稿繐鍚嬮崕妤呮煛娴ｇ顏紒缁樼洴瀹曞崬螖閸愵亞鍕樻繝鐢靛仦閸垶宕瑰ú顏勭；闁告洦鍨遍悡鏇㈢叓閸ャ劍灏垫慨锝囧仱閺岀喐顦版惔锝呯缂備胶绮粙鎺戭焽韫囨稑绀堢憸搴ㄥ磻瑜斿娲倻閳轰礁鈷夊┑鈽嗗亜閸燁偊鎮鹃悜鑺ュ仺缂佸娉曢ˇ銊ヮ渻閵堝棙鈷掗柡鍜佸亰瀹曘垽鏌嗗鍡忔嫼缂傚倷鐒﹂妴鐐哄箣閿曪拷缁�鍫熸叏濮楀棗鍘撮柡瀣閺岋繝宕橀妸褍顤�闂佺顑呴崐鍧楀蓟閺囥垹閱囨繝闈涙祩濡倗绱撴担鍙夘潐闁瑰嘲鍢查埞鎴︽偐閸偅姣勬繝娈垮枟閹稿啿鐣烽幇顖樹汗闁圭儤鍨垮Λ鐑芥偡濠婂懎顣奸悽顖涱殜閹繝寮撮姀锛勫帾婵犵數濮寸换鎰般�呴鍌滅＜闁绘﹢娼ф禒閬嶆煛鐏為潻鎷峰畷鍥ㄦ畷闁诲函缍嗛崜娑㈡儊閸儲鍊甸悷娆忓缁�鍐煥閺囨ê鐏ǎ鍥э工椤垹鐣濇繝鍐冣晜淇婇悙顏勶拷褏绱為敓鑺ョ箾閸滃啰鎮兼俊鍙夊姍楠炴锟芥稒锚椤庢捇姊洪崨濠勭畵閻庢氨鍏橀弫鎾绘寠婢跺瞼鍔梺鍝勬湰閻╊垱淇婇幖浣规櫇闁跨喍绮欓崺銏ゅ即閵忥紕鍘告繛杈剧秬椤鐣峰畝鍕厵妞ゆ梻鍘ч埛鏂棵归悪鍛洭缂佽鲸甯￠敐鐐侯敇閻旈鍘遍梻鍌氬�搁崐鐑芥嚄閸洖绠犻柟鎹愵嚙鎼村﹪鏌＄仦璇插姎閹兼潙锕弻锛勪沪鐠囨彃濮庨梺缁樻尰閿曘垽寮婚悢鍛婄秶濡わ絽鍟宥夋⒑缁嬫鍎愰柛鏃�鐟╁濠氭偄閾忓湱锛滃┑鈽嗗灡濡炰粙宕电�ｎ喗鈷戠憸鐗堝俯濡垿鏌涜箛鏃撹�挎鐐插暣閹粓鎸婃径宀婂悑闂備焦鍎冲ù姘跺磻閸℃稒鏅搁柦妯侯槹閹牓鏌嶇憴鍕仸妤犵偛锕弻娑欑節閸愨晝顦伴悗瑙勬处閸ㄥ爼鐛澶樻晩缁炬媽椴搁ˉ鈥斥攽閻愬樊鍤熷┑顔芥尦椤㈡牠宕卞☉娆忎簵闂佸搫娲㈤崹娲磹閸洘鐓熼柟閭﹀幗缂嶆垹绱掗敓浠嬪礃椤垹鍞甸柣鐔哥懃鐎氭悂鎳撻崸妤佺厸閻忕偠顕ф慨鍌炴煙椤斿搫鐏柟椋庡Т閳绘挾锟斤綆鍋呭畷宀勬煛瀹�锟介崰鏍�佸▎鎾村亗閹兼惌鍨辩�氬綊鏌熼梻瀵稿妽闁稿鏅犻弻锝夊箣閿濆棭妫勭紓浣哄珡閸曨厾顔曢梺绯曞墲閻熴儲绂嶆ィ鍐╃厱鐎广儱娲﹂弳顒勬煛瀹�瀣М闁诡喒鏅犻幊锟犲Χ閸モ晝宕跺┑鐘垫暩閸嬫盯骞忛幋鐘电濞撴熬鎷锋鐐插暞鐎靛ジ寮堕幊鐐藉姂閺屽秹宕崟顐嫹閻㈢绠繛宸簼閳锋垿鏌涘☉姗堝姛缂佺姵鎹囬幃妤�顫濋悡搴㈢彎闂佺硶鏂傞崹鍝勵嚗閸曨垰绠涙い鎾跺Т楠炲牊绻濈喊妯活潑闁搞劏椴哥粋宥嗙鐎ｎ亞锛涢梺闈涙禋濠線骞忓畡鎵虫灁闁割煈鍠楅悘鍡涙⒑閸涘娈欐繛鍛礃缁岃鲸绻濋崶銊ヤ痪濡炪倖鐗徊楣冾敁婢舵劖鈷掑ù锝呮憸缁夌儤銇勯妷锔藉磳鐎规洘顨呴～婊堟晸娴犲宓侀柛鈩冪☉绾惧ジ鏌ｉ幇顓炵祷缂佹劖绋掔换婵嬫偨闂堟刀銏ゆ煕鐎ｎ亝顥為悗闈涖偢楠炴绱掑Ο閿嬪闂備胶顭堥張顒勬偡瑜旇棟闁挎洖鍊归悡娆愮箾閺夋埈鍎滈柟鐑筋棑閹肩偓鎷呯憴鍕╀虎闂佽桨绀侀崯鏉戠暦閹烘埈娼╅柟鎻掝儑楠炪垽姊婚崒娆戭槮闁规祴锟借秮娲晝閸屾氨锛涢梺绯曞墲缁嬫垵效閺屻儲鐓忛柛顐ｇ箥濡插綊鏌ｉ幘瀛樼闁哄苯绉归崺鈩冩媴閸涘﹥顔嶉梻浣稿暱瑜扮偟娆㈠璺鸿摕鐎广儱顦伴悡銉╂倵閿濆簼绨藉ù鐓庣焸濮婃椽宕崟顒佹嫳缂備礁顑嗛崹鍧楀春閵夛箑绶炲┑鐘插瀵ゆ椽姊洪崜鎻掍簽闁哥姵鍔欏铏鐎涙ǚ鎷洪柣鐘叉处閻擄繝顢撳Δ鍛厽闊洦鏌ㄩ崫娲煙椤旀儳鍘撮柛鈺嬬節瀹曘劑顢橀埄鍐╁暫濠电姷鏁搁崑鐐哄垂椤栫偛鍨傜憸鐗堝笒绾拷闂佽鍎兼慨銈夋偂韫囨挴鏀介柣鎰皺娴犮垽鏌涢弮锟界喊宥夊Φ閸曨垼鏁冩い鎰剁磿閻╁骸顪冮妶搴濈盎闁哥喎鐡ㄦ穱濠囧醇閺囩偛鑰垮┑鈽嗗灥濞咃綁銆傞懠顒傜＝闁稿本鑹鹃敓钘夋憸缁棃骞橀鑺ユ珖闂侀潧鐗嗛¨锟界紓宥嗙墵閻擃偊宕堕妸锔绢槶缂佺偓鍎抽崥瀣┍婵犲浂鏁嶆繝鍨姇濞堫厼顪冮妶鍛劉闁圭懓娲ら～蹇撁洪鍕獩婵犵數濮寸�氀兾ｉ崼銉︹拺闁圭瀛╃壕鎼佹煕婵犲啰绠撴い鏇秮楠炲酣鎸婃径鎰暪闂備線娼ч¨锟介柤闈涚秺楠炲繐煤椤忓應鎷洪梺绋跨箺閸嬫劙濡堕幘顔界厸闁告侗鍠氶惌鎺旓拷瑙勬礈閺佸寮幘缁樺殟闁靛／鍛闂備礁鍟块崵鏍箯閻戣姤鐓曟繛鎴濆船閺嬬喖鏌ｅ┑鎰偗婵﹥妞藉畷銊︾節閸屾粎鎳栭梺姹囧焺閸亪鏁撻懞銉ュ闁搞倖娲橀妵鍕即椤忓懎顏堕柣搴ゎ潐濞叉粓宕㈣閸╃偤骞嬮敃锟介柋鍥ㄣ亜閹扳晛鐏柡鍡愬劦濮婂宕掑顒婃嫹妞嬪海鐭嗗〒姘炬嫹鐎规洏鍎抽敓鏂ょ秵閸嬪棝銆呴幓鎹楀綊鎮╁顔煎壈缂佺偓鍎冲锟犲蓟濞戞鏃堝礃閵娿倖鐫忛梻浣告惈椤戝棗顫忚ぐ鎺戠疄闁靛鍎欓弮鍌︽嫹閿濆骸浜滄い蹇氬煐缁绘繂鈻撻崹顔界亪闂佹寧娲忛崝宀勫煝瀹ュ鏅插璺猴功椤斿姊洪崨濠冨闁搞劎澧楅崕顐︽⒒娓氾拷濞佳嚶ㄩ敓钘夆攽閳ヨ櫕绌块柕鍥ㄥ姇椤繈鎳滅喊妯诲濠电偠鎻徊鍧楀磿閵堝鍚归柨鐔剁矙濮婃椽骞栭悙璇ф嫹閺嶎厽鍋嬮柣妯垮吹瀹撲線鐓崶銊р檨闁哄懏鎮傞弻銊╂偆閸屾稑顏�
				clanInfo.setClanname(newname);
				
				int costHearthStone = fire.pb.clan.srv.ClanAuthManager.getInstance().getChangeClanNameCostHearthStone();
				
				if (!fire.pb.fushi.FushiManager.subFushiFromUser(userid, 
						roleid, costHearthStone, 0, 0,
						fire.pb.fushi.FushiConst.REASON_SUB_CHANGEFACTIONNAME,
						YYLoggerTuJingEnum.tujing_Value_gonghuigaiming,true
						)) {
					return false;
				}
				
				for (java.util.Map.Entry<Long, xbean.ClanMemberInfo> entry : clanInfo.getMembers().entrySet()) {
					mkdb.Procedure.pexecuteWhileCommit(ClanUtils.addClanTitleByPositionProc(entry.getKey(), clanInfo.getClanname(), entry.getValue().getClanposition()));
				}
				
				mkdb.Procedure.psendWhileCommit(roleid, new SChangeClanName(newname));
				fire.pb.talk.MessageMgr.psendMsgNotifyWhileCommit(roleid, 160068, null);
				
				//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚敐澶婄闁挎繂鎲涢幘缁樼厱闁靛牆鎳庨顓㈡煛鐏炲墽娲存い銏℃礋閺佹劙宕卞▎娆戠┛闂傚倷娴囧▔鏇㈠窗閹版澘鍑犻柤濮愬�楁稉宥夋煙閹咃紞闁哄棴绠撻弻锝夊箻閸愯尙妲伴梺缁樻煥濡瑧鎹㈠┑瀣棃婵炴垶鑹鹃·锟介梻浣规偠閸娧囧箯闁垮绻嗛柣鎰典簻閿熷鍊濆畷鎴﹀川椤栨稑搴婇梺鍛婃处閸ㄦ壆绮婚弻銉︾厱闁哄洢鍔岄悘锟犳煙椤栨粌浠遍柟顔肩秺瀹曞爼鏁愰崨顓涙嫟闁荤偞鐨滈崟顓犵槇闂佹眹鍨藉褍鏆╅梻浣芥〃閻掞箓骞冮崒姘辨殾闁硅揪闄勯崐鐑芥煕濠靛棗顏╅柣搴弮濮婃椽宕ㄦ繝鍐ㄧ煯缂備緤鎷峰〒姘炬嫹鐎殿喗鎮傚畷濂革綖椤旇棄顏跺Δ鐘靛仜閻忔繈宕濆顓滀簻鐟滄繈骞忔搴ｇ＝闁稿本姘ㄦ牎闂佺粯顨堟繛锟界�殿喖顭烽弫鎾绘偐閼碱剙锟界偤姊洪棃娑辨Ф闁稿氦娅曠粋鎺撱偅閸愨斁鎷虹紓鍌欑劍钃遍悘蹇曟暬閺屾盯鎮╅崘鎻掝潔缂備礁鐭佹ご鍝ユ崲濠靛鐐婃い顒夊劯閸モ晛褰勯梺鎼炲劘閸斿秹鎮￠妷锔轰簻闊洦鎸鹃崺锝嗘叏婵犲嫮甯涢柟宄版嚇閹煎綊鎮烽幍顕呭仹濠碉紕鍋戦崐鎴﹀礉瀹�鍕亱闁规儳纾弳锕傛煙鏉堥箖妾柛瀣閺屻倝鎳犻锟介惃鎴犵磽瀹ュ嫮绐旈柣娑卞櫍瀹曞爼顢楁担闀愮綍闂備礁澹婇崑鍡涘窗閹扮増鍋熼柛鎰ゴ閺�浠嬫煟濮楀棗鏋涢柣蹇氶哺缁绘稒寰勭�ｎ剚鍒涘銈冨灪閻楃姴鐣烽崼鏇ㄦ晢闁跨喍绮欏畷鎺楀Ω閳哄倻鍘介梺闈涚箳婵敻宕悙鐑樼厽闁规儳顕埥澶嬨亜椤撯剝纭堕柟鐟板閹噣寮堕幋婵愭浆婵犵數濮幏鍐礋椤掑偆妲俊鐐�ら崣锟介柛搴☆煼钘濋柟缁㈠枟閻撴盯鏌涘锟界粈浣圭濠婂牆纭�闂侇剙绉甸悡娆撴煟濡わ拷閻楀﹦娆㈤懠顒傜＜闁绘瑦鐟ョ�氼喚绮绘ィ鍐╃厱闁斥晛鍠氬▓鏃堟煃闁垮顥堥柡灞剧洴閹瑩宕归锝嗙槗闂備礁鎼惌澶岀礊娓氾拷楠炲啴濮�閵堝懍绱堕梺闈涱檧缁犳垵鈻嶉幋锔解拺閻犲洦褰冮銏ゆ煕閹存繄绉虹�规洏鍨藉畷婊嗩槻闁搞劍绻堥弻娑㈩敃椤愶絿绐欓梺褰掝棑閸忔﹢寮幇顓熷劅闁斥晛鍟版禍鍫曟⒒娴ｈ櫣甯涢柟绋款煼閹嫰顢涢悙鑼暫濠殿喗顨愰幏鐑芥煙椤旂晫鎳囨鐐存崌楠炴帡宕卞Ο铏规Ш闂傚倸鍊风粈渚�鎮块崶顬盯宕熼锟介崶顒佸仺缂佸鍎婚幗鏇㈡倵楠炲灝鍔氭繛璇у閿熻姤纰嶅畝鎼佸蓟閿涘嫪娌悹鍥ㄥ絻婵酣鎮楀▓鍨灍婵犮垺顭堥悘鍐⒑缂佹﹫鑰挎繛浣冲嫮顩锋繝濠傚缁犲墽锟界懓澹婇崰鏍ь嚕椤曪拷閺屾洟宕遍弴鐙�妲柧缁樼墵閺屾稑鈽夐崡鐐茬闂佹寧绋掔划宀勫煘閹达附鍊烽柛娆忣樈濡繝姊洪幖鐐插缂傚秴锕ㄥΛ鐔兼⒑鐠恒劌娅愰柟鍑ゆ嫹?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鐐劤椤兘寮婚敐鍛傜喎鈻庨幆褎顔勭紓鍌欒兌婵挳鎮樺璺何﹂柛鏇ㄥ枤閻わ拷闂佸湱鍋撻幆灞轿涢悙鐢电＝濞达絿鏅崼顏堟煕婵犲啰绠炵�殿喖顭烽弫鍐晸閸婄喓浜藉┑鐐存尰閸戝綊宕归柆宥庢晛闁糕剝绋掗埛鎴︽煕韫囨挸鎮戠紒璺哄级缁绘稓娑垫搴ｇ槇閻庢鍠涢褔鍩ユ径濞㈢喎顭ㄩ崟顒夋閻庤娲橀敃銏′繆閹间礁围闁糕剝顨呴蹇旂節閻㈤潧校妞ゆ梹鐗犲畷鎶筋敍濠婂啰绛忛梺浼欑到閻骞忓畡閭︽僵妞ゆ挾鍠撻崙鈥愁渻閵堝骸浜滅紒缁樺灩閹广垹鈹戦崱鈺傚兊濡炪倖甯掗崑濠勬閸欏绡�闁汇垽娼ф禒婊勪繆椤愶絿鎳呴柡渚囧櫍楠炴帒螖閿熶粙宕掗妸鈺傜厓闁靛闄勯悘閬嶆煛閿熻姤绂掔�ｎ偆鍘介梺褰掑亰閸撴瑧鐥閺屾盯鏁愰崶褍骞嬮梺鍝勬湰閻╊垱淇婇幖浣肝ч柛銉㈡櫇閸橆垶姊绘担铏瑰笡濞撴碍顨婂畷鏉库槈濮樺彉绗夊┑鐐村灦鑿ゆ俊鎻掔墛缁绘盯宕卞Ο鍝勵潔濡炪倕绻掗崰鏍ь潖缂佹ɑ濯撮柤鎭掑劤閵嗗﹪姊洪棃鈺冪Ф缂佺姵鎹囬悰顔跨疀濞戞瑦娅㈤梺璺ㄥ櫐閹凤拷?
				MessageMgr.psendMsgNotifyWhileCommit(clanInfo.getMembers().keySet(), 160396, 0,Arrays.asList(newname));
				//濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮诲☉妯锋婵鐗嗘慨娑氱磽娴ｅ搫鈻堢紒鐘崇墵瀵濡搁埡鍌氫簻闁荤姴娲﹂悾顐﹀箻閸撲胶锛滅紓鍌欑劍椤洭鍩︽笟锟介弻鐔风暋閻楀牆娈楅悗瑙勬礃閿曘垹鐣烽敐鍡楃窞閻庯綆鍋勯敓浠嬵棑缁辨挻鎷呴崫鍕闂佺楠哥壕顓犳閻愬绡�闁搞儜鍡樻啺闂備焦瀵уú鈺呭箯閻戣姤鎳氶柨婵嗩槹閻撶喐鎱ㄥ鍡楀⒒闁搞倗鍠撶槐鎺楁晸娴犲骞㈡俊鐐电帛閺傦拷闂備胶绮崝鏍ь焽濞嗘挻鍊堕柣鏂垮悑閻撴洟鏌曟繛鍨姕閻犳劧绱曠槐鎺楊敊閼测晛鈪遍梺璺ㄥ枑閺嬭崵绱為崱娑樼；濞达絽婀遍々鍙夌節婵犲倻澧涢柣鎾寸懃闇夐柣鎾虫捣閹界姵绻涢幊宄板幘閻熼偊鐓ラ柛鏇ㄥ幘閻撲胶绱撴担铏瑰笡闁烩晩鍨伴悾鐑芥偂鎼存ɑ顫嶅┑鈽嗗灟鐠�锕�顭囨惔銏㈢瘈婵炲牆鐏濋弸娑㈡煥閺囨ê鍔氭い顏勫暣閹稿﹥寰勭仦鐐啎闂備線娼ч…顓熶繆閸モ晛濮柨鐔剁矙濮婃椽宕ㄦ繝鍐紭闂佸憡鏌ㄧ粔褰掓晲閻愬樊鍚嬮柛鈩冩礈缁犳岸姊虹紒妯哄Е濞存粍绮撻弫鎾存叏閹邦剨鎷峰┑鍡欐殾闁挎繂妫欓崕鐔兼煏婵炲灝鍔氶柛瀣Ч濮婅櫣鎷犻垾宕囦紘闂佽绻戦惄顖炲极閹邦厼绶炲┑鐘插閺夋悂姊绘担铏瑰笡妞ゃ劌鎳橀幃褎绻濋崒妤佺�哄┑鐘诧工鐎氼喚寮ч敓浠嬫⒑闂堟盯鐛滅紒鎻掑⒔濞戠敻鎮欓鍙ョ盎闂佺懓鐡ㄧ换鍐窗濡》鎷风憴鍕８闁搞劋绮欓獮鍐╃鐎ｎ亜绐涙繝鐢靛Т鐎氼剟鐛幇顑芥斀闁绘﹩鍠栭悘杈ㄧ箾婢跺娲撮柡浣稿暣閺佸倿鎳為妷锔惧娇闂備礁鎼ú銊╁磿閹扮増鍋勯柛鈩冪懄閸犳劙鐓崶銊р槈闁汇倗鍋撻妵鍕箛閵婏箑娈ラ梺鎸庣箓椤︻垳绮诲☉銏＄厸濠㈣泛瀛╃涵璺何旈悩鍙夋悙闁宠鍨块幃娆撳矗婢舵ɑ顥ｅ┑鐘媰閸屾粎鐓撻悗瑙勬处閸撶喖骞冩禒瀣窛濠电姴瀚獮妤呮⒒娴ｈ櫣甯涢柡灞诲姂楠炴顭ㄩ崼婵堢枃闂佸憡鍔﹂崰妤呭磹閸偅鍙忔俊顖滃帶鐢埖顨ラ悙鎼劷缂佽鲸甯￠、娆撴嚃閳轰讲鍙￠梻浣芥硶閸犳劙寮搁懡銈囩闁糕剝绋戠粣妤佷繆閵堝懏鍣洪柛瀣�圭换娑㈠箣閻愰潧鏆￠梺褰掝棑閸忔﹢骞嗛崒鐐插窛濠电姴鍋嗘导鎾绘⒒閸屾瑦绁版繛澶嬫礋瀹曟澘顓奸崶褍鐏婂┑鐐叉缁绘帡寮抽敃锟介湁闁稿繐鍚嬬紞鎴犵磼閻樺樊鐓奸柡灞诲�濆畷銊︾節鎼粹剝娅涙繝鐢靛仩閸嬫劙宕伴弽褜娼栨繛宸簻閹硅埖銇勯幘璺轰粶濠碘剝妞藉娲箹閻愯鎷疯缁骞樼拠鑼暫闂侀潧绻堥崐鏍磻閸岀偛绠归悗娑欘焽缁犳﹢鏌ｉ幇顒婅含婵﹦绮幏鍛村川婵犲倹娈樻繝鐢靛仜瀵爼鎮ч悩璇茬畺婵☆垯璀﹀鈺呭级閸碍娅囨い锔诲灦閹鐛崹顔煎濡炪倧缂氶崡鎶藉春濞戙垹绠虫俊銈勮兌閸橀亶鏌ｈ箛鏇炰粶濠⒀傜矙楠炲﹪宕ㄩ婊咃紲闂佸綊鍋婇崢浠嬪煕閹邦喚纾肩紓浣诡焽閳句線鏌熷畡鐗堝殗鐎规洘锕㈤獮鎾诲箳閹寸媭鍟嬮梺鑽ゅ枑缁孩鏅跺Δ鍐╂殰闁圭儤姊婚惌鍡涙倵閿濆骸浜栧ù婊勭矒閺屸�愁吋閸愩劌顬夐梺姹囧妽閸ㄥ爼濡甸崟顖氭闁圭瀵掑Λ锕�鈹戦纭烽練婵炲拑缍侀獮鎴﹀礋椤栨鈺呮煏婢舵稑顩憸鐗堝哺濮婄粯鎷呴悜妯烘畬闂佹悶鍊栭悧鐘荤嵁韫囨稒鏅搁柨鐕傛嫹
				MessageMgr.psendSystemMessageToRoles(clanInfo.getMembers().keySet(), 160396, Arrays.asList(newname));
				
				fire.pb.clan.srv.ClanManage.logger.info("闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚敐澶婄闁挎繂鎲涢幘缁樼厱闁靛牆鎳庨顓㈡煛鐏炲墽娲存鐐达耿閹崇娀顢楁径瀣撴粓姊绘担瑙勫仩闁告柨绉堕幑銏ゅ礃椤斿槈锕傛煕閺囥劌鐏犻柛鎰舵嫹闂備線娼ц噹濞撴艾锕ョ�氬綊鏌熼悜姗嗘畷闁绘挾鍠愮换婵嬫濞戞瑯妫ら梺绯曟櫔缂嶄線寮婚垾宕囨殕閻庯綆鍓涢惁鍫ユ倵鐟欏嫭绀�闁绘牕鍚嬫穱濠囨倻閽樺）銊ф喐瀹�鍕畺闁挎繂顦伴埛鎺懨归敐鍛础婵狅拷娴犲鐓曞┑鐘插枤濞堟粎锟借娲橀崹鍧楃嵁濮楋拷閹虫粓妫冨☉妯煎搸濠电姷鏁搁崑鐐哄垂椤栫偛鍨傞柛锔诲幘娑撳秹鏌ㄥ┑鍡橆棤缂佺娀绠栭弻娑㈠焺閸愮偓鐣肩紓浣哄У婵炲﹪寮诲☉銏犵睄闁跨喍绮欓獮鎰板礃瀹割喗缍庨梺缁樺灦钃卞┑顔界矒閺岀喎鈻撻崹顔界彯濠碘�虫▕閸ｏ絽顫忓ú顏勭閹兼番鍨婚埞娑氱磽娴ｅ搫校闁圭懓娲ら锝夘敃閿曪拷缁犺崵绱撴担濮戭亪鎯傞崟顒傜瘈闁靛骏绲剧涵楣冩煟椤掞拷閵堢顕ｉ崘娴嬫闁靛繆妾ч幏铏圭磽娴ｅ壊鍎忔繛纭风節椤㈡挸螖閸愭寧瀚归悷娆忓婢跺嫰鏌涢幘瀵告创鐎规洩缍佸畷銊э拷娑櫱氶幏娲⒑閸︻収鐒鹃悗娑掓櫇缁牓鏁撴禒瀣拺缂佸灏呭銉╂煙閼恒儳鐭岄柛鎺撳浮閺佹劙宕ㄩ崒娑欘棃鐎规洏鍔戦、娆撳箚瑜嶇粻鐐烘⒒閸屾瑧鍔嶉柡瀣偢瀵彃鈽夐姀鐘垫焾婵炴潙鍚嬪娆撴偂閵忕姰锟芥帒顫濋悙顒�顏堕梻浣告惈閻绱炴笟锟介悰顔嘉熺涵閿嬪闂傚牊绋掗崯鐐烘煕閿濆嫬宓嗘慨濠冩そ瀹曨偊宕熼鐘插Ы缂傚倸鍊哥粔宕囨濮樿埖鍋樻い鏃�鎷濋幏鐑芥晲鎼粹剝鐏嶉梺绋匡功閸忔﹢寮诲☉銏犵労闁稿繒濯禍顏堝箖濮楋拷閸╋繝宕橀鍡床婵＄偑鍊栧Λ渚�宕戦幇顓熸珷闁挎洖鍊归悡娑樏归敐鍫綈鐎规洖鐭傞弻鐔虹矙閸栤剝鏁鹃悗鍨緲鐎氼剝鐏掗柣鐘叉穿鐏忔瑥危閿濆鈷掗柛灞剧懅缁愭梹绻涙担鍐叉处閸嬪鏌涢埄鍐槈闁汇値鍠楅妵鍕箛閸撲胶鏆犵紓渚婃嫹濠㈣泛顑嗛崣蹇斾繆椤栨氨浠㈤柣鎾村姍閺岋綁骞樼�靛憡鍣梺闈涙搐鐎氭澘顕ｉ幘顔藉�烽柡澶嬪灦椤忥繝姊绘担铏瑰笡閻㈩垼浜獮蹇涙晸閿燂拷 "+roleid+"\t濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ゆ繛纭风節瀵鎮㈤悮瀛樺闁汇垺顔栭悞鍓э拷娑欑箘缁辨挻鎷呴悾灞界墯闂佺锕ョ换鍫濐嚕婵犳碍鏅濋柨鐔凤拷鐔轰航濠电偞鎸婚崙褰掑垂闁秵鏅柛鈩冪♁閸嬧剝绻濇繝鍌涘櫣妞わ絽銈搁幃浠嬵敍濞戞顑傛繝銏ｎ潐濞叉缂撴禒瀣窛濠电姴瀚獮妤呮⒒娴ｅ摜绉洪柛瀣躬瀹曡瀵肩�涙ê鍓┑鐐叉▕娴滄繈鎮￠悢鍝ョ闁瑰鍋熸晶顏堟煕閺冿拷瀹�鎼佸蓟瀹ュ洦鍠嗛柛鏇ㄥ亞娴犵螖閻橀潧浠滈柨鏇ㄤ邯瀵鈽夊▎鎴犵槇闂佸憡鍔忛弲婵嬎囬弶璇炬棃鎮╅棃娑楃捕闂佹寧娲忛崕鐢哥嵁閸℃稑绫嶉柛顐ｆ儕閳哄懏鐓忓璺虹墕閸旀碍绻涢崼娑橈拷鏇㈠煘閹达附鍊烽柤鎼佹涧濞懷呯磽娴ｈ棄钄兼繛澶嬫礀閳藉鎮界粙鍧楀敹闂佸搫娲ㄩ崑鐔煎传濡や胶绠鹃悗鐢殿焾瀛濆銈嗗灥濡繈骞冮敓鐘插嵆闁靛繆锟界鎷烽崼鏇熺厽闁归偊鍘肩徊濠氭煃闁垮顥堥柡宀嬬秮椤㈡ê顭ㄩ崘鎸庡婵犻潧顑呴拑鐔兼煥濠靛棭妲哥紒鐘冲▕閺岀喓锟芥稒顭囨俊鍥煙缁嬪灝鏆熺紒杈ㄦ尰閹峰懏绂掔�ｎ亝鎳欓梺姹囧焺閸ㄧ晫鎹㈠┑鍡╁殨妞ゆ劧绠戠粻濠氭倵闂堟稑顥忔繛鏉戝閺岋絾鎯旈婊呅ｆ繛瀛樼矌閸嬨倝寮鍜佺叆闁告劧绲鹃弬锟介梻浣虹帛閸旀牕顭囧▎鎾村�堕柨鏇炲�归悡鐔镐繆閵堝嫮鍔嶉柍閿嬪浮閺屻倖銈﹂崸妤�鎽电紓浣虹帛缁诲倿锝炲┑瀣垫晣婵炴垶鐟ラ鍦磽閸屾瑨鍏岄柧蹇撻叄瀹曘垺绺界粙璺ㄧ枃闂婎偄娲﹂崫搴㈢閸︻厽鍠愰煫鍥ㄦ礃椤洟鏌熼悜姗嗘當缂佺姷鏁婚弻鐔兼倻濡櫣浜堕梺鍦焾閸燁偊鍩為幋锔藉�烽柡澶嬪灩娴犲ジ姊烘潪鐗堢グ妞ゆ泦鍥ㄥ仼鐎瑰嫰鍋婇悡銉╂煕閺囥劌澧い搴㈡崌濮婃椽骞嗚缁犺櫕绻涢崨顐㈢伄婵″弶鍔欏濠氬Ψ閿旇瀚藉┑鐐舵彧缁蹭粙骞楀鍛煋婵炲樊浜濋悡鏇㈡倵閿濆簼鎮嶉棅顒夊墰閿熷�燁潐濞测晝寰婃ィ鍐ㄧ畾闁哄啫鐗嗛悡銏ゆ煥閻斿墎鐭欑�殿喗鎮傚顕�鏁撻悾灞惧床婵犻潧娲ㄧ弧锟介梺绋挎湰缁矂路閿熶粙姊绘担铏瑰笡闁圭顭烽幆鍕敍閻愯尙鐣哄┑顔筋殣閹风兘鏌熼鐣屾噰妤犵偞鎹囬獮鎺楀幢濡櫣妲洪梻鍌氬�风粈渚�鎮块崶顬盯宕熼锟介崶銊ヮ嚤闁哄鍤﹂敃鍌涚厱闁哄洢鍔岄悘閬嶆煛娴ｇ鏆ｉ柡灞诲妼閳规垿宕卞Ο铏圭崺闂備焦鐪归崐鏇狅拷姘煎墴閳ユ棃宕橀鍢壯囨煕閹扳晛濡垮ù鐘冲劤椤啴濡堕崘銊ヮ瀳闂佹寧娲忛崐婵嬪箖妤ｅ啯鍊婚柦妯侯槺椤斿﹤鈹戞幊閸娧囧箯妞嬪海妫柟顖嗗啯鍊繛锝呮搐閿曨亪銆佸☉姗嗙叆闁告劦浜濋濠氭⒒娴ｇ儤鍤�闁搞垺鐓″畷鏌ユ嚑閸撲椒绨烽梻鍌欑閹测剝绗熷Δ鍛偍濡わ絽鍟崑鈺呮煕濠靛棗顏存繛鎾愁煼閺屾洟宕煎┑鍥舵！缂備礁鑻锟犲蓟閻旈鏆嬮柡澶嬪浜涢梻浣哥枃椤宕归崸妤�鏄ラ柛鏇ㄥ灠缁�鍐煃鏉炴壆绛忛柟椋庡厴楠炲洭鎮ч崼銏犲箞闂備礁鍟块幖顐︻敄閸モ晛濮柨鐔剁矙閹鎲撮崟顒傤槰闁汇埄鍨辩敮锟犲灳閿曞倸惟闁宠桨鑳堕ˇ銊╂⒑闂堟侗鐓紒鐘冲笧濞嗐垽濮�閻橆偅鏂�闂佺粯锚閻忔岸寮抽埡浣叉斀妞ゆ梹鍎抽崢瀵革拷娈垮櫘閸嬪﹪鐛弽銊﹀闁告縿鍎荤槐閬嶆⒒娴ｈ櫣甯涢柛鏃�娲熼獮鏍敃閿曪拷閸ㄥ倿鏌涘畝锟介崑鐐烘偂濞嗘劑浜滈柡宥冨妿閻﹥銇勯敐鍛仮闁哄瞼鍠栧畷姗�宕ｆ径瀣缂傚倷鑳剁划顖滄崲閸儱绠栧ù鐘差儐椤ュ牊绻涢幋鐐叉暰闁归鍏橀獮妯肩磼濡厧骞嶅┑锛勫仜椤戝懏顨ラ幖浣稿偍闁圭虎鍠楅悡娑氾拷鐧告嫹闁跨喍绮欏畷鐗堟償閵娿儳鍘洪梺瑙勫礃椤曆囧垂閸屾稏浜滈柡鍐ㄥ�瑰▍鏇灻瑰鍐ㄢ挃缂佽鲸鎸婚幏鍛存偡閺夊灝袘濠电姭鎷冮崒婊呯厯閻庤娲忛崹濂杆囪ぐ鎺撶厓闁靛鍨伴々顒勬煙閻熸澘顏┑鈩冩倐閺佸啴鏁撻悾灞筋棜妞ゆ牗绋愮换鍡涙煏閸繄绠抽柣锝変憾閺岋綀绠涢弮鍌滅杽濡炪們鍨哄Λ鍐�佸锟芥慨锟介柍鎾呮嫹闁归攱妞藉娲川婵犲嫧妲堝銈庡弿閹风兘姊虹涵鍛涧缂佺姵鍨圭划缁樺鐎涙鍘甸梺璇″灣婢ф藟婢舵劖鐓㈤柛鎰典簻閺嬫盯鏌″畝瀣М鐎殿噮鍓熷畷褰掝敊閽樺鎷烽鐐粹拺閻犲洠锟藉磭浠梺绋款儑閸嬨倖淇婇悽绋跨妞ゆ牗姘ㄩ悿锟介梻浣告啞閹搁绮堟笟锟藉畷鍝勭暆閿熺晫妲愰幒妤佸�锋い鎺嶈兌閸戯紕绱撴担鍓叉Ц缂傚秴锕ら锝夊及韫囷絾鞋缂傚倷娴囨ご鍝ユ暜閹烘洜浜介梻浣虹帛閹稿摜鑺遍崼鏇炵濞寸厧鐡ㄩ埛鎺懨归敐鍛暈闁诡垰鐗撻弻锟犲醇椤愩垹鈷嬮梺璇″灠鐎氫即銆佸☉銏″�烽梻鍫熺〒閵堬箓姊绘担瑙勫仩闁稿孩妞藉畷婊堟晝閸屾碍鐎梺鎼炲労閸撴岸鎮￠悢鍏肩厵闂侇叏绠戦獮鏍磼閼艰泛鍚归柟顕呭枛椤粓鏁撻挊澶樻綎濠电姵鑹剧壕鍏肩箾閸℃ê鐒炬俊宸櫍濮婅櫣娑甸崪浣告疂缂備胶绮换鍫ユ偘椤曪拷楠炲洭寮堕崸妤�鏁归梻浣告惈濞层劑宕戦悢濡撳洭顢氶敓钘夘潖濞差亝鍋￠柟娈垮枟閹茶偐绱撴担绛嬪殭缂佸鎸抽垾锕傚炊椤掞拷閸愶拷濡炪倖鎸鹃崰鎾诲储娴犲鈷戦柣鐔煎亰閸ょ喎霉閸忚偐绠炴い銏℃瀹曞ジ顢曢敐鍡樼彣闂備礁鎼ˇ顖炴偋閸曨垰绀夐幖杈剧悼娑撳秴螖閿濆懎鏆為柣鎾存礋閺屽秹鍩℃担绋跨濡炪倕绻愰幊蹇涘矗韫囨稒鐓曢柕澶涚到婵＄霉濠婂嫮鐭掗柣鎿冨亰瀹曞爼濡烽妷銉ヮ潥闂佽瀛╅悢顒勫箯閿燂拷? "+costHearthStone);
				
				for (long members : clanInfo.getMembers().keySet())
				{
					mkdb.Procedure.pexecuteWhileCommit(new PRoleZongheRankProc(members));
				}
				
				mkdb.Procedure.pexecuteWhileCommit(new fire.pb.ranklist.proc.PFactionZongHeProc(clanInfo.getKey(), false));
				mkdb.Procedure.pexecuteWhileCommit(new fire.pb.clan.srv.PClanUpdateChangeName(clanInfo.getKey(), newname));	
				mkdb.Procedure.pexecuteWhileCommit(new fire.pb.clan.fight.PClanFightUpdateChangeName(clanInfo.getKey(), clanInfo.getClanname()));					
				
				String mastername = new PropRole(roleid, true).getName();
				//濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮诲☉妯锋婵鐗婇弫楣冩⒑閸涘﹦鎳冪紒缁樺姍濠�渚�姊虹粙璺ㄧ闁告艾顑囩槐鐐哄箣閿旂晫鍘遍梺闈涱焾閸庨亶鏁撻挊澶嬪仴鐎殿喖顭烽弫鎰緞婵犲嫷鍟嬮柣搴ゎ潐濞叉牕煤閵堝浼犳繛宸簼閳锋垿鏌涘┑鍡楊伌闁稿孩鍔欓弻锝呂旀笟鍥ㄧ暭闂佺懓绠嶉崹褰掑煡婢舵劕顫呴柣妯活問閸氬懘姊绘担铏瑰笡闁告梹鐟ラ…鍥樄鐎殿喗濞婇弫鎾绘偐閺傘儲瀚奸梻浣藉吹閸犳劕顭垮Ο浣曪絾绻濆顓犲幈闂侀潧楠忕槐鏇㈠矗閿熶粙姊洪幐搴ｇ畼闁稿鐩崺鐐哄箣閻欏懏瀚归柨婵嗛娴滄粌霉濠婂嫷娈滈柡宀�鍠栧畷妤呮嚃閳哄倹顔冮梻浣规偠閸斿秴危閹烘桅闁归偊鍘介崕鐔搞亜椤愵偄骞樼紒鐘冲哺濮婃椽妫冨☉姘暫濠电偛鐪伴崐鏇㈠汲閳哄懏鈷掑ù锝勮閻掔偓銇勯幋婵囶棦闁诡垰瀚伴、娑橆潩鏉堛劍顔曟俊鐐�栭悧婊堝磿閹版澘鏋佺�广儱妫涚弧锟芥繝鐢靛Т閸婃悂顢旈埡鍛闁哄鍩婂銉╂煃鐟欏嫬鐏撮柟顔规櫇缁辨帒螣婵犳碍鏆樺┑锛勫亼閸婃牠宕归悽绋跨疇闁归偊鍠栭崹婵嬫煕椤愵偅绶涢柟椋庡厴閺佹劖鎯旈垾鑼寜濠电偛鐡ㄧ划宥囧垝閹捐钃熼柣鏃傚帶娴肩娀鏌涢弴銊ュ辅闁靛牆顦伴悡鏇㈡煛閸屾繃纭堕弽锟犳⒑闂堟稒鎼愰悗姘緲椤曪綁顢楅崟顐ゎ唶闁硅偐琛ュΣ鍛ｉ崡鐐╂斀闁绘垵娲ㄩ崚鐗堢箾鐏炲倸锟芥繈寮崘顕呮晜闁割偅绻勯悾鍝勨攽閻愬弶顥為柟灏栨櫊瀵偊宕掗悙瀵稿幈闂佸搫娲犻敓钘夌－閸橆偊鏌ｆ惔銏ｅ缂傚秴锕濠氬灳閹颁礁鎮戦柟鑹版彧缁茶偐鍒掔捄琛℃斀闁绘劖娼欓悘锕傛煟閻曞倿妾柛鎺戯躬楠炴﹢顢欓挊澶夌敾婵犵數鍋涘Λ妤冩崲閹伴偊鏁傞柍鍝勫枦閹峰嘲鈻撻崹顔界亪濠电偛鐨烽敓鑺ュ墯濞兼牗绻涘顔荤凹妞ゃ儱鐗婄换娑㈠箣閻愯泛顥濆銈忕到閹碱偊鈥旈崘顔嘉ч煫鍥ㄦ礈缁愭姊洪崨濠庢當闁哥喎娼￠幃楣冩倻閽樺鐤�濡炪倖鎸炬慨鐑芥儊閸績鏀芥い鏃�鏋绘笟娑㈡煕濮楋拷缁犳牕鐣烽敐澶婂耿婵炴垶鐟㈤幏娲⒑閸涘﹦绠撻悗姘煎幘缁﹪鍩℃导杈╂嚀椤劑宕熼鐘垫毉闂備浇娉曢崰鏇熸叏閵堝鍤岄柛鎾楀懐顦繝鐢靛Т閸嬪棗顭囬弽褉鏀介柣妯虹枃婢规﹢鏌ｉ幇顒婂姛闁硅尙顭堥…銊╁礂閹惧懐绉�规洜鍏橀、姗�鎮╃喊澶屽簥缂傚倸鍊搁崐鐑芥倿閿曞倵锟斤箓宕堕埡鍐х瑝闂佸搫绋侀崑鍡欏閼测晝纾藉ù锝堫嚃閻掔晫绱掗悩闈涗户闁跨喎锟界噥娼愭繛鍙夘焽閺侇噣骞掑Δ瀣◤濠电娀娼ч鎰板极閸ヮ剚鐓熸俊顖氭惈閼歌銇勯妷锕�鍝烘慨濠傤煼瀹曟帒顫濋濠冨闁绘垼濮ら崵鍕煕椤愶絾纾甸柨鐔告灮缁犳挸鐣锋總鍛婂亞濞达綀顕栭崯宥夋⒒娴ｅ憡鍟炵紒鍝勬健瀹曟洘绻濆顒傤唵閻庣懓瀚竟瀣ｉ崼銉︾厵闁绘垶蓱鐏忎即鏌ｅ┑鍥╁⒌婵﹥妞介幃鐑藉箥椤旂偓娈梻浣规偠閸斿瞼绱炴繝鍥ф槬闁靛绠戠欢鐐烘煙闁箑澧绘繛鐓庯躬濮婅櫣绱掑鍡欏姼闁诲繐娴氭禍顏堝极閹剧粯瀵犲璺哄閾忓骸顪冮妶搴濈盎闁哥喎鐡ㄦ穱濠囧醇閺囩偛鑰垮┑鈽嗗灣閸庛倕鈻撻锔解拻濞达絽鎲￠幉绋库攽椤旇姤灏﹂柡灞斤躬閺佹劖寰勯崼顒佸濞撴熬鎷风�殿噮鍣ｅ畷濂告偄閸涘浠ч梻鍌欐祰濞夋洟宕抽敃鍌氱闁跨噦鎷�
				ClanManage.addDealClanEventInfo(clanInfo,ClanManage.EVENT_CHANGE_NAME,roleid,mastername,newname,"");
								
				//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊炲銈嗗笒椤︿即寮查鍫熷仭婵犲﹤鍟版晥闂佹寧绻勯崑娑㈠煘閹寸媴鎷烽敐搴′簼婵炲懎娲铏圭矙鐠恒劎鍔规繝纰橈拷铏窛缂侇喗鐟ㄧ粻娑㈠籍閸屾粎妲囬梻渚�娼ф蹇曞緤娴犲鍋傞柟鎵閻撴洟鏌￠崘鎸庡濠电偛寮剁划搴ㄥ礆閹烘挾绡�婵﹩鍓欓崬銊ヮ渻閵堝棙灏甸柛鐘虫崌瀹曘垽宕￠悜鍡樺瘜闂侀潧鐗嗗Λ妤佹叏瑜忕槐鎺楀箵閹烘垟鎸冪紓渚囧枛閻楁捇寮幘缁樺仼鐎癸拷閿熺晫澹曟總鍛婄厽闁逛即娼ф晶顕�鏌涢弬璇诧拷鏍崲濞戞碍鍏滃瀣捣閻﹀牓鎮楀▓鍨灈妞ゎ厾鍏橀獮鍐椤厾鍓ㄦ繛杈剧到濠�杈ㄧ閺嶎厽鈷掑ù锝囶焾椤ュ繘鏌ｉ幘宕囧ⅵ鐎规洘婢樿灃闁告侗鍠栭敓钘夊閿熻棄绠嶉崕閬嶅箯鐎ｎ亗锟芥帗绻濆顓犲帾闂佸壊鍋呯换鍫ヮ敁濡わ拷闇夋繝濠傚缁犳牜绱掔紒妯兼创闁瑰磭濞�椤㈡鏁撴禒瀣嚑婵炴垶鐔幏宄扳枔閸喗鐏堝銈庡幘閸忔﹢鐛崘顔碱潊妞ゎ偒鍘鹃崜銊︾箾鏉堝墽鍒版繝锟芥潏銊ь洸闁哄稁鍘介埛鎺懨归敐鍥剁劸妞ゃ儱绻橀弻锝夊箻瀹曞洤鈪甸悗瑙勬礃濠㈡鐏冮梺鍛婁緱閸犳牠鏁撻挊澶屽煟闁哄瞼鍠栧畷婊嗩槾閻㈩垱鐩弻宥夋煥鐎ｎ亞浼岄梺鍝勬湰缁嬫垿鍩ユ径濠庢建闁糕剝鐟ヨぐ鍡樼節閻㈤潧浠滈柣妤�锕ょ叅婵犲﹤鐗婇弲鎼佹煟閿濆懏婀版い蹇曞枛閺岀喐顦版惔鈥冲箣闂佸搫鐬奸崰鏍ь潖閼姐倧鎷烽棃娑橆棌婵″樊鍣ｅ娲寠婢跺﹥娈堕梺鍝ュУ閻楃姴顕ｆ繝姘╅柕澶堝灪閺傦拷闂備胶纭跺褔寮插鍛噮缂傚倸鍊搁崐鐑芥嚄閼稿灚鍙忛柣銏犳啞閸庡孩銇勯弽顐粶闁藉啰鍠栭弻鏇㈠醇濠垫劖笑缂備胶濮烽幊鎾绘箒闂佹寧绻傞悧婊冾焽閹扮増鈷戞繛鍡樺劤楠炴牗銇勯鍕殻濠碘�崇埣瀹曘劎锟界數顭堝浠嬫⒒娴ｇ儤鍤�闁搞倖鐗犻獮蹇涙晸閿燂拷?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴楠炴﹢鎳犻澶嬓滈梻浣规偠閸斿秶鎹㈤崘顔嘉﹂柛鏇ㄥ灠閸愶拷濡炪倖鍔﹀锟界紒顔肩埣濮婃椽鎸婃径濠冩闂佸摜濮甸悧鐘差嚕婵犳艾鍗抽柣鏃囨閻﹀牓妫呴銏″闁瑰皷鏅涚叅妞ゆ挶鍨洪埛鎴犵磽娴ｈ鐒界紒鐘崇缁绘稒寰勭�ｎ剚鍒涢梺绯曟櫇閸嬨倝鐛�ｎ喗鏅滈柦妯侯槷濮规姊绘担鍛婅础缂侇噮鍨抽弫顕�顢旈崼婵堫唵闂佺粯鍨煎Λ鍕煁閸ヮ剚鐓涢柛銉㈡櫅閺嬫垶绻涢崨顐㈢伈婵﹥妞藉畷妤呮⒒绾惧鐒婚梻浣侯焾妤犵鐣烽鍕畳婵＄偑鍊栧ú鈺呭箯閻戣姤鐓涚�癸拷閿熶粙宕伴弽顓滐拷浣糕枎閹炬潙浠奸悗鐧告嫹闁跨喍绮欓幃鈩冨緞閹邦厸鎷洪梺鑽ゅ枑婢瑰棝鏁嶅澶嬬厱閻庯絻鍔岄敓鑺ョ墬缁岃鲸绻濋崶銊ヤ痪濡炪倖鐗徊鍙ョ昂婵犲痉鏉匡拷妤佹叏閻戣棄纾绘繛鎴欏灪閸嬪鏌熼悙顒�澧繛鍏肩墱缁辨挻鎷呴懖鈩冨灦閸掑﹪骞橀鐣屽幈濠电偞鍨堕敃顐Ｎ涘杈╂／妞ゆ挶鍔嶇�氬綊姊婚崒姘拷鐑芥嚄閸洍锟斤箓宕奸姀锝呅″┑鐐叉▕娴滄粎澹曠憴鍕瘈闂傚牊绋掗敍宥夋煕閵堝棙绀�闁宠鍨块幃鈺冿拷鍦Т椤ユ繈鏌熼婊冩灈婵﹨娅ｉ敓钘夋贡婵敻濡撮崘顔界厾闁告劘灏欓崺锝囷拷瑙勬磸閸ㄥ湱鍙呭銈呯箰閹冲骞忓ú顏呪拺闁告稑锕ョ亸鎵喐閺夊灝鏆炵紒鍌氱Ч閹瑩鎮滃Ο鐓庡箞闂備胶绮…鍫濃枍閺囩姳鐒婇柣銏㈡暩绾惧吋銇勯弬鍨挃閻㈩垱鐩弻鏇㈠醇椤掑倻袦閻庤娲橀敃銏ゅ春閿熺姴绀冮柕濞垮劤閻ゅ嫭绻濋悽闈浶ラ柡浣告啞閹便劑骞橀鑺ユ珖闂侀潧鐗嗛ˇ顖炴偪椤斿浜滈柟鏉垮閻ｈ鲸鎱ㄧ憴鍕弨闁哄矉缍侀獮鍥敊閻撳骸顬嗛梻浣侯焾閿曘倝鎮樺璺虹疄闁靛鍎欓悢鍏煎亗閹煎瓨绻傞ˉ姘舵⒑鐠囨彃顒㈤柣鏃戝墴楠炲繘鏁撻敓锟� by changhao
				xbean.ClanProgressRankList clanprogressrankmclist = xtable.Clanprogressranklist.get(RankType.FACTION_COPY);
				if(null != clanprogressrankmclist)
				{
					List<xbean.ClanProgressRankRecord> list = clanprogressrankmclist.getRecords();
					for(xbean.ClanProgressRankRecord record : list)
					{
						if(record.getClankey() == clanInfo.getKey())
						{
							record.setClanname(newname);
							break;
						}
					}
				}
				
				return true;
			}
		}.submit();
	}

	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 808484;

	public int getType() {
		return 808484;
	}

	public java.lang.String newname;

	public CChangeClanName() {
		newname = "";
	}

	public CChangeClanName(java.lang.String _newname_) {
		this.newname = _newname_;
	}

	public final boolean _validator_() {
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		_os_.marshal(newname, "UTF-16LE");
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		newname = _os_.unmarshal_String("UTF-16LE");
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CChangeClanName) {
			CChangeClanName _o_ = (CChangeClanName)_o1_;
			if (!newname.equals(_o_.newname)) return false;
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		_h_ += newname.hashCode();
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append("T").append(newname.length()).append(",");
		_sb_.append(")");
		return _sb_.toString();
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

