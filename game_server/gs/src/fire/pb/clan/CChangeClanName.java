
package fire.pb.clan;

import java.util.Arrays;
import java.util.List;

import fire.log.enums.YYLoggerTuJingEnum;
import fire.pb.PropRole;
import fire.pb.clan.srv.ClanManage;
import fire.pb.ranklist.RankType;
import fire.pb.ranklist.proc.PRoleZongheRankProc;
import fire.pb.talk.MessageMgr;




// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CChangeClanName__ extends mkio.Protocol { }

// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

public class CChangeClanName extends __CChangeClanName__ {
	@Override
	protected void process() {
		final long roleid = gnet.link.Onlines.getInstance().findRoleid(this);
		if (roleid < 0 || newname == null)
			return;
		
		final int userid = ((gnet.link.Dispatch) this.getContext()).userid;
		
		int resultCode = fire.pb.util.CheckName.checkValid(newname);
		if (resultCode == fire.pb.util.CheckName.WORD_ILLEGALITY) {
			fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 142260, null);
			return;
		} else if (resultCode == fire.pb.util.CheckName.SPECIAL_WORD_TOO_MANY) {
			fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 142294, null);
			return;
		} else if (resultCode == fire.pb.util.CheckName.NONE_CHARACTER) {
			fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 146238, null);
			return;
		}

		if (!fire.pb.util.StringValidateUtil.checkIllegalWord(newname)) {
			fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 145025, null);
			return;
		}
		int chineseCnt = 0;
		int otherCnt = 0;
		for (int i = 0; i < newname.length(); i++) {
			// 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣洴钘濋柣銏㈩焾閺嬩線鏌熼崜褏甯涢柛瀣姍閺屾盯骞囬姘卞缂傚倸鍟ú鐔奉潖缂佹ɑ濯撮柛娑橈攻閸庢挸鈹戦悙鑼勾闁告柨绉归獮鍫ュΩ閿旂粯效闁硅壈鎻徊鍧楁倿閸忚偐绡�闁汇垽娼у瓭闂佺锕﹂弫璇差嚕閵婏妇顩烽悗锝庡亞閸樿棄鈹戦埥鍡楃仩闁圭⒈鍋嗛惀顏囶樄闁哄瞼鍠栧畷妤呮偂鎼粹槅娼氶梻浣告惈閺堫剛绮欓幘瀵割浄闁挎梻鍋撶�氭岸鏌熺紒妯轰刊婵炵厧閰ｅ缁樻媴閸涘﹥鍎撻梺鍝勭墱閸撴瑧鍙呴梺缁樻椤ユ捇寮抽敃鍌涚厽闁规儳纾畝鎼佹煛閿熻姤绂掔�ｎ偆鍘遍梺闈涱槹閸ㄧ數锟芥凹鍙冮、鏃堝Χ婢跺鎷洪梺鐓庮潟閸婃洟寮搁幋鐘电＜妞ゆ柨鍚嬪﹢鐗堛亜閵婏絽鍔︽鐐寸墬缁楃喖宕堕妸锔界彣闂傚倷绶氬褔藝椤愶箑鐤炬繛鎴炴皑閻棝鎮楅敐搴′簴濞存粍绮撻弻鐔兼倻濡櫣浠撮梺璺ㄥ枙濡嫰鈥﹂悜钘夌畾濞撴熬鎷风�规洖銈告俊鐑芥晜鐟欏嫬顏归梻鍌欑閹诧紕绮欓幋锔芥櫇闁靛绠戠欢鐐烘煕閺囥劌鐏￠柣鎾存礋閺岀喖鎮欓浣虹▏闂佸憡绻嗗▍锝夋晸閸婄噥娼愭繛鍙夊灴瀹曪繝骞庨挊澶嬬�梺鐟板⒔缁垶寮查幖浣圭叆闁绘洖鍊圭�氾拷
			String regexStr = fire.pb.util.CheckName.getRegexStr();
			if (newname.substring(i, i + 1).matches(regexStr)) {
				chineseCnt++;
			} else {
				otherCnt++;
			}
		}
		double total = chineseCnt + otherCnt / 2.0;
		int factionNameLen = 5;
		if (total < 2 || total > factionNameLen) {
			fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 145088, null);
			return;
		}
		
		new mkdb.Procedure() {
			@Override
			protected boolean process() throws Exception {
				
				if (!mkdb.util.UniqName.allocate("clan", newname)) {
					fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 142402, null);
					return false;
				}
				
				xbean.ClanInfo clanInfo = ClanUtils.getClanInfoById(roleid, false);
				if (clanInfo == null) {
					fire.pb.talk.MessageMgr.psendMsgNotify(roleid, 145077, null);
					return false;
				}
				//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣洴钘濋柣銏㈩焾閺嬩胶锟藉箍鍎遍ˇ顖滅矆鐎ｎ偁浜滈柟鍝勭Ф閸斿秵銇勯弬鎸庡枠婵﹦绮幏鍛喆閸曨偂鍝楅梻浣侯焾鐎涒晛顪冮挊澶屾殾婵犲﹤鍟犻弸搴ㄦ煙鐎涙绠ユ俊顐ｇ矒閹嘲顭ㄩ崨顓ф毉闁汇埄鍨遍〃濠囧箖閳ユ枼妲堟慨妯煎亾鐎氳顨ラ悙鑼虎闁告梹鑹捐灃闁绘娅曢崐鎰版煟濞戝崬娅嶇�殿喕绮欓、姗�鎮㈤崫鍕睄闂傚倷绀侀幉锟犲礉閿旂晫顩叉繝濠傜墕閸戠姵绻涢幋娆忕仾闁绘挻鐩幃姗�鎮欓幓鎺嗘寖濠电偛寮跺娆撳煘閹达附鏅柛鏇ㄥ亜楠炲姊烘潪鎵妽闁告梹鐟ラ悾鐑藉Ω閳哄﹥鏅ｉ悷婊冪箻閺佹捇鎮剧仦钘夊箣濠殿喖锕︾划顖炲箯閸涙潙浼犻柕澶樺灣缁�濠囨⒒娴ｄ警鏀版繛鍛礋楠炴劙宕滆閸ㄦ繈鏌￠崘銊у闁稿鍔庣槐鎺旓拷锝庡弾閸わ箓鏌ㄩ弴鐐诧拷褰掓偂閺囥垺鐓涢柛銉ｅ劚婵″ジ鏌ｈ箛鏇炐ョ紒杈ㄥ浮椤㈡洟濮�閳跺灕鍥ㄧ厸閻忕偛澧藉ú鏉戔攽閿涘嫬鍘存い銏＄懇瀹曪綁濡烽妸锔伙拷妤呮⒒閸屾瑨鍏岄柟铏尰閺呭爼鎮剧仦钘夌亰濡炪倖鐗滈崑鐐哄磻閸屾稓绠鹃柟瀛樼懃閻忣亪鏌ｉ幘瀛樼闁哄苯绉归獮姗�宕ㄩ纰变紦闂傚倷绀侀幖顐﹀箠韫囨洜鐭欓柟杈惧瘜閺佸鏌ㄥ┑鍡╂▓闁轰礁顑夐弻銊╂偄閸撲胶鐓撻悗娈垮枛椤兘寮澶婄妞ゅ繐鎳庢刊鎵磽閸屾瑧顦︽い鎴濇嚇閹ê鈹戠�ｎ亞鍘辨繝銏ｅ煐閸旀牠宕愰悽鍛婄厱妞ゎ厽鍨垫禍婵堢磼閼哥數鍙�闁诡喗顨呴～婵嬫偂鎼达紕顔掗梻浣烘嚀缁犲秹宕硅ぐ鎺戠厴闁瑰濯撮幏鐑芥晲鎼存繄鏁栭梺鎸庣♁缁矂鍩為幋锔藉�烽柡澶嬪灩娴犳悂姊洪懡銈呮珡闁搞劏娉涢悾鐑筋敍濠婃劖瀚归柨婵嗙凹缁ㄦ挳鏌￠敓鑺ョ鐎ｎ偆鍘藉┑鈽嗗灡濡炲潡宕箛娑欑厸闁糕剝顭囬惌宀�绱掓潏銊ョ瑲婵炵厧绻樻俊鎼佹晜缂併垺效闂佽姘﹂～澶娒哄锟藉畷褰掑锤濡ゅ啫绁﹀┑顔筋殣閹烽攱顨ラ悙鍙夊闁瑰嘲鎳橀幃鐑藉箥椤斿彨鎺戔攽閻樺灚鏆╅柛瀣洴椤㈡岸顢橀悢绋垮伎闂佸湱铏庨崳顕�寮崟顖涚厱婵炴垶鐟︾紞鎴︽煕閹寸姴孝闂囧鏌ㄥ┑鍡樻悙闁汇劍鍨块弻鐔割槹鎼粹�冲箣闂佺粯渚楅崳锝呯暦瑜版帩鏁婇柣鎾冲瘨濞兼稑鈹戦悩鍨毄闁稿濞�椤㈡艾顭ㄩ崨顓犵瓘婵炲濮撮鍛存偂濠靛枹褰掓偐瀹割喖鍓鹃梺杞扮閸婂潡寮诲☉銏╂晝闁靛牆鎳忛悘渚�姊洪崨濠勬噧闁哥噥鍋婇崺鐐哄箣閿曪拷閻擄繝鏌涢埄鍐炬畼濞寸姍鍥ㄧ厽闁绘瑥鎳忕�氬綊姊洪幐搴㈢┛闁归鍏樺畷鈩冩綇閳哄倸鏋戦梺缁橆殔閻楀棛绮鑸电厓闂佸灝顑呴悘锔剧磼缂佹娲寸�规洖宕灒闁告繂瀚闂佽瀛╅鏍闯椤曪拷瀹曟澘螖閸涱厾鐤勯梺闈涱煭婵″洨寮ч敓浠嬫⒑閸涘﹤濮�闁哄倸鍊圭粋鎺楀閵堝棗锟界敻鎮峰▎蹇擃仾濠㈣泛瀚伴弻娑氾拷锝庝悍瀹搞儵鏌ｉ敐鍥у幋闁诡喓鍨婚崰濠冩綇閵婏附鐝濋梻鍌欒兌缁垶宕归棃娴虫稑鈻庡顖涘浮瀹曟儼顦柡锟芥禒瀣叆婵炴垶锚椤忊晛霉濠婂啨鍋㈤柡灞剧♁缁绘稖顦查柟閿嬪灴楠炲繘鎮滈懞銉濠电偞鍨跺銊╁礉椤栫偞鍊甸悷娆忓缁�鍐╃節閵忊槄鑰块柨婵堝仜閳规垹锟斤絽鐏氶弲鐐烘⒑閸愬弶鎯堟い鎴濇川缁棃顢欑粵瀣啍闂佺粯鍔曞鍫曞窗濡眹浜滈柕蹇婃閼板潡鏌熼鐣岀煉鐎规洖宕灃濞撴艾娲ら弲顐︽⒒閸屾艾锟藉嘲霉閸ヮ剦鏁嬬憸蹇涙晸閼恒儳鈻撻柡鍛箘閸掓帒鈻庨幘宕囶唺闂佸搫娲ㄩ崑鐔虹矙婵犲洦鈷掗柛灞剧懆閸忓矂鏌熼搹顐ｅ磳鐎规洘鐓￠幊鐘活敆閸屾粠妲稿┑鐘垫暩婵挳宕戦崱妤婄劷闁哄秲鍔庣粻鍓э拷鐟板閸犳洜鑺遍懡銈囩＜闁跨喍绮欏畷濂稿Ψ閿旀儳骞樼紓浣哄亾濠㈡ê鐣烽浣规珷妞ゆ洩鎷烽柟顔荤矙椤㈡稑螣閸濆嫬袝婵犳鍠栭敃銉ヮ渻閽樺鏆︽い鎰剁畱鍞梺闈涱槹閸斞呯礊娓氾拷瀵鏁愰崨鍌涙⒐閹峰懘鎼归崷顓炲辅濠德板�楁慨鐑藉磻濞戞碍宕查柟鐑橆殕閺呮悂鏌￠崒妯猴拷妤冪矓閻㈠憡鐓曢柣妯虹－婢ц京绱掗纰辩吋闁诡喕绮欏畷銊︾節閸曨偄绠ラ梻浣藉吹閸犳劙鎮烽妷褝鎷峰顒�妲婚柍缁樻崌瀵噣宕掑鍜冪闯闁诲骸绠嶉崕閬嶅箯閹达妇鍙曟い鎺嶇贰濞堜粙鏌ｉ幇顓炵祷闁哄棴缍侀弻娑㈠煛鐎ｎ剛鐦堥悗瑙勬处娴滄繈骞忛崨顖涘枂闁告洦鍓涜ぐ鐔兼⒒閸屾艾锟界兘鎳楅崜浣稿灊妞ゆ牜鍋涚粻浼存煕濞戞﹩鐓繛鍫滅矙閺岀喖姊荤�靛摜鐡樼紓鍌氱У閻楃娀寮婚悢鍏煎�绘慨妤�妫欓悾鐑芥⒑閹惰姤鏁遍悽顖涘浮婵℃挳骞掗幋顓熷兊闂佺粯鍔﹂崜娆擃敂閸洘鈷掑ù锝堝Г绾爼鏌涢悩铏闁逛究鍔戞俊鍫曞炊閳哄啰鍘梻浣筋潐瀹曟﹢顢氳閹�愁潨閿熶粙寮婚悢鍏煎�绘慨妤�妫欓悾鐑芥⒑缂佹ɑ灏版繛鑼枛瀵鏁撻悩鑼槰闂佸湱顭堟鎼侇敂閸洘鈷掑ù锝堫潐閸嬬娀鏌涢弬鍧楀弰鐎殿噮鍋呯换婵嗩潩閵夘垱瀚瑰ù锝呭濞尖晠鏌ょ粙璺ㄤ粵婵炲懏绮嶇换婵嬪閿濆棛銆愬銈嗗灥濡鍩㈠澶婎潊闁靛牆妫岄幏娲煟閻樺厖鑸柛鏂胯嫰閳诲秹骞囬悧鍫㈠幍闂佸憡鍨崐鏍拷姘炬嫹?
				if (clanInfo.getClanmaster() != roleid) {
					fire.pb.talk.MessageMgr.psendMsgNotify(roleid, 150127, null);
					return false;
				}
				clanInfo.setOldclanname(clanInfo.getClanname());// 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊炲銈嗗笒椤︿即寮查鍫熷仭婵犲﹤鍟扮粻缁橆殽閻愭潙鐏村┑顕嗘嫹闂侀潧鐗嗛幊鎰版偪閿熻姤淇婇悙顏勶拷鏍涙担鑲濇盯宕熼浣稿妳婵犵數濮村ú锕傚煕閹寸姵鍠愰柣妤�鐗嗙粭鎺懨瑰锟介崡鎶藉蓟濞戞瑦鍎熼柕濠忛檮闁款參姊虹�圭姵顥夋い锔诲灥閻忔帒鈹戦悩璇у伐閻庢凹鍙冭棢闁割偒婢侀幏椋庢喆閸曨剛顦ㄩ梺鎸庢磸閸ㄤ粙濡存笟锟藉顕�宕煎┑鍡氾拷鍧楁⒑閸愬弶鎯堥柛濠冨姍閺佸啴宕掑☉鎺撳濠电偠鎻徊鍧楁偤閺冨牆鍚规繛鍡樻尰閻撴洟鏌熺�电校婵炲懏娲滅槐鎺撴綇閳轰椒妲愰悗瑙勬礀瀹曨剟鍩ユ径濞㈢喖鎳栭埡浣哄�為梻鍌氬�风粈渚�骞栭銈囩煓濞撴熬鎷风�规洘鍨垮畷鍗炩槈濞嗗繐澹掗梻浣虹《閸撴繄绮欓幒妤佸亗闁哄洨鍠嗘禍婊堟煙娴煎瓨娑уù婊勭箘缁辨帡鎳滈悽鍨垱闂佸搫鐬奸崰鎰八囬悧鍫熷劅闁炽儱鍟跨粻锝夋⒒娴ｈ櫣甯涘〒姘殜瀹曟娊鏁愰崨顖涙閻熸粎澧楃敮鈺呭极婵犲洦鐓熼柟鎯у暱閻︺劍绻涢崗鑲╂创婵﹤顭峰畷鎺戔枎閹烘垵甯梻浣侯攰濞呮洟骞戦崶褏鏆︽い鏍仜閸ㄥ倹銇勯弴鐐村櫤闁稿秶鏁诲娲箰鎼淬垻顦ラ梺绋匡工閹诧繝銆佹繝鍥ㄢ拻濞达絽鎲＄拹鈥愁熆瑜庨〃鍛粹�﹂崹顕呮建闁跨喍绮欓幃浼搭敋閿熻姤鎱ㄩ敓浠嬫煃閵夈劌鐨虹紒鐘冲哺濮婅櫣绱掑Ο鍝勵潓闂佸鏉垮缂侇喖鐗撻弫鎾绘偩瀹�锟界壕浠嬫煕鐏炵偓鐨戠�涙繈姊洪幐搴㈢８闁稿﹥绻堥獮鍐箚瑜忛弳瀣煙闁垮鈷愭俊顐㈠暙閻ｇ兘濡搁埡濠冩櫓闂佺绻楅崑鎰板级娴犲鈷掗柛灞剧懅椤︼箓鏌熺喊鍗炰喊閽樻繂霉閸忓吋鍎楅柡浣稿缁绘盯宕卞Δ鍐勘濠电偞鍨崹娲磻閸曨垱鐓曢煫鍥ㄦ尵濮ｇ偤鏌熸搴ｅ笡缂佺粯绋掑蹇涘礈瑜庨崑褔姊洪悜鈺佸⒉婵☆偄鍟悾鐑芥偨缁嬭法顦ㄥ銈嗘⒒閺咁偊宕㈤柆宥嗏拺缂備焦銆為幋锕�绀堟慨姗嗗厴閺嬫棃鏌￠崘銊у闁稿鍊块弻鏇㈠醇濠靛浂妫ょ紓浣叉閹峰嘲鈹戦悩鍨毄濠殿喗鎸冲畷鎰亹閹烘垿妫烽悷婊呭鐢鎮￠弴銏＄厪濠电姴绻愰々顒傜磼閻橀潧浠遍柡灞革拷宕囨殕閻庯綆鍓涢惁鍫ユ倵鐟欏嫭绀冮柨鏇樺灪娣囧﹤顫㈠畝濠冃╂俊鐐�х紞锟芥繛鍜冪悼濡叉劙骞樼�涙ê顎撻梺鍛婄箓鐎氱兘鏁撻挊澶岀劯闁哄本鐩俊鎼佹晝閿熶粙鍩㈤弴銏＄厸濞达綀顫夊畷宀勬煙椤旂厧鈷斿ù鐙呭缁辨帡锝為鐔风厱闂傚倸鍊烽懗鍫曞箠閹捐搴婇柡灞诲劚鎼村﹪鏌＄仦璇插姎闁绘挻锕㈤弻鐔告綇妤ｅ啯顎嶉梺绋款儐閸旀瑩寮婚悢铏圭＜婵☆垱妞介崵瀣⒑瑜版帩妫戦柛蹇旓耿楠炲啴鎮滈挊澶岊吋闂佹儳娴氶崑鍡涙晸閽樺鎯堥柍瑙勫灦楠炲﹪鏌涙繝鍐╃鐎规洦鍨堕獮宥夘敊绾拌鲸顥″┑鐐差嚟婵挳顢栭崱娑欏亗闁哄洢鍨洪崐鍫曟煟閹邦厽缍戠紒锟介崘顭戠唵閻熸瑥瀚搁懓鍧楁煛鐏炶濮傞柟顔哄灮閹风姴鈻撶�ｎ偅宕岄柡宀�鍠栭、娆撴偂鎼搭垱瀚归柟闂寸劍閸嬧晠鏌ｉ幋锝嗩棄缂佺嫏鍕闁糕剝鐟ユ禍楣冩煕瀹ュ洦鏆柡宀嬬秮閹晠鎳￠妶鍥╃崶婵犵數鍋涢幏鎴犵礊娓氾拷楠炲啯瀵奸弶鎳炽劑鏌嶉崫鍕拷鐢稿箯濞差亝鈷戦柛娑橈功缁犳捇鎮楀鐓庢珝闁糕斂鍨哄鍕箛椤撶姴骞堟繝纰樻閸ㄨ鲸绂嶆禒瀣；闁靛浚婢侀幏宄扳枔閸喗鐏嗛梺鍛婎殙濞呮洘绌辨繝鍥ㄥ仾妞ゆ牭绲鹃澶愭⒒娴ｅ摜绉烘い銉︽崌瀹曟顫滈敓浠嬬嵁閸℃稑纾奸柣鎰絻缁愭稒绻濋悽闈浶㈤柛瀣鐎靛ジ骞樼紒妯锋嫽闂佺鏈悷褔藝閿曞倹鐓欐繛鏉戭儜閹烽鎼炬担瑙勩仢闁轰礁鍟村畷鎺戭潩閹插骞㈤梻鍌欑閹测�趁洪敃鍌氱；闁糕剝绋戝Ч鏌ユ煏閸繍妲归柣鎾存礋閺屽秹鍩℃担鍛婃闂佸啿褰炵欢姘跺蓟瀹ュ鐓ラ悗锝庝簽娴煎矂姊洪崫鍕拱缂佸鍨块崺銉﹀緞婵犲孩寤洪梺鍓插亞閸犳劙寮虫导瀛樷拺閻犲洦鐓￠妤呮煟韫囨柨鍝洪柟顔惧厴閸╋繝宕ㄩ鈩冩啺婵犵數鍋為崹顖炲垂瑜版帒纭�闁规儼濮ら悡蹇撯攽閻愯尙浠㈤柛鏃�纰嶉妵鍕敃椤愶紕鐩庡銈庝簻閸熷瓨淇婇崼鏇炲耿婵☆垵娅ｉ。鑼磽閸屾艾锟藉摜绮旈幘顔芥櫇闁靛牆顧�缂嶆牠鐓崶銊︾缁炬儳鍚嬫穱濠囶敍濠垫劕娈銈呭閹瑰洤顫忓ú顏勫窛濠电姴瀚уΣ鍫ユ⒑閹稿孩纾搁柛濠冪箓椤曪綁骞庨挊澶愬敹闂侀潧顧�閼靛綊骞忓ú顏呪拺闁稿繗鍋愰妶鎾煛閸涱喚鐭掔�规洜鏁婚弫鎾绘嚍閵壯呯槇闂佸啿鍤栭幏鐑芥煕濞戝崬鏋熼柣婵愪邯濮婃椽宕ㄦ繝鍌滅懖闁汇埄鍨敓鑺ュ墯閸ゆ洘銇勯弴顏呭閻庤娲滈崢褔鍩為幋锕�閱囨い鎰╁灪閺嗐儵姊婚崒姘拷椋庣矆娓氾拷瀹曘儳锟斤綆鍋嗛々鎻捗归悩宸剰缁炬儳娼￠弻娑樜旈崘銊ゆ睏闂佸搫顑嗗褰掑箞閵娿儙鏃傦拷锝庡亜椤忚埖绻濆▓鍨灈闁挎洏鍔岄埢宥夋晲婢跺﹦顔夐梺鍛婃处閸ㄧ増鍎梻渚�娼ч¨锟藉┑鈥虫穿閵囨劕顫濋懜纰樻嫽婵炶揪绲块崕銈夊吹閿熶粙姊洪幖鐐诧拷鏍偋閻樿崵宓侀煫鍥ㄧ♁閺呮悂鏌ㄩ悤鍌涘
				clanInfo.setClanname(newname);
				
				int costHearthStone = fire.pb.clan.srv.ClanAuthManager.getInstance().getChangeClanNameCostHearthStone();
				
				if (!fire.pb.fushi.FushiManager.subFushiFromUser(userid, 
						roleid, costHearthStone, 0, 0,
						fire.pb.fushi.FushiConst.REASON_SUB_CHANGEFACTIONNAME,
						YYLoggerTuJingEnum.tujing_Value_gonghuigaiming,true
						)) {
					return false;
				}
				
				for (java.util.Map.Entry<Long, xbean.ClanMemberInfo> entry : clanInfo.getMembers().entrySet()) {
					mkdb.Procedure.pexecuteWhileCommit(ClanUtils.addClanTitleByPositionProc(entry.getKey(), clanInfo.getClanname(), entry.getValue().getClanposition()));
				}
				
				mkdb.Procedure.psendWhileCommit(roleid, new SChangeClanName(newname));
				fire.pb.talk.MessageMgr.psendMsgNotifyWhileCommit(roleid, 160068, null);
				
				//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴椤㈡洟鏁愰崱娆欑穿闂備浇娉曢崰鎰板几閼姐倗涓嶉柟鎯х－閺嗭箓鏌ｉ幘鍐茬槰闁绘柨妫欑换婵嬫濞戞艾顤�闂佹悶鍊ч幏閿嬩繆閻愵亜锟姐倝宕戦崨顖涘床闁告洦鍨扮粻鏌ユ煕閺囥劌鐏￠柟顖滃仱閹綊宕堕敐鍛拤閻炴皜鍕瘈闁汇垽娼у暩闂佽桨鐒﹂幃鍌氱暦閹达附鍊烽柛婵嗗閻庮參姊洪崨濠冨矮缂侊拷娓氾拷瀵悂宕奸～顔藉妤犵偛鐏濋崝姘亜瑜濋幏椋庣磽閸屾氨校闁绘濞�瀵鏁撻悩鑼�為梺闈涱槶閸庤櫕绂掓ィ鍐┾拺缂備焦蓱鐏忕敻鏌涢悩鍐插缂佸矁椴哥换婵嬪炊椤儸鍥╁彄闁搞儯鍔嶉悡銉︺亜韫囨挾鍩ｆ慨濠勭帛閹峰懘鎼归悷鎵偧婵＄偑鍊戦崝宀勬偋閹惧磭鏆﹂柟杈鹃檮閸嬪嫰鏌ら懠顒�鐨戠紓宥勭窔閻涱噣宕堕浣镐罕闂佸壊鍋嗛崰鎰版偟閸愭祴鏀介柣姗嗗枛閻忚鲸绻涙径瀣创妞ゃ垺鐗犲畷鍫曨敆閿熶粙宕掗妸鈺傜厽闁靛繒濮甸崯鐐烘煟閹惧鈽夋い顓℃硶閹瑰嫰鎮弶鎴濐潬濠电姭鎷冮崟顒傤槬濡炪値鍙�閸庡藝閹绢喗鐓涢柛婊�绀佹禍婊堝础闁秵鐓欓柣妤�鐗婄欢鑼磼閻欐瑥瀚粻楣冩煕閳╁喚娈旈柍閿嬫閺屾盯鎮欓崹顐ｆ瘓闂佸搫鐭夌紞渚�骞冮姀銈呬紶闁靛绠戝▍鎴︽⒑鐠囨彃顒㈤柛鎴濈秺瀹曘垽宕滆閸ㄦ繈鏌涢顐ｇ窙闁归鍏橀弫鎰償閳╁啰浜堕梻浣虹帛閹稿鎯勯鐐茬畺婵鎷烽柟顔界懇楠炴捇骞掗崱妯虹槺闂傚倷绀侀悿鍥涢崟顖�鍥偨缁嬭儻鎽曢悗骞垮劚濞诧妇锟芥碍宀搁弻锛勪沪鐠囨彃濮庨悗娈垮枟濠㈡鐏冮梺缁橈耿濞佳勭濠婂嫮绠剧�瑰壊鍠栧顕�鏌曢崱鏇狀槮閾绘牠鏌涘☉鍗炲箻闁挎稒绮岄埞鎴︽倷閸欏妫￠梺鎼炲妼缂嶅﹨妫熼梺璺ㄥ櫐閹凤拷?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝呂熷▎鎯ф缂備胶濮撮悘姘跺Φ閸曨喚鐤�闁圭偓鎯屽Λ鐐电磽娴ｇ晫鍫柛濠冪箞瀵鏁冮敓鍊熺亽婵炴挻鍑归崹閬嶎敁閸℃稒鈷戦柛蹇撳悑缁跺弶绻涚涵椋庣瘈鐎殿喛顕ч埥澶娢熷鍕棃鐎规洘锕㈡俊鎼佸Χ閸℃顎忔繝鐢靛У椤旀牠宕抽婊冪筏闁伙絽鐭夐幏宄邦潩椤撶喓鍑″銈庡亜缁绘垹鎹㈠┑鍡╂僵妞ゆ帒鍋婄槐鍙夌節閻㈤潧浠滄俊顐ｇ懅閺侇噣骞掑Δ锟介崒銊╂煃閵夛附鐏遍柡锟芥禒瀣厽闁归偊鍓欑痪褔鏌涢敐鍥у幋闁哄本鐩俊鎼佸Χ閸モ晝鍘梻浣虹帛娓氭宕板☉姘变笉婵炴垶菤濡插牊绻涢崱妯哄妞ゅ繒鍠栧缁樻媴閼恒儳銆婇梺闈╃秶缁犳捇鐛箛娑欐櫢闁跨噦鎷�?
				MessageMgr.psendMsgNotifyWhileCommit(clanInfo.getMembers().keySet(), 160396, 0,Arrays.asList(newname));
				//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牆濮涚紓浣哄█缁犳牠寮婚妸鈺傚亜閻犲洦鐣幘鍓佺＜缂備焦顭囬埦渚�鏌熷畡鐗堝殗鐎规洘锕㈠畷锝嗗緞鐎ｎ偄锟介绱撴担鍝勪壕闁稿骸纾槐鐐寸節閸パ嗘憰闂佹寧娲╅幏鐑芥懚閿濆鐓熸慨姗嗗墻閸ょ喓绱掗敓浠嬪幢濡炵粯鏂�闂佺粯鍔栧娆撴倶閻斿吋鐓曢柕濞垮劜鐠愶紕绱掗鑲╁ⅱ闁跨喐鏋荤紞鍡涘磻娴ｅ湱顩叉繝濠傜墛閻撴瑥霉閻撳海鎽犳繛鎳峰厾鐟邦煥閸曨厾鐓佺紓浣虹帛閻╊垰鐣烽悡搴樻婵☆垯璀﹀搴㈢節濞堝灝鏋涢柨鏇樺劚椤啴鎸婃径灞炬闂侀潧顭俊鍥╁姬閿熶粙姊洪崨濠冪８闁告柨绉归敐鐐差吋閸℃洜绠氶梺缁樺姦娴滄粓鏁撴慨鎰拷婵嗙暦閿濆棙鍎熼柕濞垮劚閸嬪秹姊虹拠鈥崇伇闁诲繑鐩弫鎰緞婵犲嫮鏉搁梻浣虹帛椤ㄥ懘鎮ф繝鍌楁瀺婵犲﹤瀚弧锟介梺闈涢獜缁插墽娑甸悙顑句簻闁瑰瓨绻冮崰妯硷拷瑙勬磸閸ㄤ粙骞冩禒瀣窛濠电姴瀚獮鎰攽閻橆喖鐏辨繛澶嬬洴閺佸啴鏁傞懞銉︾彿闂佸搫娲ㄩ崕鎰版偄閸℃瑦鍠愰煫鍥ㄧ☉閻ょ偓銇勯幇銊﹀殥闁挎繂顦粻娑㈡煛婢跺孩纭跺Δ鐘叉搐閳规垿鎮欓崣澶樻婵犫拃鍌滅煓鐎规洦鍓熼幃浠嬪川婵犲嫬骞楅梻浣虹帛閺屻劑骞楀鍫濈疇闁告劦鍠楅崐鍨叏濡厧甯舵鐐搭焽缁辨帡顢欓懖鈺佲叡闂佽法鍠愰弸鑽ょ礊閸℃稑绐楁俊銈呮噺閸嬪倹绻涢幋鐐靛暡闁归鍏橀幆鍌炲川婵犲偆浼撻梻鍌欐祰濞夋洟宕板鍥у灊婵炲棗绻掗弳锕�霉閸忓吋缍戠紒鐘差煼閺屻倝宕ㄦ繝搴℃櫛濠电偠鍋愰崰鏍ь潖濞差亜鎹舵い鎾跺仜婵℃椽姊洪幖鐐诧拷褏绮婚幘璇茬畺闁靛繈鍊栭崑鍌炲箹鐎涙绠橀柣鎰躬濮婄粯鎷呴崨濠傛殘濠电偛寮堕悧鐘诲箖濡警娼╅弶鍫氭櫇椤︻垶鎮楅獮鍨姎妞わ缚鍗抽崺娑㈠箳濡や胶鍘遍柣蹇曞仜婢т粙骞婇崨顖滅＜闁归偊鍘介埛鎰磼缂佹鈾侀柟宄版嚇瀹曟﹢骞撻幒鎴狀啋闁荤喐绮庢晶妤冩暜閹烘梻鐭嗛悗锝庡亖娴滄粓鏌″鍐ㄥ闁汇劍鍨堕妵鍕棘閹稿寒妫﹀┑顔硷龚濞咃綁骞戦崟顖毼╅柕澶涘瑜版岸姊绘担鐑樺殌闁搞倖鐗犻獮蹇涙晸閿燂拷
				MessageMgr.psendSystemMessageToRoles(clanInfo.getMembers().keySet(), 160396, Arrays.asList(newname));
				
				fire.pb.clan.srv.ClanManage.logger.info("闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴楠炴﹢鎳犻澶嬓滈梻浣规偠閸斿秶鎹㈤崘顔嘉﹂柛鏇ㄥ灠閸愶拷闂侀潧臎娓氬﹥瀚归柟鐑橆殕閻撶喐绻濋棃娑欘棤闁糕晪缍侀弻鈥崇暆鐎ｎ剛鐦堥悗瑙勬礀閻栧吋淇婇悜钘壩ㄧ憸宀勫箖閿濆鈷掑ù锝呮贡濠�浠嬫煕婵犲喚娈滅�规洘鍨块獮姗�鎳滈棃娑樼哎婵犵數鍋為崹顖炲垂閸︻厾涓嶉柨婵嗘缁犻箖鏌涢埄鍐炬畼缂佺姵濞婇弻娑㈠籍閿熶粙骞愰崘宸綎闁绘垶蓱婵粓鏌熷▓鍨珮婵″樊鍣ｅ娲箰鎼淬垻鈹涚紓浣哄У閹瑰洤顕ｉ锕�绠荤紓浣姑惂鍕節閵忥絾纭鹃柣顒�銈稿鍐测槈閵忊檧鎷虹紓浣割儏濞硷繝顢撳Δ鍐挎嫹鐟欏嫭澶勯柛鎾寸洴瀹曪綁宕ㄧ�涙ǚ鎷洪梺鍦焾鐎涒晝绮堥敓浠嬫⒑缁嬪尅宸ラ柟鑺ョ矌閸掓帡鏁愰崨鍌涙瀹曘劑顢欓幆褍绠為梻鍌欑劍閺嬪ジ寮插☉銏犵柈濞村吋娼欓悡銏犮�掑鐐闂佸搫鐭夌紞渚�鐛Ο纭锋嫹闂堟稒鍟為柛锝勫嵆濮婃椽宕崟顓犲姽缂傚倸绉崇欢姘舵偘椤旀拝鎷烽敐搴℃灍闁稿﹦鍏橀弻娑㈠焺閸忕媭浜幃姗�鍩￠崘顏嗭紲濡炪倖妫侀崑鎰櫠閿曞倹鐓涘ù锝堫潐瀹曞矂鏌熺粙鍖℃敾鐎垫澘瀚灒閻犲洩灏欏Σ锝夋⒒閸屾瑧绐旀繛浣冲洦鍋嬮柛鈩冪☉閻ゎ喗銇勯幇鍓佺暠缂侊拷婢跺鍙忔俊顖氱仢閻撴劙鏌ｉ幘瀵告噭闁靛洤瀚板鎾倷閺夋垶顏￠梻浣虹帛鐢亪骞忛敓锟� "+roleid+"\t婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鐐劤濞硷繝寮婚悢鐚存嫹閻㈡鐒剧�涙繄绱撴担鐣屽牚闁稿﹥绻堝濠氭晝閿熷�熺亽婵炴挻鍑归崹閬嶆晬閸℃稒鍋℃繝濠傛噹椤ｅジ鎮介娑樼濠㈣娲樼缓浠嬪川婵犲嫬骞楅梻浣哥秺閸嬪﹪宕规导瀛樺剭婵炲樊浜濋悡鐔哥箾閹寸偟澧柛鏃�宀搁弻宥囨喆閸曨偆浠稿Δ鐘靛仜閿曨亪寮诲☉娆戠瘈闁告劏鏅濋ˇ鏉课旈悩闈涗粶闁挎洏鍎甸獮鍡涘籍閸惊鈺呮煏婢跺牆鍔氭繛鍫涘�曢埞鎴︽倷閼搁潧娑х紓浣藉蔼濞夋洖鈽夐悽绋块唶闁哄洨鍋熼崫妤佺箾鐎电孝妞ゆ垵妫濋幃锟犲即閵忊�筹拷鍫曟煟閹邦厼绲婚柍閿嬫閺岋綁顢樺鍐挎嫹濠靛钃熼柨婵嗩槸缁犳娊鏌熺�涙濡囬柟绋垮暟缁辨挻鎷呮禒瀣懙闁汇埄鍨界换婵嗩嚕椤愶箑绠婚悗闈涘濞村嫰鏌ｆ惔顖滅У濞存粎鍋ら弫宥咁煥閸愶絾鏂�闂佺粯鍔栧娆撴倶閿曞倹鐓熸俊銈勭劍閳锋帡鏌ゆウ鍧楀摵缂佺粯绻傞～婵嬵敇濞戞瑥顏圭紓鍌欒兌閾忓酣宕㈡總绋跨疇闊洦鍝庢禍鍦喐韫囨洘顫曢柟鐑橆殔缁犵敻鏌熼悜妯虹亶闁圭鍟埞鎴︽倷閺夋垹浠奸梺杞版祰椤曆囨偩瀹勯偊鐓ラ柛鏇ㄥ墮椤庢捇姊洪幆褏绠虫繛鍛灮濡叉劙寮婚妷锔规嫽婵炶揪绲介幗婊呯矓濞差亝鐓曢悗锝庝悍闊剛锟借娲╃徊楣冨箚閺冨牆鐓㈤柨鐔剁矙瀵悂寮敓鐣屾崲濠靛洨绡�闁稿本绮岄·锟介梻浣虹帛閹稿鎯勯鐐茬畺婵鎷烽柟顔界懇楠炴捇骞掗崱妯虹槺闂傚倷绀侀悿鍥涢崟顖�鍥ㄥ閺夋嚦锕傛煕閺囥劌鐏遍柡浣稿暣閺屻劌鈹戦崱妯虹獩闂佹眹鍊曠�氼剟鈥旈崘顔嘉ч柛鎰╁妿娴犳儳顪冮妶鍐ㄥ闁挎洏鍊濋幃楣冩倻閽樺顔婂┑掳鍊ч幏椋庣棯閹冩倯濞ｅ洤锕、娑橆煥閸愵亝顓婚梻浣烘嚀閸㈡煡宕查懠鍓佷簷闂備礁鎲℃笟妤呭储妤ｅ啯鍋╅柛婵嗗濞撳鏌曢崼婵囶棡缂佸苯娼￠弻鐔风暋閺夋寧些闂佸疇顫夐崹鍧楀春閸曨垰绀冮柍杞扮筏閹风兘骞囬悧鍫㈠幈闂佸啿鎼鍥╁姬閿熶粙鎮楃憴鍕閻㈩垱甯￠垾锕傚Ω閳轰胶顦ㄩ梺闈涱煭缁犳帞娆㈤姀鐘斀闁绘ê鐏氶弳鈺佲攽椤旀儳鍘寸�殿噮鍋婇獮鏍ㄦ媴閸濄儻绱遍梻浣虹帛閸旀洟骞栭锕�鍨傞柛宀�鍋為悡娆愩亜閺嶃劎鐭婃い锝呫偢閺岀喖宕橀崣澶嬫嫳缂備胶绮换鍫ュ箖娴犲顥堟繛鎴炲敾閹风兘骞樼紒妯煎幍婵＄偛顑呮鎼佸储閹绢喗鐓涚�癸拷閿熶粙宕版惔銊ョ厺闁规崘顕ч崹鍌涖亜閺冨倹娅曞ù婊冨⒔缁辨挻鎷呴悷鏉垮Б婵犫拃鍌滅煓鐎规洏鍨奸ˇ褰掓煃閵夘垰顩柟鐟板婵℃悂鏁冮敓鐣屽椤栨稐绻嗛柕鍫濈箳閻ｉ亶鏌ｈ箛鏃傜疄妞ゃ垺妫冮、姗�濮�閳撅拷閹锋椽姊洪崨濠勨槈妞ゎ叏鎷烽梺纭呮彧缁犳垹绮绘导瀛樼厵闁诡垳澧楅ˉ澶愭煢閸愵亜鏋涢柡宀嬬秮瀵剟宕归钘夛拷顖炴⒑鐠団�崇仯闁稿鍋ゆ俊鐢稿礋椤栨氨鐤�闂佸憡鎸风粈渚�宕哄畝锟界槐鎺楁倷椤掍胶鍑＄紓浣割槸缂嶅﹤顕ｉ弰蹇ｆЬ缂備浇椴哥敮鎺曠亽闂佺粯鎸哥花鍫曞箯娴煎瓨鈷掑ù锝呮啞閹牓鏌￠崼顐㈠⒋闁诡垰瀚伴、娑㈡倷闂堟稓銈﹂梻浣规偠閸庢椽宕滈敃鍌氭瀬闁搞儺鍓氶悡鐔兼煙闁箑骞栫紒鑼跺吹閹喖顫滈敓钘夘潖婵犳艾纾兼繛鍡樺焾濡差噣姊虹涵鍜佸殝缂佺粯绻堥悰顕�骞囬弶鍧楀敹闂佸搫娲ㄩ崑鐔妓囬锟藉娲偡閹殿喗鎲肩紓浣筋嚙缁夋挳鈥﹂崶顒�鍐�妞ゆ挾鍠撻崢浠嬫⒑閻熼偊鍤熷ù鍏肩箞椤㈡棃宕奸锝嗘珨闂佸搫顦悧鍕礉鎼达絿涓嶅Δ锝呭暞閻撴洟鏌嶉埡浣稿箻妞ゅ繐鎳忛崣蹇涙煕閵夛絽濡稿ù婊勭矒閻擃偊宕堕妷銉ュ闁诲孩鐔幏锟�? "+costHearthStone);
				
				for (long members : clanInfo.getMembers().keySet())
				{
					mkdb.Procedure.pexecuteWhileCommit(new PRoleZongheRankProc(members));
				}
				
				mkdb.Procedure.pexecuteWhileCommit(new fire.pb.ranklist.proc.PFactionZongHeProc(clanInfo.getKey(), false));
				mkdb.Procedure.pexecuteWhileCommit(new fire.pb.clan.srv.PClanUpdateChangeName(clanInfo.getKey(), newname));	
				mkdb.Procedure.pexecuteWhileCommit(new fire.pb.clan.fight.PClanFightUpdateChangeName(clanInfo.getKey(), clanInfo.getClanname()));					
				
				String mastername = new PropRole(roleid, true).getName();
				//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘劙婀侀梺绋跨箰閸氬绱為幋锔界厱闁靛鍎遍敓钘夋健瀵鏁愭径濠勵啋閻庤娲栧ú銈夊传濞差亝鈷戦柛婵嗗閸庢劙鏌ｅΔ渚囨畼闁瑰箍鍨归埥澶愬閻樻鍚呴梻浣虹帛閸旀瑥顭囪瀵娊鏁撻悩鏂ユ嫼闂佽崵鍠愬妯何ｆ繝姘厱闁靛骏绱曢崣锟介梺鎸庣箘閸嬫盯鍩為幋鐙呮嫹閿濆骸浜滃ù婊勵殜閺岀喖宕楅懖鈺傛闂佹悶鍔嶅Σ鎺楀Φ閹邦厽鍎熸い顐幘缁犳岸姊洪棃娑氬婵炲眰鍊曢弳鈺呮⒒娴ｄ警鐒炬い鎴濇閹嫰顢涘杈ㄦ濡炪倖鐗滈崕鎰板极瀹ュ棛绡�濠电姴鍊搁鈺呭箹閺夋埊宸ラ柍瑙勫灴閹晝绱掑Ο濠氭暘婵＄偑鍊栭崹鐢稿箠閹邦喖鍨濋柛顐緛閹风兘鏁愭惔鈥茬按婵炲瓨绮嶇划鎾诲蓟閻旂厧浼犻柛鏇ㄥ帨閵堝鐓曢柡鍌濇硶鏍￠梺闈涙搐鐎氭澘顕ｉ鍕閹肩补妲呭Σ鍗炩攽閻戝洨鍒版繛灞傚�濋弫鍐敂閸繄鐣哄┑鐐叉閹尖晠寮崒鐐寸厱闁哄洠锟藉磭鍘柣搴㈣壘缂嶅﹪寮婚垾鎰佸悑閹艰揪绲肩划璺衡攽閻愭潙鐏﹂柣鐕傞檮閸掑﹪骞橀钘変画濠电偛妫楃换鎰邦敂閳哄喛鎷峰▓鍨灈婵炲皷锟芥剚娼栨繛宸簼椤ュ牊绻涢幋鐐跺妞わ絽鎼—鍐Χ韫囨洜绐楅梺鍛婎殔閸熷潡鎮鹃悜钘夌疀妞ゆ挾濮烽惁鍫濃攽椤旀枻渚涢柛姗�绠栧畷锝夊幢濞戞瑢鎷洪梺鍛婄箓鐎氼厾绮婇埡浼辩懓顭ㄩ崟顓犵暭闂佽法鍠曟慨銈夋嚌閸撗呯濠电姴鍋嗗鏍р攽閻樺疇澹橀柣鎰功閹茬顭ㄩ崗鎾呯秮瀹曠兘顢橀悩纰夌床缂傚倸鍊烽悞锕傗�﹂崶鈺冧笉闁哄稁鍋嗙壕鑲╃磽娴ｈ鐒界紒鐘靛仧閿熷�燁潐濞叉鏁幒妤嬬稏婵犻潧顑愰弫鍥煟濡搫鑸规い銉﹀哺濮婂宕掑顒婃嫹閻戣姤鍤勯柛顐ｆ磵閿熸枻绠撳畷濂告偆娴ｈ鍟嶉梻浣告啞缁哄潡宕曟繝姘鐎瑰嫭澹嬪Σ鍫ユ煙閻戞ɑ灏伴柣婵囩墵濮婃椽鎮烽幍顔炬殯闂佹悶鍔岀紞濠囧春閵夛箑绶為柟閭﹀墻濞煎﹪姊虹紒姗嗙劸閻忓浚浜弫鎾绘寠婢跺奔铏庡銈庝簻閸熷瓨淇婇崼鏇炲耿婵☆垳鍎ゅ▓顐︽⒒娴ｅ憡鎲稿┑顔芥尦閺屽﹪鏁愭径鍫嫹娓氾拷瀵噣宕奸悢鍛婎仧闂備浇娉曢崳锕傚箯閿燂拷
				ClanManage.addDealClanEventInfo(clanInfo,ClanManage.EVENT_CHANGE_NAME,roleid,mastername,newname,"");
								
				//闂傚倸鍊搁崐鎼佸磹閹间礁纾圭�瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟偡濠婂啰效闁挎繄鍋涢埞鎴狅拷锝庡亝濞呭洭姊虹粙璺ㄧ効濠碘�虫川缁瑨绠涢弮鍌滅槇闂侀潧楠忕徊浠嬫偂閹扮増鐓曢柡鍐挎嫹婵炲弶绮庨崚鎺撶節濮橆剙鍞ㄥ銈嗘尵閸犳捇宕㈤崡鐑嗘富闁靛牆妫楁慨褏绱掗幓鎺戔挃缂侇喖鐗撻弫鎾绘偩瀹�锟界壕濂告煟閹伴潧澧柛鏂诲�栫换娑氭兜妞嬪海鐦堥悗娈垮枛椤兘骞冮姀顫剨濞达絽婀辨禍鏍⒒娴ｇ顥忛柣鎾崇墦瀹曟澘螖閸涱喖锟藉墎锟藉箍鍎遍幏瀣�掓繝姘厪闁割偅绻堥妤�霉濠婂嫮绠栫紒缁樼洴閹崇娀顢楅敓浠嬪几濞戞熬鎷峰▓鍨灈妞ゎ厾鍏橀獮鍐椤厾鍓ㄦ繛杈剧到濠�杈ㄧ閺嶎厽鈷掑ù锝囶焾椤ュ繘鏌ｉ幘宕囧ⅵ鐎规洘婢樿灃闁告侗鍠栭敓钘夌埣閺岀喖宕滆鐢盯鏌嶉柨瀣伌闁哄本绋戦埥澶婎潨閸℃瑥褰嗘繝鐢靛仜閻楀﹤煤濠婂牊鏅搁柣锝呮湰椤忕喖鏌熸搴″幋闁哄瞼鍠栧鑽わ拷闈涘濡差噣姊洪挊澶婃殶闁哥姵鐗犲濠氬Ω閵夈垺鏂�闂佺硶妾ч弲婊呯懅缂傚倸鍊烽懗鑸垫叏閻㈠憡鍎庢い鏍仜閽冪喖鏌曢崼婵愭Ц缂佺姷鎳撻湁闁挎繂鐗滃鎰版⒑濞嗘儳骞栨い顏勫暣婵″爼宕ㄧ�电妞介梻浣烘嚀閸ゆ牠骞忛敓锟�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌ｉ幋锝呅撻柛銈呭閺屾盯骞橀懠顒夋М闂佹悶鍔嶇换鍐Φ閸曨垰鍐�妞ゆ劦婢�缁爼姊洪挊澶婃殶闁哥姵鐗犲濠氬即閻旇櫣鐦堥棅顐㈡处閹尖晛煤椤撱垺鈷戠紓浣诡焽缁犳碍绻涙径瀣创闁糕晝鍋ら獮瀣晜閽樺姹楅梻浣告贡缁垳鏁鍫濈闁绘垼妫勯柋鍥煛閸モ晛鏋戞繛鍛灲濮婃椽宕楅梻纾嬪焻闂佺楠稿畷顒勬箒濡炪倖娲╅幏鐑芥煛瀹�锟介崰鏍�佸▎鎾村仼鐎癸拷閿熶粙鎮℃径鎰拺闁荤喐澹嗛敍宥夋煕鐎ｃ劌锟芥牗绌辨繝鍥ㄥ仾妞ゆ牭绲句簺濠德板�楁慨鐑藉磻濞戙垺鍋嬮柟鐐墯濞兼牜绱撴担鑲℃垶鍒婇幘顔界厱婵炴垶锕Λ姘辩棯椤撱劍瀚归梻鍌氬�烽懗鍫曗�﹂崼銏ｅС婵炲樊浜滅壕瑙勭節闂堟稒锛嶉柛銈嗘礀閳规垿鎮╃�圭姴顥濋柟顖滃枛濮婅櫣锟藉湱濮甸妴鍐煠閸愯尙鍩ｇ�规洏鍨圭叅妞ゅ繐鎳夐幏娲⒑閸涘﹥灏扮憸鏉垮暞缁傚秹鎮欓悜妯煎幈闂佺粯顭堝▍鏇犱焊閻㈢數纾兼い鏂垮⒔鐢盯鏌曢崼顒傜М鐎规洘锕㈤崺锟犲礃閵娿儳鐤勬繝鐢靛Х閺佸憡鎱ㄩ幘顔芥櫇闁靛牆顦悿顔姐亜閹板墎鐣辨慨瑙勭叀閺岋綁骞囬鐓庡闂佺锕ら悘姘跺箞閵娿儙鐔兼偂鎼存繂顥氶梺璇插閻旑剟骞忛敓锟� by changhao
				xbean.ClanProgressRankList clanprogressrankmclist = xtable.Clanprogressranklist.get(RankType.FACTION_COPY);
				if(null != clanprogressrankmclist)
				{
					List<xbean.ClanProgressRankRecord> list = clanprogressrankmclist.getRecords();
					for(xbean.ClanProgressRankRecord record : list)
					{
						if(record.getClankey() == clanInfo.getKey())
						{
							record.setClanname(newname);
							break;
						}
					}
				}
				
				return true;
			}
		}.submit();
	}

	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 808484;

	public int getType() {
		return 808484;
	}

	public java.lang.String newname;

	public CChangeClanName() {
		newname = "";
	}

	public CChangeClanName(java.lang.String _newname_) {
		this.newname = _newname_;
	}

	public final boolean _validator_() {
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		_os_.marshal(newname, "UTF-16LE");
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		newname = _os_.unmarshal_String("UTF-16LE");
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CChangeClanName) {
			CChangeClanName _o_ = (CChangeClanName)_o1_;
			if (!newname.equals(_o_.newname)) return false;
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		_h_ += newname.hashCode();
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append("T").append(newname.length()).append(",");
		_sb_.append(")");
		return _sb_.toString();
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

