
package fire.pb.clan;

import java.util.ArrayList;
import java.util.List;

import fire.log.beans.ClanBuildUPBean;
import fire.log.beans.FactionOpbean;
import fire.pb.clan.srv.ClanManage;
import fire.pb.clan.srv.ClanRank;
import fire.pb.talk.MessageMgr;


// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CRequestClanLevelup__ extends mkio.Protocol { }

// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

public class CRequestClanLevelup extends __CRequestClanLevelup__ {
	@Override
	protected void process() {
		final long roleid = gnet.link.Onlines.getInstance().findRoleid(this);
		if (roleid < 0)
			return;
		
		/***
		 * 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ偆娲撮挊婵嬫煟閵忋埄鐒鹃柛銊ュ�歌灃闁挎繂鎳庨弳娆戠磼閻樺磭鈽夐棁澶愭煥濠靛棙鍣洪悹鎰剁磿缁辨帞锟斤絺鏅為崗宀�绱掓潏銊﹀磳鐎规洘甯掗～婵嬵敆婵犲啫顏堕梺缁樺灱婵倝宕愰崸妤佺叆闁哄洨鍋涢敓鐣屾暬閺佹捇寮妶鍥╂殼閻庤娲栭悥濂稿春閿熺姴绀冪憸蹇涙偡濠靛棌鏀介幒鎶藉磹瑜忓濠冪鐎ｎ亞鏌堝銈嗙墱閸嬬偤宕戦崒鐐寸厪濠㈣泛妫欏▍鍡涙煟閹捐泛鏋涢柡宀嬬節瀹曟帒顫濋崣妯挎婵＄偑鍊х徊鐐箾婵犲洤钃熼柨婵嗩樈閺佸洭鏌ｉ弮鍌氬妺闁革絼鍗冲娲传閸曨偒妲甸梺璺ㄥ枙濡嫮澹曢銏犳辈闁糕剝绋掗崐鐢告煥濠靛棝顎楀褌鍗抽弻锝夋晝閿熶粙鎮ч幘鎰佹綎闁绘垶蓱婵粓鏌熷▓鍨灈濠碘�茬矙濮婅櫣鎲撮崟顓熸啓閻庤娲滈弫鎼佸礆閹烘棑鎷烽敐搴℃灈缂佺姵濞婇弻锟犲礃閳哄倸闉嶉柣搴㈣壘缂嶅﹪寮婚妸銉㈡斀闁糕剝渚楅敓鑺ヮ殔闇夋繝濠傚缁犳牜绱掔紒妯兼创鐎规洏鍔戦、娆撳礈瑜忛崢婊勭節濞堝灝鏋涢柨鏇樺妼閳诲秹鏁愭径濠勵槺闂佸搫绋侀崢濂稿础閹惰姤鐓熼柟閭﹀幘閵堟挳鏌熼弸顐拷婵嗩潖缂佹ɑ濯撮柛娑橈工閺嗗牆鈹戦纭峰伐婵狅拷闁秴鏋佹い鏇嫹闁诡喗鐟╅幃婊兾熼悜妯兼瀫闂備礁鎼ˇ顖炴偋閸曨垰绀夐幖杈剧到婵剟鏌ㄩ悢缁橆棄闁宠鍨块、娆撳棘閵堝嫮杩旈梻浣告啞钃遍柟顔煎�块悰顔跨疀閹句焦妞介、鏃堝川椤忓懎顏归梻鍌欑閹诧紕绮欓幋锔芥櫇闁挎洖鍊搁悡鈥愁熆閼搁潧濮堥柣鎾卞劦閺岋繝宕堕張鐢电泿濡炪倐鏅╅崜娑氭閹烘鏁婄痪鎷屼含閸氬螖閻橀潧浠︽い顓炴川濡叉劙骞掗幊宕囧枛閹喚锟芥稒锚椤忓爼姊洪崜鑼帥闁稿鎳樺畷锝堢疀閺傚墽绠氬銈嗙墬缁瞼鏁崼鏇熷仺妞ゆ牗姘ㄩ崺锝夋煛瀹�瀣？闁跨喐鏋荤徊濠氬礉瀹�鍕櫢闁兼亽鍎崇粻鐐碉拷娈垮枦椤曆囧煡婢舵劕顫呴柍銉ュ帠濮规姊洪懡銈呅㈡繛澹洤绀冪憸蹇涙儗濡ゅ懏鈷掗柛灞剧懄椤﹂绱掓鏍ф灓缂佽京鍋ゅ畷鍫曞煛閸屾艾绨ユ繝鐢靛█濞佳囶敄閸涱垳涓嶉柡宥庡幗閻撶喖鏌熼柇锕�娅橀柡鍡樼矒閺岀喖鎮滅粵瀣棖闂佺懓寮堕幐鍐茬暦閻旂⒈鏁冮柨婵嗘閻︽悆on2->role by changhao
		 */
		mkdb.Procedure requestfactionlevelup = new mkdb.Procedure()
		{
			@Override
			protected boolean process()
			{
				SClanLevelup sClanLevelup = new SClanLevelup();
				
				Long factionid = xtable.Roleidclan.select(roleid);
				xbean.ClanInfo clan = xtable.Clans.get(factionid);
				
				if (clan.getClanmaster() != roleid && clan.getClanvicemaster() != roleid)
				{
					fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 150127, null);
					return true;
				}
				
				int money = clan.getMoney();
				int uplevel=0;//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ偆娲撮挊婵嬫煟閵忋埄鐒鹃柡瀣╃窔閺岀喖宕滆鐢盯鏌涚�ｎ偄濮堥柕鍥у瀵挳鎮欓幖顓燂紒闂佽瀛╅懝鍓х礊婵犲洤钃熸繛鎴欏灩缁犳盯姊婚崼鐔衡檨闁诲繐鐗撻幃妤呮偡閻楀牆鏆堢紓浣筋嚙閸熷瓨淇婇悽绋跨妞ゆ牗姘ㄩ濠囨⒑閻熸壆鎽犵紒璇插暣瀹曟劙顢涘锝嗘杸闂佹寧绋戠�氼剚绂掗埡浣叉斀妞ゆ柨鎼敓鑺ョ墱缁碍娼忛妸褏鐦堥梺鎼炲劀閸滀礁鏅ｆ繝鐢靛仩閹活亞绱為敓鑺ャ亜椤愩埄妲搁柍璇茬Ч瀹曞崬鈻庨幋鐙呯闯闂備胶顭堥張顒勬偡瑜斿畷婵嗩吋婢跺鍙嗛梺鍝勬处椤ㄥ棗鈻嶆繝鍕舵嫹鐟欏嫭澶勯柛銊ゅ嵆椤㈡﹢宕楅悡搴ｇ獮闁诲函鎬ラ崟顐紲濠电姷鏁搁崑鐘诲箵椤忓棛绀婇柨鐔诲Г閵囧嫰顢曢姀鈺傗枅閻庤娲橀崹鍧楀箖閳哄啰纾兼俊顖滃帶楠炲牓姊洪悷鏉挎倯闁伙綆浜畷鐟懊洪鍕庯附绻濋棃娑氬⒊闁圭兘顥撻幉鎾礋椤掑偆妲扮紓鍌欑贰閸犳牠鎯岄崒鐐叉槬闁靛繆鍓濋崕鐔兼煏婵炲灝鍔ゆい鎾存そ濮婅櫣绱掑Ο鍝勵潓閻庢鍠栭悥濂稿箖濡ゅ拋鏁囬柕蹇婃閹风粯绻涙潏鍓ф偧闁硅櫕鎹囬、姘煥閸曨厾顔曢梺鍛婄懃椤﹁鲸鏅堕悽纰夋嫹鐟欏嫭绀冮柛鏃�鐟ラ悾鐑筋敃閿曪拷鍞悷婊冪灱缁厽寰勯幇顓炰画濠电姴锕ら幊搴ㄣ�傛總鍛婂仺妞ゆ牗绋戠粭褔鏌ｉ妷顔绘捣妞わ箑缍婇弻锛勪沪閸撗勫垱濡炪們鍨哄ú鐔煎极閹版澘鐐婇柍鍝勫暞濞堝ジ姊婚崒娆戝妽濠电偛锕銊╁础閻戝棙缍庨梺鐓庮潟閸婃牠锝為弴銏＄厵闁绘垶蓱椤ユ牠鏌熸搴″幋闁轰焦鍔栭幆鏂库攽閸パ勭亾闂傚倷鑳剁划顖炲箰閹间礁围闁归棿绀侀拑鐔兼煃閵夈儳锛嶉柡鍡楁閹鏁愭惔鈥愁潾閻炴熬绠撳缁樻媴閼恒儯锟藉啴鏌ｉ幒鐐电暤鐎规洘绻傞埢搴ょ疀閺囩喐顔曢梻浣虹帛閹稿摜锟藉灚甯￠幃锟犲Ψ閳哄倻鍘遍梺纭呭焽閸斿秴鈻嶉崨瀛樼厱闁规崘鍩栭弳鈺冪磼鏉堛劍宕岀�规洘甯掗～婵嬵敆婵犲啫顏堕悗鐟板閸ｇ銇愰幒鎴犲�為梺闈涱煭缁茶偐鍒掗幘缁樷拺闁告稑锕︾紓姘舵煕鎼淬垻鍙�鐎殿喖鍟块…銊╁醇閻斿搫骞嶉梻浣虹帛閸ㄥ爼鏁冮埡浣叉灁闁哄啫鐗婇悡鐔兼煙缂併垹鐏查柟椋庡厴楠炲洦鎷呴崫鍕毄闂備浇宕垫慨鎯ь浖閵娧勫闁挎洖鍊归崑鍌涖亜閹哄秷鍏岀紒鐘插⒔缁辨帒螖閿熶粙骞栭锝嗗弿闁稿瞼鍋為悡娑㈡倶閻愭彃鈷旀繛鍙夋尦閺屾盯鍩℃担鍓蹭純閻庤娲橀敃銏犵暦濠婂棭妲绘繝娈垮枛閻栫厧顫忕紒妯肩懝闁跨喕妫勯…鍥樄闁炽儻绠撻、姗�鎮╅悽纰夌闯婵犳鍠楅…鍫熴仈缁嬭法鏆﹂柡灞诲劜閻撴洟鏌嶉埡浣告殶闁冲彞绶氶弻锝夊箻瀹曞洨顔掗梺鍝勬湰閻╊垶銆侀弴銏℃櫜闁搞儮鏅濋弳顐︽⒒娴ｇ儤鍤�闁告艾顑夊畷婵嬪冀椤撶倣锕傛煕閺囥劌澧柛搴ｅ枛閺屾洝绠涙繝蹇斿鐎规洖娴勭槐锕傛⒒閸屾瑧顦﹂柟纰卞亰閹绺界粙璺ㄧ崶闂佸搫璇為崨顔筋啎婵犵數鍋涘Λ娆撳箰缁嬫寧绾梻鍌欒兌绾爼宕滃┑瀣拷鍐疀閺傛鍤ら梺璺ㄥ櫐閹凤拷
				int cost=0;//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄闁挎繂妫Λ鍕⒑閸濆嫷鍎庣紒鑸靛哺瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈嗐亜椤撶姴鍘寸�殿喖顭烽弫鎰緞婵犲嫮鏉告俊鐐�栫敮濠囨倿閿曞倸纾块柟鍓х帛閳锋垿鏌熼懖鈺佷粶濠碘�炽偢閺屾稒绻濋崒娑樹淮閻庢鍠栭…鐑藉极閹邦厼绶炲┑鐘插缂嶅倿姊绘担铏瑰笡闁挎岸鏌涢悢閿嬪仴鐎殿喗濞婂畷濂稿Ψ閿旇瀚肩紓鍌欑椤戝棝顢栧▎鎾崇？闊洦鏌ｆ禍婊堟煙鐎涙绠ユ俊顖ゆ嫹闁诲孩顔栭崰鏍�﹂柨瀣╃箚闁归棿绀侀悡娑㈡煕鐏炲墽鐓紒銊ょ矙濮婄粯鎷呮笟顖滃姼闂佸搫鐗滈崜娑氬垝濞嗘挸绠ｉ柨鏃傜帛閺呮粓姊虹捄銊ユ珢闁瑰嚖鎷�??
				int opid=0;//
				if (id == ClanManage.Lobby) //濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮诲☉妯锋婵鐗婇弫楣冩⒑閸涘﹦鎳冪紒缁樺姍濠�渚�姊虹粙璺ㄧ闁告艾顑囩槐鐐哄箣閿旂晫鍘遍梺闈涱焾閸庨亶鏁撻挊澶樼吋妤犵偛顦甸獮鏍ㄦ媴閻熼缃曢梻浣稿閸嬪懐鎹㈤崟顖涘仭闁哄被鍎查埛鎴犵磼鐎ｎ偒鍎ラ柛搴＄箲閵囧嫰鏁傞悙顒佹瘓閻庢鍠栭…宄邦嚕閹绢喗鏅柛鏇ㄥ幗濠㈡垿姊虹拠鎻掑毐缂傚秴妫欑粋宥夋倻閽樺顔嗛梺缁樺灱濡嫰宕￠幎鑺ョ厽婵☆垰鍚嬮弳鈺呮煟閹烘垯鍋㈡慨濠冩そ瀹曘劍绻濋崒姣挎洟姊洪崫銉バｆい銊ワ躬楠炲啴妾辩紒鐘崇洴楠炴﹢顢涘☉娆愭緫闂傚倷鑳剁划顖炩�﹂崼顫剨婵炲棙鍨规稉宥夋煟濡わ拷閻楀嫭绂嶅鍫熺厓闁告繂瀚稿銉ヮ熆瑜庨幐鎶藉蓟閿涘嫪娌柣鎰靛墰椤︿即鎮楃憴鍕鐎规洦鍓濋悘鎺楁⒑閸涘﹦绠撻悗姘槻椤洤顫濋鐘电槇濠电偛鐗嗛悘婵嬪几濞戙垺鐓ラ柡鍥朵簻椤╊剟鏌涢幒鎾虫诞妞ゃ垺鐩幃娆撴嚑椤掑鏁搁梻鍌欑閹诧紕绮欓幒鎴劷婵炲棗娴氶崯鍛節闂堟稒顥戦柡锟芥禒瀣厽婵☆垵顕х徊濠氭煥閻旂儤娅曢柟铏崌閸┿垽骞樺鍕枔閹峰鐣烽崶鈺冩毎闂傚倷鑳剁划顖炲礉閿旂晫顩叉繝濠傜墛閺呮悂鏌ら幁鎺戝姎闁诲繐顕敓鍊燁潐濞叉鎹㈤崒鐐村仼婵犻潧顑呯粈瀣亜閹扳晛锟芥寮搁崘顔解拺缁绢厼鎳庨ˉ宥夋煙濞茶绨界�垫澘锕幐濠冨緞濡儤顓块梻浣告惈鐞氼偊宕曢弻銉ョ厱闁圭儤鍨敓鑺ュ笒椤繈鎮欓锟介鑸电節閻㈤潧浠掗柛鏍█瀹曞爼鏁愯箛鏂款伓闂佹寧娲栭崑鍡涘极閸ヮ剚鐓熸繛鍡楃箲閸ｆ椽鎮楀顒傜Ш婵﹤顭峰畷濂告偄娓氼垳浼囬梺璇插閻噣宕￠幎钘夎摕鐎广儱娲ㄧ壕鍏间繆椤栨繍鍤欓梻澶婄Ф缁辨挻鎷呯粙鍖℃嫹閸︻厽鏆滈柣鎰劋閺呮悂鏌￠崒妯猴拷妤冪矓閻㈠憡鐓曢悗锝庝簼椤ャ垻锟借娲╃紞浣哥暦閸楃偐妲堟繛鍡楁湰鐎氳偐绱撻崒姘拷鐑芥倿閿曚焦鎳岀紓鍌欑筏閹风兘鏌ㄩ悢鍓佺煓婵﹨娅ｇ划娆撳礌閳ュ厖绱ｆ繝鐢靛閹风兘姊洪锟界粔鐢稿疾閹间焦鐓犻柟顓熷笒閸斻倝鏌涢悢鍝ュ弨闁哄瞼鍠栧畷娆撳Χ閸℃浼� by changhao
				{
					int level = clan.getClanlevel();
					int sumlevel = 0;
					sumlevel += clan.getHouse().get(ClanManage.GoldBank);
					sumlevel += clan.getHouse().get(ClanManage.DrugStone);
					sumlevel += clan.getHouse().get(ClanManage.Hotel);

					fire.pb.clan.SClanLobby lobby =  fire.pb.main.ConfigManager.getInstance().getConf(fire.pb.clan.SClanLobby.class).get(level);
					if (lobby == null)
					{
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 143583, null);
						return true;
					}
				
					fire.pb.clan.SClanLobby l =  fire.pb.main.ConfigManager.getInstance().getConf(fire.pb.clan.SClanLobby.class).get(level + 1);
					if (l == null) //濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ゆい顓犲厴瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戦柟鑲╁仜婵″ジ鏌涙繝鍌涘仴鐎殿喛顕ч埥澶愬閳哄倹娅囬梻浣瑰缁诲倸螞濞戔懞鍥Ψ瑜忕壕钘壝归敐鍛儓鐏忓繘姊洪崨濠庢畷濠电偛锕ら锝囨嫚濞村顫嶅┑鈽嗗灦閺�閬嶅棘閿熶粙姊绘担鍛婂暈婵炶绠撳畷鎴﹀礋椤掍礁寮块梺闈涚箞閸婃牠鍩涢幋鐐电闁煎ジ顤傞崵娆愵殽閻愭惌娈滈柡宀�鍠栭幃鐑芥偋閸繃鐏庨柣搴㈩問閸犳牠鈥﹂悜钘夋瀬闁归偊鍘肩欢鐐测攽閻樻彃顏撮柛姘嚇濮婄粯鎷呴悷閭﹀殝缂備浇顕ч崐姝岀亱濡炪倖鎸鹃崐锝呪槈閵忕姷顦板銈嗘尵婵兘鏁嶅┑鍥╃闁瑰墽顥愭竟姗�鏌ㄩ弴妯哄姢闁跨喕濮ら懝鍓х礊婵犲偆娼栭柧蹇撴贡閻瑩鏌熺粙鍨劉闁圭柉浜槐鎾存媴閸撴彃鍓遍柣銏╁灙閿熻棄纾弳锕傛煥濠靛棛澧㈤柣銈忔嫹闂備礁鎼崐鍛婃櫠閻ｅ瞼涓嶆慨妯垮煐閳锋垿姊婚崼鐔恒�掑褎娲熼弻鐔风暋闁箑鍓堕悗瑙勬礃濞茬喖鐛崶顒佸亱闁割偅绻愰幏鐑藉垂椤愶絽寮垮┑顔筋殔濡鏅堕幍顔剧＜濠㈣泛顑嗛妵婵嬫煛瀹�锟介崰鏍�佸▎鎴犻┏閻庯綆鍋嗛弳顓㈡⒒娴ｇ儤鍤�鐎殿喖鐖奸獮鎰板礃閼碱剚娈鹃梺缁樻⒒閳峰牓寮崱娑欑厱閻忕偠顕ч敓鑺ョ墳閳兘姊婚崒姘拷鎼佸磹閻戣姤鍊块柨鏃�鎷濋幏椋庣箔濞戞ɑ鍣归柡瀣墢閿熻棄绠嶉崕閬嵥囬娑辨敯闂傚倷绀侀幉鈥趁洪敃鍌氬瀭闁规鍠氭稉宥呪攽閻樺磭顣查柣鎾跺枛閺岀喖鏌囬敃锟介悘鈩冦亜閵夈儺妲搁棁澶愭煟濞嗘瑦瀚归梺闈╃秶缂嶄線鐛崘銊庢棃宕橀埡浣圭�梻浣告啞濞诧箓宕滃☉銏℃櫖婵鎷锋慨濠冩そ瀹曘劍绻濋崘锝嗗闂備焦鎮堕崝灞筋焽閳╁啩绻嗛悗娑櫳戞刊鎾煕閹惧啿绾х�点倖妞藉铏规崉閵娿儲鐎虹紓渚囧枟閻熲晠鎮伴锟藉畷姗�顢氶崨顔芥珕闂備礁澹婇崑鍛崲閸屾粎鐜绘繛鎴烇供濞撳鏌曢崼婵囶棤濠⒀屽墴閺屾盯骞嬮悩鍐叉畬闁告浜跺鍫曞醇濞戞ê顬嬬紓浣叉閹风兘姊绘担鍦菇闁搞劏妫勯…鍥槻闁哄棌鏅犲缁樻媴閼恒儯锟藉啴鏌ｉ幒鐐电暤妤犵偛鍟村畷鎺戭潩鏉堛劍顔曢梻浣侯攰閹活亪姊介崟顖氱；闁规壆澧楅崑锝夋煕閵夘喕绨婚柣銊у劋閵囧嫰寮懗顖氼伃濡炪値浜滈崯瀛樹繆閸洖宸濇い鏍ㄧ矤閸炲爼姊绘担铏瑰笡妞ゃ劌鎳庤灋婵炴垶鑹鹃崹婵嗏攽閻樺啿鍤柡浣哥Ч閺岋綁骞囬澶婃闂佸憡鐟ュΛ婵嗩潖閾忓湱纾兼俊顖濆吹椤︺儵姊虹粙鍖″伐婵狅拷闁秵鏅搁柤鎭掑劤閸熸煡鏌熼崙銈嗗? by changhao
					{
						java.util.ArrayList<String> args = new java.util.ArrayList<String>();
						Integer s = level;
						args.add(s.toString());
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 160226, args);
						return true;						
					}
					
					int sum = lobby.othersum;
					if (sumlevel < sum) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氼參宕崇壕瀣ㄤ汗闁圭儤鍨归崐鐐烘偡濠婂啰绠荤�殿喗濞婇弫鍐磼濞戞艾骞楅梻渚�娼х换鍫ュ春閸曨垱鍊块柛鎾楀懐锛滈梺褰掑亰閸欏骸鈻撳鍫熺厸鐎癸拷閿熶粙宕伴弽顓炶摕闁搞儺鍓氶弲婵嬫煥閻斿墎鐭欑�规洘绻堥獮鎺楀箻閸撲緡鍟庨柣搴ｆ嚀婢瑰﹪宕伴弴鐘哄С闁煎鍊楃壕濂告煟濞嗗繑鍣界紒澶樺櫍閺岋紕浠︾拠鎻掝潎閻庢鍣崳锝呯暦閸洍锟斤箓骞嬮悜鍡橆棄闂傚倸鍊峰ù鍥р枖閺囥垹绐楅柡鍥╁�ｅ☉銏犵妞ゆ劦鍋嗛崝鐑芥⒑鐠恒劌鏋斿┑顔芥尦閹锋垿鎮㈤崗鑲╁帾婵犵數鍋熼崑鎾斥枍閸涘瓨鐓曟俊銈勭閳绘洟鏌″畝瀣М妤犵偛娲、娑㈡晲閸涱喚鏉洪梻鍌欑缂嶅﹪藟閹捐钃熷鑸靛姇妗呴梺鍦濠㈡绮婚幎鑺ョ厵閻庣數顭堥鎾剁磼鏉堚晜鏆慨濠勭帛閹峰懏绗熼娑欐殲闂備浇顫夊鎸庣椤忓嫷娼栧ù鐘差儏缁�瀣亜閺嶃劎鈽夊ù婊勵殜濮婅櫣绱掑Ο娲绘闂佸搫鎳撶亸娆撳箲閵忋倕骞㈡繛鎴炵懅閸橆亪姊洪崜鎻掍簼缂佽瀚划濠氬蓟閵夛箑锟藉灚鎱ㄥ鍡楀缂佸鍎ら幈銊︾節閸涱噮浠╃紓浣介哺鐢帡锝炲鍫濆耿婵☆垰鍚嬪▓鐣岀磽閸屾艾锟界兘鎳楅崜浣稿灊妞ゆ牜鍋為弲婵嬫煏韫囨洖啸闁哄棴闄勭换娑橆啅椤旇崵鐩庡銈庡亜閹虫﹢寮婚弴銏犻唶婵犻潧娲ゅ▍褔姊哄ú璇蹭簻閻庢碍婢橀～蹇涙惞閸︻厾鐓撻柣鐘充航閸斿酣宕濊ぐ鎺撯拻闁稿本鑹鹃鈺呮倵濮樼厧娅嶉柡浣规崌閹崇偤濡烽妶鍕劉婵＄偑鍊ら崑鍕囬悽绋课ラ柛鎰靛枛鍞梺鍐叉惈閸婃悂鏁撻悾灞藉幋闁哄被鍊楅崰濠囧础閻愭彃绠伴梻浣瑰劤缁绘劙鏌婇敐鍜佹綎婵炲樊浜滃婵嗏攽閻樻彃鏆婇柟宄扮秺閹鎯傞崨濠傤伓闂備礁缍婂Λ璺ㄧ矆娓氾拷閹锋垿鎮㈤崗鑲╁幗闂佸搫鍟悧婊兾涢幋锔界厸闁糕剝顨忛崕鏃�鎱ㄦ繝鍐┿仢妞ゃ垺锕㈡俊姝岊槾闁哄棛濞�濮婃椽宕ㄦ繝鍐ㄩ瀺濠电姰鍨洪敃銏ゅ灳閺冨牆绀冩い鏂挎瑜旈獮鏍垝閻у憡瀚归柟棰佺劍娴溿倝姊婚崒娆戝妽閻庣瑳鍏犳椽鏁傞悾宀婃锤濡炪倕绻愮�氱兘宕甸弴鐔翠簻闁规澘澧庨悾杈╃磼閻樺搫鍚圭紒杈ㄦ尰閹峰懘鎳栭埄鍐ㄧ仴闁宠绉规慨锟介柕鍫濇閹锋椽鏌ｉ悩鍏呰埅闁告柨鑻埢宥夊箛閻楀牏鍘甸梺鍛婂灟閸婃牜锟芥熬鎷� by changhao
					{
						//java.util.List<String> parameters = new java.util.ArrayList<String>();
						//parameters.add(attr.name);
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 160225, null);
						return true;
					}
				
					if (money < ClanUtils.getBuildLevelupMax(clan).get(ClanManage.Lobby)) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氼參宕崇壕瀣ㄤ汗闁圭儤鍨归崐鐐烘偡濠婂啰绠荤�殿喗濞婇弫鍐磼濞戞艾骞堟俊鐐�ら崢浠嬪垂閸偆顩叉繝闈涱儐閻撴洘绻涢崱妤冪缂佺姴顭烽弻鈥崇暆鐎ｎ剛袦婵犳鍣幏鐑芥⒑闂堟稓绠氶柡鍛箞瀹曟繈宕妷褏锛濇繛鎾磋壘閿曘儳锟芥俺顫夌换婵嬪閿濆懐鍘梺鍛婃⒐閻楃娀骞冮敓鐘参ㄩ柍鍝勫�婚崢鎼佹⒑閹肩偛鍔楅柡鍛♁缁傛帒顭ㄩ崼鐔哄弳闂佺粯姊荤划顖炈夋径鎰厵闁兼亽鍎抽惌宀勬煕閹烘挸娴柡浣瑰姍瀹曘劑宕掑☉娆樻閻庤娲忛崝鎴︺�佸▎鎾崇畾鐟滃秶绮绘导瀛樷拺閻犲洦鐓￠妤冪磼閻樿尙效鐎规洘娲樺蹇涒�﹂幋鐑嗗晬闂備礁鎲＄缓鍧楀磿閺屻儱姹叉繝濠傜墛閻撶喖鏌熼柇锕�鏋涢柛鏂款儔閺岋綁骞樼�涙顦伴梺鍝勬湰濞叉ê顕ラ崟顐嬬喖鎮滃Ο闂撮偗婵犵數濮幏鍐礃閸撗冩倯闂備礁鎼径鍥礈濠靛绠柛娑欐綑瀹告繂鈹戦悩鎻掝劉闁挎稑妫濆缁樻媴閸涘﹥鍎撻梺鍝勭墱閸撶喖骞嗛崟顖ｆ晬婵鍘у▓銊╂⒑閸︻叀妾搁柛鐘崇墬閸庮偊姊绘笟锟藉褔藝椤撱垹纾块柛婵嗗閻掕棄鈹戦悩宕囶暡闁抽攱甯掗湁闁挎繂鎳忛崯鐐烘煕閻斿搫浠遍柡宀�鍠撴禍鎼佸冀閵婏妇褰嬮柣搴ゎ潐濞测晝绱炴担鍝ユ殾婵鎷烽柍銉畵楠炲鎮欓悽纰樻瀱婵犵數濮烽弫鎼佸磻濞戞鐔哥節閸愵亶娲稿┑鐘诧工閸犳岸宕崨顔剧瘈闂傚牊绋掗ˉ鎴︽煛閿熻姤绂掔�ｎ偆鍘藉┑鈽嗗灥椤曆呭緤婵犳碍鐓涢柛鈩冾焽閹冲嫰鏌曢崶褍顏柡浣稿�婚幉鎾礋椤掑倸缍冨┑鐘愁問閸犳牠鏁冮妷銉富濞寸姴顑囧畵渚�鏌″搴″箺闁稿﹦鍏橀弻鐔虹磼濡桨鍒婇梺璇查閻°劎鎹㈠┑瀣仺闂傚牊鍒�閻愮儤鐓曢柕濠忛檮閵囨繈鏌℃担绋挎殻濠殿噯鎷烽梺闈涚墕閹冲繐危椤掑嫭鈷戦梻鍫熺〒缁犲啿鈹戦锝呭籍鐎规洏鍎抽敓鏂ょ秵娴滃爼鎮㈤崱娑欏仯闁告繂瀚ㄩ崑銊╂煥閻斿搫孝闁绘挻鐩弻娑樷槈閸楃偞鐏撻梺鍛娚戦幑鍥ь潖濞差亜宸濆┑鐘插閻ｇ敻鏌ｆ惔銏犲毈闁告挾鍠栧顐﹀箻缂佹ê浠奸柣蹇曞仧閸嬫挸袙閸惊鏃堟偐闂堟稐绮剁紓浣虹帛閸旀宕ｉ崨顓ф富闁靛牆鎳愮粻浼存煙閸愬樊妯�妤犵偛绻愮叅妞ゅ繐鎳夐幏娲⒑缁嬭法绠绘俊顐㈡健閹虫粓顢旈崼鐔哄幈闁硅壈鎻槐鏇熸櫏婵＄偑鍊戦崹鍝勎涢崘銊ф殾闁惧繗顫夊畷澶愭煟閹寸伝顏堝几閻樺樊娓婚柕鍫濆暙閻忣亞绱掔�ｎ偄鐏撮柍銉畵婵℃悂鍩℃担鍝ョ崺婵＄偑鍊栭悧顓犲緤閸撗呮噮濠电姷鏁告慨鐑藉极閹间礁纾婚柣妯款嚙缁犲灚銇勮箛鎾搭棤缂侊拷婵犲洦鐓ラ柣鏃囶嚙琚氱紓浣虹帛閻╊垰鐣烽鍫濈妞ゅ繐鎳庢禒鐟扳攽閻橆喖鐏辨い顐㈩槸鐓ら柣鏃堫棑閺嗭附淇婇妶鍛櫤闁抽攱甯￠幃妤呮濞戞瑦鍠愰梺浼欑秮缁犳牕顫忕紒妯肩懝闁跨喕妫勯…鍥樄闁诡啫鍥у耿婵炲棙鍔曟惔濠囨⒑閻熼偊鍤熷┑顖涙尦楠炲繐鐣￠柇锔藉兊闁哄鐗勯崝灞解枔鐏炵瓔娓婚柕鍫濈凹缁ㄥ鏌涢悢椋庢憼濞ｅ洤锕獮鍡涘箥椤旂偓婢戦梻浣告惈濞层劍鎱ㄩ棃娑掓灁闁绘挸绨堕弨浠嬫煟閹邦垰鐨洪柟鐣屽Х缁辨帡顢欓懖鈺冨姱闂佽鍠撻崕鑼紦娴犲宸濆┑鐘插�风划褎淇婇悙顏勶拷鏍洪埡鍛濡炲鍑介幏宄扳枔閸喗鐏嗙紓渚囧枟閻熲晠濡存担鍓叉建闁跨喍绮欓獮鍐閵堝懎绐涙繝鐢靛Т缁ㄥジ骞嬮悜鑺モ拻闁稿本鑹鹃敓钘夊槻闇夐柛銉戯拷閺嬫牠鏌￠崶銉ョ仼闂傚偆鍨堕弻銊╁即閻愯鎷烽崫銉т笉妞ゆ牜鍋為悡銉╂煟閺囩偛锟藉湱锟芥熬鎷�? by changhao
					{
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 160224, null);
						return true;
					}
					
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂傚洤顦甸弻銊モ攽閸♀晜效婵炲瓨鍤庨崐婵嬪蓟閵堝绾ч柟绋块娴犳潙鈹戦纭锋敾婵＄偘绮欓妴浣肝旈崨顔芥闂佷紮绲介惉濂告儗閹剧粯鐓涢悘鐐额嚙閸旀粓鏌￠崨顔藉�愰柡宀嬬畱铻ｅ〒姘煎灡绗戦梻浣芥硶閸犳洖螞閸曨偒鐒介柨鐔哄Т杩濇繛杈剧悼绾爼寮告惔銊︾厵闁诡垎鍜冪礊濡炪倧瀵岄崣鍐箖瀹勯偊鐓ラ柛鎰典簽椤旀帡鏌﹀Ο鑽ょ畺闁靛洤瀚板浠嬪Ω瑜嬮敓鑺ュ笧缁辨帡鎮╅懡銈囨毇闂佸搫鐬奸崰鏍嵁閸℃凹妾ㄩ梺鎼炲�楅崰鏍蓟濞戙垺鍋勯柛婵勫劚瀵劑姊洪崫鍕伇闁哥姵鐗犻獮鍐煥閸喎娈熼梺闈涱檧闂勫嫬鈻撻崨濠佺箚闁绘劦浜滈敓鑺ュ灴瀹曟繃绻濋崶褏锛熼梺姹囧灮椤牏绮婚弽銊х闁糕剝蓱鐏忣厾绱掗悪娆忔处閻撴瑩鎮楀☉娆樼劷缂佺姰鍎茬换娑㈠礂閻撳骸鎽靛┑顔硷功缁垶骞忛崨瀛樺殟闁靛缍囬幏鐑藉礃椤旂晫鍘介梺纭呮閸嬬喖鎮鹃崹顐闁绘劖娼欓悘瀵革拷瑙勬礀閻栧ジ銆佸Δ鍛櫢濞寸姴顑呴崙鐘层�掑鐐闂佸搫鐬奸崰鏍х暦濠婂棭妲鹃柣銏╁灡閻╊垶寮婚敓鐘插窛妞ゆ棁妫勯敓鑺ュ姍閺岋紕浠︾拠鎻掝潎闂佽鍠撻崐婵嗙暦閹烘垟妲堟慨妤�妫旂槐锟� by changhao
					boolean ok = ClanManage.AddClanMoney(-lobby.levelupcost, clan);
					if (ok == false)
					{
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 160224, null);
						return true;
					}
					
					clan.setClanlevel(level + 1);
					
					sClanLevelup.change.put(ClanManage.Lobby, level + 1);
					sClanLevelup.money = clan.getMoney();	
					uplevel=level + 1;//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ偆娲撮挊婵嬫煟閵忋埄鐒鹃柡瀣╃窔閺岀喖宕滆鐢盯鏌涚�ｎ偄濮堥柕鍥у瀵挳鎮欓幖顓燂紒闂佽瀛╅懝鍓х礊婵犲洤钃熸繛鎴欏灩缁犳盯姊婚崼鐔衡檨闁诲繐鐗撻幃妤呮偡閻楀牆鏆堢紓浣筋嚙閸熷瓨淇婇悽绋跨妞ゆ牗姘ㄩ濠囨⒑閻熸壆鎽犵紒璇插暣瀹曟劙顢涘锝嗘杸闂佹寧绋戠�氼剚绂掗埡浣叉斀妞ゆ柨鎼敓鑺ョ墱缁碍娼忛妸褏鐦堥梺鎼炲劀閸滀礁鏅ｆ繝鐢靛仩閹活亞绱為敓鑺ャ亜椤愩埄妲搁柍璇茬Ч瀹曞崬鈻庨幋鐙呯闯闂備胶顭堥張顒勬偡瑜斿畷婵嗩吋婢跺鍙嗛梺鍝勬处椤ㄥ棗鈻嶆繝鍕舵嫹鐟欏嫭澶勯柛銊ゅ嵆椤㈡﹢宕楅悡搴ｇ獮闁诲函鎬ラ崟顐紲濠电姷鏁搁崑鐘诲箵椤忓棛绀婇柨鐔诲Г閵囧嫰顢曢姀鈺傗枅閻庤娲橀崹鍧楀箖閳哄啰纾兼俊顖滃帶楠炲牓姊洪悷鏉挎倯闁伙綆浜畷鐟懊洪鍕庯附绻濋棃娑氬⒊闁圭兘顥撻幉鎾礋椤掑偆妲扮紓鍌欑贰閸犳牠鎯岄崒鐐叉槬闁靛繆鍓濋崕鐔兼煏婵炲灝鍔ゆい鎾存そ濮婅櫣绱掑Ο鍝勵潓閻庢鍠栭悥濂稿箖濡ゅ拋鏁囬柕蹇婃閹风粯绻涙潏鍓ф偧闁硅櫕鎹囬、姘煥閸曨厾顔曢梺鍛婄懃椤﹁鲸鏅堕悽纰夋嫹鐟欏嫭绀冮柛鏃�鐟ラ悾鐑筋敃閿曪拷鍞悷婊冪灱缁厽寰勯幇顓炰画濠电姴锕ら幊搴ㄣ�傛總鍛婂仺妞ゆ牗绋戠粭褔鏌ｉ妷顔绘捣妞わ箑缍婇弻锛勪沪閸撗勫垱濡炪們鍨哄ú鐔煎极閹版澘鐐婇柍鍝勫暞濞堝ジ姊婚崒娆戝妽濠电偛锕銊╁础閻戝棙缍庨梺鐓庮潟閸婃牠锝為弴銏＄厵闁绘垶蓱椤ユ牠鏌熸搴″幋闁轰焦鍔栭幆鏂库攽閸パ勭亾闂傚倷鑳剁划顖炲箰閹间礁围闁归棿绀侀拑鐔兼煃閵夈儳锛嶉柡鍡楁閹鏁愭惔鈥愁潾閻炴熬绠撳缁樻媴閼恒儯锟藉啴鏌ｉ幒鐐电暤鐎规洘绻傞埢搴ょ疀閺囩喐顔曢梻浣虹帛閹稿摜锟藉灚甯￠幃锟犲Ψ閳哄倻鍘遍梺纭呭焽閸斿秴鈻嶉崨瀛樼厱闁规崘鍩栭弳鈺冪磼鏉堛劍宕岀�规洘甯掗～婵嬵敆婵犲啫顏堕悗鐟板閸ｇ銇愰幒鎴犲�為梺闈涱煭缁茶偐鍒掗幘缁樷拺闁告稑锕︾紓姘舵煕鎼淬垻鍙�鐎殿喖鍟块…銊╁醇閻斿搫骞嶉梻浣虹帛閸ㄥ爼鏁冮埡浣叉灁闁哄啫鐗婇悡鐔兼煙缂併垹鐏查柟椋庡厴楠炲洦鎷呴崫鍕毄闂備浇宕垫慨鎯ь浖閵娧勫闁挎洖鍊归崑鍌涖亜閹哄秷鍏岀紒鐘插⒔缁辨帒螖閿熶粙骞栭锝嗗弿闁稿瞼鍋為悡娑㈡倶閻愭彃鈷旀繛鍙夋尦閺屾盯鍩℃担鍓蹭純閻庤娲橀敃銏犵暦濠婂棭妲绘繝娈垮枛閻栫厧顫忕紒妯肩懝闁跨喕妫勯…鍥樄闁炽儻绠撻、姗�鎮╅悽纰夌闯婵犳鍠楅…鍫熴仈缁嬭法鏆﹂柡灞诲劜閻撴洟鏌嶉埡浣告殶闁冲彞绶氶弻锝夊箻瀹曞洨顔掗梺鍝勬湰閻╊垶銆侀弴銏℃櫜闁搞儮鏅濋弳顐︽⒒娴ｇ儤鍤�闁告艾顑夊畷婵嬪冀椤撶倣锕傛煕閺囥劌澧柛搴ｅ枛閺屾洝绠涙繝蹇斿鐎规洖娴勭槐锕傛⒒閸屾瑧顦﹂柟纰卞亰閹绺界粙璺ㄧ崶闂佸搫璇為崨顔筋啎婵犵數鍋涘Λ娆撳箰缁嬫寧绾梻鍌欒兌绾爼宕滃┑瀣拷鍐疀閺傛鍤ら梺璺ㄥ櫐閹凤拷
					cost=lobby.levelupcost;//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄闁挎繂妫Λ鍕⒑閸濆嫷鍎庣紒鑸靛哺瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈嗐亜椤撶姴鍘寸�殿喖顭烽弫鎰緞婵犲嫮鏉告俊鐐�栫敮濠囨倿閿曞倸纾块柟鍓х帛閳锋垿鏌熼懖鈺佷粶濠碘�炽偢閺屾稒绻濋崒娑樹淮閻庢鍠栭…鐑藉极閹邦厼绶炲┑鐘插缂嶅倿姊绘担铏瑰笡闁挎岸鏌涢悢閿嬪仴鐎殿喗濞婂畷濂稿Ψ閿旇瀚肩紓鍌欑椤戝棝顢栧▎鎾崇？闊洦鏌ｆ禍婊堟煙鐎涙绠ユ俊顖ゆ嫹闁诲孩顔栭崰鏍�﹂柨瀣╃箚闁归棿绀侀悡娑㈡煕鐏炲墽鐓紒銊ょ矙濮婄粯鎷呮笟顖滃姼闂佸搫鐗滈崜娑氬垝濞嗘挸绠ｉ柨鏃傜帛閺呮粓姊虹捄銊ユ珢闁瑰嚖鎷�??
					opid=FactionOpbean.TYPE_LOBBY_UP;
					
					SendAllFactionMemeber(clan, ClanManage.Lobby, level + 1);
					
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ剙浠遍柟顔ㄥ洦鍋愭慨鐟版祫閹烽攱绗熼敓钘夘嚕閹绢喖顫呴柣姗�娼ч獮鍫熺節濞堝灝鏋熼柨鏇楁櫊瀹曘垺绂掔�ｎ�附绻濋棃娑欘棏闁猴拷娴犲鈷旈柛銉墮閺勩儵鏌″畵顔艰嫰濞堫偊姊洪崨濠冨闁告瑥绻橀獮蹇涙倻閼恒儲娅滈柟鐓庣摠缁诲嫰鎳楅崫鍕ㄦ斀闁炽儱鍟跨痪褔鏌涢弮锟介悷銉╋綖韫囨洜纾兼俊顖濆亹閹虫繈姊虹捄銊ユ灆婵☆偄瀚伴垾锕傚炊椤忓秵鈻夊┑鐘媰閸曨厾鐤勫┑顔硷攻濡炶棄鐣烽锕�绀嬫い鎺炴嫹婵炲懌鍊濆娲倻閳哄倹鐝﹂梺鎼炲妼閻栧ジ鎮伴璺ㄧ杸婵炴垶顭囬娲⒑閹稿孩顥嗘俊顐㈠缁傚秴顭ㄩ崼鐔哄幗闂婎偄娲﹂幐鍓х不閿濆鐓熼柟铏瑰仧閻ｇ數锟芥鍣崜鐔煎极閹惧顩烽悗锝庡亐閹风粯绻涙潏鍓хК婵炲拑绲块弫顔尖槈閵忥紕鍙嗗┑顔缴戦崬濠氬箯瀹勬壋鏋旈柛顭戝枟閻忓牓姊虹紒妯煎ⅹ闁靛牊鎮傞幃浼搭敋閿熻棄顕ｆ禒瀣垫晣闁绘劗鏁搁弶鍛婁繆閻愵亜锟芥牠寮婚妸锔芥珷濞寸姴顑嗛弲顒佺節婵犲倻澧涢柍閿嬪灴閹綊骞侀幒鎴濐瀳闂佸搫顑呯粔鍓佹閹烘鏁婇柣锝呮湰閸Ｑ囨⒑娴兼瑧鎮奸柛蹇旓耿閻涱噣骞掑Δ锟界粻锝夋煛閸愭寧瀚瑰銈庡亜缁夌懓顫忓ú顏勪紶闁告洦鍘搁弸灞剧節绾版﹫鎷烽搹顐㈡灎闂佽鍨扮�氼參骞嗛弮鍫澪╅柨鏃囶潐鐎氳棄鈹戦悙鑸靛涧缂佽尪鍋愰幏鍐晝閸屾氨鍝楁繛瀵稿帶閻°劑鎮″▎鎰闁煎ジ顤傞崬铏圭磼閵娧勬珪闁跨喕妫勯悘姘熆濮楋拷閺佸啴顢旈崟顓熸濠电姴锕ゅΛ顓炍ｆ總鍛娾拺缂佸娉曠粻鑼磼椤旇姤宕岀�殿喛顕ч埥澶愬閻樻鍟嬮梻浣藉婢瑰牆鈻斿☉銏犲偍闁挎稑瀚壕濂告煟閹伴潧澧柛鏂诲�濋弻鏇㈠醇閻旂锟芥劗锟芥鍠栭…鐑藉箖閵忋倕绀傞柤娴嬫櫅婵椽姊绘担鐟邦嚋婵炴祴鏅犻獮蹇旑槹鎼搭垱瀚规繛鍫濈仢閺嬨倝鏌涚�ｎ偅灏甸柟骞垮灩閳藉濮�閻樿鏁归梻浣虹帛濞叉垿鎳楅崼鏇炵濡炲娴风壕钘壝归敐鍕煓闁告繃妞介幃浠嬵敍濞戣鲸鐣跺銈庡幖濞测晝绮诲☉妯锋婵☆垱澹曢弲鐘诲蓟閺囩喓鐝舵い鏍ㄧ閸ｆ椽鏌涢敐搴＄仸婵﹤顭峰畷鎺戔枎閹搭厽袦闂備焦鐪归崐鏇灻洪妶鍫罕闂備礁鎲″ú锕傚垂娓氾拷瀹曞爼顢楁径瀣珫闂備胶绮崹闈浢洪妸褏鐭欓煫鍥ㄦ尨閺�浠嬫煟濡鍤嬬�规悶鍎甸弻锝呂旈敓钘壩涘┑瀣仒妞ゆ洩鎷峰┑顕嗘嫹闂佺偨鍎寸亸娆戠不濮橆剦娓婚柕鍫濇婢ь剛绱掗鍏兼拱缂佸倸绉电缓浠嬪川婵犲嫬骞堥梻浣告惈閸婅棄鈻旈弴鐔哄ⅰ缂傚倸鍊风粈渚�鎯屾担骞夸粓闁告縿鍎插畷鍙夌節闂堟侗鍎忛柣鎰攻閵囧嫰顢楁径濠傚П闂佹悶鍎崝搴ㄥ储闁秵鈷戦梻鍫熶緱濡牓鏌涢悩宕囶暡缂佸倹甯℃慨锟介柕鍫濇閸橆亪妫呴銏″偍闁稿骸纾竟鏇犳崉閵娧咃紲闂佺粯蓱瑜板啴鍩涢弮鍫熺叆闁绘梻鍎ゅ▍鏇㈡煙閾忣偅灏扮紒鏃傚枑缁绘繈宕惰閻涖儵姊洪崫鍕檨閻忕偠濮ら鎸庝繆閻愵亜锟芥牕煤閳哄懎绠柣鎴ｅГ閻撴稓锟界櫢鎷烽悗锝庡墮閸╁矂姊虹�圭姵顥夋い锕傛涧閻ｇ兘鏁撻悩鍐诧拷鐑芥倵閻㈡鐒剧紓宥呮閳规垶骞婇柛濠冾殕閹便劑鎮滈挊澶岋紱闂佺粯鍔曢悘姘跺汲濠婂牊鐓欓柣鎴炆戠粈鍫澝瑰鍕噰婵﹦绮幏鍛存嚍閵壯侊拷濠囨⒑閸濄儱校闁圭懓娲ら锝夊蓟閵夘喗鏅濋梺闈涚墕閹冲酣鎮樻繝鍐瘈闁汇垽娼ф牎闂佽偐鎳撴晶鐣屽垝婵犳凹鏁嬮柨鐔剁矙瀵濡舵径濠勭暢闂佸湱鍎ら崹鍨叏閵忋倖鈷戦柛娑橆焵閹达箑绠栭柛灞惧嚬濞兼牗绻涘顔荤盎缂佺姴缍婇弻锝夊箛椤撶偟绁锋繝娈垮枛閻倸顫忛搹鍦煓闁圭楠搁弨顓熶繆閻愬瓨缍戦柟璇х磿缁碍娼忛妸褏鐦堥梺鍛婂姦娴滆泛霉閸曨垱鐓熼幖鎼灣缁夌敻鏌涚�ｎ亝顥㈢�规洏鍨介獮鏍ㄦ媴閸忓瀚肩紓鍌欑椤戝牆鈻旈弴銏″�块柛褎顨嗛埛鎺楁煕閺囥劌浜滄い蹇ｅ亰閺屻劑鎮㈢拠娈嬫捇鏌ｉ弮鎴濆⒋妤犵偛绻橀弫鎾绘晸閿燂拷 by changhao
					mkdb.Procedure.pexecuteWhileCommit(new ClanRank(clan.toData()));
					mkdb.Procedure.pexecuteWhileCommit(new fire.pb.ranklist.proc.PFactionZongHeProc(clan.getKey(), false));
					mkdb.Procedure.pexecuteWhileCommit(new fire.pb.clan.fight.PClanFightUpdateClanLevel(clan.getKey(), clan.getClanlevel()));
				}
				else if (id == ClanManage.GoldBank)
				{
					int level = clan.getHouse().get(ClanManage.GoldBank);
					fire.pb.clan.SClanGoldBank bank =  fire.pb.main.ConfigManager.getInstance().getConf(fire.pb.clan.SClanGoldBank.class).get(level);
					if (bank == null)
					{
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 143583, null);
						return true;
					}
				
					fire.pb.clan.SClanGoldBank l =  fire.pb.main.ConfigManager.getInstance().getConf(fire.pb.clan.SClanGoldBank.class).get(level + 1);
					if (l == null) //濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ゆい顓犲厴瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戦柟鑲╁仜婵″ジ鏌涙繝鍌涘仴鐎殿喛顕ч埥澶愬閳哄倹娅囬梻浣瑰缁诲倸螞濞戔懞鍥Ψ瑜忕壕钘壝归敐鍛儓鐏忓繘姊洪崨濠庢畷濠电偛锕ら锝囨嫚濞村顫嶅┑鈽嗗灦閺�閬嶅棘閿熶粙姊绘担鍛婂暈婵炶绠撳畷鎴﹀礋椤掍礁寮块梺闈涚箞閸婃牠鍩涢幋鐐电闁煎ジ顤傞崵娆愵殽閻愭惌娈滈柡宀�鍠栭幃鐑芥偋閸繃鐏庨柣搴㈩問閸犳牠鈥﹂悜钘夋瀬闁归偊鍘肩欢鐐测攽閻樻彃顏撮柛姘嚇濮婄粯鎷呴悷閭﹀殝缂備浇顕ч崐姝岀亱濡炪倖鎸鹃崐锝呪槈閵忕姷顦板銈嗘尵婵兘鏁嶅┑鍥╃闁瑰墽顥愭竟姗�鏌ㄩ弴妯哄姢闁跨喕濮ら懝鍓х礊婵犲偆娼栭柧蹇撴贡閻瑩鏌熺粙鍨劉闁圭柉浜槐鎾存媴閸撴彃鍓遍柣銏╁灙閿熻棄纾弳锕傛煥濠靛棛澧㈤柣銈忔嫹闂備礁鎼崐鍛婃櫠閻ｅ瞼涓嶆慨妯垮煐閳锋垿姊婚崼鐔恒�掑褎娲熼弻鐔风暋闁箑鍓堕悗瑙勬礃濞茬喖鐛崶顒佸亱闁割偅绻愰幏鐑藉垂椤愶絽寮垮┑顔筋殔濡鏅堕幍顔剧＜濠㈣泛顑嗛妵婵嬫煛瀹�锟介崰鏍�佸▎鎴犻┏閻庯綆鍋嗛弳顓㈡⒒娴ｇ儤鍤�鐎殿喖鐖奸獮鎰板礃閼碱剚娈鹃梺缁樻⒒閳峰牓寮崱娑欑厱閻忕偠顕ч敓鑺ョ墳閳兘姊婚崒姘拷鎼佸磹閻戣姤鍊块柨鏃�鎷濋幏椋庣箔濞戞ɑ鍣归柡瀣墢閿熻棄绠嶉崕閬嵥囬娑辨敯闂傚倷绀侀幉鈥趁洪敃鍌氬瀭闁规鍠氭稉宥呪攽閻樺磭顣查柣鎾跺枛閺岀喖鏌囬敃锟介悘鈩冦亜閵夈儺妲搁棁澶愭煟濞嗘瑦瀚归梺闈╃秶缂嶄線鐛崘銊庢棃宕橀埡浣圭�梻浣告啞濞诧箓宕滃☉銏℃櫖婵鎷锋慨濠冩そ瀹曘劍绻濋崘锝嗗闂備焦鎮堕崝灞筋焽閳╁啩绻嗛悗娑櫳戞刊鎾煕閹惧啿绾х�点倖妞藉铏规崉閵娿儲鐎虹紓渚囧枟閻熲晠鎮伴锟藉畷姗�顢氶崨顔芥珕闂備礁澹婇崑鍛崲閸屾粎鐜绘繛鎴烇供濞撳鏌曢崼婵囶棤濠⒀屽墴閺屾盯骞嬮悩鍐叉畬闁告浜跺鍫曞醇濞戞ê顬嬬紓浣叉閹风兘姊绘担鍦菇闁搞劏妫勯…鍥槻闁哄棌鏅犲缁樻媴閼恒儯锟藉啴鏌ｉ幒鐐电暤妤犵偛鍟村畷鎺戭潩鏉堛劍顔曢梻浣侯攰閹活亪姊介崟顖氱；闁规壆澧楅崑锝夋煕閵夘喕绨婚柣銊у劋閵囧嫰寮懗顖氼伃濡炪値浜滈崯瀛樹繆閸洖宸濇い鏍ㄧ矤閸炲爼姊绘担铏瑰笡妞ゃ劌鎳庤灋婵炴垶鑹鹃崹婵嗏攽閻樺啿鍤柡浣哥Ч閺岋綁骞囬澶婃闂佸憡鐟ュΛ婵嗩潖閾忓湱纾兼俊顖濆吹椤︺儵姊虹粙鍖″伐婵狅拷闁秵鏅搁柤鎭掑劤閸熸煡鏌熼崙銈嗗? by changhao
					{
						java.util.ArrayList<String> args = new java.util.ArrayList<String>();
						Integer s = level;
						args.add(s.toString());
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 160226, args);
						return true;						
					}
					
					if (money < ClanUtils.getBuildLevelupMax(clan).get(ClanManage.GoldBank)) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氼參宕崇壕瀣ㄤ汗闁圭儤鍨归崐鐐烘偡濠婂啰绠荤�殿喗濞婇弫鍐磼濞戞艾骞堟俊鐐�ら崢浠嬪垂閸偆顩叉繝闈涱儐閻撴洘绻涢崱妤冪缂佺姴顭烽弻鈥崇暆鐎ｎ剛袦婵犳鍣幏鐑芥⒑闂堟稓绠氶柡鍛箞瀹曟繈宕妷褏锛濇繛鎾磋壘閿曘儳锟芥俺顫夌换婵嬪閿濆懐鍘梺鍛婃⒐閻楃娀骞冮敓鐘参ㄩ柍鍝勫�婚崢鎼佹⒑閹肩偛鍔楅柡鍛♁缁傛帒顭ㄩ崼鐔哄弳闂佺粯姊荤划顖炈夋径鎰厵闁兼亽鍎抽惌宀勬煕閹烘挸娴柡浣瑰姍瀹曘劑宕掑☉娆樻閻庤娲忛崝鎴︺�佸▎鎾崇畾鐟滃秶绮绘导瀛樷拺閻犲洦鐓￠妤冪磼閻樿尙效鐎规洘娲樺蹇涒�﹂幋鐑嗗晬闂備礁鎲＄缓鍧楀磿閺屻儱姹叉繝濠傜墛閻撶喖鏌熼柇锕�鏋涢柛鏂款儔閺岋綁骞樼�涙顦伴梺鍝勬湰濞叉ê顕ラ崟顐嬬喖鎮滃Ο闂撮偗婵犵數濮幏鍐礃閸撗冩倯闂備礁鎼径鍥礈濠靛绠柛娑欐綑瀹告繂鈹戦悩鎻掝劉闁挎稑妫濆缁樻媴閸涘﹥鍎撻梺鍝勭墱閸撶喖骞嗛崟顖ｆ晬婵鍘у▓銊╂⒑閸︻叀妾搁柛鐘崇墬閸庮偊姊绘笟锟藉褔藝椤撱垹纾块柛婵嗗閻掕棄鈹戦悩宕囶暡闁抽攱甯掗湁闁挎繂鎳忛崯鐐烘煕閻斿搫浠遍柡宀�鍠撴禍鎼佸冀閵婏妇褰嬮柣搴ゎ潐濞测晝绱炴担鍝ユ殾婵鎷烽柍銉畵楠炲鎮欓悽纰樻瀱婵犵數濮烽弫鎼佸磻濞戞鐔哥節閸愵亶娲稿┑鐘诧工閸犳岸宕崨顔剧瘈闂傚牊绋掗ˉ鎴︽煛閿熻姤绂掔�ｎ偆鍘藉┑鈽嗗灥椤曆呭緤婵犳碍鐓涢柛鈩冾焽閹冲嫰鏌曢崶褍顏柡浣稿�婚幉鎾礋椤掑倸缍冨┑鐘愁問閸犳牠鏁冮妷銉富濞寸姴顑囧畵渚�鏌″搴″箺闁稿﹦鍏橀弻鐔虹磼濡桨鍒婇梺璇查閻°劎鎹㈠┑瀣仺闂傚牊鍒�閻愮儤鐓曢柕濠忛檮閵囨繈鏌℃担绋挎殻濠殿噯鎷烽梺闈涚墕閹冲繐危椤掑嫭鈷戦梻鍫熺〒缁犲啿鈹戦锝呭籍鐎规洏鍎抽敓鏂ょ秵娴滃爼鎮㈤崱娑欏仯闁告繂瀚ㄩ崑銊╂煥閻斿搫孝闁绘挻鐩弻娑樷槈閸楃偞鐏撻梺鍛娚戦幑鍥ь潖濞差亜宸濆┑鐘插閻ｇ敻鏌ｆ惔銏犲毈闁告挾鍠栧顐﹀箻缂佹ê浠奸柣蹇曞仧閸嬫挸袙閸惊鏃堟偐闂堟稐绮剁紓浣虹帛閸旀宕ｉ崨顓ф富闁靛牆鎳愮粻浼存煙閸愬樊妯�妤犵偛绻愮叅妞ゅ繐鎳夐幏娲⒑缁嬭法绠绘俊顐㈡健閹虫粓顢旈崼鐔哄幈闁硅壈鎻槐鏇熸櫏婵＄偑鍊戦崹鍝勎涢崘銊ф殾闁惧繗顫夊畷澶愭煟閹寸伝顏堝几閻樺樊娓婚柕鍫濆暙閻忣亞绱掔�ｎ偄鐏撮柍銉畵婵℃悂鍩℃担鍝ョ崺婵＄偑鍊栭悧顓犲緤閸撗呮噮濠电姷鏁告慨鐑藉极閹间礁纾婚柣妯款嚙缁犲灚銇勮箛鎾搭棤缂侊拷婵犲洦鐓ラ柣鏃囶嚙琚氱紓浣虹帛閻╊垰鐣烽鍫濈妞ゅ繐鎳庢禒鐟扳攽閻橆喖鐏辨い顐㈩槸鐓ら柣鏃堫棑閺嗭附淇婇妶鍛櫤闁抽攱甯￠幃妤呮濞戞瑦鍠愰梺浼欑秮缁犳牕顫忕紒妯肩懝闁跨喕妫勯…鍥樄闁诡啫鍥у耿婵炲棙鍔曟惔濠囨⒑閻熼偊鍤熷┑顖涙尦楠炲繐鐣￠柇锔藉兊闁哄鐗勯崝灞解枔鐏炵瓔娓婚柕鍫濈凹缁ㄥ鏌涢悢椋庢憼濞ｅ洤锕獮鍡涘箥椤旂偓婢戦梻浣告惈濞层劍鎱ㄩ棃娑掓灁闁绘挸绨堕弨浠嬫煟閹邦垰鐨洪柟鐣屽Х缁辨帡顢欓懖鈺冨姱闂佽鍠撻崕鑼紦娴犲宸濆┑鐘插�风划褎淇婇悙顏勶拷鏍洪埡鍛濡炲鍑介幏宄扳枔閸喗鐏嗙紓渚囧枟閻熲晠濡存担鍓叉建闁跨喍绮欓獮鍐閵堝懎绐涙繝鐢靛Т缁ㄥジ骞嬮悜鑺モ拻闁稿本鑹鹃敓钘夊槻闇夐柛銉戯拷閺嬫牠鏌￠崶銉ョ仼闂傚偆鍨堕弻銊╁即閻愯鎷烽崫銉т笉妞ゆ牜鍋為悡銉╂煟閺囩偛锟藉湱锟芥熬鎷�? by changhao
					{
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 160224, null);
						return true;
					}
					
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂傚洤顦甸弻銊モ攽閸♀晜效婵炲瓨鍤庨崐婵嬪蓟閵堝绾ч柟绋块娴犳潙鈹戦纭锋敾婵＄偘绮欓妴浣肝旈崨顔芥闂佷紮绲介惉濂告儗閹剧粯鐓涢悘鐐额嚙閸旀粓鏌￠崨顔藉�愰柡宀嬬畱铻ｅ〒姘煎灡绗戦梻浣芥硶閸犳洖螞閸曨偒鐒介柨鐔哄Т杩濇繛杈剧悼绾爼寮告惔銊︾厵闁诡垎鍜冪礊濡炪倧瀵岄崣鍐箖瀹勯偊鐓ラ柛鎰典簽椤旀帡鏌﹀Ο鑽ょ畺闁靛洤瀚板浠嬪Ω瑜嬮敓鑺ュ笧缁辨帡鎮╅懡銈囨毇闂佸搫鐬奸崰鏍嵁閸℃凹妾ㄩ梺鎼炲�楅崰鏍蓟濞戙垺鍋勯柛婵勫劚瀵劑姊洪崫鍕伇闁哥姵鐗犻獮鍐煥閸喎娈熼梺闈涱檧闂勫嫬鈻撻崨濠佺箚闁绘劦浜滈敓鑺ュ灴瀹曟繃绻濋崶褏锛熼梺姹囧灮椤牏绮婚弽銊х闁糕剝蓱鐏忣厾绱掗悪娆忔处閻撴瑩鎮楀☉娆樼劷缂佺姰鍎茬换娑㈠礂閻撳骸鎽靛┑顔硷功缁垶骞忛崨瀛樺殟闁靛缍囬幏鐑藉礃椤旂晫鍘介梺纭呮閸嬬喖鎮鹃崹顐闁绘劖娼欓悘瀵革拷瑙勬礀閻栧ジ銆佸Δ鍛櫢濞寸姴顑呴崙鐘层�掑鐐闂佸搫鐬奸崰鏍х暦濠婂棭妲鹃柣銏╁灡閻╊垶寮婚敓鐘插窛妞ゆ棁妫勯敓鑺ュ姍閺岋紕浠︾拠鎻掝潎闂佽鍠撻崐婵嗙暦閹烘垟妲堟慨妤�妫旂槐锟� by changhao
					boolean ok = ClanManage.AddClanMoney(-bank.levelupcost, clan);
					if (ok == false)
					{
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 160224, null);
						return true;
					}
					
					clan.getHouse().put(ClanManage.GoldBank, level + 1);
					
					sClanLevelup.change.put(ClanManage.GoldBank, level + 1);
					sClanLevelup.money = clan.getMoney();	
					uplevel=level + 1;//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ偆娲撮挊婵嬫煟閵忋埄鐒鹃柡瀣╃窔閺岀喖宕滆鐢盯鏌涚�ｎ偄濮堥柕鍥у瀵挳鎮欓幖顓燂紒闂佽瀛╅懝鍓х礊婵犲洤钃熸繛鎴欏灩缁犳盯姊婚崼鐔衡檨闁诲繐鐗撻幃妤呮偡閻楀牆鏆堢紓浣筋嚙閸熷瓨淇婇悽绋跨妞ゆ牗姘ㄩ濠囨⒑閻熸壆鎽犵紒璇插暣瀹曟劙顢涘锝嗘杸闂佹寧绋戠�氼剚绂掗埡浣叉斀妞ゆ柨鎼敓鑺ョ墱缁碍娼忛妸褏鐦堥梺鎼炲劀閸滀礁鏅ｆ繝鐢靛仩閹活亞绱為敓鑺ャ亜椤愩埄妲搁柍璇茬Ч瀹曞崬鈻庨幋鐙呯闯闂備胶顭堥張顒勬偡瑜斿畷婵嗩吋婢跺鍙嗛梺鍝勬处椤ㄥ棗鈻嶆繝鍕舵嫹鐟欏嫭澶勯柛銊ゅ嵆椤㈡﹢宕楅悡搴ｇ獮闁诲函鎬ラ崟顐紲濠电姷鏁搁崑鐘诲箵椤忓棛绀婇柨鐔诲Г閵囧嫰顢曢姀鈺傗枅閻庤娲橀崹鍧楀箖閳哄啰纾兼俊顖滃帶楠炲牓姊洪悷鏉挎倯闁伙綆浜畷鐟懊洪鍕庯附绻濋棃娑氬⒊闁圭兘顥撻幉鎾礋椤掑偆妲扮紓鍌欑贰閸犳牠鎯岄崒鐐叉槬闁靛繆鍓濋崕鐔兼煏婵炲灝鍔ゆい鎾存そ濮婅櫣绱掑Ο鍝勵潓閻庢鍠栭悥濂稿箖濡ゅ拋鏁囬柕蹇婃閹风粯绻涙潏鍓ф偧闁硅櫕鎹囬、姘煥閸曨厾顔曢梺鍛婄懃椤﹁鲸鏅堕悽纰夋嫹鐟欏嫭绀冮柛鏃�鐟ラ悾鐑筋敃閿曪拷鍞悷婊冪灱缁厽寰勯幇顓炰画濠电姴锕ら幊搴ㄣ�傛總鍛婂仺妞ゆ牗绋戠粭褔鏌ｉ妷顔绘捣妞わ箑缍婇弻锛勪沪閸撗勫垱濡炪們鍨哄ú鐔煎极閹版澘鐐婇柍鍝勫暞濞堝ジ姊婚崒娆戝妽濠电偛锕銊╁础閻戝棙缍庨梺鐓庮潟閸婃牠锝為弴銏＄厵闁绘垶蓱椤ユ牠鏌熸搴″幋闁轰焦鍔栭幆鏂库攽閸パ勭亾闂傚倷鑳剁划顖炲箰閹间礁围闁归棿绀侀拑鐔兼煃閵夈儳锛嶉柡鍡楁閹鏁愭惔鈥愁潾閻炴熬绠撳缁樻媴閼恒儯锟藉啴鏌ｉ幒鐐电暤鐎规洘绻傞埢搴ょ疀閺囩喐顔曢梻浣虹帛閹稿摜锟藉灚甯￠幃锟犲Ψ閳哄倻鍘遍梺纭呭焽閸斿秴鈻嶉崨瀛樼厱闁规崘鍩栭弳鈺冪磼鏉堛劍宕岀�规洘甯掗～婵嬵敆婵犲啫顏堕悗鐟板閸ｇ銇愰幒鎴犲�為梺闈涱煭缁茶偐鍒掗幘缁樷拺闁告稑锕︾紓姘舵煕鎼淬垻鍙�鐎殿喖鍟块…銊╁醇閻斿搫骞嶉梻浣虹帛閸ㄥ爼鏁冮埡浣叉灁闁哄啫鐗婇悡鐔兼煙缂併垹鐏查柟椋庡厴楠炲洦鎷呴崫鍕毄闂備浇宕垫慨鎯ь浖閵娧勫闁挎洖鍊归崑鍌涖亜閹哄秷鍏岀紒鐘插⒔缁辨帒螖閿熶粙骞栭锝嗗弿闁稿瞼鍋為悡娑㈡倶閻愭彃鈷旀繛鍙夋尦閺屾盯鍩℃担鍓蹭純閻庤娲橀敃銏犵暦濠婂棭妲绘繝娈垮枛閻栫厧顫忕紒妯肩懝闁跨喕妫勯…鍥樄闁炽儻绠撻、姗�鎮╅悽纰夌闯婵犳鍠楅…鍫熴仈缁嬭法鏆﹂柡灞诲劜閻撴洟鏌嶉埡浣告殶闁冲彞绶氶弻锝夊箻瀹曞洨顔掗梺鍝勬湰閻╊垶銆侀弴銏℃櫜闁搞儮鏅濋弳顐︽⒒娴ｇ儤鍤�闁告艾顑夊畷婵嬪冀椤撶倣锕傛煕閺囥劌澧柛搴ｅ枛閺屾洝绠涙繝蹇斿鐎规洖娴勭槐锕傛⒒閸屾瑧顦﹂柟纰卞亰閹绺界粙璺ㄧ崶闂佸搫璇為崨顔筋啎婵犵數鍋涘Λ娆撳箰缁嬫寧绾梻鍌欒兌绾爼宕滃┑瀣拷鍐疀閺傛鍤ら梺璺ㄥ櫐閹凤拷
					cost=bank.levelupcost;//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄闁挎繂妫Λ鍕⒑閸濆嫷鍎庣紒鑸靛哺瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈嗐亜椤撶姴鍘寸�殿喖顭烽弫鎰緞婵犲嫮鏉告俊鐐�栫敮濠囨倿閿曞倸纾块柟鍓х帛閳锋垿鏌熼懖鈺佷粶濠碘�炽偢閺屾稒绻濋崒娑樹淮閻庢鍠栭…鐑藉极閹邦厼绶炲┑鐘插缂嶅倿姊绘担铏瑰笡闁挎岸鏌涢悢閿嬪仴鐎殿喗濞婂畷濂稿Ψ閿旇瀚肩紓鍌欑椤戝棝顢栧▎鎾崇？闊洦鏌ｆ禍婊堟煙鐎涙绠ユ俊顖ゆ嫹闁诲孩顔栭崰鏍�﹂柨瀣╃箚闁归棿绀侀悡娑㈡煕鐏炲墽鐓紒銊ょ矙濮婄粯鎷呮笟顖滃姼闂佸搫鐗滈崜娑氬垝濞嗘挸绠ｉ柨鏃傜帛閺呮粓姊虹捄銊ユ珢闁瑰嚖鎷�??
					opid=FactionOpbean.TYPE_GOLD_UP;
					
					SendAllFactionMemeber(clan, ClanManage.GoldBank, level + 1);
				}
				else if (id == ClanManage.DrugStone)
				{
					int level = clan.getHouse().get(ClanManage.DrugStone);
					fire.pb.clan.SClanDrugstore drugstone =  fire.pb.main.ConfigManager.getInstance().getConf(fire.pb.clan.SClanDrugstore.class).get(level);
					if (drugstone == null)
					{
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 143583, null);
						return true;
					}
				
					fire.pb.clan.SClanDrugstore l =  fire.pb.main.ConfigManager.getInstance().getConf(fire.pb.clan.SClanDrugstore.class).get(level + 1);
					if (l == null) //濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ゆい顓犲厴瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戦柟鑲╁仜婵″ジ鏌涙繝鍌涘仴鐎殿喛顕ч埥澶愬閳哄倹娅囬梻浣瑰缁诲倸螞濞戔懞鍥Ψ瑜忕壕钘壝归敐鍛儓鐏忓繘姊洪崨濠庢畷濠电偛锕ら锝囨嫚濞村顫嶅┑鈽嗗灦閺�閬嶅棘閿熶粙姊绘担鍛婂暈婵炶绠撳畷鎴﹀礋椤掍礁寮块梺闈涚箞閸婃牠鍩涢幋鐐电闁煎ジ顤傞崵娆愵殽閻愭惌娈滈柡宀�鍠栭幃鐑芥偋閸繃鐏庨柣搴㈩問閸犳牠鈥﹂悜钘夋瀬闁归偊鍘肩欢鐐测攽閻樻彃顏撮柛姘嚇濮婄粯鎷呴悷閭﹀殝缂備浇顕ч崐姝岀亱濡炪倖鎸鹃崐锝呪槈閵忕姷顦板銈嗘尵婵兘鏁嶅┑鍥╃闁瑰墽顥愭竟姗�鏌ㄩ弴妯哄姢闁跨喕濮ら懝鍓х礊婵犲偆娼栭柧蹇撴贡閻瑩鏌熺粙鍨劉闁圭柉浜槐鎾存媴閸撴彃鍓遍柣銏╁灙閿熻棄纾弳锕傛煥濠靛棛澧㈤柣銈忔嫹闂備礁鎼崐鍛婃櫠閻ｅ瞼涓嶆慨妯垮煐閳锋垿姊婚崼鐔恒�掑褎娲熼弻鐔风暋闁箑鍓堕悗瑙勬礃濞茬喖鐛崶顒佸亱闁割偅绻愰幏鐑藉垂椤愶絽寮垮┑顔筋殔濡鏅堕幍顔剧＜濠㈣泛顑嗛妵婵嬫煛瀹�锟介崰鏍�佸▎鎴犻┏閻庯綆鍋嗛弳顓㈡⒒娴ｇ儤鍤�鐎殿喖鐖奸獮鎰板礃閼碱剚娈鹃梺缁樻⒒閳峰牓寮崱娑欑厱閻忕偠顕ч敓鑺ョ墳閳兘姊婚崒姘拷鎼佸磹閻戣姤鍊块柨鏃�鎷濋幏椋庣箔濞戞ɑ鍣归柡瀣墢閿熻棄绠嶉崕閬嵥囬娑辨敯闂傚倷绀侀幉鈥趁洪敃鍌氬瀭闁规鍠氭稉宥呪攽閻樺磭顣查柣鎾跺枛閺岀喖鏌囬敃锟介悘鈩冦亜閵夈儺妲搁棁澶愭煟濞嗘瑦瀚归梺闈╃秶缂嶄線鐛崘銊庢棃宕橀埡浣圭�梻浣告啞濞诧箓宕滃☉銏℃櫖婵鎷锋慨濠冩そ瀹曘劍绻濋崘锝嗗闂備焦鎮堕崝灞筋焽閳╁啩绻嗛悗娑櫳戞刊鎾煕閹惧啿绾х�点倖妞藉铏规崉閵娿儲鐎虹紓渚囧枟閻熲晠鎮伴锟藉畷姗�顢氶崨顔芥珕闂備礁澹婇崑鍛崲閸屾粎鐜绘繛鎴烇供濞撳鏌曢崼婵囶棤濠⒀屽墴閺屾盯骞嬮悩鍐叉畬闁告浜跺鍫曞醇濞戞ê顬嬬紓浣叉閹风兘姊绘担鍦菇闁搞劏妫勯…鍥槻闁哄棌鏅犲缁樻媴閼恒儯锟藉啴鏌ｉ幒鐐电暤妤犵偛鍟村畷鎺戭潩鏉堛劍顔曢梻浣侯攰閹活亪姊介崟顖氱；闁规壆澧楅崑锝夋煕閵夘喕绨婚柣銊у劋閵囧嫰寮懗顖氼伃濡炪値浜滈崯瀛樹繆閸洖宸濇い鏍ㄧ矤閸炲爼姊绘担铏瑰笡妞ゃ劌鎳庤灋婵炴垶鑹鹃崹婵嗏攽閻樺啿鍤柡浣哥Ч閺岋綁骞囬澶婃闂佸憡鐟ュΛ婵嗩潖閾忓湱纾兼俊顖濆吹椤︺儵姊虹粙鍖″伐婵狅拷闁秵鏅搁柤鎭掑劤閸熸煡鏌熼崙銈嗗? by changhao
					{
						java.util.ArrayList<String> args = new java.util.ArrayList<String>();
						Integer s = level;
						args.add(s.toString());
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 160226, args);
						return true;						
					}
					
					if (money < ClanUtils.getBuildLevelupMax(clan).get(ClanManage.DrugStone)) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氼參宕崇壕瀣ㄤ汗闁圭儤鍨归崐鐐烘偡濠婂啰绠荤�殿喗濞婇弫鍐磼濞戞艾骞堟俊鐐�ら崢浠嬪垂閸偆顩叉繝闈涱儐閻撴洘绻涢崱妤冪缂佺姴顭烽弻鈥崇暆鐎ｎ剛袦婵犳鍣幏鐑芥⒑闂堟稓绠氶柡鍛箞瀹曟繈宕妷褏锛濇繛鎾磋壘閿曘儳锟芥俺顫夌换婵嬪閿濆懐鍘梺鍛婃⒐閻楃娀骞冮敓鐘参ㄩ柍鍝勫�婚崢鎼佹⒑閹肩偛鍔楅柡鍛♁缁傛帒顭ㄩ崼鐔哄弳闂佺粯姊荤划顖炈夋径鎰厵闁兼亽鍎抽惌宀勬煕閹烘挸娴柡浣瑰姍瀹曘劑宕掑☉娆樻閻庤娲忛崝鎴︺�佸▎鎾崇畾鐟滃秶绮绘导瀛樷拺閻犲洦鐓￠妤冪磼閻樿尙效鐎规洘娲樺蹇涒�﹂幋鐑嗗晬闂備礁鎲＄缓鍧楀磿閺屻儱姹叉繝濠傜墛閻撶喖鏌熼柇锕�鏋涢柛鏂款儔閺岋綁骞樼�涙顦伴梺鍝勬湰濞叉ê顕ラ崟顐嬬喖鎮滃Ο闂撮偗婵犵數濮幏鍐礃閸撗冩倯闂備礁鎼径鍥礈濠靛绠柛娑欐綑瀹告繂鈹戦悩鎻掝劉闁挎稑妫濆缁樻媴閸涘﹥鍎撻梺鍝勭墱閸撶喖骞嗛崟顖ｆ晬婵鍘у▓銊╂⒑閸︻叀妾搁柛鐘崇墬閸庮偊姊绘笟锟藉褔藝椤撱垹纾块柛婵嗗閻掕棄鈹戦悩宕囶暡闁抽攱甯掗湁闁挎繂鎳忛崯鐐烘煕閻斿搫浠遍柡宀�鍠撴禍鎼佸冀閵婏妇褰嬮柣搴ゎ潐濞测晝绱炴担鍝ユ殾婵鎷烽柍銉畵楠炲鎮欓悽纰樻瀱婵犵數濮烽弫鎼佸磻濞戞鐔哥節閸愵亶娲稿┑鐘诧工閸犳岸宕崨顔剧瘈闂傚牊绋掗ˉ鎴︽煛閿熻姤绂掔�ｎ偆鍘藉┑鈽嗗灥椤曆呭緤婵犳碍鐓涢柛鈩冾焽閹冲嫰鏌曢崶褍顏柡浣稿�婚幉鎾礋椤掑倸缍冨┑鐘愁問閸犳牠鏁冮妷銉富濞寸姴顑囧畵渚�鏌″搴″箺闁稿﹦鍏橀弻鐔虹磼濡桨鍒婇梺璇查閻°劎鎹㈠┑瀣仺闂傚牊鍒�閻愮儤鐓曢柕濠忛檮閵囨繈鏌℃担绋挎殻濠殿噯鎷烽梺闈涚墕閹冲繐危椤掑嫭鈷戦梻鍫熺〒缁犲啿鈹戦锝呭籍鐎规洏鍎抽敓鏂ょ秵娴滃爼鎮㈤崱娑欏仯闁告繂瀚ㄩ崑銊╂煥閻斿搫孝闁绘挻鐩弻娑樷槈閸楃偞鐏撻梺鍛娚戦幑鍥ь潖濞差亜宸濆┑鐘插閻ｇ敻鏌ｆ惔銏犲毈闁告挾鍠栧顐﹀箻缂佹ê浠奸柣蹇曞仧閸嬫挸袙閸惊鏃堟偐闂堟稐绮剁紓浣虹帛閸旀宕ｉ崨顓ф富闁靛牆鎳愮粻浼存煙閸愬樊妯�妤犵偛绻愮叅妞ゅ繐鎳夐幏娲⒑缁嬭法绠绘俊顐㈡健閹虫粓顢旈崼鐔哄幈闁硅壈鎻槐鏇熸櫏婵＄偑鍊戦崹鍝勎涢崘銊ф殾闁惧繗顫夊畷澶愭煟閹寸伝顏堝几閻樺樊娓婚柕鍫濆暙閻忣亞绱掔�ｎ偄鐏撮柍銉畵婵℃悂鍩℃担鍝ョ崺婵＄偑鍊栭悧顓犲緤閸撗呮噮濠电姷鏁告慨鐑藉极閹间礁纾婚柣妯款嚙缁犲灚銇勮箛鎾搭棤缂侊拷婵犲洦鐓ラ柣鏃囶嚙琚氱紓浣虹帛閻╊垰鐣烽鍫濈妞ゅ繐鎳庢禒鐟扳攽閻橆喖鐏辨い顐㈩槸鐓ら柣鏃堫棑閺嗭附淇婇妶鍛櫤闁抽攱甯￠幃妤呮濞戞瑦鍠愰梺浼欑秮缁犳牕顫忕紒妯肩懝闁跨喕妫勯…鍥樄闁诡啫鍥у耿婵炲棙鍔曟惔濠囨⒑閻熼偊鍤熷┑顖涙尦楠炲繐鐣￠柇锔藉兊闁哄鐗勯崝灞解枔鐏炵瓔娓婚柕鍫濈凹缁ㄥ鏌涢悢椋庢憼濞ｅ洤锕獮鍡涘箥椤旂偓婢戦梻浣告惈濞层劍鎱ㄩ棃娑掓灁闁绘挸绨堕弨浠嬫煟閹邦垰鐨洪柟鐣屽Х缁辨帡顢欓懖鈺冨姱闂佽鍠撻崕鑼紦娴犲宸濆┑鐘插�风划褎淇婇悙顏勶拷鏍洪埡鍛濡炲鍑介幏宄扳枔閸喗鐏嗙紓渚囧枟閻熲晠濡存担鍓叉建闁跨喍绮欓獮鍐閵堝懎绐涙繝鐢靛Т缁ㄥジ骞嬮悜鑺モ拻闁稿本鑹鹃敓钘夊槻闇夐柛銉戯拷閺嬫牠鏌￠崶銉ョ仼闂傚偆鍨堕弻銊╁即閻愯鎷烽崫銉т笉妞ゆ牜鍋為悡銉╂煟閺囩偛锟藉湱锟芥熬鎷�? by changhao
					{
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 160224, null);
						return true;
					}
					
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂傚洤顦甸弻銊モ攽閸♀晜效婵炲瓨鍤庨崐婵嬪蓟閵堝绾ч柟绋块娴犳潙鈹戦纭锋敾婵＄偘绮欓妴浣肝旈崨顔芥闂佷紮绲介惉濂告儗閹剧粯鐓涢悘鐐额嚙閸旀粓鏌￠崨顔藉�愰柡宀嬬畱铻ｅ〒姘煎灡绗戦梻浣芥硶閸犳洖螞閸曨偒鐒介柨鐔哄Т杩濇繛杈剧悼绾爼寮告惔銊︾厵闁诡垎鍜冪礊濡炪倧瀵岄崣鍐箖瀹勯偊鐓ラ柛鎰典簽椤旀帡鏌﹀Ο鑽ょ畺闁靛洤瀚板浠嬪Ω瑜嬮敓鑺ュ笧缁辨帡鎮╅懡銈囨毇闂佸搫鐬奸崰鏍嵁閸℃凹妾ㄩ梺鎼炲�楅崰鏍蓟濞戙垺鍋勯柛婵勫劚瀵劑姊洪崫鍕伇闁哥姵鐗犻獮鍐煥閸喎娈熼梺闈涱檧闂勫嫬鈻撻崨濠佺箚闁绘劦浜滈敓鑺ュ灴瀹曟繃绻濋崶褏锛熼梺姹囧灮椤牏绮婚弽銊х闁糕剝蓱鐏忣厾绱掗悪娆忔处閻撴瑩鎮楀☉娆樼劷缂佺姰鍎茬换娑㈠礂閻撳骸鎽靛┑顔硷功缁垶骞忛崨瀛樺殟闁靛缍囬幏鐑藉礃椤旂晫鍘介梺纭呮閸嬬喖鎮鹃崹顐闁绘劖娼欓悘瀵革拷瑙勬礀閻栧ジ銆佸Δ鍛櫢濞寸姴顑呴崙鐘层�掑鐐闂佸搫鐬奸崰鏍х暦濠婂棭妲鹃柣銏╁灡閻╊垶寮婚敓鐘插窛妞ゆ棁妫勯敓鑺ュ姍閺岋紕浠︾拠鎻掝潎闂佽鍠撻崐婵嗙暦閹烘垟妲堟慨妤�妫旂槐锟� by changhao
					boolean ok = ClanManage.AddClanMoney(-drugstone.levelupcost, clan);
					if (ok == false)
					{
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 160224, null);
						return true;
					}
					
					clan.getHouse().put(ClanManage.DrugStone, level + 1);
					
					sClanLevelup.change.put(ClanManage.DrugStone, level + 1);
					sClanLevelup.money = clan.getMoney();
					
					uplevel=level + 1;//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ偆娲撮挊婵嬫煟閵忋埄鐒鹃柡瀣╃窔閺岀喖宕滆鐢盯鏌涚�ｎ偄濮堥柕鍥у瀵挳鎮欓幖顓燂紒闂佽瀛╅懝鍓х礊婵犲洤钃熸繛鎴欏灩缁犳盯姊婚崼鐔衡檨闁诲繐鐗撻幃妤呮偡閻楀牆鏆堢紓浣筋嚙閸熷瓨淇婇悽绋跨妞ゆ牗姘ㄩ濠囨⒑閻熸壆鎽犵紒璇插暣瀹曟劙顢涘锝嗘杸闂佹寧绋戠�氼剚绂掗埡浣叉斀妞ゆ柨鎼敓鑺ョ墱缁碍娼忛妸褏鐦堥梺鎼炲劀閸滀礁鏅ｆ繝鐢靛仩閹活亞绱為敓鑺ャ亜椤愩埄妲搁柍璇茬Ч瀹曞崬鈻庨幋鐙呯闯闂備胶顭堥張顒勬偡瑜斿畷婵嗩吋婢跺鍙嗛梺鍝勬处椤ㄥ棗鈻嶆繝鍕舵嫹鐟欏嫭澶勯柛銊ゅ嵆椤㈡﹢宕楅悡搴ｇ獮闁诲函鎬ラ崟顐紲濠电姷鏁搁崑鐘诲箵椤忓棛绀婇柨鐔诲Г閵囧嫰顢曢姀鈺傗枅閻庤娲橀崹鍧楀箖閳哄啰纾兼俊顖滃帶楠炲牓姊洪悷鏉挎倯闁伙綆浜畷鐟懊洪鍕庯附绻濋棃娑氬⒊闁圭兘顥撻幉鎾礋椤掑偆妲扮紓鍌欑贰閸犳牠鎯岄崒鐐叉槬闁靛繆鍓濋崕鐔兼煏婵炲灝鍔ゆい鎾存そ濮婅櫣绱掑Ο鍝勵潓閻庢鍠栭悥濂稿箖濡ゅ拋鏁囬柕蹇婃閹风粯绻涙潏鍓ф偧闁硅櫕鎹囬、姘煥閸曨厾顔曢梺鍛婄懃椤﹁鲸鏅堕悽纰夋嫹鐟欏嫭绀冮柛鏃�鐟ラ悾鐑筋敃閿曪拷鍞悷婊冪灱缁厽寰勯幇顓炰画濠电姴锕ら幊搴ㄣ�傛總鍛婂仺妞ゆ牗绋戠粭褔鏌ｉ妷顔绘捣妞わ箑缍婇弻锛勪沪閸撗勫垱濡炪們鍨哄ú鐔煎极閹版澘鐐婇柍鍝勫暞濞堝ジ姊婚崒娆戝妽濠电偛锕銊╁础閻戝棙缍庨梺鐓庮潟閸婃牠锝為弴銏＄厵闁绘垶蓱椤ユ牠鏌熸搴″幋闁轰焦鍔栭幆鏂库攽閸パ勭亾闂傚倷鑳剁划顖炲箰閹间礁围闁归棿绀侀拑鐔兼煃閵夈儳锛嶉柡鍡楁閹鏁愭惔鈥愁潾閻炴熬绠撳缁樻媴閼恒儯锟藉啴鏌ｉ幒鐐电暤鐎规洘绻傞埢搴ょ疀閺囩喐顔曢梻浣虹帛閹稿摜锟藉灚甯￠幃锟犲Ψ閳哄倻鍘遍梺纭呭焽閸斿秴鈻嶉崨瀛樼厱闁规崘鍩栭弳鈺冪磼鏉堛劍宕岀�规洘甯掗～婵嬵敆婵犲啫顏堕悗鐟板閸ｇ銇愰幒鎴犲�為梺闈涱煭缁茶偐鍒掗幘缁樷拺闁告稑锕︾紓姘舵煕鎼淬垻鍙�鐎殿喖鍟块…銊╁醇閻斿搫骞嶉梻浣虹帛閸ㄥ爼鏁冮埡浣叉灁闁哄啫鐗婇悡鐔兼煙缂併垹鐏查柟椋庡厴楠炲洦鎷呴崫鍕毄闂備浇宕垫慨鎯ь浖閵娧勫闁挎洖鍊归崑鍌涖亜閹哄秷鍏岀紒鐘插⒔缁辨帒螖閿熶粙骞栭锝嗗弿闁稿瞼鍋為悡娑㈡倶閻愭彃鈷旀繛鍙夋尦閺屾盯鍩℃担鍓蹭純閻庤娲橀敃銏犵暦濠婂棭妲绘繝娈垮枛閻栫厧顫忕紒妯肩懝闁跨喕妫勯…鍥樄闁炽儻绠撻、姗�鎮╅悽纰夌闯婵犳鍠楅…鍫熴仈缁嬭法鏆﹂柡灞诲劜閻撴洟鏌嶉埡浣告殶闁冲彞绶氶弻锝夊箻瀹曞洨顔掗梺鍝勬湰閻╊垶銆侀弴銏℃櫜闁搞儮鏅濋弳顐︽⒒娴ｇ儤鍤�闁告艾顑夊畷婵嬪冀椤撶倣锕傛煕閺囥劌澧柛搴ｅ枛閺屾洝绠涙繝蹇斿鐎规洖娴勭槐锕傛⒒閸屾瑧顦﹂柟纰卞亰閹绺界粙璺ㄧ崶闂佸搫璇為崨顔筋啎婵犵數鍋涘Λ娆撳箰缁嬫寧绾梻鍌欒兌绾爼宕滃┑瀣拷鍐疀閺傛鍤ら梺璺ㄥ櫐閹凤拷
					cost=drugstone.levelupcost;//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄闁挎繂妫Λ鍕⒑閸濆嫷鍎庣紒鑸靛哺瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈嗐亜椤撶姴鍘寸�殿喖顭烽弫鎰緞婵犲嫮鏉告俊鐐�栫敮濠囨倿閿曞倸纾块柟鍓х帛閳锋垿鏌熼懖鈺佷粶濠碘�炽偢閺屾稒绻濋崒娑樹淮閻庢鍠栭…鐑藉极閹邦厼绶炲┑鐘插缂嶅倿姊绘担铏瑰笡闁挎岸鏌涢悢閿嬪仴鐎殿喗濞婂畷濂稿Ψ閿旇瀚肩紓鍌欑椤戝棝顢栧▎鎾崇？闊洦鏌ｆ禍婊堟煙鐎涙绠ユ俊顖ゆ嫹闁诲孩顔栭崰鏍�﹂柨瀣╃箚闁归棿绀侀悡娑㈡煕鐏炲墽鐓紒銊ょ矙濮婄粯鎷呮笟顖滃姼闂佸搫鐗滈崜娑氬垝濞嗘挸绠ｉ柨鏃傜帛閺呮粓姊虹捄銊ユ珢闁瑰嚖鎷�??
					opid=FactionOpbean.TYPE_DRUGSTONE_UP;
					
					SendAllFactionMemeber(clan, ClanManage.DrugStone, level + 1);
					//濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮诲☉妯锋婵鐗婇弫楣冩⒑閸涘﹦鎳冪紒缁樺姍濠�渚�姊虹粙璺ㄧ闁告艾顑囩槐鐐哄箣閿旂晫鍘遍梺闈涱焾閸庨亶鏁撻挊澶嬪仴鐎殿喖顭烽弫鎰緞婵犲嫷鍟嬮柣搴ゎ潐濞叉牕煤閵堝浼犳繛宸簼閳锋垿鏌涘┑鍡楊伌闁稿孩鍔欓弻锝呂旀笟鍥ㄧ暭闂佺懓绠嶉崹褰掑煡婢舵劕顫呴柣妯活問閸氬懘姊绘担铏瑰笡闁告梹鐟ラ…鍥樄鐎殿喗濞婇弫鎾绘偐閺傘儲瀚奸梻浣藉吹閸犳劕顭垮Ο浣曪絾绻濆顓犲幈闂侀潧楠忕槐鏇㈠矗閿熶粙姊洪幐搴ｇ畼闁稿鐩崺鐐哄箣閻欏懏瀚归柨婵嗛娴滄粌霉濠婂嫷娈滈柡宀�鍠栧畷妤呮嚃閳哄倹顔冮梻浣规偠閸斿秴危閹烘桅闁归偊鍘介崕鐔搞亜椤愵偄骞樼紒鐘冲哺濮婃椽妫冨☉姘暫濠电偛鐪伴崐鏇㈠汲閳哄懏鈷掑ù锝勮閻掔偓銇勯幋婵囶棦闁诡垰瀚伴、娑橆潩鏉堛劍顔曟俊鐐�栭悧婊堝磿閹版澘鏋佺�广儱妫涚弧锟芥繝鐢靛Т閸婃悂顢旈埡鍛闁哄鍩婂銉╂煃鐟欏嫬鐏撮柟顔规櫇缁辨帒螣婵犳碍鏆樺┑锛勫亼閸婃牠宕归悽绋跨疇闁归偊鍠栭崹婵嬫煕椤愮姴鍔氱紒锟介崘鈹夸簻闁哄啫鍊瑰▍鏇㈡煕濡湱鐭欐慨濠冩そ閺屽懎鈽夊Ο铏广偖婵犵數鍋橀崠鐘诲炊瑜嶉崑宥夋⒑閸涘﹦缂氶柛搴＄－婢规洟宕楃粭杞扮盎闂佸搫娲ㄩ崑鐐哄闯瑜版帗鐓熼煫鍥ュ劤绾捐法绱掓潏銊ョ缂佽鲸甯掕灒闁兼祴鏅濋弳顓㈡⒒娴ｅ憡鎲稿┑顔芥尦閺佸啴濡堕崼顫埅濠电姷鏁搁崑鐘典焊濞嗘垵鍨濇い鏍ㄧ矌缁�濠傤熆閼搁潧濮堥柍閿嬪笒闇夐柨婵嗙墱濞兼劙鏌涚�ｎ剙鈻堥柡灞剧洴瀵噣鏁撴禒瀣瀭闁告挷鑳堕惌澶岋拷骞垮劚椤︻垶鏌嬮崶顒佺厸闁搞儺鐓夐崗顒勬煙閻戣姤鏁辩紒妤冨枛閺佹捇鎸婃径妯烘闂佺锕﹂崳銉ノｉ悜鑺モ拺闁告繂瀚烽崕蹇涙⒑鐢喚绉�殿喖顭烽幃銏ゆ偂鎼达絿鏆伴柣鐔哥矊缁绘ê顕ｉ幖浣哥妞ゅ繐鎳庢禒蹇撯攽閻樼粯娑фい鎴濇閸╂盯骞掗幊銊ョ秺閺佹劙宕奸锝囩Х闂備胶顭堥鍥ㄧ箾閿熶粙鏌＄仦鍓р檨闁诡垱妫冩慨锟介幒铏閵忋倖鍊甸悷娆忓缁�鍐磼椤旇偐鐒搁柨婵堝仜閳规垹锟斤綆鍋勫▓婵嬫⒒閸屾氨澧涚紒瀣姉閼洪亶鎮介崨濞炬嫽婵炶揪绲介幉锟犲箚閸喓绠鹃悘鐐插�搁悘鑼拷瑙勬礈閹虫挾鍙呭銈呯箰閹冲孩绂嶅Δ锟介埞鎴︽倷閸欏妫￠梺鍦焾椤兘骞冮敓鐘冲亜闁稿繗鍋愰崢鐢告煟鎼达絾鏆╂い顓炵墦閺佹捇鎳為妷褍鈷屽Δ鐘靛仜椤戝寮崘顔芥櫢濞寸姴顑嗛崑鍌炴煛閸ャ儱鐏柣鎾寸懇閺岀喎鈻撻崹顔界亪濡炪倧绲介妶鎼佸蓟閿濆绠婚悹铏瑰劋閻忓牓姊洪崫鍕伇闁哥姵鐗犻獮鍐煥閸忓墽鍠栭幊锟犲Χ鎼粹懣鐐电磽閸屾瑨鍏岄柧蹇撻叄瀹曘垺绺介崨濠備函婵犻潧鍊婚…鍫ユ嫅閻斿吋鐓忓┑鐐靛亾濞呭棝鏌涚�ｎ亜顏柡灞剧洴楠炲鈻庤箛銉﹀闁哄稁鍋撻幏宄邦潩椤掑倻楔闂佸搫鐭夌紞浣割嚕閺夋埈娼╅柛妤冨仜椤绱撻崒姘拷鍝ョ矓閹绢喗鍋嬮柟鐐墯濞兼牗绻涘顔荤凹闁稿绻濋弻锝呂旈敓浠嬫偋閸℃稑姹查柛顐犲劜閳锋垿鎮归崶锝忔嫹閾忣偆浜梻浣侯焾閿曘儵骞冮崒鐐茬畺濡わ絽鍟崐濠氭煢濡警妲洪柣銈忔嫹闂傚倷绀侀幖顐λ囬姘肩劷闁跨喓濮撮弸浣圭節婵犲倸鏆婇柡锟芥禒瀣闁规儼妫勭壕鍦喐閺冨牏宓侀煫鍥ㄧ♁閸婂鏌ら幁鎺戝姢闁告瑥鍟村娲川婵犲倸袝婵炲瓨绮嶇划鎾愁嚕缁嬪簱妲堥柕蹇ョ磿閸樻悂鏌ｈ箛鏇炰粶濠⒀傜矙閸┿儲寰勯幇顓犲帗闂佽姤锚椤﹁棄危閹间焦鐓冮悹鍥ㄧ叀閸欏嫭顨ラ悙鍙夊枠妞ゃ垺鐟╅弻銊╊敍濞戞熬鎷锋總鍛娾拻闁稿本鑹鹃敓浠嬵棑缁牊绗熼敓浠嬬嵁婢舵劖鏅搁柣妯哄暱娴狀參姊洪棃娑辨Т闁哄懏绮撳鎻掆攽閸ャ儰绨婚棅顐㈡处閹哥偓鏅跺☉銏＄厱閻庯綆浜滈敓钘夌秺婵＄敻宕熼姘辩杸闂佸憡鎸烽懗鍫曞汲閻樼粯鈷戠紓浣姑慨鍥煥閺囥劋閭�殿喖顭峰鎾偄閾忓湱妲囬梻濠庡亜濞诧箓骞栭埡浼辨椽顢橀悜鍡樺瘜闂侀潧鐗嗙换妤冪矆鐎ｎ喗鐓曢幖杈剧磿閿涘秵淇婇崣澶婂妤犵偞顭囬敓鑺ョ♁閿氭い搴㈡崌閺岋綁鎮㈤崫銉﹀櫑闁诲孩鑹鹃崲鑼剁亱闂佸搫绋侀崢浠嬪煕閹达附鐓熼柣鏂挎啞缁跺弶绻涢崼姘珚闁哄瞼鍠栧畷娆撳Χ閸℃浼�
					if(level==0){
						mkdb.Procedure proc=fire.pb.clan.srv.ClanManage.refreshMedic(clan.getKey());
						mkdb.Procedure.pexecuteWhileCommit(proc);
					}
				}
				else if (id == ClanManage.Hotel)
				{
					int level = clan.getHouse().get(ClanManage.Hotel);
					fire.pb.clan.SClanHotel hotel =  fire.pb.main.ConfigManager.getInstance().getConf(fire.pb.clan.SClanHotel.class).get(level);
					if (hotel == null)
					{
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 143583, null);
						return true;
					}
				
					fire.pb.clan.SClanDrugstore l =  fire.pb.main.ConfigManager.getInstance().getConf(fire.pb.clan.SClanDrugstore.class).get(level + 1);
					if (l == null) //濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ゆい顓犲厴瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戦柟鑲╁仜婵″ジ鏌涙繝鍌涘仴鐎殿喛顕ч埥澶愬閳哄倹娅囬梻浣瑰缁诲倸螞濞戔懞鍥Ψ瑜忕壕钘壝归敐鍛儓鐏忓繘姊洪崨濠庢畷濠电偛锕ら锝囨嫚濞村顫嶅┑鈽嗗灦閺�閬嶅棘閿熶粙姊绘担鍛婂暈婵炶绠撳畷鎴﹀礋椤掍礁寮块梺闈涚箞閸婃牠鍩涢幋鐐电闁煎ジ顤傞崵娆愵殽閻愭惌娈滈柡宀�鍠栭幃鐑芥偋閸繃鐏庨柣搴㈩問閸犳牠鈥﹂悜钘夋瀬闁归偊鍘肩欢鐐测攽閻樻彃顏撮柛姘嚇濮婄粯鎷呴悷閭﹀殝缂備浇顕ч崐姝岀亱濡炪倖鎸鹃崐锝呪槈閵忕姷顦板銈嗘尵婵兘鏁嶅┑鍥╃闁瑰墽顥愭竟姗�鏌ㄩ弴妯哄姢闁跨喕濮ら懝鍓х礊婵犲偆娼栭柧蹇撴贡閻瑩鏌熺粙鍨劉闁圭柉浜槐鎾存媴閸撴彃鍓遍柣銏╁灙閿熻棄纾弳锕傛煥濠靛棛澧㈤柣銈忔嫹闂備礁鎼崐鍛婃櫠閻ｅ瞼涓嶆慨妯垮煐閳锋垿姊婚崼鐔恒�掑褎娲熼弻鐔风暋闁箑鍓堕悗瑙勬礃濞茬喖鐛崶顒佸亱闁割偅绻愰幏鐑藉垂椤愶絽寮垮┑顔筋殔濡鏅堕幍顔剧＜濠㈣泛顑嗛妵婵嬫煛瀹�锟介崰鏍�佸▎鎴犻┏閻庯綆鍋嗛弳顓㈡⒒娴ｇ儤鍤�鐎殿喖鐖奸獮鎰板礃閼碱剚娈鹃梺缁樻⒒閳峰牓寮崱娑欑厱閻忕偠顕ч敓鑺ョ墳閳兘姊婚崒姘拷鎼佸磹閻戣姤鍊块柨鏃�鎷濋幏椋庣箔濞戞ɑ鍣归柡瀣墢閿熻棄绠嶉崕閬嵥囬娑辨敯闂傚倷绀侀幉鈥趁洪敃鍌氬瀭闁规鍠氭稉宥呪攽閻樺磭顣查柣鎾跺枛閺岀喖鏌囬敃锟介悘鈩冦亜閵夈儺妲搁棁澶愭煟濞嗘瑦瀚归梺闈╃秶缂嶄線鐛崘銊庢棃宕橀埡浣圭�梻浣告啞濞诧箓宕滃☉銏℃櫖婵鎷锋慨濠冩そ瀹曘劍绻濋崘锝嗗闂備焦鎮堕崝灞筋焽閳╁啩绻嗛悗娑櫳戞刊鎾煕閹惧啿绾х�点倖妞藉铏规崉閵娿儲鐎虹紓渚囧枟閻熲晠鎮伴锟藉畷姗�顢氶崨顔芥珕闂備礁澹婇崑鍛崲閸屾粎鐜绘繛鎴烇供濞撳鏌曢崼婵囶棤濠⒀屽墴閺屾盯骞嬮悩鍐叉畬闁告浜跺鍫曞醇濞戞ê顬嬬紓浣叉閹风兘姊绘担鍦菇闁搞劏妫勯…鍥槻闁哄棌鏅犲缁樻媴閼恒儯锟藉啴鏌ｉ幒鐐电暤妤犵偛鍟村畷鎺戭潩鏉堛劍顔曢梻浣侯攰閹活亪姊介崟顖氱；闁规壆澧楅崑锝夋煕閵夘喕绨婚柣銊у劋閵囧嫰寮懗顖氼伃濡炪値浜滈崯瀛樹繆閸洖宸濇い鏍ㄧ矤閸炲爼姊绘担铏瑰笡妞ゃ劌鎳庤灋婵炴垶鑹鹃崹婵嗏攽閻樺啿鍤柡浣哥Ч閺岋綁骞囬澶婃闂佸憡鐟ュΛ婵嗩潖閾忓湱纾兼俊顖濆吹椤︺儵姊虹粙鍖″伐婵狅拷闁秵鏅搁柤鎭掑劤閸熸煡鏌熼崙銈嗗? by changhao
					{
						java.util.ArrayList<String> args = new java.util.ArrayList<String>();
						Integer s = level;
						args.add(s.toString());
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 160226, args);
						return true;						
					}
					
					if (money < ClanUtils.getBuildLevelupMax(clan).get(ClanManage.Hotel)) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氼參宕崇壕瀣ㄤ汗闁圭儤鍨归崐鐐烘偡濠婂啰绠荤�殿喗濞婇弫鍐磼濞戞艾骞堟俊鐐�ら崢浠嬪垂閸偆顩叉繝闈涱儐閻撴洘绻涢崱妤冪缂佺姴顭烽弻鈥崇暆鐎ｎ剛袦婵犳鍣幏鐑芥⒑闂堟稓绠氶柡鍛箞瀹曟繈宕妷褏锛濇繛鎾磋壘閿曘儳锟芥俺顫夌换婵嬪閿濆懐鍘梺鍛婃⒐閻楃娀骞冮敓鐘参ㄩ柍鍝勫�婚崢鎼佹⒑閹肩偛鍔楅柡鍛♁缁傛帒顭ㄩ崼鐔哄弳闂佺粯姊荤划顖炈夋径鎰厵闁兼亽鍎抽惌宀勬煕閹烘挸娴柡浣瑰姍瀹曘劑宕掑☉娆樻閻庤娲忛崝鎴︺�佸▎鎾崇畾鐟滃秶绮绘导瀛樷拺閻犲洦鐓￠妤冪磼閻樿尙效鐎规洘娲樺蹇涒�﹂幋鐑嗗晬闂備礁鎲＄缓鍧楀磿閺屻儱姹叉繝濠傜墛閻撶喖鏌熼柇锕�鏋涢柛鏂款儔閺岋綁骞樼�涙顦伴梺鍝勬湰濞叉ê顕ラ崟顐嬬喖鎮滃Ο闂撮偗婵犵數濮幏鍐礃閸撗冩倯闂備礁鎼径鍥礈濠靛绠柛娑欐綑瀹告繂鈹戦悩鎻掝劉闁挎稑妫濆缁樻媴閸涘﹥鍎撻梺鍝勭墱閸撶喖骞嗛崟顖ｆ晬婵鍘у▓銊╂⒑閸︻叀妾搁柛鐘崇墬閸庮偊姊绘笟锟藉褔藝椤撱垹纾块柛婵嗗閻掕棄鈹戦悩宕囶暡闁抽攱甯掗湁闁挎繂鎳忛崯鐐烘煕閻斿搫浠遍柡宀�鍠撴禍鎼佸冀閵婏妇褰嬮柣搴ゎ潐濞测晝绱炴担鍝ユ殾婵鎷烽柍銉畵楠炲鎮欓悽纰樻瀱婵犵數濮烽弫鎼佸磻濞戞鐔哥節閸愵亶娲稿┑鐘诧工閸犳岸宕崨顔剧瘈闂傚牊绋掗ˉ鎴︽煛閿熻姤绂掔�ｎ偆鍘藉┑鈽嗗灥椤曆呭緤婵犳碍鐓涢柛鈩冾焽閹冲嫰鏌曢崶褍顏柡浣稿�婚幉鎾礋椤掑倸缍冨┑鐘愁問閸犳牠鏁冮妷銉富濞寸姴顑囧畵渚�鏌″搴″箺闁稿﹦鍏橀弻鐔虹磼濡桨鍒婇梺璇查閻°劎鎹㈠┑瀣仺闂傚牊鍒�閻愮儤鐓曢柕濠忛檮閵囨繈鏌℃担绋挎殻濠殿噯鎷烽梺闈涚墕閹冲繐危椤掑嫭鈷戦梻鍫熺〒缁犲啿鈹戦锝呭籍鐎规洏鍎抽敓鏂ょ秵娴滃爼鎮㈤崱娑欏仯闁告繂瀚ㄩ崑銊╂煥閻斿搫孝闁绘挻鐩弻娑樷槈閸楃偞鐏撻梺鍛娚戦幑鍥ь潖濞差亜宸濆┑鐘插閻ｇ敻鏌ｆ惔銏犲毈闁告挾鍠栧顐﹀箻缂佹ê浠奸柣蹇曞仧閸嬫挸袙閸惊鏃堟偐闂堟稐绮剁紓浣虹帛閸旀宕ｉ崨顓ф富闁靛牆鎳愮粻浼存煙閸愬樊妯�妤犵偛绻愮叅妞ゅ繐鎳夐幏娲⒑缁嬭法绠绘俊顐㈡健閹虫粓顢旈崼鐔哄幈闁硅壈鎻槐鏇熸櫏婵＄偑鍊戦崹鍝勎涢崘銊ф殾闁惧繗顫夊畷澶愭煟閹寸伝顏堝几閻樺樊娓婚柕鍫濆暙閻忣亞绱掔�ｎ偄鐏撮柍銉畵婵℃悂鍩℃担鍝ョ崺婵＄偑鍊栭悧顓犲緤閸撗呮噮濠电姷鏁告慨鐑藉极閹间礁纾婚柣妯款嚙缁犲灚銇勮箛鎾搭棤缂侊拷婵犲洦鐓ラ柣鏃囶嚙琚氱紓浣虹帛閻╊垰鐣烽鍫濈妞ゅ繐鎳庢禒鐟扳攽閻橆喖鐏辨い顐㈩槸鐓ら柣鏃堫棑閺嗭附淇婇妶鍛櫤闁抽攱甯￠幃妤呮濞戞瑦鍠愰梺浼欑秮缁犳牕顫忕紒妯肩懝闁跨喕妫勯…鍥樄闁诡啫鍥у耿婵炲棙鍔曟惔濠囨⒑閻熼偊鍤熷┑顖涙尦楠炲繐鐣￠柇锔藉兊闁哄鐗勯崝灞解枔鐏炵瓔娓婚柕鍫濈凹缁ㄥ鏌涢悢椋庢憼濞ｅ洤锕獮鍡涘箥椤旂偓婢戦梻浣告惈濞层劍鎱ㄩ棃娑掓灁闁绘挸绨堕弨浠嬫煟閹邦垰鐨洪柟鐣屽Х缁辨帡顢欓懖鈺冨姱闂佽鍠撻崕鑼紦娴犲宸濆┑鐘插�风划褎淇婇悙顏勶拷鏍洪埡鍛濡炲鍑介幏宄扳枔閸喗鐏嗙紓渚囧枟閻熲晠濡存担鍓叉建闁跨喍绮欓獮鍐閵堝懎绐涙繝鐢靛Т缁ㄥジ骞嬮悜鑺モ拻闁稿本鑹鹃敓钘夊槻闇夐柛銉戯拷閺嬫牠鏌￠崶銉ョ仼闂傚偆鍨堕弻銊╁即閻愯鎷烽崫銉т笉妞ゆ牜鍋為悡銉╂煟閺囩偛锟藉湱锟芥熬鎷�? by changhao
					{
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 160224, null);
						return true;
					}
					
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂傚洤顦甸弻銊モ攽閸♀晜效婵炲瓨鍤庨崐婵嬪蓟閵堝绾ч柟绋块娴犳潙鈹戦纭锋敾婵＄偘绮欓妴浣肝旈崨顔芥闂佷紮绲介惉濂告儗閹剧粯鐓涢悘鐐额嚙閸旀粓鏌￠崨顔藉�愰柡宀嬬畱铻ｅ〒姘煎灡绗戦梻浣芥硶閸犳洖螞閸曨偒鐒介柨鐔哄Т杩濇繛杈剧悼绾爼寮告惔銊︾厵闁诡垎鍜冪礊濡炪倧瀵岄崣鍐箖瀹勯偊鐓ラ柛鎰典簽椤旀帡鏌﹀Ο鑽ょ畺闁靛洤瀚板浠嬪Ω瑜嬮敓鑺ュ笧缁辨帡鎮╅懡銈囨毇闂佸搫鐬奸崰鏍嵁閸℃凹妾ㄩ梺鎼炲�楅崰鏍蓟濞戙垺鍋勯柛婵勫劚瀵劑姊洪崫鍕伇闁哥姵鐗犻獮鍐煥閸喎娈熼梺闈涱檧闂勫嫬鈻撻崨濠佺箚闁绘劦浜滈敓鑺ュ灴瀹曟繃绻濋崶褏锛熼梺姹囧灮椤牏绮婚弽銊х闁糕剝蓱鐏忣厾绱掗悪娆忔处閻撴瑩鎮楀☉娆樼劷缂佺姰鍎茬换娑㈠礂閻撳骸鎽靛┑顔硷功缁垶骞忛崨瀛樺殟闁靛缍囬幏鐑藉礃椤旂晫鍘介梺纭呮閸嬬喖鎮鹃崹顐闁绘劖娼欓悘瀵革拷瑙勬礀閻栧ジ銆佸Δ鍛櫢濞寸姴顑呴崙鐘层�掑鐐闂佸搫鐬奸崰鏍х暦濠婂棭妲鹃柣銏╁灡閻╊垶寮婚敓鐘插窛妞ゆ棁妫勯敓鑺ュ姍閺岋紕浠︾拠鎻掝潎闂佽鍠撻崐婵嗙暦閹烘垟妲堟慨妤�妫旂槐锟� by changhao
					boolean ok = ClanManage.AddClanMoney(-hotel.levelupcost, clan);
					if (ok == false)
					{
						fire.pb.talk.MessageMgr.sendMsgNotify(roleid, 160224, null);
						return true;
					}
					
					clan.getHouse().put(ClanManage.Hotel, level + 1);
					
					sClanLevelup.change.put(ClanManage.Hotel, level + 1);
					sClanLevelup.money = clan.getMoney();
					uplevel=level + 1;//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ偆娲撮挊婵嬫煟閵忋埄鐒鹃柡瀣╃窔閺岀喖宕滆鐢盯鏌涚�ｎ偄濮堥柕鍥у瀵挳鎮欓幖顓燂紒闂佽瀛╅懝鍓х礊婵犲洤钃熸繛鎴欏灩缁犳盯姊婚崼鐔衡檨闁诲繐鐗撻幃妤呮偡閻楀牆鏆堢紓浣筋嚙閸熷瓨淇婇悽绋跨妞ゆ牗姘ㄩ濠囨⒑閻熸壆鎽犵紒璇插暣瀹曟劙顢涘锝嗘杸闂佹寧绋戠�氼剚绂掗埡浣叉斀妞ゆ柨鎼敓鑺ョ墱缁碍娼忛妸褏鐦堥梺鎼炲劀閸滀礁鏅ｆ繝鐢靛仩閹活亞绱為敓鑺ャ亜椤愩埄妲搁柍璇茬Ч瀹曞崬鈻庨幋鐙呯闯闂備胶顭堥張顒勬偡瑜斿畷婵嗩吋婢跺鍙嗛梺鍝勬处椤ㄥ棗鈻嶆繝鍕舵嫹鐟欏嫭澶勯柛銊ゅ嵆椤㈡﹢宕楅悡搴ｇ獮闁诲函鎬ラ崟顐紲濠电姷鏁搁崑鐘诲箵椤忓棛绀婇柨鐔诲Г閵囧嫰顢曢姀鈺傗枅閻庤娲橀崹鍧楀箖閳哄啰纾兼俊顖滃帶楠炲牓姊洪悷鏉挎倯闁伙綆浜畷鐟懊洪鍕庯附绻濋棃娑氬⒊闁圭兘顥撻幉鎾礋椤掑偆妲扮紓鍌欑贰閸犳牠鎯岄崒鐐叉槬闁靛繆鍓濋崕鐔兼煏婵炲灝鍔ゆい鎾存そ濮婅櫣绱掑Ο鍝勵潓閻庢鍠栭悥濂稿箖濡ゅ拋鏁囬柕蹇婃閹风粯绻涙潏鍓ф偧闁硅櫕鎹囬、姘煥閸曨厾顔曢梺鍛婄懃椤﹁鲸鏅堕悽纰夋嫹鐟欏嫭绀冮柛鏃�鐟ラ悾鐑筋敃閿曪拷鍞悷婊冪灱缁厽寰勯幇顓炰画濠电姴锕ら幊搴ㄣ�傛總鍛婂仺妞ゆ牗绋戠粭褔鏌ｉ妷顔绘捣妞わ箑缍婇弻锛勪沪閸撗勫垱濡炪們鍨哄ú鐔煎极閹版澘鐐婇柍鍝勫暞濞堝ジ姊婚崒娆戝妽濠电偛锕銊╁础閻戝棙缍庨梺鐓庮潟閸婃牠锝為弴銏＄厵闁绘垶蓱椤ユ牠鏌熸搴″幋闁轰焦鍔栭幆鏂库攽閸パ勭亾闂傚倷鑳剁划顖炲箰閹间礁围闁归棿绀侀拑鐔兼煃閵夈儳锛嶉柡鍡楁閹鏁愭惔鈥愁潾閻炴熬绠撳缁樻媴閼恒儯锟藉啴鏌ｉ幒鐐电暤鐎规洘绻傞埢搴ょ疀閺囩喐顔曢梻浣虹帛閹稿摜锟藉灚甯￠幃锟犲Ψ閳哄倻鍘遍梺纭呭焽閸斿秴鈻嶉崨瀛樼厱闁规崘鍩栭弳鈺冪磼鏉堛劍宕岀�规洘甯掗～婵嬵敆婵犲啫顏堕悗鐟板閸ｇ銇愰幒鎴犲�為梺闈涱煭缁茶偐鍒掗幘缁樷拺闁告稑锕︾紓姘舵煕鎼淬垻鍙�鐎殿喖鍟块…銊╁醇閻斿搫骞嶉梻浣虹帛閸ㄥ爼鏁冮埡浣叉灁闁哄啫鐗婇悡鐔兼煙缂併垹鐏查柟椋庡厴楠炲洦鎷呴崫鍕毄闂備浇宕垫慨鎯ь浖閵娧勫闁挎洖鍊归崑鍌涖亜閹哄秷鍏岀紒鐘插⒔缁辨帒螖閿熶粙骞栭锝嗗弿闁稿瞼鍋為悡娑㈡倶閻愭彃鈷旀繛鍙夋尦閺屾盯鍩℃担鍓蹭純閻庤娲橀敃銏犵暦濠婂棭妲绘繝娈垮枛閻栫厧顫忕紒妯肩懝闁跨喕妫勯…鍥樄闁炽儻绠撻、姗�鎮╅悽纰夌闯婵犳鍠楅…鍫熴仈缁嬭法鏆﹂柡灞诲劜閻撴洟鏌嶉埡浣告殶闁冲彞绶氶弻锝夊箻瀹曞洨顔掗梺鍝勬湰閻╊垶銆侀弴銏℃櫜闁搞儮鏅濋弳顐︽⒒娴ｇ儤鍤�闁告艾顑夊畷婵嬪冀椤撶倣锕傛煕閺囥劌澧柛搴ｅ枛閺屾洝绠涙繝蹇斿鐎规洖娴勭槐锕傛⒒閸屾瑧顦﹂柟纰卞亰閹绺界粙璺ㄧ崶闂佸搫璇為崨顔筋啎婵犵數鍋涘Λ娆撳箰缁嬫寧绾梻鍌欒兌绾爼宕滃┑瀣拷鍐疀閺傛鍤ら梺璺ㄥ櫐閹凤拷
					cost=hotel.levelupcost;//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄闁挎繂妫Λ鍕⒑閸濆嫷鍎庣紒鑸靛哺瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈嗐亜椤撶姴鍘寸�殿喖顭烽弫鎰緞婵犲嫮鏉告俊鐐�栫敮濠囨倿閿曞倸纾块柟鍓х帛閳锋垿鏌熼懖鈺佷粶濠碘�炽偢閺屾稒绻濋崒娑樹淮閻庢鍠栭…鐑藉极閹邦厼绶炲┑鐘插缂嶅倿姊绘担铏瑰笡闁挎岸鏌涢悢閿嬪仴鐎殿喗濞婂畷濂稿Ψ閿旇瀚肩紓鍌欑椤戝棝顢栧▎鎾崇？闊洦鏌ｆ禍婊堟煙鐎涙绠ユ俊顖ゆ嫹闁诲孩顔栭崰鏍�﹂柨瀣╃箚闁归棿绀侀悡娑㈡煕鐏炲墽鐓紒銊ょ矙濮婄粯鎷呮笟顖滃姼闂佸搫鐗滈崜娑氬垝濞嗘挸绠ｉ柨鏃傜帛閺呮粓姊虹捄銊ユ珢闁瑰嚖鎷�??
					opid=FactionOpbean.TYPE_HOTEL_UP;
					
					SendAllFactionMemeber(clan, ClanManage.Hotel, level + 1);
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ剙浠遍柟顔ㄥ洦鍋愭慨鐟版祫閹烽攱绗熼敓钘夘嚕閹绢喖顫呴柣姗�娼ч獮鍫熺節濞堝灝鏋熼柨鏇楁櫊瀹曘垺绂掔�ｎ�附绻濋棃娑欘棏闁猴拷娴犲鈷旈柛銉墮閺勩儵鏌″畵顔艰嫰濞堫偊姊洪崨濠冨闁告瑥绻橀獮蹇涙倻閼恒儲娅滈柟鐓庣摠缁诲嫰鎳楅崫鍕ㄦ斀闁炽儱鍟跨痪褔鏌涢弮锟介悷銉╋綖韫囨洜纾兼俊顖濆亹閹虫繈姊虹捄銊ユ灆婵☆偄瀚伴垾锕傚炊椤忓秵鈻夊┑鐘媰閸曨厾鐤勫┑顔硷攻濡炶棄鐣烽锕�绀嬫い鎺炴嫹婵炲懌鍊濆娲倻閳哄倹鐝﹂梺鎼炲妼閻栧ジ鎮伴璺ㄧ杸婵炴垶顭囬娲⒑閹稿孩顥嗘俊顐㈠缁傚秴顭ㄩ崼鐔哄幗闂婎偄娲﹂幐鍓х不閿濆鐓熼柟铏瑰仧閻ｇ數锟芥鍣崜鐔煎极閹惧顩烽悗锝庡亐閹风粯绻涙潏鍓хК婵炲拑绲块弫顔尖槈閵忥紕鍙嗗┑顔缴戦崬濠氬箯瀹勬壋鏋旈柛顭戝枟閻忓牓姊虹紒妯煎ⅹ闁靛牊鎮傞幃浼搭敋閿熻棄顕ｆ禒瀣垫晣闁绘劗鏁搁弶鍛婁繆閻愵亜锟芥牠寮婚妸锔芥珷濞寸姴顑嗛弲顒佺節婵犲倻澧涢柍閿嬪灴閹綊骞侀幒鎴濐瀳闂佸搫顑呯粔鍓佹閹烘鏁婇柣锝呮湰閸Ｑ囨⒑娴兼瑧鎮奸柛蹇旓耿閻涱噣骞掑Δ锟界粻锝夋煛閸愭寧瀚瑰銈庡亜缁夌懓顫忓ú顏勪紶闁告洦鍘搁弸灞剧節绾版﹫鎷烽搹顐㈡灎闂佽鍨扮�氼參骞嗛弮鍫澪╅柨鏃囶潐鐎氳棄鈹戦悙鑸靛涧缂佽尪鍋愰幏鍐晝閸屾氨鍝楁繛瀵稿帶閻°劑鎮″▎鎰闁煎ジ顤傞崬铏圭磼閵娧勬珪闁跨喕妫勯悘姘熆濮楋拷閺佸啴顢旈崟顓熸濠电姴锕ゅΛ顓炍ｆ總鍛娾拺缂佸娉曠粻鑼磼椤旇姤宕岀�殿喛顕ч埥澶愬閻樻鍟嬮梻浣藉婢瑰牆鈻斿☉銏犲偍闁挎稑瀚壕濂告煟閹伴潧澧柛鏂诲�濋弻鏇㈠醇閻旂锟芥劗锟芥鍠栭…鐑藉箖閵忋倕绀傞柤娴嬫櫅婵椽姊绘担鐟邦嚋婵炴祴鏅犻獮蹇旑槹鎼搭垱瀚规繛鍫濈仢閺嬨倝鏌涚�ｎ偅灏甸柟骞垮灩閳藉濮�閻樿鏁归梻浣虹帛濞叉垿鎳楅崼鏇炵濡炲娴风壕钘壝归敐鍕煓闁告繃妞介幃浠嬵敍濞戣鲸鐣跺銈庡幖濞测晝绮诲☉妯锋婵☆垱澹曢弲鐘诲蓟閺囩喓鐝舵い鏍ㄧ閸ｆ椽鏌涢敐搴＄仸婵﹤顭峰畷鎺戔枎閹搭厽袦闂備焦鐪归崐鏇灻洪妶鍫罕闂備礁鎲″ú锕傚垂娓氾拷瀹曞爼顢楁径瀣珫闂備胶绮崹闈浢洪妸褏鐭欓煫鍥ㄦ尨閺�浠嬫煟濡鍤嬬�规悶鍎甸弻锝呂旈敓钘壩涘┑瀣仒妞ゆ洩鎷峰┑顕嗘嫹闂佺偨鍎寸亸娆戠不濮橆剦娓婚柕鍫濇婢ь剛绱掗鍏兼拱缂佸倸绉电缓浠嬪川婵犲嫬骞堥梻浣告惈閸婅棄鈻旈弴鐔哄ⅰ缂傚倸鍊风粈渚�鎯屾担骞夸粓闁告縿鍎插畷鍙夌節闂堟侗鍎忛柣鎰攻閵囧嫰顢楁径濠傚П闂佹悶鍎崝搴ㄥ储闁秵鈷戦梻鍫熶緱濡牓鏌涢悩宕囶暡缂佸倹甯℃慨锟介柕鍫濇閸橆亪妫呴銏″偍闁稿骸纾竟鏇犳崉閵娧咃紲闂佺粯蓱瑜板啴鍩涢弮鍫熺叆闁绘梻鍎ゅ▍鏇㈡煙閾忣偅灏扮紒鏃傚枑缁绘繈宕惰閻涖儵姊洪崫鍕檨閻忕偠濮ら鎸庝繆閻愵亜锟芥牕煤閳哄懎绠柣鎴ｅГ閻撴稓锟界櫢鎷烽悗锝庡墮閸╁矂姊虹�圭姵顥夋い锕傛涧閻ｇ兘鏁撻悩鍐诧拷鐑芥倵閻㈡鐒剧紓宥呮閳规垶骞婇柛濠冾殕閹便劑鎮滈挊澶岋紱闂佺粯鍔曢悘姘跺汲濠婂牊鐓欓柣鎴炆戠粈鍫澝瑰鍕噰婵﹦绮幏鍛存嚍閵壯侊拷濠囨⒑閸濄儱校闁圭懓娲ら锝夊蓟閵夘喗鏅濋梺闈涚墕閹冲酣鎮樻繝鍐瘈闁汇垽娼ф牎闂佽偐鎳撴晶鐣屽垝婵犳凹鏁嬮柨鐔剁矙瀵濡舵径濠勭暢闂佸湱鍎ら崹鍨叏閵忋倖鈷戦柛娑橆焵閹达箑绠栭柛灞惧嚬濞兼牗绻涘顔荤盎缂佺姴缍婇弻锝夊箛椤撶偟绁锋繝娈垮枛閻倸顫忛搹鍦煓闁圭楠搁弨顓熶繆閻愬瓨缍戦柟璇х磿缁碍娼忛妸褏鐦堥梺鍛婂姦娴滆泛霉閸曨垱鐓熼幖鎼灣缁夌敻鏌涚�ｎ亝顥㈢�规洏鍨介獮鏍ㄦ媴閸忓瀚肩紓鍌欑椤戝牆鈻旈弴銏″�块柛褎顨嗛埛鎺楁煕閺囥劌浜滄い蹇ｅ亰閺屻劑鎮㈢拠娈嬫捇鏌ｉ弮鎴濆⒋妤犵偛绻橀弫鎾绘晸閿燂拷 by changhao
					mkdb.Procedure.pexecuteWhileCommit(new ClanRank(clan.toData()));
					mkdb.Procedure.pexecuteWhileCommit(new fire.pb.ranklist.proc.PFactionZongHeProc(clan.getKey(), false));
				}
				
				sClanLevelup.costmax.putAll(ClanUtils.getBuildLevelupMax(clan));
				mkdb.Procedure.psendWhileCommit(clan.getMembers().keySet(), sClanLevelup); //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ偆娲撮挊婵嬫煟閵忋埄鐒鹃柡瀣╃窔閺岀喖宕滆鐢盯鏌涚�ｎ偄濮嶉柡灞剧洴楠炲洭顢涘鍗烆槱闂備焦鐪归崹褰掆�﹀畡閭︽綎缂備焦蓱婵挳鏌ｉ悢鐓庝喊闁搞倕顑呴埞鎴︽倷閹绘帞楠囬梺缁橆殘婵挳鎮鹃悜钘夌疀闁哄娉曢鎰箾鏉堝墽鎮兼い顓炵墦閹顢橀姀鈾�鎷虹紓浣割儓濞夋洟鎮橀柆宥嗙厱閻庯綆鍓欐禒閬嶆煙椤曞棛绡�濠碉紕鍏橀崺锟犲磼濠婂啫绠洪梻鍌欑閹碱偄煤閵娾晛纾绘繛鎴欏灪閺呮悂鏌﹀Ο渚Ч閻犳劧绻濋弻銊╂偄鐠囨畫鎾绘煟閺冩垵澧存鐐茬箻閺佹捇鏁撻敓锟�?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鐐劤椤兘寮婚敐鍛傜喎鈻庨幆褎顔勭紓鍌欒兌婵挳鎮樺璺何﹂柛鏇ㄥ枤閻わ拷闂佸湱鍋撻幆灞轿涢妶鍥╃＝濞撴艾锕ョ�氳绻濋悽闈浶㈡繛璇х畵閹繝濡烽埡鍌滃幗闂佸搫鍟ù鍌炲吹濞嗘垶鍋栨慨妯夸含绾捐棄霉閿濆牊顏犻悽顖涚洴閺岋綁鍩℃繝鍌滀哗闂佷紮绲块崗姗�銆侀弮鍫濋唶婵犻潧鐗滃Σ鐗堜繆閻愵亜锟芥洜鎹㈤幇鏉胯摕濠电姴鍋嗛悡銉╂煕椤愩倕鏆遍柟鐤缁辨帞绱掗姀鐘茬闂佺懓鍟跨换姗�骞冮悽鍓叉晜闁糕剝鐟ч敍婊冾渻閵堝棙顥嗗┑顔哄�楁禍鎼侇敇閵忥紕鍘介梺鎸庣箓椤︿即寮潏鈺冪＜闁惧繗顫夊▍鏇犵磼椤旂晫鎳囩�规洖缍婇、娆撴嚃閳瑰灝浠忛梻鍌氬�搁崐鐑芥嚄閸撲礁鍨濇い鏍仜閽冪喖鏌曟繛鐐珔缂佺姾顫夐妵鍕箛鐠轰警娲悗瑙勬尫閼冲爼鏁撻挊澶岀暛闁稿酣浜惰棟濞村吋娼欓悡鏇㈡煙閻戞ê娈憸鐗堝笚閺呮煡鏌涢锝囨袱闁规儳澧庡Λ顖涖亜閹捐泛浠ч柛鈺嬬秮閺岋紕浠﹂崜褎鍒涢梺杞扮劍閸旀绮诲☉銏犲嵆闁绘娅曢鎾斥攽鎺抽崐妤佹叏閻戣棄纾绘繛鎴炵瀹曞弶鎱ㄥΔ瀣閻庢鍣崑濠囩嵁濡偐纾兼俊顖滅帛椤忕喖姊绘担鑺ョ《闁革綇绠撻獮蹇涙晸閿燂拷?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ剙浠遍柟顔ㄥ洦鍋愭慨鐟版祫閹烽攱绗熼敓钘夘嚕閹绢喖顫呴柍鈺佸暞閻濇洟姊绘担钘壭撻柨姘亜閿旇鏋ょ紒杈ㄦ瀵挳濮�閳撅拷閹风粯绻涙潏鍓хК婵炲拑缍佹俊瀛樼節閸ャ劎鍘遍梺瑙勫劤椤曨厾绮婚悙鐑樼厵闁芥ê顦敓钘夘煼閺佹捇寮妶鍥┬ｉ梺鍝ュУ閻楃娀骞冨▎鎰瘈闁告劧缂氱花濠氭⒑閸︻厼鍔嬮柛鈺佺墕鍗辩憸鐗堝笚閻撴盯鏌涘☉鍙樼凹婵炲懎锕ラ幈銊︾節閸涱噮浠╃紓浣介哺鐢帟鐏掗梺鍛婄箓鐎氬懘寮撮姀鈾�鎷洪梺鍛婄☉閿曘儵骞嗛崼銏㈢＜闁绘ê鍟块悘鎾煃閵夘垳鐣电�规洖鐖奸、妤佹媴闂�鎰泿闂傚倷绀侀幉锛勭紦閸ф纾块柟鍓佺摂閺佸﹪鏌￠崶銉ョ仾闁抽攱鍨块弻娑樷攽閸℃浼屽┑鈩冨絻缂嶅﹪寮诲☉銏犖╃憸搴ㄥ汲椤掍緡娈介柣鎰絻閺嗭絾顨ラ悙宸剶闁诡喗鐟╅幃钘夆枔閸喗娅楅梻鍌氬�烽懗鍫曗�﹂崼銏″床婵°倕鎳庣壕濠氭煙閻楀牊绶茬紒鐘靛█閺屾盯骞囬妸锔芥緭婵炲瓨绮嶇划鎾诲蓟閿熺姴纾兼繝闈涙川閵嗗﹦绱撴担鍝勑㈡い顓犲厴瀵鍩勯崘鈺侇�撻柣鐔哥懃鐎氼剛澹曢幎鑺モ拺閺夌偞澹嗛崝宥夋煙閻熺増鍠樼�殿噮鍋婇獮妯肩磼濡粯顏熼梻浣芥硶閸ｏ箓骞忛敓锟�? by changhao
				//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鏉戭潩鏉堚敩銏ゆ⒒娴ｈ鍋犻柛搴㈡そ瀹曟粓鏁冮崒姘�梺鍛婂姦閸犳鎮￠妷鈺傜厸闁搞儲婀圭花濂告倵濮橆剛绉烘慨濠傛惈鏁堥柛銉戝秵瀚规俊銈呮噹绾惧鏌熼幑鎰厫鐎规洖寮剁换婵嬫濞戞瑥绐涚紓浣叉閹风兘姊绘担渚劸闁哄牜鍓涢崚鎺戠暆閸曗晪鎷烽崒鐐存優闁革富鍘鹃敍婵囩箾閹剧澹橀柨鏇樺劤閿熻姤淇洪～澶屾崲濠靛顫呴柨婵嗘閵嗘劕顪冮妶鍡楃仴婵☆偅绻傞悾鐑芥晲閸垻鏉搁梺鍝勫�告晶鐣岀不濮樿埖鈷戦梻鍫熺〒婢ф洟鏌熷畡閭﹀剶鐎规洘娲熼獮鍥偋閸繐鎷烽崹顐ｅ弿婵☆垰娼￠崫娲煕閵堝繑瀚归梻浣稿⒔缁垶鎮ч悩璇茶摕闁挎繂鎷嬪銊╂煥閻旂粯顥夋い顓炴穿椤﹀磭绱掗崒娑樼瑨妞ゎ厹鍔戝畷鐔碱敂閸℃瑧鏆板┑锛勫亼閸婃牠宕濊瀵板﹦鎹勯妸褌绗夐梺缁樺姉椤ｎ噣骞忓畡鎵虫灁闁割煈鍠楅悵顕�姊虹粙娆惧剰闁挎洦浜幃浼搭敊閸㈠鍠撳☉鐢告煥鐎ｎ亶浼撻梻鍌氬�搁悧濠勭矙閹次诲绠涢弮鍌滎啎闂佸搫顦伴崹鐢割敂椤撱垺鐓涚�癸拷鐎ｎ剛蓱闂佽鍨卞Λ鍐�佸☉姗嗙叆闁告稑鎷戠紞浣割潖閾忓湱鐭欐繛鍡樺劤閸撴澘鈹戦埥鍡椾簼缂佽鍊块幃楣冩倻閽樺娼婇梺闈涚墕閹虫劙顢欓幇顓犵閺夊牆澧介崚浼存煕濡崵鐭掓鐐茬箰鐓ゆい蹇撴噳閹锋椽姊洪崨濠勨槈闁挎洩绠撻崺銉﹀緞閹邦厾鍙嗛梺鍝勬处閿氶柨鐔诲Г閻楃娀鐛崼銉ノ╂い顓熷灦闉嬬紓鍌氬�峰ù鍥ㄣ仈閸濄儲鏆滈柨鐔哄Т缁犳牠鏌嶉崫鍕櫣缂侊拷閸愵喗鐓犵痪鏉垮船閸樺摜绱掓潏銊х疄闁哄矉绲鹃幆鏃堝Χ鎼淬垻绉锋繝鐢靛仜瀵爼鈥﹂崶顒�绠查柕蹇嬪�曠壕濂告煟閹存繃宸濈紒瀣箰閳规垿鎮╃紒妯婚敪濠电偠顕滄俊鍥╂閻愬搫鐐婃い鎺嶈兌閸樻捇姊洪崨濠勭畵閻庢凹鍓熷鎼佹晜閸撗咃紲闁哄鐗勯崝宀�寰婃繝姘厓閻熸瑥瀚悘鎾煙椤旂晫鎳呴柨鐔诲Г缁嬫帡鈥﹂崶鈺冪煓闁搞儺鍓氶埛鎴︽煕濞戞﹫榫氬瑙勆戦妵鍕箣濠垫劖鈻堝Δ鐘靛仜閸熸挳骞冨鍫熷殟闁靛闄勯悵鏇㈡⒒娴ｇ瓔娼愰柛搴㈠▕楠炲﹨绠涢弴顏呭婵ɑ鍓氬鎰版煙娓氬灝濡奸摶锝夋煟閹惧磭鍑瑰瑙勬礋閺岋絾鎯旈姀銏犳殹闂佺懓鍤栭幏锟�
				ClanBuildUPBean factionOpbean=new ClanBuildUPBean(clan.getKey(),opid, uplevel -1, uplevel,cost);
				fire.log.YYLogger.factionBuildUPLog(roleid,factionOpbean);
				
				return true;
			}
		};
		
		requestfactionlevelup.submit();	
	}
	
	public void SendAllFactionMemeber(xbean.ClanInfo clanInfo, int type, int data)
	{
		List<String> paras = new ArrayList<String>();
		paras.add(String.valueOf(data));
		int msgid = 160200;
		if (type == ClanManage.GoldBank)
		{
			msgid = 160219;
		}
		else if (type == ClanManage.DrugStone)
		{
			msgid = 160220;
		}
		else if (type == ClanManage.Hotel)
		{
			msgid = 160221;
		}
		
		for (long roleid : clanInfo.getMembers().keySet())
		{
			MessageMgr.psendSystemMessageToRole(roleid, msgid, paras);				
		}
		
		//濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮诲☉妯锋婵鐗婇弫楣冩⒑閸涘﹦鎳冪紒缁樺姍濠�渚�姊虹粙璺ㄧ闁告艾顑囩槐鐐哄箣閿旂晫鍘遍梺闈涱焾閸庨亶鏁撻挊澶嬪仴鐎殿喖顭烽弫鎰緞婵犲嫷鍟嬮柣搴ゎ潐濞叉牕煤閵堝浼犳繛宸簼閳锋垿鏌涘┑鍡楊伌闁稿孩鍔欓弻锝呂旀笟鍥ㄧ暭闂佺懓绠嶉崹褰掑煡婢舵劕顫呴柣妯活問閸氬懘姊绘担铏瑰笡闁告梹鐟ラ…鍥樄鐎殿喗濞婇弫鎾绘偐閺傘儲瀚奸梻浣藉吹閸犳劕顭垮Ο浣曪絾绻濆顓犲幈闂侀潧楠忕槐鏇㈠矗閿熶粙姊洪幐搴ｇ畼闁稿鐩崺鐐哄箣閻欏懏瀚归柨婵嗛娴滄粌霉濠婂嫷娈滈柡宀�鍠栧畷妤呮嚃閳哄倹顔冮梻浣规偠閸斿秴危閹烘桅闁归偊鍘介崕鐔搞亜椤愵偄骞樼紒鐘冲哺濮婃椽妫冨☉姘暫濠电偛鐪伴崐鏇㈠汲閳哄懏鈷掑ù锝勮閻掔偓銇勯幋婵囶棦闁诡垰瀚伴、娑橆潩鏉堛劍顔曟俊鐐�栭悧婊堝磿閹版澘鏋佺�广儱妫涚弧锟芥繝鐢靛Т閸婃悂顢旈埡鍛闁哄鍩婂銉╂煃鐟欏嫬鐏撮柟顔规櫇缁辨帒螣婵犳碍鏆樺┑锛勫亼閸婃牠宕归悽绋跨疇闁归偊鍠栭崹婵嬫煕椤愵偅绶涢柟椋庡厴閺佹劖鎯旈垾鑼寜濠电偛鐡ㄧ划宥囧垝閹捐钃熼柣鏃傚帶娴肩娀鏌涢弴銊ュ辅闁靛牆顦伴悡鏇㈡煛閸屾繃纭堕弽锟犳⒑闂堟稒鎼愰悗姘緲椤曪綁顢楅崟顐ゎ唶闁硅偐琛ュΣ鍛ｉ崡鐐╂斀闁绘垵娲ㄩ崚鐗堢箾鐏炲倸锟芥繈寮崘顕呮晜闁割偅绻勯悾鍝勨攽閻愬弶顥為柟灏栨櫊瀵偊宕掗悙瀵稿幈闂佸搫娲犻敓钘夌－閸橆偊鏌ｆ惔銏ｅ缂傚秴锕濠氬灳閹颁礁鎮戦柟鑹版彧缁茶偐鍒掔捄琛℃斀闁绘劖娼欓悘锕傛煟閻曞倿妾柛鎺戯躬楠炴﹢顢欓挊澶夌敾婵犵數鍋涘Λ妤冩崲閹伴偊鏁傞柍鍝勫枦閹峰嘲鈻撻崹顔界亪濠电偛鐨烽敓鑺ュ墯濞兼牗绻涘顔荤凹妞ゃ儱鐗婄换娑㈠箣閻愯泛顥濆銈忕到閹碱偊鈥旈崘顔嘉ч煫鍥ㄦ礈缁愭姊洪崨濠庢當闁哥喎娼￠幃楣冩倻閽樺鐤�濡炪倖鎸炬慨鐑芥儊閸績鏀芥い鏃�鏋绘笟娑㈡煕濮楋拷缁犳牕鐣烽敐澶婂耿婵炴垶鐟㈤幏娲⒑閸涘﹦绠撻悗姘煎幘缁﹪鍩℃导杈╂嚀椤劑宕熼鐘垫毉闂備浇娉曢崰鏇熸叏閵堝鍤岄柛鎾楀懐顦繝鐢靛Т閸嬪棗顭囬弽褉鏀介柣妯虹枃婢规﹢鏌ｉ幇顒婂姛闁硅尙顭堥…銊╁礂閹惧懐绉�规洜鍏橀、姗�鎮╃喊澶屽簥缂傚倸鍊搁崐鐑芥倿閿曞倵锟斤箓宕堕埡鍐х瑝闂佸搫绋侀崑鍡欏閼测晝纾藉ù锝堫嚃閻掔晫绱掗悩闈涗户闁跨喎锟界噥娼愭繛鍙夘焽閺侇噣骞掑Δ瀣◤濠电娀娼ч鎰板极閸ヮ剚鐓熸俊顖氭惈閼歌銇勯妷锕�鍝烘慨濠傤煼瀹曟帒顫濋濠冨闁绘垼濮ら崵鍕煕椤愶絾纾甸柨鐔告灮缁犳挸鐣锋總鍛婂亞濞达綀顕栭崯宥夋⒒娴ｅ憡鍟炵紒鍝勬健瀹曟洘绻濆顒傤唵閻庣懓瀚竟瀣ｉ崼銉︾厵闁绘垶蓱鐏忎即鏌ｅ┑鍥╁⒌婵﹥妞介幃鐑藉箥椤旂偓娈梻浣规偠閸斿瞼绱炴繝鍥ф槬闁靛绠戠欢鐐烘煙闁箑澧绘繛鐓庯躬濮婅櫣绱掑鍡欏姼闁诲繐娴氭禍顏堝极閹剧粯瀵犲璺哄閾忓骸顪冮妶搴濈盎闁哥喎鐡ㄦ穱濠囧醇閺囩偛鑰垮┑鈽嗗灣閸庛倕鈻撻锔解拻濞达絽鎲￠幉绋库攽椤旇姤灏﹂柡灞斤躬閺佹劖寰勯崼顒佸濞撴熬鎷风�殿噮鍣ｅ畷濂告偄閸涘浠ч梻鍌欐祰濞夋洟宕抽敃鍌氱闁跨噦鎷�
		fire.pb.clan.srv.ClanManage.addDealClanEventInfo(clanInfo,fire.pb.clan.srv.ClanManage.EVENT_BUILD_UP,0,fire.pb.clan.srv.ClanManage.getClanBuildNameByType(type),data+"","");
		
	}

	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 808472;

	public int getType() {
		return 808472;
	}

	public int id; // 1大厅2金库3药店4旅馆 by changhao

	public CRequestClanLevelup() {
	}

	public CRequestClanLevelup(int _id_) {
		this.id = _id_;
	}

	public final boolean _validator_() {
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		_os_.marshal(id);
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		id = _os_.unmarshal_int();
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CRequestClanLevelup) {
			CRequestClanLevelup _o_ = (CRequestClanLevelup)_o1_;
			if (id != _o_.id) return false;
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		_h_ += id;
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append(id).append(",");
		_sb_.append(")");
		return _sb_.toString();
	}

	public int compareTo(CRequestClanLevelup _o_) {
		if (_o_ == this) return 0;
		int _c_ = 0;
		_c_ = id - _o_.id;
		if (0 != _c_) return _c_;
		return _c_;
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

