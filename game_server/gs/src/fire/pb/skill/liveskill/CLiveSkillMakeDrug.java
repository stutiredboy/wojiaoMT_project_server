
package fire.pb.skill.liveskill;





import fire.log.enums.YYLoggerTuJingEnum;
import fire.pb.item.AddItemResult;
import fire.pb.item.BagTypes;
import fire.pb.item.Pack;
import fire.pb.item.SFoodAndDrugEffect;
import fire.pb.main.ConfigManager;
import fire.pb.skill.SSkillError;
import fire.pb.skill.SkillConstant;
import fire.pb.skill.SkillRole;
import fire.pb.util.Misc;



// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CLiveSkillMakeDrug__ extends mkio.Protocol { }

// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

/***
 * 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴椤㈡洟鏁愰崱娆欑穿闂備浇娉曢崰鎰板几閼姐倗涓嶉柟鎯х－閺嗭箑鈹戦崒婊庣劸閸烆垰顪冮妶鍡橆梿濠殿喓鍊曢埢宥夊醇閵夛腹鎷绘繛杈剧秬濞咃綁濡存繝鍥ㄧ厱闁规儳顕粻鐐烘煃閵夘垳鐣电�规洖鐖奸、妤呮晸娴犲鍋傛俊顖溿�嬮幏鐑界嵁閸喖濮庡銈忕細閸楁娊骞冮敓鐘插嵆闁绘棁娅ｉ惁鍫ユ⒒閸屾氨澧涚紒瀣浮钘熸繝濠傚娴滄粓鐓崶椋庡埌濞存粈鍗抽弻鈥崇暆鐎ｎ剛鐦堥悗瑙勬礋娴滃爼鐛崶顒夋晢濠电姴鍟璺衡攽閻樼粯娑фい鎴濇嚇閹锋垿鎮㈤崗鑲╁帾婵犵數鍋熼崑鎾斥枍閸℃稒鐓曢悗锝庝簼椤ャ垽鏌＄仦鍓с�掑ù鐙呯畵瀹曟粏顦俊鎻掔墕椤啴濡堕崨瀵稿椽闂佺懓鍤栭幏锟�
 * @author changhao
 *
 */
public class CLiveSkillMakeDrug extends __CLiveSkillMakeDrug__ {
	@Override
	protected void process() {
		// protocol handle

		final long roleid = gnet.link.Onlines.getInstance().findRoleid(this);
		if (roleid < 0)
			return;
		mkdb.Procedure liveskillmakedrug = new mkdb.Procedure()
		{
			@Override
			protected boolean process()
			{
				SkillRole skillrole = new SkillRole(roleid);
				
				xbean.LiveSkill liveskill = skillrole.getLiveSkills().get(LiveSkillManager.LIVE_SKILL_TYPE_MAKE_DRUG);	//闂傚倸鍊搁崐鎼佸磹閹间礁纾圭�瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟偡濠婂啰效婵狅拷娓氾拷濮婅櫣绱掑Ο铏逛紘濠碘槅鍋勭�氭澘顕ｉ崨濠勭懝闁跨喍绮欏璇测槈濡攱顫嶅┑顔筋殔閻楀﹪寮幆褉鏀介柣鎰级閸ｈ棄鈹戦鑲╀粵缂佸矁椴哥换婵嬪炊椤儸鍥ㄧ厱婵炴垵宕弸娑欑箾閸滃啰绡�婵﹨娅ｉ幑鍕Ω閵夛妇浜炴繝纰樻閸嬪嫮锟芥碍婢橀悾鐑筋敍閻愯尙楠囬梺鐟邦嚟婵潧鈻撴ィ鍐┾拺闂傚牊鍗曢崼銉ョ柧婵炴垶姘ㄥΛ顖滄喐閺冨牆钃熼柣鏃傚皑閹风兘鎮藉▓璺ㄥ姼婵炲濯存俊鍥箖椤曪拷閺佹劖寰勭�Ｑ勫闂佽崵濮村ú銈咁嚕閸洖绠查柨婵嗘缁犻箖鏌涘☉鍗炰簻闁诲繐寮堕〃銉╂倷閼碱剛顔掗梺璇″枟缁捇骞婇悙鍝勎ㄧ憸宥夌嵁閸儲鈷掑ù锝呮啞閹牊绻涚仦鍌氱伈鐎规洘绻勬禒锕傛倷椤掍胶褰挎俊鐐�栧鍦矈绾懌浜归柟鐑樻尭娴滃綊姊洪幆褎绂嬮柛瀣╃劍缁傛帡濮�閻橆偅鏂�濡炪倖姊婚妴瀣涘顓犵闁告粌鍟伴幃鍏间繆閸欏濮嶆鐐村浮楠炲﹤鐣烽崶褎鐏堥梺鍦劜缁绘繃淇婇崼鏇炲窛妞ゆ挾鍠曠欢銏ゆ⒒閸屾艾锟芥悂宕愰悜鑺ュ殑闁割偅娲忛敓鎴掔劍缁绘繈宕堕懜鍨珨婵犵數濮撮敃銈夊箠韫囨挾鏆﹂柛娆忣槺缁★拷闂傚倸鐗婄粙鎺楁儗濡ゅ啰纾奸悹鍥у级椤ャ垽鏌″畝瀣М濠殿噯鎷烽梺缁樏崯鍧楀汲閸儲鈷戠紒瀣儥閸庡繘鎮楀顐㈠祮鐎殿喛顕ч埥澶婎煥閸涱垱婢戞繝娈垮枟閿曗晠宕楀☉妯炑兾旈崨顔规嫼闂佸憡绋戦…顒勬倿娴犲鐓涘ù锝囩摂閸ゆ瑦銇勯銏㈢闁圭厧婀遍幉鎾礋椤愩倧绱￠梻鍌欑窔濞佳団�﹂崼銉ョ？闁哄被鍎查崑鐔兼煏韫囧锟芥牠鍩涢幋锔界厽闁绘柨鎲＄欢鍙夌箾閸碍娅婇柡宀�鍠栧畷娆撳Χ閸℃浼�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴椤㈡洟鏁愰崱娆樻К闂備胶顭堢悮顐﹀礉鎼淬劌绠熸慨婵嗙灱閻わ拷闂佸搫鍟崐鏄忋亹妤ｅ啯鈷戦柛婵嗗閸屻劑鏌涢埡浣割伃鐎殿噮鍋婂畷鍫曨敆娴ｅ搫甯鹃梻濠庡亜濞诧箑煤閺嵮勬瘎闂傚倷绀侀幖顐︽儓濞嗘挸绀冮柣鎰靛墮閻︽粓姊绘笟锟藉褔鎮ч崱妞㈡稑螖娴ｇ懓寮块悷婊勬煥椤繑绻濆顒傤槹濡炪倖鍔戦崺鍕閸愵喗鍊甸悷娆忓缁�鍐煕閵婏箑顕滃ǎ鍥э躬閹虫粓妫冨☉姘辩嵁闂佽鍑界紞鍡涘礈濞嗘挾宓佺�广儱顦伴埛鎴︽偣閸パ冪骇闁圭櫢缍侀弻鈩冩媴鐟欏嫬锟芥劙鏌嶉妷顖滅暤鐎规洜鍘ч埞鎴﹀炊閵娧勵潠婵犵數濮烽弫鍛婃叏閻戝锟藉倿鎸婃竟鈺嬬秮瀹曘劑寮堕幋鐙呯幢闂備浇顫夊畷姗�顢氳缁顢涢悙瀵稿弳闂佺粯娲栭崐鍦拷姘炬嫹? by changhao			
				if (liveskill == null)
				{
					LiveSkillManager.logger.debug("CLiveSkillMakeDrug skilllevel error:" + roleid);
					psend(roleid, new SSkillError(SkillConstant.SkillError.SkillLevelNotEnough));
					return true;					
				}
				
				int skilllevel = liveskill.getLevel();
				
				boolean energyenough = LiveSkillManager.getInstance().ConsumeMakeEnergy(
						roleid, LiveSkillManager.LIVE_SKILL_TYPE_COOKING, skilllevel,"闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴楠炴﹢鎳犻澶嬓滈梻浣规偠閸斿秶鎹㈤崘顔嘉﹂柛鏇ㄥ灠閸愶拷濡炪倖鍔﹀锟界紒顔煎缁辨挻绗熸繝鍐伓濠电姰鍨煎▔娑㈩敄閸曨厽宕查柛鈩兦滄禍婊堟煛瀹ュ啫濡跨紒鐘虫崌閺屾稑顫濋鍌溞ㄩ梺鍝勭焿缁蹭粙鍩為幋锕�骞㈡繛鍡楃箳閸樹粙姊绘担鍛婃儓闁哄牜鍓熼幆鍕敍閻愵亷鎷锋笟锟藉鎾閳╁啯鐝抽梻浣规偠閸庮噣寮插┑瀣辈妞ゆ挶鍨洪埛鎺懨归敐鍛暈闁诡垰鐗婃穱濠囶敃閵忋倕寮伴悗瑙勬礃閸旀洟鍩為幋鐙呮嫹閿濆簼娴烽柟鑺ユ礋濮婃椽妫冨ù銉ョ墦瀵彃顭ㄩ崼婵堬紱闂佺硶鍓濈粙鎺楁偂閺囥垺鍊堕柣鎰絻閳锋棃鏌嶉挊澶樻Ч闁靛洤瀚粻娑㈠Ψ閿曪拷椤忥拷 ", 
						YYLoggerTuJingEnum.tujing_Value_liveskillcost, false);
				
				if (energyenough == false) //濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ゆい顓犲厴瀵鏁愭径濠勭杸濡炪倖甯婇悞锕傚磿閹剧粯鈷戦柟鑲╁仜婵″ジ鏌涙繝鍌涘仴鐎殿喖顭烽弫鎰緞婵犲孩缍傞梻浣虹帛閿氶柛鐔锋健瀵娊宕奸妷锔规嫼缂備礁顑嗛娆撳磿韫囨柣浜滈柟瀛樼箥濡拷閻庢鍠栭…閿嬩繆閹间礁鐓涢柛灞剧煯缁ㄤ粙姊绘担渚劸闁哄牜鍓涚划娆撳箣閿旂粯鏅滈梺璺ㄥ櫐閹凤拷?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌熺紒銏犳灍闁稿骸顦…鍧楁嚋闂堟稑顫岀紓浣哄珡閸ャ劎鍘遍梺鍝勭Р閸婃洘鏅堕弻銉﹀�垫慨姗嗗墰缁夋椽鏌″畝锟介崰鏍х暦濠婂棭妲鹃柣銏╁灡閻╊垶寮诲☉娆戠瘈闁稿本绋戞禒鎾⒑閸濆嫯顫﹂柛鏃�鍨甸锝夊箻椤旇棄锟界兘鎮归崶鍥у椤忓爼姊洪崨濠勨槈妞ゎ収鍓熷銊﹀鐎涙ǚ鎷婚梺绋挎湰閻熴劑宕楀畝锟界槐鎺楊敋閸涱厾浠搁悗娈垮枛椤攱淇婇幖浣哥厸濞达絽褰ㄩ弴銏＄厽閹兼惌鍨崇粔鐢告煕閻樻剚娈滅�规洘鍨垮畷鎺楁倷鐎电骞愰梻浣规偠閸庮垶宕曢柆宥嗗�舵い蹇撶墛閻撶喖鏌熼幆褍鑸归柛鏃撶畵閺屸�崇暆鐎ｎ剛袦閻庢鍠楅幐鎶藉箖濞嗘垶瀚氱憸搴ｏ拷姘秺閺屾盯鏁傜拠鎻掍紟闂佺懓鍢查崲鏌ワ綖濠靛鍊锋い鎺炴嫹妞ゅ骏鎷�? by changhao
				{
					psend(roleid, new SSkillError(SkillConstant.SkillError.EnergyNotEnough));
					return true;						
				}							
				
				Pack bag = (Pack)fire.pb.item.Module.getInstance().getItemMaps(roleid, fire.pb.item.BagTypes.BAG, false);
				
				int count = 0;
				
				int makingsweight = 0;
				
				if (makingslist.size() == 0) //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鐐劤椤兘寮婚敐鍛傜喎鈻庨幆褎顔勭紓鍌欒兌婵挳鎮樺璺何﹂柛鏇ㄥ枤閻わ拷闂佸湱鍋撻幆灞轿涢妶鍥╃＝濞撴艾锕ョ�氳绻濋悽闈浶㈡繛璇х畵閹繝濡烽埡鍌滃幗闂佸搫鍟ù鍌炲吹濞嗘垶鍋栨慨妯夸含绾捐棄霉閿濆牊顏犻悽顖涚〒缁辨帞锟斤綆鍋勭粭鎺撱亜閺囨ê鍔︾�规洜鍠栭、姗�濡搁敃锟介鍫曟⒑閹稿海绠撳Δ鐘叉啞缁傚秹鎮欏ǎ顑跨盎闂佹寧鏌ㄩ悘婵嗙暤閸℃稒鐓欐い鏃傜摂濞堟棃鏌嶇紒妯诲磳鐎规洖缍婇、娆撴偩鐏炲�熸嫬闂傚倸鍊烽懗鍫曗�﹂崼銉晞闁告稑鐡ㄩ弲婵嬫煏婢舵稑顩柍鐟扮Т閳规垿鎮╅崣澶婎槱闂佹悶鍊曢澶婎潖婵犳艾閱囬柣鏃�浜介敓鑺ュ笧缁辨帡骞囬闂存闂佸搫鐭夌徊楣冨箚閺冨牜鏁嶆繝濠傛啗閿濆鈷戦柛娑橈攻鐏忎即鏌ｉ悢鏉戝姦妞ゃ垺宀搁弫鎰板幢濡ゅ﹤娈奸梺璇插缁嬫帟褰滈梺褰掓敱濡炶棄顫忓ú顏呭亗閹兼惌鍠楃紞妤呮⒑缁嬪尅鏀绘繛鑼枛瀹曟椽濮�閵堝懘鍞堕梺闈涚箞閸ㄥ鏁嶅┑瀣拺缂佸瀵у﹢鎵磼鐎ｎ偆澧紒鏃傚枎椤粓鏁撴禒瀣摕鐎广儱娲︾�氭岸鏌ょ喊鍗炲姰鐟滄棃寮婚埄鍐╁闁荤喐婢橀～宥夋倵閸偅绶查悗姘煎墲閻忔帞绱撻崒娆戝妽閽冮亶鏌ｅ┑鍥ㄧ婵﹤顭峰畷鎺戔枎閹搭厽袦闂備礁婀遍埛鍫ュ磻閸℃稑绠栨い鏇嫹妞ゃ垺娲熼弫鍐晸閻ｅ苯顥氶柛褎顨嗛悡娑㈡倶閻愰鍤欓柛鏃�绮撻弻娑氾拷锝庝簻閿熻棄娼″濠氭晲婢跺﹥顥濋梺鍓茬厛閸犳宕愰鐐粹拺缂備焦蓱鐏忎即鏌ｉ悢鍙夋珔妞ゎ偄绻愮叅妞ゅ繐绉甸弲锝夋⒑闂堟丹娑㈠川椤旂瓔鍟呴梻鍌氬�峰ù鍥敋瑜忛幑銏ゅ箳閹炬潙寮块梺姹囧灮椤牊顢婇梻浣告啞濞诧箓宕归弶鎸庢殰闂傚倷绶氬褔藝娴犲鍊舵繝闈涱儏鍥存繝銏ｆ硾椤戝洭宕ｉ崱娑欌拺缂備焦蓱閻撱儵鏌涢妶鍡欏⒌妤犵偛绻橀幃婊堟嚍閵夈儰绨藉┑鐐舵彧缁茶棄锕㈡潏鈺冪煋闁绘垼濮ら埛鎺懨归敐鍛暈閻犳劧绻濋弻宥呯暋閹殿喖鈪甸悗瑙勬礃閸ㄥ墎鎹㈠┑瀣倞闁宠桨鑳堕妶锕傛⒒婵犲骸浜滄繛璇у缁瑩骞掑Δ锟介悿楣冩煙闂傚鍔嶉柣鎾卞劦閺岋綁寮撮悙璇ф嫹閸︻叏鎷峰鐐 by changhao
				{
					fire.pb.item.SFoodAndDrugEffect stuff = (SFoodAndDrugEffect) fire.pb.item.Module.getInstance().getItemManager().getAttr(LiveSkillManager.ITEM_TYPE_DRUG_MAKINGS_LOW);
					if (stuff == null)
					{
						psend(roleid, new SSkillError(SkillConstant.SkillError.ItemNotExist));
						return true;						
					}
					
					makingsweight = stuff.lianyaoMaterialWeight * 4;
					count = 4;
					
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闂囧鏌ㄥ┑鍡╂Ч濞存嚎鍊濋弻銈夊级閹稿骸浠村┑顔硷攻濡炰粙銆佸Δ鍛櫢闁伙絽鐬奸惌鎾绘煛鐏炶鍔滈柡鍛倐閺岋箑螣娓氼垱笑闂佽法鍠曞Λ鍕焽閿熺姴违濞达絿纭堕弸搴ㄦ煙閹咃紞妞わ富鍙冮幃宄邦煥閸愵亞顔掗柦妯荤箖閵囧嫰寮介妸褋锟芥帞绱掗悩鑽ょ暫闁哄瞼鍠栭獮鍡氼檨闁搞倗鍠栭弻娑㈡偄閸濄儱寮ㄩ梺鍝勭灱閸犳牠骞冨鍫熷殟闁靛闄勫▓鍛婁繆閻愵亜锟芥垿宕濇繝鍥х？闁汇垻顭堢粻鏍ㄧ箾閸℃ɑ灏紒鐙欏洦鐓欓悗娑欘焽缁犮儲绻涢崗鐓庡摵婵﹦绮幏鍛存嚍閵夛綇鎷烽崘顔界厽闁硅櫣鍋熼悾鍨殽閻愭潙鐏寸�规洖鐖奸、妤呮晸娴犲鍑犲〒姘炬嫹闁哄瞼鍠栧畷婊嗩槾閻㈩垱鐩弻锟犲川椤旇棄锟芥劙鏌＄仦璇插闁诡喓鍊濆畷鎺戔槈濮楀棔绱� by changhao
					if(bag.subMoney(-6000, LiveSkillManager.MakeDrug, fire.log.enums.YYLoggerTuJingEnum.tujing_Value_gonghuilianjin, 0) != -6000)
					{
						psend(roleid, new SSkillError(SkillConstant.SkillError.MoneyNotEnough));
						return false;	
					}
				}
				else if (makingslist.size() < 2) //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鐐劤椤兘寮婚敐澶婄疀妞ゆ帊鐒﹂崕鎾绘⒑閸濆嫬顏ラ柛搴ㄤ憾閸╃偤骞嬮敂钘変汗闂佸憡鐟ラˇ浼村箖濞嗘垹纾藉ù锝呮惈椤庡矂鏌涢妸銉у煟鐎殿喖顭锋俊鎼佸煛閸屾矮绨介梻浣侯焾閺堫剛绮欓幋锔绘晜闁跨噦鎷�?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鐐劤椤兘寮婚敐澶婄疀妞ゆ帊鐒﹂崕鎾绘⒑閹肩偛濡奸柛濠傛健瀵鈽夐姀鈺傛櫇闂佹寧绻傚Λ娑⑺囬妷褏纾藉ù锝呮惈瀛濈紓鍌氱Т閿曨亜顕ｇ拠宸悑濠㈣泛锕ｇ槐鍫曟⒑閸涘﹥澶勯柛瀣崌楠炲繘鏌ㄧ�ｎ剛鐦堝┑顔角滈崕濠氬箯閻戣棄宸濋柡澶嬪灩閻撴垶绻濋姀锝嗙【闁活剙銈搁幆渚�宕奸妷锔规嫽闂佺鏈銊︽櫠濞戞氨纾奸悗锝庡亜濞搭噣鏌℃担鍝バ㈡い鎾冲悑瀵板嫮锟斤綆鍓欓獮妤呮⒒娴ｅ憡璐￠柛搴涘�曠叅闁哄稁鍓﹂弳杈ㄧ節閻㈤潧鍓崇紒鑼舵鐓ら柕鍫濐槹閺呮繃銇勮箛鎾村櫢缂佽妫濋弻娑㈩敃閿濆棛顦ラ悗鐟版啞缁诲啴濡甸崟顖氭闁割煈鍠楅崐顖氼渻閵堝懐绠冲┑顔炬暩閹广垹鈹戦崼婵囩�冲┑鈽嗗灡濡炲灝顭囬幋锔解拺缂佸顑欓崕蹇涙煙閾忣偅宕屾鐐搭殜椤㈡洟濡堕崶鈺嬬闯濠电偠鎻紞锟芥繛鍜冪悼閺侇喖鈽夐姀锛勫幗闂佸啿鎼敃銈夋倶閻樼粯鐓熼柨婵嗘搐閸樺锟借娲╃换婵嬪箖濞嗗浚鍚嬮柛鈩兦氶幏褰掓⒑閻熸澘妲婚柟铏耿楠炲啴鏌ㄧ�ｎ亶鍤ら柣搴㈢♁閿曨偆妲愰鍕拻闁稿本鑹鹃敓鑺ユ倐瀹曟劕鐣￠幊濠傜秺瀹曟儼顦撮柡鍡畵閺岋綁濮�閵忊晝鍔哥紓浣瑰姈椤ㄥ﹪寮婚悢鍏肩劷闁挎洩鎷烽柡瀣枔閿熷�燁潐濞叉﹢鎮￠敓鐘茶摕婵炴垯鍩勯弫鍐煟濡绲诲┑顔奸叄濮婃椽鎸婃径濠冩闂佸摜濮甸悧鐘差嚕婵犳艾鍗抽柕蹇曞█閸炶泛鈹戦悩缁樻锭婵炲眰鍊曢埢宥堫樄婵﹥妞藉畷顐﹀礋椤掑﹦宸濈紓鍌欒兌婵敻骞戦崶褜鍤曢悹鍥ㄧゴ濡插牓鏌曡箛鏇烆潔闁靛ň鏅滈悡銉︾節闂堟稒顥為柛锝堫潐閵囧嫰顢楅敓浠嬎囬棃娑辨綎闁惧繐婀辩壕鍏间繆椤栨繂浜规い鎾冲悑缁绘稓锟芥稒顭囬惌銈吤瑰鍕煉闁挎繄鍋犵粻娑樷槈濞嗘劕鍔掗梻渚�娼荤�靛矂宕㈡ィ鍐╁亗闁瑰墽绮悡鐔兼煟濡搫甯犻柤鍓蹭邯閺屾盯寮捄銊愌咃拷瑙勬礃婵炲﹪鐛惔銊﹀殟闁靛鍨虹�氬ジ姊绘担渚敯闁稿鍔欏畷鎴濃槈閵忕姷顦┑顔筋殣閹风兘鏌＄仦鍓ф创鐎殿噮鍓熼幊妤咁敍濮橀棿绱旈梻鍌欑绾绢厾鍒掗鐐茬闁搞儺鍓欓弸渚�鏌熼崜褏甯涢柡鍛倐閺屻劑鎮ら崒娑橆伓? by changhao
				{
					psend(roleid, new SSkillError(SkillConstant.SkillError.OneStuffCannot));
					return true;
				}
				else
				{
					for (Integer makings : makingslist)
					{
						fire.pb.item.SFoodAndDrugEffect stuff = (SFoodAndDrugEffect) fire.pb.item.Module.getInstance().getItemManager().getAttr(makings);
						if (stuff != null)
						{
							fire.pb.item.ItemNameClassConfig classid = ConfigManager.getInstance().getConf(fire.pb.item.ItemNameClassConfig.class).get(stuff.getTypeid());
							if (classid != null)
							{
								boolean drugstufftype = classid.classname.equals(LiveSkillManager.DrugStuff);
								if (drugstufftype == true) //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄婵犲灚鍔栫紞妤呮⒑鐠恒劌鏋欐俊顐㈠瀹曟劙宕烽鐘电効闂佸湱鍎ゅΛ鎴﹀箯閻戣姤鏅查幖绮癸拷鑼嚬婵犵數鍋涢幊宀勫垂閽樺娼栨繛宸簼閸ゅ秹鏌曟径濠傛灓濞存粠浜ｅΛ鐔奉渻閵堝棛澧遍柛瀣☉鏁堥柡灞诲劜閳锋垶銇勯幒鐐村缂備礁顦遍弫濠氬箖閿熺姴唯闁冲搫鍊婚崢浠嬫⒑閸濆嫬鏆欓柛濠呭吹閺侇喖鈽夊▎宥勭盎闂侀潧顦崕鍝勎ｉ搹鍦＜閺夊牄鍔嶇亸顓熴亜閹剧偨鍋㈢�规洦浜畷姗�顢橀悙鏉戝壍婵犲痉鏉匡拷妤佹叏閻戣棄纾绘繛鎴欏灩閻ゎ喗銇勯幇鈺佸姢濞存粈绮欏娲嚒閵堝憛銏＄箾濞村娅囧ù婊咁焾閳诲酣骞嬮悩闈涚闂備胶绮崝妤呭磿閵堝鐓曢柟瀵稿У閸犳劙鏌ｅΔ锟介悧鍡欑箔閹烘嚚鐟邦煥閿熶粙宕￠幎钘夎摕婵炴垯鍨圭粻濠氭倵闂堟稒鍟為柛锛卞喚娓婚柕鍫濇缁岃法绱掗煫顓犵煓闁诡噣绠栭弫鎾绘偐瀹曞洤濮洪梻浣瑰濡礁螞閸曨垱鍎婃繝濠傜墛閳锋帒銆掑鐐濠电偘鍖犻崶銊ヤ罕闂佺硶鍓濋妵鍌氣槈濡攱顫嶅┑鐐叉閸旀牠鎮靛畡閭︽富闁靛牆妫楃粭鎺楁煕婵犲懎鍚瑰瑙勬礋瀹曟绮潪鎵泿闂備礁鎼崐鎼佹倶濠靛绠栭柟瀵稿仧缁★拷闂佽法鍠嶇划娆撶嵁瀹ュ鏁婇柛鎾楀秶搴婇梻鍌欒兌椤牓寮甸鍌滅煓闁瑰濮风粻鏃堟煃閸濆嫭鍣洪柣鎾崇箻閺屾盯濡烽敐鍛瀳婵犳鍠栫粔鐢搞�冮妷鈺傚�烽柡澶嬪灦鐠囩偛螖閻橀潧浠︽い顓炴喘楠炴垿宕熼姘炊闂佸憡娲﹂崣搴ㄥ疮鐎ｎ剛纾介柛灞捐壘閿熻姤鎮傚畷鎰板箹娴ｅ摜锛欓梺缁樺灱婵倝宕愰崸妤佺叆闁哄倸鐏濋埛鏃堟煟椤撶喓鎳囬柡宀�鍠愬蹇涘箚瑜忓Σ锝夋⒑鏉炴壆顦﹂悗姘嵆瀵鈽夊Ο閿嬵潔濠碘槅鍨伴崥瀣箟婵傚憡鈷戠紒瀣皡瀹搞儵鏌ｉ弽褋鍋㈢�殿喛顕ч鍏煎緞婵犲嫬骞愬┑鐐舵彧缁蹭粙骞夐垾鏂ユ灁闁告挷鑳剁壕钘壝归敐鍛儓闁宠鐗忕槐鎺楁偐瀹曞洤鈷岄悗娈垮枦椤曆囧煡婢跺鐓ラ柛娑卞灡濠㈡垿姊绘担鍛婃儓婵炶绠撻妴鍐幢濞嗘瑦瀚规慨姗嗗幘閳藉鏌嶇憴鍕伌闁诡喗鐟╅幊鐘活敆閿熶粙路閿熺晫绱撻崒娆戣窗闁哥姵鐗犻弻濠囨晲婢跺﹥鐎梺鐟板⒔缁垶宕靛澶嬬厪濠㈣埖锚閺嬫盯鏌￠崨缈犳喚婵﹥妞藉Λ鍐煛閸愵�綁姊洪幖鐐插闁绘牕銈搁幃浼搭敊鐠恒劎鏉稿┑鐐村灦閻燂箑鈻嶉姀銈嗏拺閻犳亽鍔屽▍鎰版煙閸戙倖瀚�?  by changhao
								{
									makingsweight += stuff.lianyaoMaterialWeight;
									
									//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴椤㈡洟鏁愰崱娆樻К缂傚倷鑳舵慨閿嬬箾閿熶粙鏌″畝锟介崰鏍х暦濠婂棭妲鹃柣銏╁灡閻╊垶寮诲☉姘炬嫹閿濆啫濡奸柨鐔诲Г缁诲牆顕ｆ繝姘嵆闁绘棁娅ｉ鏇㈡⒑缂佹ê濮﹂柛鎾村哺閹敻寮崒婊咃紳婵炴挻鑹鹃敃銉э拷姘愁潐缁绘繈濮�閿濆懐鍘梺鍛婃⒐閻楃娀骞冮垾鏂ユ闁靛骏绱曢崢閬嶆⒑闂堟侗妲堕柛銊ユ惈閳诲秹宕ㄧ�涙鍘搁柣搴秵閸嬪嫰鎮橀幘顔界厸閻忕偛澧介埥澶愭煃鐠囧弶鍞夌紒鐘崇洴瀵挳鎮敓浠嬪船閸︻厾纾介柛灞剧懆閸忓瞼绱掗鍛仸闁诡垰瀚伴、娑㈡倷闂堟稓銈﹂梺璇插嚱缂嶅棝宕板Δ鍛９闁绘垼濮ら悡鏇㈡煙閼割剙濡芥繛鍛墕椤法鎲撮崟鎯帮拷璺拷瑙勬穿缁绘繈寮婚崱妤婂悑闁糕剝鐟ラ獮鍫熶繆閻愵亜锟芥牠宕濆Δ浣瑰弿闁圭虎鍠栫粈澶嬬節婵犲倻澧涢柣鎾跺枛閺岀喖骞嗚閹界姷绱掗敓浠嬪礃椤旂晫鍘梺鎼炲劀閸愬彞绱旀俊銈囧Х閸嬫稑煤椤撶倣娑㈠礃閵娿垺顫嶅┑顔筋殔濡瑥霉閸ヮ剚鈷掑ù锝囩摂閸ゆ瑩鎮楀☉鎺撴珚闁诡喓鍨介、妤呭礋椤愩値鍞甸梻浣芥硶閸ｏ箓骞忛敓锟�?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌熺紒銏犳灍闁稿骸顦…鍧楁嚋闂堟稑顫岀紓浣哄珡閸ャ劎鍘遍梺鍝勭Р閸婃洘鏅堕弻銉﹀�垫慨姗嗗墰缁夋椽鏌″畝瀣瘈鐎规洖鐖兼俊鐑藉Ψ瑜岄幃锝囩磽閸屾瑨鍏屽┑顕�鏀遍幈銊╂倻閼恒儲娅㈤梺鑺ッˇ閬嶆偩椤撱垺鐓曢幖绮癸拷瀹犲煘闁捐崵鍋炵换娑㈠箣濞嗗繒浠鹃梺绋款儑閸犳牠寮诲☉銏╂晝闁挎繂妫涢ˇ銊╂⒑缂佹ɑ灏伴柣鈺婂灦瀵鈽夐姀鐘栥劑鏌ㄥ┑鍡樺櫣濠殿喖閰ｅ铏规嫚閸欏顩版繛瀛樼矤娴滎亜顕ｆ繝姘櫜濠㈣泛锕﹂鎺楁煟鎼淬垻鈾佹い顓炴喘钘濆ù鐓庣摠閳锋垿鏌涘┑鍡楊伂妞ゎ偓绠撻弻娑㈠籍閿熶粙宕归崸妤冨祦闁告劦鍠栧洿婵犮垼娉涢敃锕傛晬濠婂啠鏀介柣鎰綑閻忥箓鏌ㄩ弴妤佹珕閻庨潧銈搁弫鎾绘晸閿燂拷? by changhao
									if(bag.removeItemById(makings, 1, fire.log.enums.YYLoggerTuJingEnum.tujing_Value_gonghuiyaofanguse, 0, LiveSkillManager.MakeDrug) == 1)
									{
										count ++;
									}						
								}								
							}
						}
					}		
				}
								
				if (count < 2) //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鐐劤椤兘寮婚敐澶婄疀妞ゆ帊鐒﹂崕鎾绘⒑閸濆嫬顏ラ柛搴ㄤ憾閸╃偤骞嬮敂钘変汗闂佸憡鐟ラˇ浼村箖濞嗘垹纾藉ù锝呮惈椤庡矂鏌涢妸銉у煟鐎殿喖顭锋俊鎼佸煛閸屾矮绨介梻浣侯焾閺堫剛绮欓幋锔绘晜闁跨噦鎷�?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鐐劤椤兘寮婚敐澶婄疀妞ゆ帊鐒﹂崕鎾绘⒑閹肩偛濡奸柛濠傛健瀵鈽夐姀鈺傛櫇闂佹寧绻傚Λ娑⑺囬妷褏纾藉ù锝呮惈瀛濈紓鍌氱Т閿曨亜顕ｇ拠宸悑濠㈣泛锕ｇ槐鍫曟⒑閸涘﹥澶勯柛瀣崌楠炲繘鏌ㄧ�ｎ剛鐦堝┑顔角滈崕濠氬箯閻戣棄宸濋柡澶嬪灩閻撴垶绻濋姀锝嗙【闁活剙銈搁幆渚�宕奸妷锔规嫽闂佺鏈銊︽櫠濞戞氨纾奸悗锝庡亜濞搭噣鏌℃担鍝バ㈡い鎾冲悑瀵板嫮锟斤綆鍓欓獮妤呮⒒娴ｅ憡璐￠柛搴涘�曠叅闁哄稁鍓﹂弳杈ㄧ節閻㈤潧鍓崇紒鑼舵鐓ら柕鍫濐槹閺呮繃銇勮箛鎾村櫢缂佽妫濋弻娑㈩敃閿濆棛顦ラ悗鐟版啞缁诲啴濡甸崟顖氭闁割煈鍠楅崐顖氼渻閵堝懐绠冲┑顔炬暩閹广垹鈹戦崼婵囩�冲┑鈽嗗灡濡炲灝顭囬幋锔解拺缂佸顑欓崕蹇涙煙閾忣偅宕屾鐐搭殜椤㈡洟濡堕崶鈺嬬闯濠电偠鎻紞锟芥繛鍜冪悼閺侇喖鈽夐姀锛勫幗闂佸啿鎼敃銈夋倶閻樼粯鐓熼柨婵嗘搐閸樺锟借娲╃换婵嬪箖濞嗗浚鍚嬮柛鈩兦氶幏褰掓⒑閻熸澘妲婚柟铏耿楠炲啴鏌ㄧ�ｎ亶鍤ら柣搴㈢♁閿曨偆妲愰鍕拻闁稿本鑹鹃敓鑺ユ倐瀹曟劕鐣￠幊濠傜秺瀹曟儼顦撮柡鍡畵閺岋綁濮�閵忊晝鍔哥紓浣瑰姈椤ㄥ﹪寮婚悢鍏肩劷闁挎洩鎷烽柡瀣枔閿熷�燁潐濞叉﹢鎮￠敓鐘茶摕婵炴垯鍩勯弫鍐煟濡绲诲┑顔奸叄濮婃椽鎸婃径濠冩闂佸摜濮甸悧鐘差嚕婵犳艾鍗抽柕蹇曞█閸炶泛鈹戦悩缁樻锭婵炲眰鍊曢埢宥堫樄婵﹥妞藉畷顐﹀礋椤掑﹦宸濈紓鍌欒兌婵敻骞戦崶褜鍤曢悹鍥ㄧゴ濡插牓鏌曡箛鏇烆潔闁靛ň鏅滈悡銉︾節闂堟稒顥為柛锝堫潐閵囧嫰顢楅敓浠嬎囬棃娑辨綎闁惧繐婀辩壕鍏间繆椤栨繂浜规い鎾冲悑缁绘稓锟芥稒顭囬惌銈吤瑰鍕煉闁挎繄鍋犵粻娑樷槈濞嗘劕鍔掗梻渚�娼荤�靛矂宕㈡ィ鍐╁亗闁瑰墽绮悡鐔兼煟濡搫甯犻柤鍓蹭邯閺屾盯寮捄銊愌咃拷瑙勬礃婵炲﹪鐛惔銊﹀殟闁靛鍨虹�氬ジ姊绘担渚敯闁稿鍔欏畷鎴濃槈閵忕姷顦┑顔筋殣閹风兘鏌＄仦鍓ф创鐎殿噮鍓熼幊妤咁敍濮橀棿绱旈梻鍌欑绾绢厾鍒掗鐐茬闁搞儺鍓欓弸渚�鏌熼崜褏甯涢柡鍛倐閺屻劑鎮ら崒娑橆伓? by changhao
				{
					psend(roleid, new SSkillError(SkillConstant.SkillError.OneStuffCannot));
					return true;					
				}
				
				int prob = GetProbByNum(count);
				
				int index = Misc.getRandomBetween(1, 1000);
				
				SLiveSkillMakeDrug msg = new SLiveSkillMakeDrug();
				
				if (index <= prob) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣洴钘濋柣銏㈩焾閺嬩胶锟藉箍鍎遍ˇ顖滅矆鐎ｎ偁浜滈柟鍝勭Ф閸斿秵銇勯弬鎸庡缂佺粯绻傞銉╂煥鐎ｎ偆鍑￠梺璺ㄥ枔閻涖倝宕惰椤斿棝姊虹紒妯虹伇濠殿喓鍊濋幃锟犲Ψ閳哄倻鍘搁梺鎼炲労閻撲線顢旈崼鐔凤拷鍫曟煠绾板崬澧鹃柟鐑筋棑閹叉挳宕熼鍌ゆФ闂備胶顭堢换鎴︽晝閵忋倕违濞达絽澹婂銊╂煥閻斿墎鐭欐鐐插暣閸┾剝鎷呴崣澶屼簴闂備礁婀遍…鍫濐啅閳哄懏鏅濋柛灞剧▓閹峰姊虹粙鎸庢拱闁荤啙鍥佸洭鏁冮崒娑氬幍缂佺偓婢樺畷顒佺閹殿噯鎷风憴鍕闁告梹锕㈡俊鐢稿箛閺夎法顔婂┑鐘绘涧濞诧箑鈻嶉崼鐔虹瘈闁汇垽娼ф禒婊勪繆椤愶絿鎳囨鐐村姍楠炴牗鎷呭灞濇洟鎮峰鍛暭閻㈩垱顨婇幃锟犲Ψ閳哄倻鍘介梺鍝勬川閸嬫盯鏁撻挊澶嬭础闁跨喕濮ら悢顒勫箯閿燂拷?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄婵犲灚鍔栫紞妤呮⒑鐠恒劌鏋欐俊顐㈠瀹曟劙宕稿纭锋嫹娴ｅ壊娼╅柤绋跨仛濞呫垺绻涚�电孝妞ゆ垵娲ら悾鍨瑹閿熶粙鎮￠锕�鐐婇柕濞э拷濡俱劑姊洪崫鍕櫤闁诡喖鍊垮濠氬Ω閳哄倸浜為梺绋挎湰缁嬫垿顢旈敓锟�? by changhao
				{
					fire.pb.item.SFoodAndDrugEffect jinchuang = (SFoodAndDrugEffect) fire.pb.item.Module.getInstance().getItemManager().getAttr(LiveSkillManager.ITEM_TYPE_DRUG_JIN_CHUANG);
					int jinchuangweight = jinchuang.getLianyaoWeight() - skilllevel * 2 - makingsweight;
					int drugtotalweight = LiveSkillManager.getInstance().drugtotalweight;
					
					int randomValue = Misc.getRandomBetween(0, jinchuangweight + drugtotalweight - 1);
					
					int curWeight = 0;
					
					int drug = LiveSkillManager.ITEM_TYPE_DRUG_JIN_CHUANG; //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴楠炴﹢宕ｆ径妯烩枈闂備胶绮敮鎺楁晝椤忓牆钃熼柡鍥╁枔缁犻箖鏌ｉ幇闈涘闁绘繃姊荤槐鎾存媴閸濆嫷锟藉矂鏌涢妸銉у煟鐎殿喖顭锋俊鎼佸煛閸屾矮绨介梻浣侯焾閺堫剛绮欓幋锔绘晜闁跨噦鎷�?缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閹冣挃闁硅櫕鎹囬垾鏃堝礃椤忓孩瀚归柨婵嗙凹缁ㄥジ鏌熼惂鍝ョМ闁哄矉缍侀、姗�鎮欓幖顓燁棧闂備線娼уΛ娆戞暜閹烘缍栨繝闈涱儐閸婇攱銇勯幒鐐村濡炪倕绻愰悥鐓庮潖缂佹ɑ濯寸紒娑橆儏濞堟劙姊洪崫銉ユ珡闁稿锕ら悾鐑藉箚闁附些缂傚倷鐒﹂崝鏍矙閹达腹锟芥棃宕橀鍢壯囨煕閳╁喚鐒芥い锔哄劦濮婃椽鎮烽弶鎸庢瘣缂備胶绮敃銏ゅΥ娴ｇ硶鏋庨柟鎯х－閻嫰姊洪崜鎻掍簽闁哥喎娼￠獮蹇撁洪鍛嫼缂佺虎鍘奸幊搴㈢瑜版帗鐓曢悗锝庡亞濞插锟借娲樼换鍫ョ嵁濮楋拷椤㈡瑩鎮剧仦钘夌疄闂傚倷娴囬～澶愬磿閹剁瓔鏁嬫い鎾卞灩缁犵娀鏌涘☉鍗炵仯缁炬儳鍚嬮妵鍕籍閸パ傛睏婵犫拃宥咁洭闁跨喎锟界噥娼愭繛鍙夌矒瀹曚即寮介婊愭嫹娴ｇ硶妲堟俊顖炴敱椤秴鈹戦鏂や緵闁告挻鐟х划濠氭倷濞村鏂�闂佺粯锚閻忔岸寮抽埡浣叉斀闁绘垵娲︾�氳绻濋悽闈涗粧闁告牜濞�瀹曟鎮欓鍌楁闁剧粯鐗犻弻娑橆煥閿熶粙鎮為敃鍌氱柧婵犲﹤鍠氬〒濠氭煏閸繃鍣界紒鐘卞嵆閺岀喖鎼归銏狀潕缂備緡鍠氱划顖炲Χ閿濆绀冮柍鍝勫暙楠炲牊淇婇悙顏勶拷鏍礉閿曞倸纾婚柛鏇ㄥ墯濞呯娀鏌熷▓鍨灓缁惧墽鍘ч…鍧楁嚋瀵版浜滈埢宥咁吋婢跺鍘搁悗鐧告嫹閻庯綆鍓涢敍鐔哥箾鐎电顎撳┑鈥虫喘楠炲繘鎮╅崹顐㈢彴閻熸粌娴烽敓鑺ヤ亢椤鎹㈠┑瀣棃婵炴垵宕崜浼存⒑閸濆嫷鍎庣紒鑸靛哺瀵鎮㈤悡搴ｎ槶閻熸粌绻掗弫顔尖槈閵忥紕鍘搁梺鍛婁緱閸犳宕愰幇鐗堢厸閻忕偠顕ф慨鍌炴煙椤斿搫锟芥繂鐣烽幒鎴旀婵妫旂槐锟�? by changhao
					if (randomValue < jinchuangweight) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閻樻爠鍥╁彄闁搞儯鍔嶉悡銉︺亜韫囨碍纭鹃柍瑙勫灴椤㈡瑩鎯岄顐＄盎闁伙絿鍏橀、妤呭礋椤愩垹浜堕梺璇叉捣閺佽顭囨繝姘濡炲瀛╅崰鍡涙煕閺囥劌澧版い锔诲枛椤啴濡舵惔鈥茬盎濡炪倧绠撴禍鍫曞极閹惧顩烽悗锝庡亝闁款參姊洪棃娑氬ⅱ妞ゎ厼鐗撻、姘舵晲婢跺﹪鍞堕梺鍝勬川閸嬬喖顢樺ú顏呪拺缂備焦鈼ら鍫熷�舵慨姗嗗劮閹烘挻鍎熼柕蹇嬪灮閻﹀牓姊哄Ч鍥х伈婵炰匠鍕浄闁冲搫鎳忛悡娆愮箾閼奸鍞虹紒銊ф櫕閿熻棄鐏氬姗�鏁冮鍫濈濠电姴鍟欢鐐寸箾閹寸偟鐜婚柟椋庡厴瀹曠螖娴ｅ弶瀚兼俊鐐�栫敮顏堝箯妞嬪海纾煎璺侯儑閸欙拷闂佽桨鐒﹂幑鍥箰婵犲啫绶為悗锝庝簼閻ｅ姊绘担鐑樺殌缁剧虎鍘界换娑㈡晸閼恒儯浜滈柕蹇婃濞堟洟鏌熷畡鐗堝殗鐎规洏鍔嶇换婵嬪礋閼搁潧顏舵俊銈忕到閸燁垶鍩涢幒鎴旀斀闁绘ɑ鐓￠妤�霉濠婂嫮鐭嬬紒缁樼〒閹风姾顦叉い鈺婂墰缁辨帡顢欓悾灞惧櫚濡ょ姷鍋涢澶愬极閸愵喗鏅稿ù鐘差儏缁�鍕煟濡櫣婀撮柨鐔诲Г鐢帡锝炲┑瀣�锋い鎺炴嫹妞ゅ繐鐖煎缁樻媴閸涘﹥鍎撻梺娲诲墮閵堢鐣锋导鏉戝唨鐟滃繘寮抽敂鐣岀瘈濠电姴鍊归敍宥嗕繆閺屻儳鐣洪柡宀嬬秮婵拷闁宠桨鑳舵禒顓㈡⒑閻戔晜娅撻柛銊ㄦ硾椤曪絾绻濆顓熸珳婵犮垼娉涢敃锕傤敊閹烘鈷戦柛娑橈工婵本銇勯弴鐔虹煉妤犵偛绻橀幃婊堟寠婢舵劖鏆呮繝寰锋澘锟窖囧箯閻戣姤鐓㈤柛鎰典簻閺嬫盯鏌″畝瀣М鐎殿噮鍣ｅ畷鎺戭潩鏉堫煈鍚囬梻鍌欑缂嶅﹪藟閹捐绀傛慨妤嬫嫹妤犵偛鍟撮幐濠冨緞閸℃浜栭梺鑽ゅУ娴滀粙宕濈仦鐐弿濠靛倸鎲￠埛鎴︽煕濠靛棗顏柍璇茬灱缁辨帞绱掑Ο鑲╃暤濡炪値鍋勭换姗�骞栬ぐ鎺戞嵍妞ゆ挾濯寸槐鍙夌節绾版ɑ顫婇柛銊﹀▕瀹曟洟濡堕崶銊ョ彴闂佺粯鍔楅弫鍝ュ閽樺褰掓晲閸涱喗鍎撻柡宥忕節濮婅櫣绱掑鍡樼暭婵犳鍠楅幐鎶姐�佸鑸垫櫜闁糕剝鐟ч惁鍫濃攽椤旀枻渚涢柛搴濈祷椤﹀弶銇勯鈩冪《闁圭懓瀚粭鐔碱敍濮橆剙顥庡┑鐘垫暩閸嬫盯骞婂畝鍕瀭闁芥ê顦藉鏍煣韫囨凹娼愮�规洖顦甸弻鏇熺箾閸喖濮曢梺缁樼缚閸ㄨ棄顫忓ú顏呭仭闁哄瀵ч锟介梻浣烘嚀閸ゆ牠骞忛敓锟�? by changhao
					{

					}
					else
					{
						//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鎯у⒔缁垳鎹㈠☉銏犵婵炲棗绻掓禒楣冩⒑缁嬫鍎嶉柛濠冪箞瀵寮撮悢铏诡啎閻熸粌绉归獮濠冩償閵娿儲杈堝┑掳鍊曢幊蹇涘煕閹寸姷纾奸悗锝庡幗绾爼鏌ｈ箛娑楁喚闁哄本绋撻敓鏂ょ秵閸嬪棝鍩ユ径瀣ㄤ簻闁哄倽娉曠粻浼存煃鐟欏嫬鐏寸�规洖鐖兼俊鐑藉Χ閸モ晜鏅ㄩ梻鍌氬�风粈渚�骞栭锕�鐤い鎰ㄦ寣濞差亜围闁割偒鍋呭В鎰節绾板纾块柛瀣灴瀹曟劙寮撮悩鍐插簥闂佸湱鍎ら〃鍛玻濡ゅ懏鐓涚�规搩鍠栭張顒傜礊鎼淬垻绡�闁汇垽娼ф牎闂佽偐鎳撴晶鑺ョ珶閺囥垹绀傞柤娴嬫櫇椤旀洟姊虹化鏇炲⒉闁挎岸鏌ｈ箛姘惈缂佽鲸甯￠獮鍥敇瑜庨悿浣糕攽椤旂》鏀绘俊鐐舵閻ｇ兘濡搁敂鍓х槇闂佸憡娲﹂崜娆忊枍閹寸姷纾介柛灞剧懆閸忓瞼绱掗鍛仯闁轰緡鍣ｉ獮鎺懳旀繝鍐╂珨闂備線娼ч¨锟藉┑鈥虫川瀵囨晸娴犲鈷戦柛娑橈工婵箑霉濠婂簼绨绘い顒�锕、姘舵晸閽樺娼栨繛宸簻瀹告繂鈹戦悩鎻掝仱婵℃彃鐗撳娲箰鎼淬垻鈹涚紓浣哄У閹告悂鎮鹃悜钘夘潊闁靛牆鎳愰濠囨⒑閻熸壆鎽犳慨濠傜秺瀵剟鏁撴禒瀣拻濞达綀娅ｇ敮娑欍亜椤撶偟澧︽い銏¤壘椤劑宕橀幆褎娅婇梻渚�娼чˇ顐﹀疾濠婂牊鍋傞柣鏃堟櫜缁诲棝鏌曢崼婵堢閻庢艾缍婂娲箰鎼淬垹顦╂繛瀛樼矋缁捇骞冩ィ鍐╁�婚柤鎭掑劚娴犳椽姊洪崨濠勨槈闁挎洏鍎遍埢宥夊閵堝棌鎷洪柣鐘充航閸斿苯鈻嶉幇鐗堢厵闁告垯鍊栫�氾拷? by changhao
						curWeight = jinchuangweight;
						for (fire.pb.item.SFoodAndDrugEffect e : LiveSkillManager.getInstance().druglist)
						{
							curWeight += e.getLianyaoWeight();
							
							if (randomValue < curWeight)
							{
								drug = e.getId();
								break;
							}
						}						
					}
					
					fire.pb.item.drug.GeneralDrug drugitem = (fire.pb.item.drug.GeneralDrug)fire.pb.item.Module.getInstance().getItemManager().genItemBase(drug, 1);
					//drugitem.setFlag( fire.pb.Item.BIND);
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閻樻爠鍥ㄧ厱闁靛鍨哄▍鍥煕濡厧鈻堟慨濠勭帛閹峰懘鎼归悷鎵偧闂備焦鎮堕崝宀勬偉閻撳寒鍤曢柟闂寸劍閸ゆ帡鏌曢崼婵囧窛妞わ富鍨跺娲传閸曨喚妾ㄩ悗鐧告嫹闁跨喍绮欏畷顒勬偨閸涘﹦鍘介梺缁橆焽閸庛倝顢旈悩缁樺�堕煫鍥ь儏婵倻锟借娲樼换鍫ュ箖閵忋倕绀傞柤娴嬫櫅楠炴劙姊绘担铏广�婇柛鎾寸箞瀹曟繈寮撮姀鈩冩闂佸吋浜介崕鑼矆鐎ｎ亖鏀介柍鈺佸暞鐏忥附顨ラ悙鏉戞诞妤犵偛顑夐、姗�鎮㈠畡鏉垮釜闂傚倸鍊烽懗鍓佸垝椤栫偛绀夐柨鏇炲�哥粈鍫熺箾閸℃ɑ鎯勯柡浣稿�块弻銈囩矙閸喗鍊庣紓浣筋嚙濡繈寮婚弴銏犻唶婵犻潧娲﹂幃娆撴煕閻斿憡鍊愭慨濠呮缁瑩宕归鍛Ψ闂備焦鎮堕崝灞筋焽閿熺姵鍋樻い鏃囨硶閻わ拷濠电偞鍨堕悷锕�鈻嶉姀銈嗏拺閻犳亽鍔屽▍鎰版煙閸戙倖瀚�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴椤㈡洟鏁愰崱娆樻К闂備胶顭堢悮顐﹀礉鎼淬劌绠熸慨婵嗙灱閻わ拷闂佸搫鍟崐鏄忋亹妤ｅ啯鈷戦柛婵嗗閸屻劑鏌涢埡浣割伃鐎殿噮鍋婂畷鍫曨敆娴ｅ搫甯鹃梻濠庡亜濞诧箑煤閺嵮勬瘎闂傚倷绀侀幖顐︽儓濞嗘挸绀冮柣鎰靛墮閻︽粓姊绘笟锟藉褔鎮ч崱妞㈡稑螖娴ｇ懓寮块悷婊勬煥椤繑绻濆顒傤槹濡炪倖鍔戦崺鍕閸愵喗鍊甸悷娆忓缁�鍐煕閵婏箑顕滃ǎ鍥э躬閹虫粓妫冨☉姘辩嵁闂佽鍑界紞鍡涘礈濞嗘挾宓佺�广儱顦伴埛鎴︽偣閸パ冪骇闁圭櫢缍侀弻鈩冩媴鐟欏嫬锟芥劙鏌嶉妷顖滅暤鐎规洜鍘ч埞鎴﹀炊閵娧勵潠婵犵數濮烽弫鍛婃叏閻戝锟藉倿鎸婃竟鈺嬬秮瀹曘劑寮堕幋鐙呯幢闂備礁婀遍崕銈夈�冮崨鏉戝瀭闁稿瞼鍋為悡娆撴煙椤栨粌顣兼い銉ヮ槺缁辨帡鎮╅棃娑欑亪闂佸搫鐬奸崰鏍ь潖閼姐倧鎷烽棃娑橆棌婵″樊鍠栭埞鎴﹀煡閸℃ぞ绨奸梺鎸庢磸閸ㄤ粙鎮伴锟藉浠嬵敃椤掍礁顏跺┑鐐村灦椤忎即骞嬮悩杈╁墾婵炲鍘ч悺銊╂偂閻旇偐鍙撻柛銉戝嫭宕崇紓浣瑰姈濮婂綊骞堥妸锔剧瘈闁告劏鏂傛禒銏犫攽閳藉棗浜滈柛鐕佸亰閸┿儲寰勬繝搴㈠兊闁哄鐗冮弲婊冾熆閺嶎厽鈷掗柛灞剧懆閸忓本銇勯鐐靛ⅵ闁轰礁鍟存俊鐑藉Ψ閸愩劍鎯堟い顓滃姂瀹曞ジ鎮㈤崨濠庝户闂傚倷绀侀崥瀣娴犲纾块悗娑欘焽閻濊埖淇婇娑氭菇濞存粍绮撻弻銊╁籍閸屾矮澹曢梺鍝勬－閸撴盯鏁撻懞銉晱闁哥姵顨呭嵄闁圭儤顧傞崶顒�绀堝ù锝堟閿涙粓姊虹紒妯忣亞澹曢銏犵叀濠㈣泛顑冩禍婊勩亜閹板墎鎮肩紒鐘靛仧閿熷�燁潐濞叉﹢銆冩繝鍥х疇闁哄稁鍘奸悡娑㈡煕閹邦剙鏆旈柛搴ㄦ涧椤繑绻濆顒傦紲濠电偛妫欓崺鍫澪ｉ锟藉娲捶椤撴稒瀚涢梺绋款儏閿曨亪鎮伴鐣岀瘈闁告侗鍨抽弶绋库攽閻愭潙鐏︽い顓炴喘閹儳煤椤忓應鎷虹紓浣割儓濞夋洟鎮橀柆宥嗙厱閻庯綆鍋嗗ú鎾煙闁垮鐏撮柟顔哄灲瀹曟鎳栭埡浣哥闂傚倷绀侀幖顐﹀疮椤愶箑纾归柟闂寸劍閸庡秹鏌熸潏楣冩闁绘挻鐟ч敓鐣屾嚀鐎氼厼顭垮Ο浣曪絾绻濆顓犲帗闂佽姤锚椤﹁棄危閹间焦鐓冮悹鍥皺鏁堝銈冨灪椤牓藝鏉堚晝纾奸柕濞垮劘閸嬨垽鏌″畝锟介崰鎰箔閻旂厧鍨傛い鏃傗拡濞煎酣鏌ｆ惔銈庢綈婵炲弶鐗犻幃銉︾附閹肩儑鎷锋担鑲濇梹鎷呴悷閭︼拷鎾绘⒑閸涘﹦绠撻悗姘煎墰缁濡烽敂鍓х槇闂佹眹鍨藉褎绂掗埡鍛厵婵炶尪顔婄花鐣岋拷鍨緲閿曘儳绮嬮幒鏃撴嫹閿濆簼绨介柡灞界墦濮婅櫣绮旈崱妤�顏存繛鍫熸⒒缁辨帡鎮╅棃娑掓瀰闂佺粯鎼╅崑濠傜暦閸洖惟闁挎棃鏁弫宥夋⒒娴ｇ儤鍤�闁搞垺鐓″畷鏌ュ蓟閵夘垳绋忓┑鐘绘涧椤戝棝宕愰柨瀣ㄤ簻闁硅櫣鍋炵�氱懓顪冮妶鍛寸崪闁瑰嚖鎷�? by changhao
					
					fire.pb.common.SCommon common = ConfigManager.getInstance().getConf(fire.pb.common.SCommon.class).get(159);
					int delta = Integer.parseInt(common.value);					
					
					int quality = Misc.getRandomBetween(Math.max(skilllevel - delta, 1), skilllevel);
					drugitem.setQuality(quality);
					
					if (bag.isFull())
					{
						fire.pb.item.ItemMaps tempBag = fire.pb.item.Module.getInstance().getItemMaps(roleid, BagTypes.TEMP, false);
						if (tempBag.doAddItem(drugitem, -1, LiveSkillManager.MakeDrug, fire.log.enums.YYLoggerTuJingEnum.tujing_Value_gonghuiyaofang, 2) != AddItemResult.SUCC)
						{
							return false;
						}
					}
					else
					{
						if(bag.doAddItem(drugitem, -1, LiveSkillManager.MakeDrug, fire.log.enums.YYLoggerTuJingEnum.tujing_Value_gonghuiyaofang, 2) != AddItemResult.SUCC)
						{
							return false;
						}						
					}
									
					msg.itemid = drug;
					msg.ret = 0;
					
					mkdb.Procedure.psendWhileCommit(roleid, msg);
				}
				else //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣洴钘濋柣銏㈩焾閺嬩胶锟藉箍鍎遍ˇ顖滅矆鐎ｎ偁浜滈柟鍝勭Ф閸斿秵銇勯弬鎸庡缂佺粯绻傞銉╂煥鐎ｎ偆鍑￠梺璺ㄥ枔閻涖倝宕惰椤斿棝姊虹紒妯虹伇濠殿喓鍊濋幃锟犲Ψ閳哄倻鍘搁梺鎼炲労閻撲線顢旈崼鐔凤拷鍫曟煠绾板崬澧鹃柟鐑筋棑閹叉挳宕熼鍌ゆФ闂備胶顭堢换鎴︽晝閵忋倕违濞达絽澹婂銊╂煥閻斿墎鐭欐鐐插暣閸┾剝鎷呴崣澶屼簴闂備礁婀遍…鍫濐啅閳哄懏鏅濋柛灞剧▓閹峰姊虹粙鎸庢拱闁荤啙鍥佸洭鏁冮崒娑氬幍缂佺偓婢樺畷顒佺閹殿噯鎷风憴鍕婵犮垺锕㈤崺銉﹀緞閹邦剦娼婇梺缁樕戦鏍船闂堟稈鏀介柨娑樺娴犳粍銇勯幋婵囧殗鐎规洘鐟︾粋鎺旓拷锝庝簽椤斿棝姊虹紒妯虹伇婵☆偄瀚板畷褰掑磼濞戞牔绨婚梺瑙勬緲婢у酣骞冩總鍛婄厱闁规惌鍨崇弧锟介梺鍝勭焿缁查箖骞嗛弮鍫濐潊闁绘ê寮堕惁鎾绘⒒娴ｅ憡鍟為柨姘舵煏閸喐鍊愰柛銊╃畺閺佸啴宕掑鍗烇拷鐐差渻閵堝懐绠版俊顐ｇ洴瀵墎绮欐惔鎾存杸闂佺粯鍔栧娆撴倶閸楃儐娓婚悗娑櫳戦崐鎰拷娈垮枟瑜板啴鍩為幋鐙呮嫹閿濆骸浜愰柟閿嬫そ濮婂宕掑鍗烆杸婵炴挻纰嶉〃鍛祫閻熸粎澧楃敮妤呮偂閺囥垺鐓涢柛灞剧矊娴犳粍绻涚仦鍌氾拷妤冨垝婵犳凹鏁嶉柣鎰嚟閸欏棝姊虹紒妯荤闁稿﹤婀遍敓鑺ョ啲閹凤拷 by changhao
				{
					msg.itemid = 0;
					msg.ret = 1;
					
					mkdb.Procedure.psendWhileCommit(roleid, msg);				
				}
				
				return true;
			}
		};
		
		liveskillmakedrug.submit();	
		
	}
	
	//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閻樻爠鍥ㄧ厱闁靛鍨哄▍鍥煕濡厧鈻堟慨濠勭帛閹峰懘鎼归悷鎵偧闂備焦鎮堕崝宀勬偉閻撳寒鍤曢柟闂寸劍閸ゆ帡鏌曢崼婵囧窛妞わ富鍨跺娲传閸曨喚妾ㄩ悗鐧告嫹闁跨喍绮欏畷顒勬偨閸涘﹦鍘介梺缁橆焽閸庛倝顢旈悩缁樺�堕煫鍥ь儏婵倻锟借娲樼换鍫ュ箖閵忋倕绀傞柤娴嬫櫅楠炴劙姊绘担铏广�婇柛鎾寸箞瀹曟繈寮撮姀鈩冩闂佸吋浜介崕鑼矆鐎ｎ亖鏀介柍鈺佸暞鐏忥附顨ラ悙鏉戞诞妤犵偛顑夐、姗�鎮㈠畡鏉垮釜闂傚倸鍊烽懗鍓佸垝椤栫偛绀夐柨鏇炲�哥粈鍫熺箾閸℃ɑ鎯勯柡浣稿�块弻娑㈩敃閿濆棛顦ㄩ梺鎶芥敱鐢帡婀侀梺鎸庣箓閹冲繘宕悙鐑樼厵妞ゆ牗姘ㄦ晶锕傛煛鐏炶锟芥洜鍙呴柣鐘叉穿鐏忔瑦绂掗埡鍛叄闁煎鍊曟禒锔剧磼缂佹绠炴俊顐㈠暙閳藉宕￠悙鎻掝棎闂佽姘﹂～澶愬箰閻戣姤鍊块柨鏇炲�哥粻鐐烘煏婵炲灝鍓婚柡鍐ㄥ亰閹风兘鏁愭惔鈥茬盎濡炪倕绻愰悥濂稿蓟閿濆棙鍎熼柕鍫濆缂嶅牆鈹戦悙鎻掔骇闁挎洏鍨藉顐﹀礃椤旂⒈娼婇梺闈涚墕濞层倗绮婇敃鍌涒拺閻熸瑥瀚粈鍐┿亜閺囧棗鎳愭稉宥夋煙閹澘袚闁绘挻鐩弻娑㈠箛椤撶儐鍤嬮柣搴㈣壘缂嶅﹤顫忛崫鍕殾闁搞儮鏅涚粭鈥斥攽閻愯泛鐨洪柛鐘查叄閿濈偠绠涢弮鍌滅槇濠殿喗锕╅崜娑㈡晬濠婂啠鏀介柣鎰级椤ョ偤鏌涢弮锟介〃濠冧繆閸洖绾ч幖瀛樻尰閺傦拷闂備焦鏋奸弲娑㈠疮閵婏妇顩烽柣妯肩帛閻撴洟鏌￠崒婵囩《闁绘帗鎮傞弻宥夊Ψ閿旂瓔妫冮悗瑙勬礃閿曘垽銆佸▎鎾村殐闁冲搫锕ら弫钘夆攽閻樿尙妫勯柡澶婂皡閹风柉顦规鐐茬箲椤︾増鎯旈敐鍡础婵＄偑鍊栭幐鍫曞礉瀹ュ浄鎷峰顒傜Ш婵﹤顭峰畷鎺戔枎閹邦喓鍋樻俊鐐�ら崑鍕囬棃娑氭殾闁哄洢鍨洪崑鍌涱殽閻戝棗澧柣鈺婂灠閻ｇ兘鎮㈢喊杈ㄦ櫖濠电偞鍨剁敮妤冿拷姘冲Г娣囧﹪鎮欓鍕舵嫹閺嶎厽鍋嬫繝濠傜墕绾惧鏌ｉ幇顔煎妺闁稿鍊块弻锟犲炊閳轰焦鐏佺紓浣叉閹风兘姊婚崒姘拷鎼佹偋婵犲嫮鐭欓柟鐑橆檪婢跺鐓ラ柛鏇楁櫃缁ㄥ妫呴銏″婵﹤婀辨禍鎼佹晝閸屾稓鍘搁柣蹇曞仜婢ц棄煤閺夋垟鏀介柍銉ョ－閸╋絿锟借娲熸禍鍫曞春閿熺姴纾兼繝濠傚椤旀洖鈹戦悩鍨毄闁稿孩鍨瑰濠囨寠婢规繃妞芥俊鑸靛緞鐎ｎ偅鐝栨俊鐐�曠换鎰板箠瀹ュ洦宕查柛鈩冪♁閻撴瑦銇勯弽銊р槈妞ゃ儱顑夐弻锝夊Χ韫囨柨顏堕梻鍌氬�风粈渚�骞栭锕�纾圭憸鐗堝俯閺佸嫭绻涢崱妯哄妞ゆ洟浜堕弻鐔煎礈瑜忕敮娑㈡煃闁垮娴柡灞剧〒娴狅箓宕滆閸ｎ垶姊虹粙璺ㄧ闁活剙銈搁幆锟芥い蹇撶墱閺佸洭鏌ｉ幇鐗堟锭闁绘挾鍠栭幃妤�鈻撻崹顔界亶閻熸粍婢橀崯鎾春閵夛箑绶為柟閭﹀墻濞煎﹪姊洪悙钘夊姎闁哥喐瀵х粩鐔煎箳濡や讲鎷绘繛杈剧导鐠�锕傛倿妤ｅ啯鐓熸い鎺炴嫹闁靛牏顭堥悾鐑藉箣濠靛啯顫嶅┑顔矫ぐ澶岀箔婢舵劖鈷戦柛婵嗗閳诲鏌ｈ箛鏂垮闁靛洦鍔欓獮鎺楀箻閸忓懏鐫忛梺璇叉捣閹虫挻绔熸繝鍥х獥闁哄稁鍘肩粈鍫ユ⒑椤掞拷缁夌敻鍩涢幋鐘电＜閻庯綆鍋掗崕銉╂煕鎼达紕绠婚柟顔筋殔椤繈鎮℃惔銏壕婵犵锟藉啿绾ч柛鏃�鐟╅悰顕�骞掑Δ锟界猾宥夋煙閻愵剚缍戞い蹇撶埣濮婃椽骞愭惔锝囩暤婵°倗濮甸幃鍌炴偘椤斿槈鏃堝礃椤忓拑绱℃俊鐐�栭幐鎾礈濠靛牊鍏滃Δ锝呭暞椤ュ棗顭跨捄渚剳缂佲槄鎷峰┑鐘垫暩婵挳宕锝嗗弿濠㈣泛鐬肩壕鐓庮熆閼稿緱顏堝几閻斿吋鐓欏〒姘仢婵＄晫绱掔紒妯肩疄鐎规洘甯掗埥澶娾枎韫囨挸顥掗梻鍌欐祰濡椼劎绮堟笟锟介幃褔骞樼拠鑼舵憰濠电偞鍨崹鐟版暜闂備胶鎳撻悺銊ф崲閸岀偛鍑犻柕鍫濐槹閻撶喖骞栧ǎ顒�鐏╅柍缁樻礃閹便劍绻濋崨顕呬哗闂佸綊顥撴繛锟芥鐐存崌楠炴帒鈹戦崱妞€劑姊婚崒娆戭槮闁硅绻濆畷褰掓偨閻㈢數顦繝鐢靛Т閸婂寮抽敃鍌涚叆婵犻潧妫Σ鍝ョ磼閿熶粙宕橀埞澶哥盎闂佸搫鍊圭�笛囷綖瀹ュ鐓忓璺烘濞呭棝鏌ｉ幘瀛樼缂佺粯鐩獮瀣枎韫囨洑鎮ｅ┑鐐茬摠缁孩鏅跺Δ浣衡攳濠电姴娴傞弫宥嗘叏濮楀棗澧诲ù鐓庡暙閳规垿顢欑涵鐑界反濠电偛鎷戠紞渚�鐛箛娑欏亹閻犲洩灏欐导瀣⒑閹勭闁稿妫滈妵鎰板蓟閵夛腹鎷绘繛杈剧悼閸庛倝宕甸敓浠嬫⒑閹肩偛锟芥牠鎮ч悩鑽ゅ祦闊洦绋掗弲鎼佹煥閻曞倹瀚�? by changhao
	public int GetProbByNum(int num)
	{
		if (num == 2)
		{
			return (int)(1000F * (2F / 3F));
		}
		else if (num == 3)
		{
			return (int)(1000F * (7F / 8F));
		}
		else if (num == 4)
		{
			return 1000;
		}
		
		return 0;
	}

	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 800519;

	public int getType() {
		return 800519;
	}

	public java.util.LinkedList<Integer> makingslist; // 材料链 by changhao

	public CLiveSkillMakeDrug() {
		makingslist = new java.util.LinkedList<Integer>();
	}

	public CLiveSkillMakeDrug(java.util.LinkedList<Integer> _makingslist_) {
		this.makingslist = _makingslist_;
	}

	public final boolean _validator_() {
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		_os_.compact_uint32(makingslist.size());
		for (Integer _v_ : makingslist) {
			_os_.marshal(_v_);
		}
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		for (int _size_ = _os_.uncompact_uint32(); _size_ > 0; --_size_) {
			int _v_;
			_v_ = _os_.unmarshal_int();
			makingslist.add(_v_);
		}
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CLiveSkillMakeDrug) {
			CLiveSkillMakeDrug _o_ = (CLiveSkillMakeDrug)_o1_;
			if (!makingslist.equals(_o_.makingslist)) return false;
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		_h_ += makingslist.hashCode();
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append(makingslist).append(",");
		_sb_.append(")");
		return _sb_.toString();
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

