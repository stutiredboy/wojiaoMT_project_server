
package fire.pb.skill.liveskill;

import java.util.HashMap;

import fire.log.beans.RoleSkillUpBean;






import fire.pb.attr.SRefreshRoleData;
import fire.pb.buff.BuffConstant;
import fire.pb.clan.srv.ClanManage;
import fire.pb.item.Pack;
import fire.pb.main.ConfigManager;
import fire.pb.skill.Result;
import fire.pb.skill.SSkillError;
import fire.pb.skill.SkillConstant;
import fire.pb.talk.MessageMgr;


// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CRequestLearnLiveSkill__ extends mkio.Protocol { }

// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

/***
 * 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氼參宕崇壕瀣ㄤ汗闁圭儤鍨归崐鐐烘偡濠婂啰绠荤�殿喗濞婇弫鍐磼濞戞艾骞堟俊鐐�ら崢浠嬪垂閸偆顩叉繝闈涱儐閻撴洘绻涢崱妤冪缂佺姴顭烽弻锛勪沪缁嬪灝鈷夐悗鍨緲鐎氼噣鏁撻弬銈囩У濞存粍绻堥、娆撳川椤撴稒鏂�闂佺粯鍔曞鍫曞煝閺囩伝鐟邦煥閸愵亜鐓熼悗娈垮櫘閸嬪﹤鐣烽崼鏇ㄦ晢濞达絽鎼敮楣冩⒒婵犲骸浜滄繛璇х畱鐓ら柡宓嫭鐦庨梻鍌氬�风粈渚�骞夐敍鍕床闁告劦鍠撻敓钘夊暞缁绘繈宕掗妶鍡欑▉缂傚倸鍊烽悞锕傗�﹂崶顒佸仭鐟滅増甯楅悡鏇㈡煏婢跺鐏ラ柛鐘宠壘椤洭鎳￠妶鍥╋紳闂佺鏈悷褔藝閿斿浜滈柨鏇炲�烽幉鍓э拷娈垮櫘閸嬪棝骞忛悩缁樺殤妞ゆ帊鐒﹂鏇㈡⒒娴ｅ憡鎯堟繛灞傚灲瀹曞綊宕烽鐘辩瑝闂佹寧绻傞ˇ浼存偂閵夆晜鐓涢柛鎰╁妼閿熺晫鎳撻埢宥夊即閵忥紕鍘卞┑顔筋殣閹烽攱绻涙担鍐叉搐閻撴﹢鏌熸潏楣冩闁稿﹦鍏橀弻銈囧枈閸楃偛顫╁銈忕稻濡炶棄顫忛搹瑙勫珰闁肩⒈鍓涢澶岀磽娴ｇ瓔鍤欓柛濠傛健瀹曟椽濮�閻欙拷閸氬鏌涘☉鍙樼凹闁诲骸顭峰铏规喆閸曨偄濮㈠銈嗘处閸欏啫鐣烽姀銈嗗仺闁告稑锕ら敓鐣屾暬閺岋綁鎮㈤崨濠勫嚒濡炪倕娴氭禍婵堟崲濠靛顫呴柍顓㈩杺娴滄粌鐣甸崟顒傜瘈闁汇垽娼ф牎缂佺偓婢樼粔褰掑箖閿熺姴绀冩い鏃傛櫕閸欏啫鈹戦埥鍡楃仧閻狅拷閿曪拷铻ｉ柛顐ゅ枍缁诲棝鏌涘▎蹇ｆЧ闁稿﹥鍔欓弻鈥崇暆鐎ｎ剛袦闂佽桨鐒﹂崝娆忕暦閹偊妲诲Δ鐘靛仜椤戝骞冨Δ鍐╁枂闁告洦鍓涢ˇ銉╂⒑缂佹澧柕鍫㈩焾閻ｅ嘲煤椤忓懏娅㈤梺缁橆焾鐏忔瑩藝閵娿儺娓婚柕鍫濇噽缁犱即鎮楀鐓庢珝鐎规洘鍔欓幃娆撴偨閻㈢绱抽梻浣侯焾閺堫剟鎳濇ィ鍐╂櫢闁兼亽鍎查崐鎰拷瑙勬礃閸旀瑩鐛弽銊﹀闁告縿鍎荤槐顔尖攽閿涘嫬浠滄い鎴濇噽閿熻姤绋堥弲婊堝礆婵犲啰闄勯柛娑橈功閸樻悂鏌ｈ箛鏇炰哗妞ゆ泦鍥х婵犲﹤鐗婇悡娑㈡煕濞戝崬鏋熼柛濠冨姍閺屸�崇暆鐎ｎ剛鏆犻柧浼欑到閵嗘帒顫濋悡搴ｄ画缂佹鍨垮缁樻媴閸涘﹥鍎撳┑鈽嗗亝缁秹濡甸弮鍫濈濞达綀鍊介敃鍌涚厱闁哄洢鍔岄弸銈夋煟閵堝繑瀚归梻鍌欑劍鐎笛呮崲閸岀偛绠犻幖杈剧悼鐏忕數锟藉箍鍎遍ˇ浼村煕閹达附鐓曟繝闈涙椤忣偊鏌ｈ箛娑楁喚闁哄本鐩幃鈺佺暦閸パ�鎷伴梻渚�娼уΛ鏃傜矆娓氾拷閸┿垺鎯旈妸銉ь啋闂佸搫顦伴崹鍫曨敇婵傚憡鈷掑〒姘炬嫹婵炰匠鍥ㄥ亱闁糕剝顦哄ú顏勎╅柍杞扮閸嬪秴顪冮妶鍡欏⒈闁稿鍋ら崺娑㈠箳閹炽劌缍婇弫鎰板炊閳哄倹鍟掗梻浣规偠閸婃洟宕幘顔艰摕婵炴垯鍨洪崑鎰版煣韫囷絽浜滅痪鐐▕閹鎲撮崟顒傤槬缂傚倸绉撮敃顏堢嵁閹邦厾绡�闁告劑鍔庣粣鐐烘煟韫囨洖浠ч柛瀣崌椤㈡瑩寮撮姀鈾�鎷绘繛鎾寸啲閹烽攱绻涙担鍐叉礌閿熸枻绠撻、姗�鎮㈤崜浣虹暰闂備焦鎮堕崕顕�寮插┑鍥┾枖鐎广儱顦伴悡娆愩亜閺嵮勵棞闁活剙銈稿畷顒勬偨閸涘﹦鍘介梺缁橆焽閸庛倝顢旈悩缁樼厱閹煎瓨绋戦敓鑺ョ箓閻ｇ兘顢涢悙鏉戯拷鐑芥煟閹寸儐鐒介柛姗�浜跺娲礃閸欏鍎撻梺绋匡龚椤曆呭弲闁诲孩绋掕摫闁告瑥绻愰埞鎴︽偐閹绘帊绨介梺缁樻崄閸嬫劙鏁撻崐鐕佹綈婵炲弶顭囬弫顕�骞掑Δ锟介悡婵嬪箹濞ｎ剙濡肩紒鐘冲▕閺岀喓锟芥稒顭囩粻鎾绘煠閸偄濮囬柍瑙勫灴閹晠宕归锝嗙槑闂備胶顭堥鍡涙儎椤栫偟宓佸┑鐘插�婚弳鍡涙煕閺囥劌浜滈柣搴幗缁绘稓锟界數顭堝瓭濡炪倖鍨靛ú銈夋偩閸偆鐟归柨鐔剁矙閹繝顢曢敃锟介悙濠囨煏婵炑嶆嫹婵′勘鍔戝娲传閸曨剙娅ら梺璇″枛閸婂灝顕ｆ繝姘╅柍鍝勫�告禍鐐烘⒑缁嬫寧婀扮紒瀣灴椤㈡棃鏁撻敓锟�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚敐澶婄闁挎繂鎲涢幘缁樼厱闁靛牆鎳庨顓㈡煛鐏炲墽娲存い銏℃礋閺佹劙宕卞▎妯恍氶梺鍝勵槴閺呮粎鎹㈤崼銉ヨ摕闁挎繂妫欓崕鐔搞亜閺嶃劎鐭岄弽锟犳⒒娴ｅ憡鎲稿┑顔炬暬閹冾煥閸涱厼鐏婃繝鐢靛У閸戝綊寮澶嬬厽闁归偊鍓﹂崵鐔兼煕濞嗗繑顥㈡慨濠呮缁辨帒螣閼姐値妲梻浣侯焾閿曘倕锕㈤柆宥嗘櫢闁兼亽鍎抽崯鏌ユ煙閸戙倖瀚�?
 * @author changhao
 *
 */
public class CRequestLearnLiveSkill extends __CRequestLearnLiveSkill__ {
	@Override
	/* 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ偆娲撮挊婵嬫煟閵忋埄鐒鹃柛銊ュ�歌灃闁挎繂鎳庨弳娆戠磼閻樺磭鈽夐棁澶愭煥濠靛棙鍣洪悹鎰剁磿缁辨帞锟斤絺鏅為崗宀�绱掓潏銊﹀磳鐎规洘甯掗～婵嬵敆婵犲啫顏堕梺缁樺灱婵倝宕愰崸妤佺叆闁哄洨鍋涢敓鐣屾暬閺佹捇寮妶鍥╂殼閻庤娲栭悥濂稿春閿熺姴绀冪憸蹇涙偡濠靛棌鏀介幒鎶藉磹瑜忓濠冪鐎ｎ亞鏌堝銈嗙墱閸嬬偤宕戦崒鐐寸厪濠㈣泛妫欏▍鍡涙煟閹捐泛鏋涢柡宀嬬節瀹曟帒顫濋崣妯挎婵＄偑鍊х徊鐐箾婵犲洤钃熼柨婵嗩樈閺佸洭鏌ｉ弮鍌氬妺闁革絼鍗冲娲传閸曨偒妲甸梺璺ㄥ枙濡嫮澹曢銏犳辈闁糕剝绋掗崐鐢告煥濠靛棝顎楀褌鍗抽弻锝夋晝閿熶粙鎮ч幘鎰佹綎闁绘垶蓱婵粓鏌熷▓鍨灈濠碘�茬矙濮婅櫣鎲撮崟顓熸啓閻庤娲滈弫鎼佸礆閹烘棑鎷烽敐搴℃灈缂佺姵濞婇弻锟犲礃閳哄倸闉嶉柣搴㈣壘缂嶅﹪寮婚妸銉㈡斀闁糕剝渚楅敓鑺ヮ殔闇夋繝濠傚缁犳牜绱掔紒妯兼创鐎规洏鍔戦、娆撳礈瑜忛崢婊勭節濞堝灝鏋涢柨鏇樺妼閳诲秹鏁愭径濠勵槺闂佸搫绋侀崢濂稿础閹惰姤鐓熼柟閭﹀幘閵堟挳鏌熼弸顐拷婵嗩潖缂佹ɑ濯撮柛娑橈工閺嗗牆鈹戦纭峰伐婵狅拷闁秴鏋佹い鏇嫹闁诡喗鐟╅幃婊兾熼悜妯兼瀫闂備礁鎼ˇ顖炴偋閸曨垰绀夐幖杈剧到婵剟鏌ㄩ悢缁橆棄闁宠鍨块、娆撳棘閵堝嫮杩旈梻浣告啞钃遍柟顔煎�块悰顔跨疀閹句焦妞介、鏃堝川椤忓懎顏归梻鍌欑閹诧紕绮欓幋锔芥櫇闁挎洖鍊搁悡鈥愁熆閼搁潧濮堥柣鎾卞劦閺岋繝宕堕張鐢电泿濡炪倐鏅╅崜娑氭閹烘鏁婄痪鎷屼含閸氬螖閻橀潧浠︽い顓炴川濡叉劙骞掗幊宕囧枛閹喚锟芥稒锚椤忓爼姊洪崜鑼帥闁稿鎳樺畷锝堢疀閺傚墽绠氬銈嗙墬缁瞼鏁崼鏇熷仺妞ゆ牗姘ㄩ崺锝夋煛瀹�瀣？闁跨喐鏋荤徊濠氬礉瀹�鍕櫢闁兼亽鍎崇粻鐐碉拷娈垮枦椤曆囧煡婢舵劕顫呴柍銉ュ帠濮规姊洪懡銈呅㈡繛澹洤骞㈡俊銈勭閸撶敻姊婚崒姘拷宄懊归崶褜娴栭柕濞炬櫆閸婂潡鏌ㄩ弴鐐诧拷鍝ョ不閺屻儲鐓曢柕澶樺枛婢ь噣鏌＄�ｂ晝绐旈柡宀�鍠栧畷婊嗩槾閻㈩垱鐩弻锟犲川椤旇棄锟芥劙鏌＄仦璇插闁诡喓鍊濆畷鎺戔槈濮楀棔绱� roleid by changhao*/
	protected void process() {
		// protocol handlen 
		final long roleid = gnet.link.Onlines.getInstance().findRoleid(this);
		if (roleid < 0)
			return;
		mkdb.Procedure requestlearnliveskill = new mkdb.Procedure()
		{
			@Override
			protected boolean process()
			{
				if (fire.pb.buff.Module.existState(roleid, BuffConstant.StateType.STATE_BATTLE_FIGHTER))
				{
					fire.pb.talk.MessageMgr.psendMsgNotifyWhileCommit(roleid, 142383, null);
					return true;
				}
				
				fire.pb.skill.SLifeSkill config = ConfigManager.getInstance().getConf(fire.pb.skill.SLifeSkill.class).get(id);
				
				if (config == null)
				{
					LiveSkillManager.logger.error("CRequestLearnLiveSkill config error:" + id);
					psend(roleid, new SSkillError(SkillConstant.SkillError.LiveSkillIdError));
					return true;						
				}
			
				fire.pb.skill.SkillRole skillrole = new fire.pb.skill.SkillRole(roleid);
				
				xbean.LiveSkill liveskill = skillrole.getLiveSkills().get(id);
				
				int requireLevel = 1; //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ょ紓宥咃躬瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欑粈鍐┿亜閺囧棗娲ら悡姗�鏌熸潏楣冩闁稿鍔欓弻娑樷枎韫囷絾效闂佽鍠楅悷褏妲愰幘瀛樺闁告繂瀚烽敓钘夌焸閺屾盯濡搁妷褍鐓熼悗娈垮枛椤攱淇婇幖浣哥厸闁稿本鐭花浠嬫⒒娴ｄ警鐒鹃柡鍫墰缁瑩骞嬮敂缁樻櫆闂佽法鍣﹂幏锟�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氼參宕崇壕瀣ㄤ汗闁圭儤鍨归崐鐐烘偡濠婂啰绠荤�殿喗濞婇弫鍐磼濞戞艾骞楅梻渚�娼х换鍫ュ春閸曨垱鍊块柛鎾楀懐锛滈梺褰掑亰閸欏骸鈻撳鍫熺厸鐎癸拷閿熶粙宕伴弽顓炶摕闁搞儺鍓氶弲婵嬫煥閻斿墎鐭欑�规洘绻堥獮鎺楀箻閸撲緡鍟庨柣搴ｆ嚀婢瑰﹪宕伴弴鐘哄С闁煎鍊楃壕濂告煟濞嗗繑鍣界紒澶樺櫍閺屸�崇暆鐎ｎ剙鍩岄柧浼欑秮閺屾稖绠涢幘铏�┑顕嗙到鐎氭澘顫忛搹鍦＜婵☆垵娅ｉ悷銊╂⒑閸涘﹨澹樻い鎴濇喘楠炴垿濮�閻橆偅顫嶉梺闈涚箳婵兘顢欓幒妤佺厽閹艰揪绲鹃弳鈺傘亜椤撶偟澧︾�殿喗濞婇弫鎾绘偐閺傘儲瀚奸梻渚�娼荤�靛矂宕㈡總绋垮偍闁圭虎鍠楅悡娑㈡煥閻斿墎鐭欓柡灞芥椤撳ジ宕ㄩ崒锔剧暤闁哄本鐩鎾Ω閵壯傚摋婵＄偑鍊ら崑鍕箠濮楋拷瀵顓兼径瀣檮婵犮垼娉涢鎰涢敓鐘斥拺婵懓娲ら敓鑺ユ尵濞嗐垹顫濋澶嬬稁闂佹儳绻楅～澶岋拷姘哺閺屽秹濡烽妸锔惧涧闂佽绻嬬欢姘潖濞差亜绠归柣鎰絻椤懎鈹戦埥鍡椾簻閻庢矮鍗抽獮鍐┿偅閸愨晛锟借崵绱掑☉姗嗗剱闁哄懏绻堝娲箰鎼淬垻鈹涢梺褰掝棑閸忔ê鐣烽鍕垫晬闁绘劗琛ラ幏娲⒒閸屾氨澧涢柣鈺婂灦閹澘顭ㄩ崨顖滐紲闁哄鐗勯崝宥囩矆閸愵亞纾奸柛灞炬皑鏁堥梺璇″枟閻熲晠骞冨鍏剧喖鏌ㄧ�ｎ亶浼滈梻鍌氬�烽懗鍫曗�﹂崼銉ュ珘妞ゆ帒瀚崑锟犳煏婵炵偓娅呯紒锟介崒婊愭嫹閻у憡瀚归梺璺ㄥ枔閺咁偄危閹版澘绠虫俊銈咃攻閺咁亪姊洪崨濠佺繁闁告鍋撶粋鎺楀箻椤旇В鎷洪梺闈╁瘜閸橀箖骞楅崒鐐寸厱閻庯綆浜烽煬顒侇殽閻愭彃鏆欓柣锝忕節閺屽洭鏁傞幆褍姹查梻鍌欑閹测�趁洪敃鍌氱婵炴垯鍨圭粈鍕煥閻斿搫校闁抽攱鍨块弻娑樷攽閸曨偄濮庨梺鍝勵儐閸ㄥ潡寮婚悢鐓庡窛濠电姴鍊甸弸娆撴⒑缂佹ü绶遍柛锝忕到閻ｅ嘲顫滈敓浠嬨�佸▎鎾村殟闁靛瀵屾禒褔姊婚崒娆掑厡缂侇噮鍨堕垾锕傚醇椤厾鍓ㄥ┑鐐叉閹稿寮查浣虹瘈濠电姴鍊绘晶娑㈡煃闁垮鐏╃紒杈ㄦ尰閹峰懏鎱ㄩ幋顓濈凹闁逛究鍔戝畷鍫曞Ω閿濆嫮鐩庨梻浣告惈濞层垽宕濈仦绛嬪殨妞ゆ梹鎷濋幏椋庢喆閸曨剛锛橀梺鎼炲姀濞咃絿鍒掔�ｎ喖绠抽柡鍐╂尰鐎氬綊鏌ㄥ┑鍡涱�楀ù婊勫姍閺岀喖鏌ㄧ�ｎ偁浠㈠┑顔硷工椤嘲鐣烽幒鎴僵闁告鍎愰弶绋库攽閻愬瓨灏扮痪鏉跨Ч閵嗗啯绻濋崶褏鐣洪梺缁樺姈閻ｎ亪宕戦崨瀛樼厱闁硅埇鍔嶅▍鍥煕濮楋拷娴滃爼寮婚悢鐓庣闁兼祴鏅滃▓顒勬⒑閸涘﹥鐓ユい鎴濐樀閻涱喗寰勯幇顓烇拷閿嬨亜閹存繂缍栫紒銊ヮ煼濮婃椽妫冨☉姘辩暰闂佸憡鎸荤换鍫ｆ＂闂佸壊鍋嗛崰鍡樼濠婂牊鐓忛煫鍥э工婢ц尙绱掗敓鐣岋拷锝庡枟閻撴稑霉閿濆浂鐒鹃柨鐔绘濞硷繝鐛崘顔肩鐟滃苯鈻介鍫熺參婵☆垯璀﹀Σ鐑樸亜閺冿拷閸ㄥ灝顫忔繝姘＜婵﹩鍓ㄩ幏鐑芥倻閼恒儱锟藉潡鏌ㄩ弴鐐诧拷鎼佸礄閻樻祴鏀介柛灞剧矤閻掗箖鏌ｉ妶鍥т壕缂佺粯鐩獮瀣枎韫囨洑鎮ｉ梻浣圭湽閸娿倝宕板Δ鍛﹂柛鏇ㄥ灠缁犳盯鏌涢锝嗙妞ゅ骸绉瑰铏圭矙閸栤�充紣闂佺粯鐗曢妶绋款嚕鐠囧樊鍚嬪璺猴梗缁卞爼姊洪崨濠冨闁告挻鐟ラ埢宥夊Χ婢跺鎷虹紓鍌欑劍钃遍悘蹇曟暬閺屾盯鎮╁畷鍥р拰閻庢鍠栭…宄邦嚕閹绢喗鍋勫瀣捣閻涱喗绻濈喊妯活潑闁搞劑娼ч埢宥夋晲閸℃瑯娴勫銈嗘尪閸ㄦ椽鎮￠悢鐓庣婵烇綆鍓欓悘顕�鏌涢悢鍝ュ弨闁哄瞼鍠栧畷娆撳Χ閸℃浼�? by changhao
				
				if (liveskill != null)
				{
					requireLevel = liveskill.getLevel() + 1;
				}
				
				if (requireLevel > config.skillLevelMax) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ剙浠遍柟顔ㄥ洦鍋愭慨鐟版祫閹烽攱绗熼敓钘夘嚕閹绢喖顫呴柣妯荤垹閸モ晛褰勯梺鎼炲劘閸斿秹鎮￠妷锔轰簻闊洦纰嶇涵楣冩煃鐟欏嫬鐏存い銏＄懇閹矂顢曢锛勭泿闂佷紮绲块崗姗�銆佸Δ鍛妞ゆ劑鍨规禍鍫曟⒑鐠囧弶鎹ｉ柡浣筋嚙椤洦绻濆顒傤唵婵＄偛顑呯�涒晠宕伴崱娑欑厱闁哄洢鍔屾晶鐗堛亜閿旇鏋涙い顏勫暣婵¤埖鎯旈垾鑼泿婵＄偑鍊х粻鎾寸閸洖鏋侀柟鎯ь嚟椤╃兘鎮楅敐搴′簼闂佹鍙冨娲濞戞艾鈪卞銈庡幖閻楁捇銆佸鑸垫櫜濠㈣泛锕崬鍫曟⒑閸濆嫭宸濋柛瀣枛椤㈡ê煤椤忓應鎷虹紓鍌欑劍閳笺倝顢旈崼鐔凤拷鑸垫叏濮楀棗鍔柟鐑樻尰閸庣喖鏌曡箛瀣伄闁伙箑鐗撳鍝勑ч崶褏浼堝┑鐐板尃閸曨収娴勯梺鍐叉惈閹冲繘鎮″▎鎰闁煎ジ顤傞崬铏圭磼閵娧勬珪闁跨喕妫勯悘姘熆濮楋拷閺佸啴顢旈崼婵堢枃闂佺粯鍔曢幖顐㈡暜闁荤喐绮岀换妤呭Φ閹扮増鍊锋い鎺戝�婚惁鍫ユ⒑濮瑰洤鐏叉繛浣冲啰鎽ュ┑鐘垫暩閸嬫盯鎯囨导鏉戠９婵犻潧顑呯粻鏍煕瑜庨〃蹇涘极鐎ｎ喗鐓ラ柣鏂垮閻瑧锟芥鍠涢褔鍩ユ径濞㈢喖鏌ㄧ�ｅ灚缍屽┑鐘殿暯濡插懘宕规导鏉戣Е閻庯綆鍠栫粻鐔封攽閸屾碍鍟為柍閿嬪灩缁辨挻鎷呴懖鈩冨灩娴滄悂妫冨☉鎺撴杸濡炪倖姊归崕鎶藉储閹绢喗鐓欐い鏍ュ�栫�氳淇婇悙顏勶拷鏇犳崲閹扮増鍋嬮柛鈩冪懅濡垳鎲搁弮鍫濊摕婵炴垟鎳囬敓鏂ょ畵楠炲鈹戦崶鈺�绮氶梻鍌欒兌绾爼寮插┑瀣；闁绘劕鐏氬畷鍙夌節闂堟侗鍎忛柣鎾存礋閺屻劑鎮㈤崜浣虹厯閻庤娲樼敮鎺楋綖濠靛鏁嗛柛灞久禒蹇涙⒒閸屾艾锟介绮堟笟锟介獮鏍敃閿旇棄鍓规繝銏ｆ硾閻偐绮堟繝鍋綊鏁愭径娑欏婵炴垶姘ㄩ悾楣冩⒒娴ｈ櫣甯涢柛銊у帶铻為柛鏇ㄥ亝閺嗘粓姊婚崒娆戝妽閻庣瑳鍏犳椽鍩￠崨顓狀唵闂備礁鐏濋鍥╃不妤ｅ啯鐓曟い鎰╁�曞▍蹇旂箾閸喓鐭掗柡宀�鍠栭、娆戠驳鐎ｎ偆鏆ラ梻浣哥－缁垶骞戦崶褏鏆︾憸鐗堝俯閺佸﹪鏌ｉ敐鍛殭闂侇収鍨跺濠氬磼濞嗘帒鍘＄紓渚囧櫘閸ㄥ爼骞冭椤劑宕煎┑鍡椾憾闁荤喐绮嶅Λ鍐嵁閸愨斂鍋呴柛鎰ㄦ櫇閸欏棝鏌ｆ惔顖滅У闁告挾鍠庨‖濠囶敋閿熻棄顫忓ú顏勫窛濠电姴瀚уΣ鍫ユ⒑閹稿孩纾搁柛濠冪墱缁顓奸崪浣哄弳闂佸壊鍋嗛崰搴ㄦ晸閻ｅ本鏆柡宀嬬秮閹垽宕ㄦ繝鍕殥婵＄偑鍊曞ù姘濠靛牊宕叉繝闈涱儏椤懘鏌嶉挊澶嬵棤闁告梻顭堥—鍐Χ韫囨洖顕辩紓渚囧枟閻熴儵锝炶箛鏃傜瘈婵﹩鍓涢敍婊冣攽椤旀枻渚涢柛鎾卞姂楠炲繘鎮滈懞銉ワ拷濠氭煠閹帒鍔氭繛鍫熷灴濮婃椽宕ㄦ繝鍐ㄧ煯闂佺粯甯粻鎾崇暦濡わ拷椤劑宕奸悢鍝勫箞婵＄偑鍊栭崝褏寰婇崜褏鐭嗛柨鐔剁矙濮婂搫效閸パ嶆嫹濡ゅ懎纾婚柟鎹愬煐瀹曞弶绻涢幋娆忕仼缂佺媴绲剧换娑㈠幢濡ゅ啰顔婃繛瀵稿█缁犳牕顫忛搹鍦煓闁割煈鍣崝澶婎渻閵堝啫濡奸柨鏇ㄤ簻椤曪絿鎷犲ù瀣潔濠殿喗锕╅崑鍛村礋閸愵喗鈷戦悹鍥ｏ拷宕囷拷濠氭煕閹般劍娅囨俊鍙夘殜濮婂宕掑▎鎴濆闂佽鍠栭悥鐓庣暦閹版澘鍐�妞ゎ兘鍓濆浠嬪箖閵忋倖鍋傞幖娣�栭幉浼存⒒娓氾拷濞佳嗗闂佸搫鎳忕划鎾崇暦閹达箑骞㈡繛鎴炵懅閸橀亶鏌ｈ箛鏇炰粶濠⒀傜矙閸┿儲寰勭�ｃ劋绨婚棅顐㈡储閸庤尙锟芥熬鎷�?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮诲☉妯锋婵鐗婇弫楣冩⒑閸涘﹦鎳冪紒缁樺姍濠�渚�姊虹粙璺ㄧ闁告艾顑囩槐鐐哄箣閿旂晫鍘遍梺闈涱焾閸庨亶鏁撻挊澶樼吋妤犵偛顦甸獮鏍ㄦ媴閻熼缃曢梻浣稿閸嬪懐鎹㈤崟顖涘仭闁哄被鍎查埛鎴犵磼鐎ｎ偒鍎ラ柛搴＄箲閵囧嫰鏁傞悙顒佹瘓閻庢鍠栭…宄邦嚕閹绢喗鏅柛鏇ㄥ幗濠㈡垿姊虹拠鎻掑毐缂傚秴妫欑粋宥夋倻閽樺顔嗛梺缁樺灱濡嫰宕￠幎鑺ョ厽闁瑰瓨绻冮ˉ婊堟煛閸涱垰孝闁宠鍨块幃鈺冪磼濡鏁繝鐢靛仜閻即宕归搹鍦焿鐎广儱鎷嬮悡銉╂煕椤愩倕鏋旈柛妯绘倐閹鐛崹顔煎闂佸摜鍣ラ崑鍛┍婵犲洤閿ゆ俊銈勮兌閸樻捇姊洪崨濠勬噣闁稿骸纾划锝夊籍閸喓鍘搁柣蹇曞仜婢т粙鍩︽笟锟介弻鐔碱敍濞戞瑯妫冨銈冨灪閻熲晠骞婇弽顓炵厸闁跨喍绮欏畷鐘诲冀椤愩倗锛濋梺绋挎湰閻燂妇绮婇弶娆炬富閻庢稒蓱閸婃劖顨ラ悙鏉戠伌鐎规洘鍎奸ˇ鎾煛閸☆厾鐣甸柡宀�鍠栭幃婊兾熼搹閫涙喚闂備礁鎼鍛存煀閿濆钃熼柣鏃傚皑閹风兘鎮藉▓璺ㄥ姼闁哥喐鎮傚铏规兜閸涱噮妫勯梺娲诲幖閸婃悂锝炶箛鏇犵＜婵☆垵顕ч鎾绘⒑缂佹ê鐏﹂柨姘箾閸繄鐒告慨濠冩そ楠炴牠鎮欑拠褎瀚归柡宥庡幗閸嬪鏌ｅΟ鍨惞鐎规挷绶氶悡顐﹀炊閵娧�妾ㄩ梺鍝勬噺閹倿寮婚妸鈺傚亞闁稿本绋戦锟�? by changhao
				{
					psend(roleid, new SSkillError(SkillConstant.SkillError.SkillMaxLimit));
					return false;						
				}
				 
				fire.pb.skill.SLifeSkillCost cost = ConfigManager.getInstance().getConf(fire.pb.skill.SLifeSkillCost.class).get(requireLevel);
				if (cost == null)
				{
					LiveSkillManager.logger.error("CRequestLearnLiveSkill cost error:" + requireLevel);					
					psend(roleid, new SSkillError(SkillConstant.SkillError.LiveSkillIdError));
					return false;					
				}
				
				xbean.Properties roleproperty = xtable.Properties.get(roleid);
				
				int roleidlevel = roleproperty.getLevel();
				
				if (config.studyLevelRule > 0)
				{
					int needLevelLimit = cost.needLevelList.get(config.studyLevelRule - 1);
					if (roleidlevel < needLevelLimit) //缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ょ紓宥咃躬瀵鏁愭径濠勵吅闂佹寧绻傞幉娑㈠箻缂佹鍘辨繝鐢靛Т閸婂綊宕戦妷鈺傜厸閻忕偠顕ф慨鍌滐拷娈垮櫘閸撶喎鐣疯ぐ鎺濇晩閻熸瑥瀚惁閬嶆⒒閸屾瑧鍔嶆俊鐐叉健瀹曘垺绂掔�ｎ偄浠梺鍐叉惈閹冲酣鎷戦悢鍏肩厽闁哄倽娉曞▓閬嶆煛鐎ｎ亪鍙勬慨濠佺矙瀹曞爼顢楁径瀣珨闁荤喐绮岀粔鍫曞矗閸涘瓨鈷戦柟绋垮缁屽潡鏌熼悜鑺ユ暠闁靛洤瀚伴、姗�鎮欑�电硶鏁嶇紓鍌欒兌婵數绮欓幋锕�鐓″鑸靛姇缁犳娊鏌ｉ幇顓熺稇妞ゅ繐鐖煎娲箰鎼淬垻顦ラ梺绋匡工閹芥粎鍒掓繝姘櫜濠㈣泛顑囬崢浠嬫⒑閻熸壆鎽犵紒璇插暣钘熸繝濠傜墛閻撴盯鏌涘锟界粈浣规櫠鐎涙ɑ鍙忓┑鐘插亞閻撹偐锟借娲樼敮鎺楀煝鎼淬劌绠ｆ繝闈涙－閻庢挳姊婚崒娆愮グ妞ゆ洘鐗犲畷浼村冀椤撶喎浜梺缁樻尭濞寸兘寮抽敃鍌涚厸闁搞儯鍎遍悞娲煛娴ｅ摜效闁哄矉缍侀獮鍥敍濮樿鲸顕楁俊鐐�х�靛矂宕抽敐澶婅摕闁绘梻鍘х粈鍌炴煠濞村娅嗘繛鍫墴濮婃椽宕ㄦ繝鍐弳闂佹椿鍘奸崐鍧楃嵁閸愵喖鐏抽柡鍌樺劜閺傦拷闂佽鍑界紞鍡涘磻閸℃稑鍌ㄩ柟闂寸劍閳锋垿鏌涘☉姗堝伐濠殿喖鍊块弻娑㈠棘閹稿孩鎷辩紓浣稿�哥粔鐢碉拷浣冨亹閿熻姤绋掗…鍥储閸偂绻嗛柣鎰▕閸庡繐螖閻樿櫕鍊愮�规洏鍨介獮姗�顢欓悾灞藉箺婵犵數鍋為崹闈涚暦椤掞拷閳诲秴顓奸崶閿嬪閻熸瑥瀚粈锟界紓鍌氱Т閿曨亪濡存担绯曟瀻闁圭偓娼欐禍妤呮煙閸忓吋鍎楅柛鐘愁殘缁辩偤骞樼紒妯锋嫽闂佺鏈懝楣冩晸閻ｅ苯鍘撮柟铏殜瀹曞ジ寮撮悙鐢垫瀮闂備浇顫夊畷姗�顢氳閹梹绻濋崶銊у幐闁诲繒鍋犻褔宕濋幘顔界厸濞达絿顭堥顓㈡煛鐏炲墽鈽夐柍钘夘槸椤繃绋婂Ο渚█闁哄被鍔戦幃銏㈡嫚濞堝鎹囬弻锝呂旀笟鍥ㄧ暭闂佺懓绠嶉崹褰掑煘閹寸媴鎷烽敐搴濈敖闁稿﹦鍋ゅ娲濞戣京鍙氶梻鍌氬鐎氫即銆侀弮鍫熷亜闁稿繐鐨烽幏缁樼箾鏉堝墽绉┑顔哄�楀☉鐢稿醇閺囩喓鍘遍梺鎸庣箓缁绘帡鎮鹃崹顐闁绘劘灏欑粻濠氭煛娴ｈ宕岄柡浣规崌閺佹捇鏁撻敓锟� by changhao
					{
						psend(roleid, new SSkillError(SkillConstant.SkillError.MoneyNotEnough));
						return false;						
					}					
				}
				
				if (config.needGuild == 1 && roleproperty.getClankey() <= 0) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ剙浠遍柟顔ㄥ洦鍋愭慨鐟版祫閹烽攱绗熼敓钘夘嚕閹绢喖顫呴柣妯荤垹閸モ晛褰勯梺鎼炲劘閸斿秹鎮￠妷锔轰簻闊洦纰嶇涵楣冩煃鐟欏嫬鐏存い銏＄懇閹矂顢曢锛勭泿闂佷紮绲块崗姗�銆佸Δ鍛妞ゆ劑鍨规禍鍫曟⒑鐠囧弶鎹ｉ柡浣筋嚙椤洦绻濆顒傤唵婵＄偛顑呯�涒晠宕伴崱娑欑厱闁哄洢鍔屾晶鐗堛亜閿旇鏋涙い顏勫暣婵¤埖鎯旈垾鑼泿婵＄偑鍊х粻鎾寸閸洖鏋侀柟鎯ь嚟椤╃兘鎮楅敐搴′簼闂佹鍙冨娲濞戞艾鈪卞銈庡幖閻楁捇銆佸鑸垫櫜濠㈣泛锕崬鍫曟⒑閸濆嫭宸濋柛瀣枛椤㈡ê煤椤忓應鎷虹紓鍌欑劍閳笺倝顢旈崼鐔凤拷鑸垫叏濮楀棗鍔柟鐑樻尰閸庣喖鏌曡箛瀣伄闁伙箑鐗撳鍝勑ч崶褏浼堝┑鐐板尃閸曨収娴勯梺鎸庢礀閸婂綊鎮″▎鎴犵＜閻庯綆鍋掗崕銉╂煟閹剧偨鍋㈤柡宀�鍠栭、娆撳传閸曨厺绱欐俊鐐�戦崹娲�冩繝鍌滄殾闁绘梻鈷堥弫鍐煏閸繈顎楅柡浣规倐濮婂宕掑顒婃嫹妞嬪海鐭嗗〒姘炬嫹闁诡喗锚閳规垹锟斤絽鐏氶弲鐐烘⒑閸涘﹥澶勯柛妯挎閻ｇ兘寮婚妷锔惧幈闂佹枼鏅涢崣鍥ь煥閸曨収娲稿┑鐘诧工閻楀﹪鎮″▎寰濆綊鎮℃惔锝嗘喖濠电偞鍤崘鍓у數閻熸粍绮撳畷褰掑醇閺囩偟鐣哄┑掳鍊ч幏閿嬨亜椤愶絿绠為柟顔界懇椤㈡鏁撴禒瀣垫晜闁跨噦鎷�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氼參宕崇壕瀣ㄤ汗闁圭儤鍨归崐鐐烘偡濠婂啰绠荤�殿喗濞婇弫鍐磼濞戞艾骞楅梻渚�娼х换鍫ュ春閸曨垱鍊块柛鎾楀懐锛滈梺褰掑亰閸欏骸鈻撳鍫熺厸鐎癸拷閿熶粙宕伴弽顓炶摕闁搞儺鍓氶弲婵嬫煥閻斿墎鐭欑�规洘绻堥獮鎺楀箻閸撲緡鍟庨柣搴ｆ嚀婢瑰﹪宕伴弴鐘哄С闁煎鍊楃壕濂告煟濞嗗繑鍣界紒澶樺櫍閺屸�崇暆鐎ｎ剙鍩岄柧浼欑秮閺屾稖绠涢幘铏�┑顕嗙到鐎氭澘顫忛搹鍦＜婵☆垵娅ｉ悷銊╂⒑閸涘﹨澹樻い鎴濇喘楠炴垿濮�閻橆偅顫嶉梺闈涚箳婵兘顢欓幒妤佺厽閹艰揪绲鹃弳鈺傘亜椤撶偟澧︾�殿喗濞婇弫鎾绘偐閺傘儲瀚奸梻渚�娼荤�靛矂宕㈡總绋垮偍閻庢稒菧娴滄粓鏌曟径娑㈡鐎规洖鐭傞弻鈩冩媴鐟欏嫬纾抽悗瑙勬礃閸旀瑩骞冮妶鍡樺闁革富鍘惧暩婵犵數濮烽弫鎼佸磻閻愮數鐭堥柟缁㈠枛閻ょ偓绻濋棃娑氬妞ゎ偅娲熼弻锝夊箛椤掑倹鎲兼繝娈垮灡閹告娊寮诲☉銏犵闁哄鍨圭粊宄扳攽閻愯尙澧戦柛鏃�鍨甸～蹇撁洪鍕祶濡炪倖鎸撮崜婵嬵敁濡ゅ懏鈷戦柛婵勫劚鏍″銈冨妼閿曘倝鎮鹃悜钘夌闁挎洩鎷风紒锟界�ｎ偁浜滈柟閭﹀枛閺嬫垿鏌￠崒锔藉闂傚倸鍊烽懗鍫曗�﹂崼銉ュ珘妞ゆ帒瀚粈鍕煟閻旂鐝楅柨婵嗩槸瀹告繂鈹戦悩鎻掝伀妞ゆ梹娲熷娲礈閹绘帊鑸梺鍛婃尰濮樸劑鏁撻懞銉у暡闁瑰嚖鎷�? by changhao
				{
					MessageMgr.psendMsgNotify(roleid, 150027, null);
					return false;	
				}
				
				//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄婵犲灚鍔栫紞妤呮⒑鐠恒劌鏋欐俊顐㈠瀹曟劙宕稿Δ锟界粻鏉库攽閻樻彃鏆熼柣婵嗙埣閺屽秹宕崟闈涘壋缂備礁顦介崰姘舵晸閸婄噥娼愭繛鍙夌矒瀹曚即寮介婊愭嫹娴ｇ硶妲堟慨妤�妫欓崓鍨繆閹绘帗婀伴柣妤佹礋瀵偊骞栨担鍏夋嫽闂佺鏈悷锔剧矈閻楀牏绠惧璺侯儐缁�瀣拷瑙勬礃婵炲﹪寮崘顔肩＜婵﹢纭搁崬鐢告⒒娴ｈ姤纭堕柛锝忕畵楠炲繘鏁撻敓锟�?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄闁挎繂妫Λ鍕⒑閸濆嫷鍎庣紒鑸靛哺瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈嗐亜椤撶姴鍘寸�殿喖顭烽弫鎰緞婵犲嫮鏉告俊鐐�栫敮濠勬媼閺屻儱鍑犳繛鍡樻尰閳锋垹绱撴担濮戭亞绮埡浣叉斀妞ゆ柨鎼敓鑺ヮ殜楠炴垿濮�閻橆偅顫嶉梺闈涚箳婵挳鎳撻崹顔规斀闁宠棄妫楅悘锝囩磼椤曞懎鐏︾�规洘娲橀幆鏃堝Ω閿旇瀚奸梺鍝勵槺閸嬬偞绔熼崱娴板洭鏁冮崒娑橈拷鍨叏濮楀棗浜滅�规挸妫涢敓鑺ヮ問閸犳盯顢氳閸┿儲寰勬繛銏㈠枛閺屻劎锟斤絽鐏氱紞灞解攽閻樺灚鏆╅柛瀣☉铻炴繛鍡樻尭缁�澶愭煛閸ャ儱鐏╃紒锟介崼銏″枑闁绘鐗嗙粭姘舵煃闁垮鐏寸�殿喖鐖奸幃娆撳级閹搭厽顥嬫俊鐐�х拋锝夋⒔閸曨剛鈹嶅┑鐘叉祩閺佸啴鏌ㄥ┑鍡樺窛闁汇倕瀚伴幃妤�鈻撻崹顔界亪濡炪値鍘鹃崗妯侯嚕椤愶箑绠涙い鎾跺仧缁愮偞绻濋悽闈浶㈤柛鐘宠壘铻為柣鏂垮悑閳锋帒霉閿濆懏鍟為悹鎰ㄥ墲閵囧嫰顢橀悙闈涒叡闂佽法鍠曟慨銈囩矙閸儱鐤鹃柣妯垮皺閺嗭箑霉閸忓吋缍戠紒鐘崇洴閺岋絽螖閿熶粙鎮ч崘顔肩婵炲樊浜濋崐鐢告偡濞嗗繐顏紒锟介敓钘夆攽閻愯尙婀撮柛鏂块叄瀵偊顢欑亸鏍潔濠电偛妫欓崹褰掝敊閺囥垺鈷戦柤娴嬫杹閹凤繝鏌涢幘瀵告噰鐎殿喚顭堥埥澶婎潩閻愵剙顏跺┑鐐茬墕閻忔繈寮稿☉娆嶄簻妞ゆ挾濮撮崢瀵革拷娈垮櫘閸嬪﹪鐛崶顒�绾ч柛顭戝枤閻涒晠姊绘担渚劸闁哄牜鍓涢崚鎺戠暆閸曨偄鍤戝┑鐐村灟閸ㄦ椽鎮″▎鎾寸厽闁规崘娅曢幑锝囩磼婢跺銇濋柡宀�鍠栭、娑橆潩椤掑﹥瀚归柛顭戝枤閺嗭附銇勯幇鍓佺暠閸烆垶鎮峰鍕煀閸楅亶鏌熼梻瀵稿妽闁抽攱甯￠弻娑氫沪閸撗勫櫘濡炪倧璁ｇ粻鎾诲蓟閻斿吋鍤嶉柕澹懐鍘滈柣搴ゎ潐濞叉垿宕￠幎鐣屽祦闁搞儺鍓欑痪褔鎮归幁鎺戝闁哄棭鍋婂缁樻媴娓氼垳鍔搁梺鍝勭墱閸撶喎鐣峰▎鎾村仭闂侇叏濡囬崝鐑芥⒑閸濆嫮鈻夐柛妯圭矙閹繝鏁愭径灞藉絼闂佹悶鍎崝宀勫吹椤掍胶绠鹃柛蹇曞帶婵秹鏌＄仦鍓ь灱缂佺姵鐩顕�宕掑鍛辅濠电姵顔栭崰鏍晝閵夈儺娓婚柦妯侯槺閺嗭妇鎲搁悧鍫濅刊闁轰礁顑夐弻娑樷槈閸楃偛绠规繝銏㈡嚀閻楀﹥绌辨繝鍥ㄥ�锋い蹇撳閹风兘寮撮悤浣诡啍闂婎偄娲︾粙鎴犵不椤栫偞鐓ラ柣鏇炲�圭�氾拷? by changhao
				
				if (config.studyCostRule > 0)
				{
					int silverCost = cost.silverCostList.get(config.studyCostRule - 1);
					
					Pack bag = (Pack)fire.pb.item.Module.getInstance().getItemMaps(
							roleid, fire.pb.item.BagTypes.BAG, false);
					
					if (bag.getMoney() < silverCost)
					{
						psend(roleid, new SSkillError(SkillConstant.SkillError.MoneyNotEnough));
						return false;					
					}
					
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂傚洤顦甸弻銊モ攽閸♀晜效婵炲瓨鍤庨崐婵嬪蓟閵堝绾ч柟绋块娴犳潙鈹戦纭锋敾婵＄偘绮欓妴浣肝旈崨顔芥闂佷紮绲介惉濂告儗閹剧粯鐓涢悘鐐额嚙閸旀粓鏌￠崨顔藉�愰柡宀嬬畱铻ｅ〒姘煎灡绗戦梻浣芥硶閸犳洖螞閸曨偒鐒介柨鐔哄Т杩濇繛杈剧悼绾爼寮告惔銊︾厵闁诡垎鍜冪礊濡炪倧瀵岄崣鍐箖瀹勯偊鐓ラ柛鎰典簽椤旀帡鏌﹀Ο鑽ょ畺闁靛洤瀚板浠嬪Ω瑜嬮敓鑺ュ笧缁辨帡鎮╅懡銈囨毇闂佸搫鐬奸崰鏍嵁閸℃凹妾ㄩ梺鎼炲�楅崰鏍蓟濞戙垺鍋勯柛婵勫劚瀵劑姊洪崫鍕伇闁哥姵鐗犻獮鍐煥閸喎娈熼梺闈涱檧闂勫嫬鈻撻崨濠佺箚闁绘劦浜滈敓鑺ュ灴瀹曟繃绻濋崶褏锛熼梺姹囧灮椤牏绮婚弽銊х闁糕剝蓱鐏忣厾绱掗悪娆忔处閻撴瑩鎮楀☉娆樼劷缂佺姰鍎茬换娑㈠礂閻撳骸鎽靛┑顔硷功缁垶骞忛崨瀛樺殟闁靛缍囬幏鐑藉礃椤旂晫鍘介梺纭呮閸嬬喖鎮鹃崹顐闁绘劖娼欓悘瀵革拷瑙勬礀閻栧ジ銆佸Δ鍛櫢濞寸姴顑呴崙鐘层�掑鐐闂佸搫鐬奸崰鏍х暦濠婂棭妲鹃柣銏╁灡閻╊垶寮婚敓鐘插窛妞ゆ棁妫勯敓鑺ュ姍閺岋紕浠︾拠鎻掝潎闂佽鍠撻崐婵嗙暦閹烘垟妲堟慨妤�妫旂槐锟� by changhao
					if(bag.subMoney(-silverCost, LiveSkillManager.LiveSkill, fire.log.enums.YYLoggerTuJingEnum.tujing_Value_gonghuilianjin, 0) != -silverCost)
					{
						psend(roleid, new SSkillError(SkillConstant.SkillError.MoneyNotEnough));
						return false;	
					}
				}
				
				//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ょ紓宥咃躬瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欑粈鍐┿亜閺囧棗娲ら悡姗�鏌熸潏楣冩闁稿鍔欓弻娑樷枎韫囷絾效闂佽鍠楅悷褏妲愰幘瀛樺闁告繂瀚烽敓钘夌焸閺屾盯濡搁妷褍鐓熼悗娈垮枛椤攱淇婇幖浣哥厸闁稿本鐭花浠嬫⒒娴ｄ警鐒鹃柡鍫墰缁瑩骞嬮敂缁樻櫆闂佽法鍣﹂幏锟�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氼參宕崇壕瀣ㄤ汗闁圭儤鍨归崐鐐烘偡濠婂啰绠荤�殿喗濞婇弫鍐磼濞戞艾骞楅梻渚�娼х换鍫ュ春閸曨垱鍊块柛鎾楀懐锛滈梺褰掑亰閸欏骸鈻撳鍫熺厸鐎癸拷閿熶粙宕伴弽顓炶摕闁搞儺鍓氶弲婵嬫煥閻斿墎鐭欑�规洘绻堥獮鎺楀箻閸撲緡鍟庨柣搴ｆ嚀婢瑰﹪宕伴弴鐘哄С闁煎鍊楃壕濂告煟濞嗗繑鍣界紒澶樺櫍閺岋紕浠︾拠鎻掝潎閻庢鍣崳锝呯暦閸洍锟斤箓骞嬮悜鍡橆棄婵犵數濮烽弫鎼佸磻濞戙垺鍋嬪┑鐘叉搐閸ㄥ倿鏌涜椤ㄥ懘鎷戦悢鍏肩叆婵犻潧妫Σ褰掓煕鐎ｎ偄濮嶉柡灞诲�栭幈銊╁箛椤掑﹥瀚规俊銈呭暟閻滅粯淇婇妶鍛櫤闁抽攱鍨垮濠氬醇閻旇　妾ㄩ梺鎸庣♁濡啴寮婚悢鍓叉Ч閹肩补锟藉啿绠ｆ繝娈垮枛閿曘儱顪冮挊澶屾殾妞ゆ劧绠戠粈瀣⒒閸喓鈽夊鐟邦槹缁绘繄鍠婂Ο娲绘綉闂佺顑呯�氭澘鐣烽鐐茬骇闁规惌鍘煎▓銊︾節閻㈤潧校缁炬澘绉瑰畷鎴﹀礋椤栨稓鍘藉┑顔斤供閸撴盯骞楅悩缁樺�垫慨姗嗗墰缁夋椽鏌″畝瀣М濠殿噯鎷烽梺瀹犳濡寮查柆宥嗏拺缂備焦锚濞搭喚绱掗悩宕囧ⅹ妞ゆ洩绲剧粋鎺旓拷锝庡亝濞呫垽姊虹紒妯曟垿寮告總绋跨婵炲樊浜濋埛鎴︽煕濞戞﹫鍔熺紒鐘虫崌閹顫濋悡搴＄睄闁芥鍠栭弻锝夊箛椤旇姤姣勭紒鐐劤閸氬濡甸崟顖氱睄闁搞儜鍌涚潖闂佽桨绀侀悧濠勬崲濠靛牆鏋堝璺虹灱閿涚喖姊烘潪鐗堢グ妞ゆ泦鍥ㄥ仼闁绘垼濮ら崑鍕棯閹峰矂鍝洪柡鍜佸墮閳规垿顢欑粵瀣姼婵炲瓨绮犻崜娆撯�﹂崶銊ョ窞闁归偊鍘搁幏缁樼箾鏉堝墽绉い顐㈩樀瀹曟垿鎮╃紒妯煎幈闁瑰吋鎯岄崰鏍倶閿旀拝鎷风憴鍕缂佽鍟撮獮鍡涘籍閸惊鈺呮煏婢跺﹦鏄傞柛搴ㄤ憾閸╃偤骞嬮敂钘変汗闂佸湱绮敮濠勮姳閽樺鏀介柣鎰摠鐏忣厽銇勯鐘插幋鐎殿喖顭峰鎾閻樿鏁规繝鐢靛█濞佳兾涢銏犵濠㈣泛鐬肩壕钘壝归敐鍫燁棄闁绘挻鍔欓弻锝夊煛婵犲倻浠搁悗娈垮枛椤兘骞冮姀銈嗗亗閹艰揪缍嗗Σ閬嶆⒒娓氾拷濞佳囨偋閸℃あ娑樜旈崪浣规櫆闂佽法鍣﹂幏锟� by changhao
				if (config.studyCostRule > 0)
				{
					int needfactioncontr = cost.guildContributeCostList.get(config.studyCostRule - 1);
					if (needfactioncontr > 0)
					{
						boolean ok = ClanManage.delContribution(roleid, needfactioncontr, LiveSkillManager.StudyLiveSkill, false);
						if (ok == false) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵挳鎮欑拠褎瀚圭憸鐗堝笒绾惧潡鏌熺�电校闁哥姵鍔欓弻锝呂旈敓浠嬫偋閸℃瑧绠旈柟鐑橆殕閻撴盯鏌涢弴妤佹珔闁告棑绠撻弻锛勪沪閸撗勫垱閻庢鍠楅幐铏繆閹间礁唯鐟滃矂宕Δ鍛拻濞达綀顫夐崑鐘绘煕閺傝法鐒哥�规洘鍔欓獮鏍ㄦ媴閸濄儱骞嬮梻浣侯攰閹活亞绮婚幋鐘差棜闁稿繗鍋愮弧锟芥繝鐢靛Т閸婂綊骞戦敐澶嬬厱闁哄倹瀵ч幉鍝ョ磼鏉堛劍灏伴柟宄版嚇閹兘寮跺▎鐐秾濠碉紕鍋戦崐鎴﹀礉鐏炶娇娑樷槈閵忕姷顔夐梺闈涚箳婵厼危閸儲鐓忛煫鍥ㄦ礀鍟稿銈嗘尰濡炶棄顫忛搹鍦＜婵☆垰鎼～宥咁渻閵堝棙鈷愰柣妤冨Т椤曪綁骞庨懞銉︽闂佺粯蓱閺嬪ジ骞忛搹鍦＝濞达絽澹婇崕鎾寸箾婢跺绀堢紒顔碱煼閹崇娀顢楅崒婊愮床婵＄偑鍊栧Λ浣规叏閵堝懐鏆︾�癸拷閿熶粙鏁撻懞銉晱闁哥姵鐗犻垾锕傛煥鐎ｂ晝绠氶梺褰掓？缁�渚�鎮″☉銏＄厱閻忕偛澧介悡顖滅磼閵娿劌鍚圭紒杈ㄦ崌瀹曟帒顫濋濠冨闁绘垼濮ら崐鍧楁煥閺囩偛锟藉綊寮插┑瀣厓閺夌偞澹嗙�靛吋绻涢幋娆忕仼缂侊拷鐎ｎ偁浜滈柡宥冨妿閳绘捇鏌熼柨瀣仢闁哄矉绲鹃幆鏃堝焺閸愵厾顢呭┑鐘愁問閸犳岸寮弰蹇旓紓濠电姰鍨煎▔娑㈩敄閸愨晝顩叉繝濠傜墛閻撱儵鏌￠崘銊ワ拷鍛婄妤ｅ啯鐓涢柛鈾�鏅涙晶鎾煛瀹�瀣埌闁宠棄顦靛畷锟犳倷鐎甸晲閭梻浣稿綖缁鳖喚绱炴笟锟藉鏄忣樁缂佺姵绋戦～婵嬪礂閼测晝啸濠电姷鏁搁崑娑㈡偋閹惧墎涓嶉柡宓本缍庡┑鐐叉▕娴滄粎绮昏ぐ鎺撶厽闁归偊鍘肩徊璇测攽椤斿ジ顎楅柍瑙勫灴閸┿儵宕卞鍓х泿闂傚倷绀佹惔婊呭緤娴犲鍋╅柣鎴ｅГ閸嬶繝鏌熼崘璇ф敾婵＄偘绮欓妴渚�寮崼婵堫槹闁瑰吋鎯岄崹鎶芥偩閻㈠憡鐓涢悘鐐插⒔濞插锟芥鍠楅幐铏繆閹间礁唯闁挎梹鍎抽拏瀣攽閻樻鏆滅紒杈ㄦ礋閹艰鎯旈姀銏╂锤濡炪倕绻愮�氬嘲顭囬弽銊х鐎瑰壊鍠曠花濂告煕鐎ｅ墎绡�闁哄备鍓濆鍕拷锝庝憾閸ゅ顪冮妶鍡橆棖闁归鍏樺濠氬磼濞嗘帒鍘￠梺纭呮珪閹瑰洤鐣烽悽绋垮唨妞ゆ挾鍋熼鍡涙⒑鐠恒劌娅愰柟鍑ゆ嫹 by changhao
						{
							psend(roleid, new SSkillError(SkillConstant.SkillError.ContributeNotEnough));
							return false;						
						}					
					}						
				}			
				
				if (liveskill == null)
				{
					xbean.LiveSkill e = xbean.Pod.newLiveSkill();
					e.setLevel(requireLevel);
					skillrole.getLiveSkills().put(id, e);
					
					liveskill = e;
				}
				else
				{
					liveskill.setLevel(requireLevel);					
				}
				
				if (config.skillId != 0) //闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ剙浠遍柟顔ㄥ洦鍋愭慨鐟版祫閹烽攱绗熼敓钘夘嚕閹绢喖顫呴柣妯荤垹閸モ晛褰勯梺鎼炲劘閸斿秹鎮￠妷锔轰簻闊洦纰嶇涵楣冩煃鐟欏嫬鐏存い銏＄懇閹矂顢曢锛勭泿闂佷紮绲块崗姗�銆佸Δ鍛妞ゆ劑鍨规禍鍫曟⒑鐠囧弶鎹ｉ柡浣筋嚙椤洦绻濆顒傤唵婵＄偛顑呯�涒晠宕伴崱娑欑厱闁哄洢鍔屾晶鐗堛亜閿斿搫鍔ょ紒杈ㄦ崌瀹曟帒顫濆В娆嶅灲閺屻劑寮撮妸銈夊仐闂佺粯渚楅崳锝呯暦濮楋拷閸╋繝宕橀悙顒傘偒闂備浇顕ч崙鐣岀礊閸℃稑纾婚柟鐑樺殾濞戙垹绀冩い鏃囆掗幏娲⒑閸涘﹤濮囩�殿喖鐖奸獮鍡涘醇閵夛妇鍘遍梺缁樻濞夋稑鐣甸崱娑欑厱闁冲搫顑囩粔顔尖攽闄囬崺鏍ь嚗閸曨叏鎷烽敍鍗炲椤忕儤绻濋悽闈涗哗闁规椿浜炲濠囧锤濡わ拷缁犵娀鏌熼悙顒併仧闁轰礁顑嗙换婵囩節閸屾凹浼�缂備胶濞�缁犳牠寮诲☉妯锋瀻闊浄绲炬濠电姭鎷冮崨顔芥瘎闂佽法鍠庨敓鐣屽櫏濞兼劖绻涢崣澶涜�跨�规洘绻傞埢搴ょ疀閺囩喐顔曟俊鐐�栭崝褏绮婚幋婵囨殰闂佽崵鍠愮划宀�鎹㈠锟介獮鍐倷閸濆嫮顦ч梺鍏肩ゴ閺呮繈鎯侀崼銉︹拺闂傚牊鐩悰婊呯磼闊厾鐭欓柟顕嗙節楠炲洭鎮ч崼銏犲箞闂備礁鎼崰娑㈠箯閻戣姤鐓熸俊銈呭暙閳诲牊顨ラ悙鎻掓殻婵℃崘浜槐鎺楁偐瀹曞洦鍒涘Δ鐘靛仦閿曘垽銆佸☉妯锋婵炲棙鍔栫欢顐︽⒒閸屾艾锟界兘鎳楅崜浣稿灊妞ゆ牜鍋愰敓鏂ょ畵瀹曞ジ锝為鐘插⒕婵犵數鍋涘Λ娆撳垂鐟欏嫮鈻旂�广儱顦伴悡娆撴煙椤栨稒绶茬悮姘舵⒑缂佹ɑ灏甸柛鐘崇墵瀵濡搁妷銏℃杸闂佺硶妾ч弲婊冩毄闂傚倷娴囬～澶愭偂閿涘嫮涓嶉柡宥庡幖閽冪喖鏌ｉ弮鍌氬付缁炬儳缍婇弻锝夊棘閹稿孩鍠愰梺闈涙閸旀洟鈥旈崘顔嘉ч幖绮癸拷鑼嚬缂傚倷娴囬褔鎮ч幘鑽ゅ祦濠电姴鍋嗛悡銉╂煕濞戝崬骞楅柣搴″暱閳规垿鍩ラ崱妤冧淮濡炪倖娉﹂崶鑸垫櫆闂侀潻瀵岄崢鍓у娴犲鐓曢悘鐐插⒔閹冲棝鏌涜箛鎾剁劯闁哄睙鍡欑杸闁规崘顕у浼存倵鐟欏嫭绌跨紓宥勭閻ｅ嘲顫滈敓浠嬨�佸▎鎾村殐闁宠桨鐒﹂幉銏ゆ⒒娴ｅ憡鎯堟い锔诲灦閹囧礃椤旇偐鏌у銈呯箰閻楀棛绮婚婊愭嫹閻熸澘顏柛瀣工椤洭鍩￠崨顔惧幗闂侀�涘嵆濞佳勬櫠椤斿浜滈煫鍥ュ劜鐎氾拷? by changhao
				{
					Result result = new Result(true);
					
					//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ偆娲撮挊婵嬫煟閵忋埄鐒鹃柡瀣╄兌閿熻棄绠嶉崕閬嵥囬婊呯焼閻庯綆鍋佹禍婊堟煙閸濆嫮肖闁告柨绉甸妵鍕棘閹稿骸鏋犲┑顔硷功缁垶骞忛崨瀛樺殟闁靛／渚婃嫹婵犲洦鈷戦柛婵勫劚鏍￠梺鍦焾椤兘鐛崼銉ノ╃憸婵嬪箯閻戣姤顥堟繛鎴炵懄閸犳劗绱掗悙顒�鍔ら柕鍫熸倐瀵顓兼径濠佺炊闂佸憡娲﹂崜娆忊枍閵堝鈷戦柟鎯板Г閺侀亶鏌涢妸銉у煟濠碉紕鏁诲畷鐔碱敍濮橀硸鍞洪梻浣虹帛閸旀牕顭囧▎鎿冩晜闁告挷鑳剁壕浠嬫煕鐏炲墽鎳呮い锔奸檮閵囧嫰鏁傞崹顔肩ギ濡ょ姷鍋為崝娆撶嵁鎼淬劍瀵犲璺虹焾閸炵敻姊绘担渚敯闁规椿浜浠嬪礋椤栨氨锛涢梺鍛婃处閸嬶拷闁猴拷娴犲鐓曢悘鐐村劤閸ゎ剚淇婇崣澶嬨仢闁哄本鐩幃娆撳垂椤愶絾鐦撴繝娈垮枛閿曘儱顪冮挊澶屾殾闁靛濡囩弧锟介梺鍛婂姂閸斿酣鎮￠鐐粹拻濞达絽鎼敮鍫曟煕閻旈攱鍋ラ柟顔哄劜缁虹晫绮欑捄銊ф毇闂備胶绮崹鍨珶濞嗘劕绶為柟閭﹀幖娴犙囨⒑鐠恒劌娅愰柟鍑ゆ嫹 by changhao
					result.updateResult(skillrole.addLiveSkillBuff());	
				
					if(!result.getChangedAttrs().isEmpty())//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閹冣挃闁硅櫕鎹囬垾鏃堝礃椤忓孩瀚归柨婵嗙凹缁ㄧ粯銇勯幒瀣仾闁靛洤瀚伴獮鍥敂閸℃瑧鍘梻浣告惈鐞氼偊宕濋幋锕�绠栭柕蹇嬪�曟导鐘绘煕閺囩喎鐏熼柛銊ヮ煼閹拷妞ゅ繐鐗嗙粻姘辨喐濠婂牊鍋傚┑鍌氭啞閻撴盯鎮橀悙鎻掆挃闁宠棄顦甸弻宥夋寠婢舵ɑ鈻堥悗瑙勬穿缁绘繈骞冨▎鎾崇闁圭儤绻傛俊褎绻濋悽闈浶ラ柡浣规倐瀹曟垵鈽夐姀鈥冲壄闂佺粯鍨煎Λ鍕偪妤ｅ啯鐓熸俊顖涱儥閸ゆ瑩鏌﹂崘顏勬灈闁哄矉绻濆畷鍫曞煛娴ｅ湱浜栫紓鍌欒兌婵烇拷缂佺姵鐗犲濠氭晲婢跺﹦鐤�闂傚倸鐗婄粙鎴︼綖椤忓牊鈷戠紓浣诡焽缁犳牗绻涢懠顒�鏋庢い顐㈢箻閹煎綊宕烽鐘靛幆婵犵數鍋涘Λ娆撳磿閹惰棄绀堝ù鐓庣摠閳锋垹绱掔�ｎ亜鐨＄�规悶鍎茬换娑氫焊閺嶅灚瀚归柟棰佺濞堛劍绻濋悽闈浶ｉ柤鍦亾閸庮偊姊绘笟锟藉褔藝椤撱垹鍨傛繛宸悍缂嶆牜锟藉箍鍎遍幊澶愬绩娴犲鐓冮柦妯侯槹椤ユ粓鏌ｈ箛鏇炴灈闁诡喖缍婇弫鎾寸鐎ｎ偅娅嗛梺浼欑到閻牆霉閸曨垱鈷戦柤濮愬�曢弸鎴濐熆閻熼偊鍎旂�殿喓鍔嶇粋鎺旓拷锝庡亞閸樹粙姊鸿ぐ鎺戜喊闁搞劋鍗抽幆鍐洪鍛幗闂佸湱鍎ら幐鎼佸礉閵堝顥嗗璺侯儑缁★拷婵犵數濮撮崐濠氬礄瑜版帗鈷戞い鎾楀啰浠梺璺ㄥ枙婵倝顢欓弽顓炵獥闁哄稁鍘搁敓鏂ょ畵閹粓鎸婃径瀣拷顒勬⒑瑜版帒浜伴柛妯垮亹濞嗐垽鎮欏ù瀣杸闂佺粯蓱瑜板啴顢旈锔界厸濠㈣泛顑嗛崐鎰叏婵犲嫮甯涢柟宄版噽缁瑩骞愭惔鈽呮嫹椤栫偞鈷戦悹鍥ｏ拷铏亪闂佺锕ラ幃鍌炲灳閿曞倸鐐婃い蹇撶У閳诲本淇婇悙顏勶拷鎴﹀垂閸濆嫀娑㈠礃椤斿吋鐎梺鐟板⒔缁垶寮查幖浣圭叆闁绘洖鍊圭�氾拷?闂傚倸鍊搁崐鎼佸磹閹间礁纾圭�瑰嫭鍣磋ぐ鎺戠倞鐟滃繘寮抽敃鍌涚厽闁靛繈鍩勯悞鍓х磼閹邦収娈滈柡宀�鍠栭弻鍥晝閿熶粙寮稿☉銏＄厱闁靛濡囩粻姗�鏌ㄩ悢鐑樻珪婵炲懌鍨介獮蹇涙倻閼恒儳鍘遍梺鍝勬储閸斿本鏅舵导瀛樼厱婵☆垵顕ф慨宥嗘叏婵犲啯銇濇鐐村姈閹棃鏁愰崶鈺傛闂傚倷鑳堕幊鎾诲床閺屻儺鏁勫璺猴功閺嗭箓鏌ｉ姀銏╃劸闁告濞婇弻锝夊籍閸屾粎鐦堢紓浣靛妼椤嘲顫忛搹瑙勫枂闁告洦鍓涢崙鈩冪節閳凤拷閸愵喖寮板Δ鐘靛仜閸燁垳缂撴禒瀣窛濠电偟鍋撶�氫粙姊绘担鍛婂暈婵炶绠撳畷鎴﹀礋椤栵絾鏅滃銈嗗姂閸婃澹曟總绋跨骇闁割偅绋戞俊鑲╃磼濡烇箑娲﹂悡銉╂煟閺傛寧鍟為柣蹇ｅ枤缁辨挸顓奸崨顕呮＆閻庤娲忛崹浠嬪箖閸撗傛勃闁诡垎鍐ㄧ闂傚倷鑳堕崢褔骞楀鍫濈；闁挎繂妫涢々鍙夌節婵犲倻澧涢柣鎾卞劦閺岋繝宕掑鍙樿檸闂佽鍠楅崹鍧楀箖濡わ拷椤繈鎮欓锟介锟�? by changhao
					{
						mkdb.Procedure.psendWhileCommit(roleid,new SRefreshRoleData((HashMap<Integer, Float>)result.getChangedAttrs()));
					}
				}
				
				SUpdateLearnLiveSkill msg = new SUpdateLearnLiveSkill();
				msg.skill.level = liveskill.getLevel();
				msg.skill.id = id;
				
				mkdb.Procedure.psendWhileCommit(roleid, msg);

				mkdb.Procedure.pexecuteWhileCommit(new fire.pb.ranklist.proc.PRoleZongheRankProc(roleid));
				
				//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ偆娲撮挊婵嬫煟閵忋埄鐒鹃柡瀣╃窔閺岀喖宕滆鐢盯鏌涚�ｎ偄濮嶉柡灞熷棛鐤�闁挎繂鎳嶇花濂告⒑缂佹缂氶柛鏂跨Ф閹广垹鈹戠�ｎ偄浠洪梻鍌氱墛閸掞拷闁靛璐熸禍婊堟煥濠靛棛澧涙い銉ヮ樀瀹曪繝鏌嗗鍡欏幈濠电偞鍨堕悷锔剧礊閹寸姷妫柟顖嗗瞼鍚嬮梺鍝勬湰缁嬫垿鍩ユ径濞㈢喖宕楅崗鐓庢灈闂傚倷鑳堕…鍫燁殽閸濄儻鎷峰☉鎺撴珚濠碉紕鏁诲畷鐔碱敍濮橆剙鏁ゆ俊鐐�栭崝锕�顭块敓鐣岀磼椤旇偐鍩ｆ慨濠冩そ瀹曨偊宕熼顐℃樊闂備胶顭堝ù鐑藉极鐠囧樊鍤曞┑鐘宠壘閸楁娊鏌ㄥ☉妯侯伀闁哄鎮傚娲濞戝磭纭�闂佸憡绮岄崯浼村触瑜版帗鈷掗柛灞捐壘閿熻姤鎮傚畷鎰板传閵夘垱瀚规慨妯煎帶婢т即鏌ㄩ悢璇残撻柣顓у櫍瀹曪繝宕樺顔兼闁荤姴娲︾粊鏉懳ｉ崼鐔剁箚妞ゆ牜鍋為弫杈ㄣ亜椤愩垻孝闁宠鍨块、娆戠驳鐎ｎ偆鏆ラ梻浣虹帛椤ㄥ懎螞濞嗘埊鎷烽棃娑栧仮妤犵偛娲、姗�鎮╁▓鍨櫗闂備浇顕уù鐑藉极閹间讲锟斤箓宕奸悢鍝勨叞婵犵數濮烽。顔炬閺囥垹纾婚柣妯哄棘濞戙垹绀嬫い鏍ュ�楃粙蹇涙椤愩垺澶勭紒瀣浮楠炲棝鎮欓悜妯煎幈闂佹寧妫侀褔鐛锟介弻銊モ槈濞嗘垹鐓�闂佸疇顫夐崹鍧楀春閵夆晛骞㈡俊銈呭暕濞ｎ噣鏌ｆ惔銈庢綈婵炲弶绮撳顐ゆ嫚閼碱剚娈鹃梺鎸庣箓椤︻垶鐛姀锛勭闁瑰鍋熼幉鍧楁煙閻ゎ垱顏犵紒杈ㄥ笧缁辨帡濮�閻樿尙顔愰梻浣烘嚀閸㈡煡顢栨径濠勬殾闁汇垻顣幏鐑芥晲鎼粹�愁潾缂佺偓宕橀崑鎰閹惧瓨濯撮悹鍥风磿閸旈绱撴担鍝勑ｉ柣妤佹礉瑜颁線姊洪幖鐐插妧鐎广儱鐗嗛幆鍫ユ⒒娴ｇ瓔鍤冮柛鐘虫礈閸掓帒鈻庤箛鏇熸闂侀潧顭俊鍥╁姬閿熶粙姊虹粙鎸庢拱闁荤啙鍥ㄥ剮閹兼番鍔嶉埛鎺楁煕鐏炲墽鎳嗛柛蹇撴湰閵囧嫰顢橀悙闈涒叡闂佺懓绠嶉崹纭呯亙闂佸憡渚楅崢楣冩晬濞戙垺鈷戦柛锔诲幖椤ｅ吋绻濋姀鈽呰�跨�规洘甯℃俊鎼佸煛閸屾粌骞楅梻渚�娼х换鎺撴叏閻㈢鐤柣鎰劋閻撳啴姊洪崹顕呭剰闁诲繑鎸抽弻鐔碱敊閼测晝楔濡ょ姷鍋樼欢姘剁嵁閹烘绠ｆ繝鍨姉閿熷�熸珪缁绘繈鎮介棃娑楃捕闂佺懓鍟跨换妯虹暦濠靛棌鏋庨柟鎯х枃閹芥洟姊虹紒妯烩拻闁告鍛焼闁告洦鍨遍悡蹇涙煕椤愶絿绠栨い銉︾矋閵囧嫯绠涢妷锕�顏�?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚敐澶婄闁挎繂鎲涢幘缁樼厱闁靛牆鎳庨顓㈡煛鐏炲墽娲存い銏℃礋閺佹劙宕卞▎妯恍氶梻鍌欒兌椤牏鎮锕�绀夐幖娣妼缁犵喖鏌熼梻瀵割槮婵☆偅锕㈤幃褰掑箒閹烘垵顬夊┑鐐茬墛閸庢娊鈥旈崘顔嘉ч柛鈩冪懃閳峰牓姊虹粙娆惧剱闁烩晩鍨跺濠氬Ω閳轰絼褔鏌涢埄鍐╃缂佺姵宀稿娲濞戞艾顣洪柣搴㈠嚬閸ｏ絽鐣峰┑鍡╁悑闁糕剝鐟ч鏇㈡⒑閸涘﹣绶遍柛瀣閹﹢宕ｆ径瀣伎婵犵數濮寸�氼剟宕濈�ｎ喗鍊甸柣銏ゆ涧鐢爼鏌嶇拠鏌ュ弰妤犵偛顑呴埞鎴﹀幢濞嗗繐绗撻梻鍌氬�搁崐椋庣矆娓氾拷瀹曘儳锟斤綆浜跺〒濠氭煕瑜庨〃鍛村垂閸岀偞鍋ｉ弶鐐村椤掔喖鏌涢妶鍡樼闁哄瞼鍠栧鑽わ拷闈涘濡差喚绱撴担鍝勵�撶紓宥勭窔瀵鏁愰崨鍌滃枛瀹曨偊宕熼浣烘И闂傚倷绀侀幖顐︻敄閸℃稑鍨傞柛顭戝櫘濞兼牠鏌ц箛姘兼綈闁稿繑绮撻弻娑樷槈閸楃偞鐏撻梺闈涙閸旀瑥顫忓ú顏勭閹兼番鍨婚敍姗�姊虹粙鍖℃敾婵炲弶绮撳畷锝夊川鐎涙ǚ鎷洪梺鍦焾鐎涒晝绮堥敓浠嬫⒑缁嬪尅宸ョ紓宥咃工閻ｇ兘骞嬮敃锟界壕濂告煟閹邦剦鍤熼柛妯绘倐濮婃椽骞栭悙鎻掑闂佺閰ｆ禍鍫曞箖濮楋拷椤㈡棃宕奸悢鍝勫箺闂備浇顫夐崕鎶筋敋椤撱垹绠犻柛銉墯閻撴稓锟界櫢鎷烽悗锝庡墰琚︽俊銈囧Х閸嬫盯顢栨径鎰畺婵炲棙鎸搁獮銏′繆椤栨繃顏犲ù鐘插悑缁绘稓锟芥稒顭囬惌瀣煙椤旂厧锟藉潡濡存担鍓叉建闁跨喍绮欓獮鍐閵忋垻顦╅梺缁橆焽閺佺鈻旈崸妤佲拻闁稿本鐟х粣鏃�绻涙担鍐叉硽閸ヮ剦鏁囬柕蹇曞Х閿涚喎鈹戦悙鍙夆枙濞存粍绮庢竟鏇㈠锤濡や胶鍘搁梺鍛婂姂閸斿孩鏅跺☉銏＄厽闁规儳顕妴鎺楁煥閻旂儤娅曟繛鍛灲楠炲繘鎮滈懞銉ワ拷鐢告煥濠靛棝顎楀褎澹嗛幃顕�鏁冮崒娑掓嫽婵炶揪缍�濞咃綁濡存繝鍥ㄧ厸闁告侗鍠氶妴鎺楁煥閻旇袚缁炬澘绉撮…鍨潨閿熶粙骞冮幆褏鏆嬮梺顓ㄩ檮瀵ゆ椽姊虹捄銊ユ灆濠殿喓鍊栫粚杈ㄧ節閸屻倖妗ㄩ悗鐧告嫹濠电姴鍞妸鈺傗拻濞达絿鐡旈崵鍐煕閿濆骸鐏ｇ紒杈╁仦閹峰懘宕滈崣澶岀▉缂傚倸鍊烽悞锕佹懌婵犳鍨遍幐鎶藉蓟濞戙垺鏅滈悹鍥ㄥ絻缁犳椽姊洪悡搴ｄ虎婵炲樊鍘奸～蹇涙惞閸︻厾鐓撻梺绉嗗嫷娈㈤柨鐔诲Г椤ㄥ棝濡甸崟顖ｆ晣闁绘ɑ褰冮獮瀣⒑缂佹ü绶遍柛鐘崇〒缁鈽夊Ο閿嬵潔濠电偛妫欓崝鏍敂閻斿吋鈷掑ù锝堝Г绾爼鏌涢敐蹇曠暤妤犵偛绻橀弫鎾绘晸閿燂拷?
				fire.pb.course.CourseManager.checkAchieveCourse(roleid, fire.pb.course.CourseType.SHENG_HUO_JINENG, liveskill.getLevel());
				fire.log.YYLogger.roleSkillUPLog(roleid, new RoleSkillUpBean(id, liveskill.getLevel()));
				return true;
			}
		};
		
		requestlearnliveskill.submit();	
	}

	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 800515;

	public int getType() {
		return 800515;
	}

	public int id;

	public CRequestLearnLiveSkill() {
	}

	public CRequestLearnLiveSkill(int _id_) {
		this.id = _id_;
	}

	public final boolean _validator_() {
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		_os_.marshal(id);
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		id = _os_.unmarshal_int();
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CRequestLearnLiveSkill) {
			CRequestLearnLiveSkill _o_ = (CRequestLearnLiveSkill)_o1_;
			if (id != _o_.id) return false;
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		_h_ += id;
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append(id).append(",");
		_sb_.append(")");
		return _sb_.toString();
	}

	public int compareTo(CRequestLearnLiveSkill _o_) {
		if (_o_ == this) return 0;
		int _c_ = 0;
		_c_ = id - _o_.id;
		if (0 != _c_) return _c_;
		return _c_;
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

