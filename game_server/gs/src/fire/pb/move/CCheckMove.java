
package fire.pb.move;
import java.util.List;


import fire.pb.move.Pos;
import fire.pb.scene.manager.RoleManager;
import fire.pb.scene.movable.Role;
import fire.pb.scene.sPos.Position;

// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CCheckMove__ extends mkio.Protocol { }

// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

public class CCheckMove extends __CCheckMove__ {

	@Override
	protected void process() {
		final Role role = RoleManager.getInstance().getRoleByProtocol(this);
		if(null == role) return;
		if(null == role.getScene()) return;
		
		final long curTick = System.currentTimeMillis();
		if(! role.checkValidFrequency(curTick)){
			return;//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣洴钘濋柣銏㈩焾閺嬩線鏌熼崜褏甯涢柛瀣姍閺屾盯骞囬姘卞闂佹眹鍨荤划顖涚┍婵犲洦鍊锋い蹇撳閹风兘寮介鐔蜂罕濠德板�曢崯浼存儗濞嗘挻鐓欓柣鎰靛墰濠�浠嬫煥閻旂粯顥夐柟铏悾鐑芥晲閸℃绐為悗鐧告嫹闁跨喍绮欓幆渚�宕奸悢铏圭槇闂佹眹鍨藉褍鐡梻浣侯焾閿曪妇鍒掗鐐茬柧闁割偅娲栭崡鎶芥煟濡吋鏆╅柨娑欑矒濮婅櫣绱掑Ο鍏煎殏闂佸綊顥撻崗姗�寮诲☉銏犖╅柕澹啰鍘介柣搴㈩問閸犳牠鈥﹂悜钘夋瀬闁归偊鍘肩欢鐐测攽閻樻彃顏撮柛姘嚇濮婄粯鎷呴悷閭﹀殝缂備浇顕ч崐鍧楃嵁婢跺ň妲堥柕蹇曞Х椤旀帞绱撻崒娆戝妽妞ゎ厼娲畷銏ゆ焼瀹ュ棛鍘介柟鍏兼儗閸ㄩ亶鏁撴慨鎰姦鐎规洜鍠栭、妤呭磼濮樿京袪闂傚倸鍊搁崐椋庣矆娓氾拷楠炴牠顢曢敃锟界�氬銇勯幒鐐村闁绘挶鍊栨穱濠囶敍濞嗘帩鍔呴梺鎼炲�栭〃濠囧蓟濞戙垹鍗抽柕濞垮劵閹风兘鎮╃紒妯轰簻闂佺绻愰崥瀣磿椤忓牊鈷掑〒姘搐娴滄繄绱掔�ｎ偄鐏╅柨鐔稿灊缁茶崵浜稿▎鎴烆潟闁规崘顕х壕鍏兼叏濮楀棗澧鹃柟鐑芥敱椤︾増鎯旈姀鈺佷缓闂備線娼ч悧鍡浰囬婊呬笉妞ゆ牗绮ｉ幏鐑芥偡閺夋浼冮梺绋款儏閿曨亪骞冮姀銈呭耿婵炴垶鐟ユ禒顖炴⒑閸涘﹦绠撻悗姘煎墯缁绘盯宕堕浣哄幈濡炪倖鍔х徊楣冨磿閺囥垺鐓ユ繝闈涙－濡叉悂姊洪崡鐐村枠闁哄本娲樺鍕槈濮楀棙鍠橀梻浣告啞椤洭寮拠宸綎闁惧繗顫夌�氭岸鏌嶉妷銉э紞闁跨喕妫勯…鐑藉蓟濞戞﹩鐓ラ柛鎰╁妽濞堝墎绱撴笟濠冨婵犵數濮村ú锕傚煕閹达附鐓曟繝闈涘閸旀岸鏌＄�ｎ偅鈷愰柕鍥у椤㈡﹢鎮欓棃娑掑徍闂備胶纭堕弲婵嬪磻閵堝宓侀悗锝庡枟閺呮粓鏌﹀Ο渚闁归鍏橀幃婊堟嚍閵壯冨箰濠电姰鍨煎▔娑㈩敄閸涘瓨鍊堕柍鍝勬噺閻撴洟鏌￠崒娑橆嚋闁哥喓鍋熺槐鎺旂磼濡锟芥帡鏌ㄩ悢璇残撶紒瀣浮閳ワ箓宕堕浣稿壒闂侀潧鐗嗛幃鍧楁偡闁妇鍙嗛柟鐓庣摠缁诲牓宕戝Δ鍛拺閻犲洠锟借櫕鐏嗛梺鍛婎殕婵炲﹪濡存担鍓叉僵闁肩鐏氬▍銏＄箾鐎电孝妞ゆ垵鎳樺鍛婄瑹閿熶粙寮婚悢鐓庣鐟滃繒鏁☉銏＄厸闁告侗鍠楅崐鎰版煛鐏炶濮傞柟顔哄�濆畷鎺戔槈濮楀棔绱�?
		}
		
		checkmove(role, sceneid, curpos, poslist,curTick);
		
	}
	
	public static boolean checkmove(Role role,long sceneid, fire.pb.move.Pos curpos,List<fire.pb.move.Pos> poslist, long curTick)
	{
		if(role.getScene().getSceneID() != sceneid) return false;
		
		if(! role.checkMoveUnit())
		{
			//Scene.logger.debug("闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閳╁啯鐝曢梻浣藉Г閿氭い锔诲枤缁辨棃寮撮姀鈾�鎷绘繛杈剧秬濞咃綁濡存繝鍥ㄧ厱闁规儳顕粻鐐烘煙閽樺锟藉鏁撻弬銈囩У闁哥姵鐗犻幃娆愮節閸愶缚绨婚梺纭呮閸嬬偟锟芥艾婀辩槐鎾存媴閸濆嫷锟藉矂鏌涢敐蹇曠М鐎殿喖顭烽弫鎾绘偐閼碱剨绱叉繝纰樻閸ㄥ磭浜搁妸鈺佺鐎瑰嫭瀚堥弮鍫濈妞ゅ繐妫涢崢顖炴⒒婵犲骸浜滄繛璇х畵楠炴劙骞橀鑲╁摋婵炲濮撮鍛不閹惰姤鐓欓柟顖滃椤ュ鐥幆褏绉洪柡宀嬬節瀹曞爼濡烽妷褌鎮ｇ紓鍌欒兌婵攱绻涢敓浠嬫煟閹垮啫浜扮�规洖鐖兼俊姝岊槷婵℃彃鐗撳娲川婵犲懎顥濆┑鐙呮嫹闂侇剙绉甸弲鎼佹煟閿濆懏婀版い蹇曞枛閺岀喐顦版惔鈥冲箣闂佸搫鏈惄顖氼嚕閹绢喖惟闁靛鍎哄楣冩⒒娴ｅ憡鍟為拑閬嶆煙椤旂厧锟藉灝顕ｆ繝姘櫜闁割偁鍨婚弶鎼佹⒑閸濆嫭宸濋柛瀣耿瀹曨偄螖閿熶粙鈥旈崘顔嘉ч柛鈩冾焾閸嬩線姊洪幖鐐插妧闁告粈鐒﹀暩婵犵數濮烽弫鍛婃叏閹绢喗鏅濋柕鍫濐槸缁犵娀鐓崶銊р槈缁炬儳顭烽弻鈥愁吋閸愩劌顬嬬紓浣叉閹风兘姊婚崒姘拷鎼佹偋婵犲嫮鐭欓柟鐑樺焾閸熷懏绻濋棃娑氬ⅱ缁炬儳銈搁弻锝呂熼崹顔兼優闂佷紮绲惧浠嬪蓟閻旂⒈鏁婄紒娑橆儐閻や線姊虹拠鈥虫灕婵☆偄瀚伴崺銏ゅ箻閼搁潧纾梺闈涱焾閸庤鲸鐡忛梻鍌氬�烽悞锕傛儑瑜版帒鏄ラ柛鏇ㄥ灠閸ㄥ倿鏌ｅΔ锟介悧濠傗枍閻樿绠归弶鍫濆⒔缁嬬粯銇勯锝嗙闁哄瞼鍠栭幃婊兾熺拠鑼暡缂傚倷绀佹晶搴ㄥ磻閵堝绠栨俊銈呮噺閺呮煡骞栫�涙绠橀柟绋款樀濮婃椽宕崟闈涘壉闂佽崵鍟块弲娑綖韫囨稒鎯為悷娆忓閸樺綊姊洪崨濠佺繁闁哥姵淇洪妵鎰樄婵﹥妞介幊锟犲Χ閸涱喗鐦ｉ梻浣告惈閹虫劖鎱ㄩ幘顕呮晪闁挎繂顦介弫鍐煥閺囶亝瀚圭紓浣哄Ь瀹曠數妲愰幘瀛樺闁兼祴鍓濋崹鐢稿煝瀹ュ顫呴柕鍫濇閹锋椽鏌ｉ悩鍏呰埅闁告柨鑻埢宥夊箛閻楀牏鍘甸梺鍛婂灟閸婃牜锟芥熬鎷�, 婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鐐劤椤兘寮婚敐鍛傜喎鈻庨幆褎顔勭紓鍌欒兌婵挳鎮樺璺何﹂柛鏇ㄥ枤閻わ拷闂佸湱鍋撻幆灞轿涢悙鐢电＝濞达絿鏅崼顏堟煕婵犲啰绠炵�殿喖顭烽弫鍐晸閸婄喓浜介梻浣虹帛閼归箖顢氶鐘电焼闁糕剝銇涢弨浠嬫煟閹邦厽缍戦柣蹇ョ畵閹筹綁濡舵径瀣幐闂佽法鍠曟慨銈囩矉閹烘棑鎷烽敐搴′簽闁告﹢浜跺娲惞椤愶絽鐝梺褰掝棑閸忔﹢寮婚敓鐘插窛妞ゆ柨澧介悿鍕倵鐟欏嫭绀冪紒璇插�块幃楣冩晸閻樺磭鍔烽梺鎸庢濡嫰鎯佸鍫熲拻濞撴熬鎷锋繛浣冲洦鍋嬮柛鈩冪☉缁犵娀鏌熼柇锕�鏋ゅ☉鎾崇Т闇夐柣鎾虫捣閹界娀鏌ｉ幘璺烘瀾濞ｅ洤锕俊鎯扮疀閺傛浼撻梻鍌欑劍鐎笛兠洪敂鐣岊洸妞ゅ繐瀚弳锕傛煕濠靛棗顏ゆ俊鎻掔墦閺屾洝绠涢弴鐐愩儲銇勯弮锟界敮鐐垫閹捐纾兼繛鍡樺灥婵¤棄顪冮妶搴″箹婵炲樊鍘奸悾鐑藉閿涘嫷娴勯柣搴秵閸嬶拷闁归攱妞藉娲川婵犲嫮鐣甸柣搴㈠嚬閸撶喖寮幘缁樺殟闁靛绠戦敓鑺ュ姍閺岀喖顢欓惌顐邯閸╃偤骞嬮悪鍛闁挎繂绨肩花浠嬫煟閿濆棙銇濇慨濠冩そ閹兘鏌囬敃锟藉▓鍫曟⒑缁嬫鍎戦柛瀣ㄥ�曢悾鐑芥晲閸垻鏉稿┑鐐村灦閻熝囧矗閸℃せ鏀介柣妯肩帛濞懷勪繆椤愶絿鎳囬挊鐔哥節婵犲倸鏆婇柡锟介懞銉ｄ簻闁哄啫娲ゆ禍褰掑极閸儲鈷戦柛婵嗗閻掕法绱掓潏銊︾缂佸倹甯￠弫鍐磼濮橀硸妲堕柣鐔哥矊椤︻垰宓勯梺鍓插亖閸庢煡鍩涢幋锔藉�甸柛锔诲幖椤庡矂鏌涢妶鍡欐噰婵﹨娅ｉ弫顕�顢欓崜顬粓姊虹紒妯圭繁闁革綇绲介悾鐑藉醇閺囥劍鏅㈡繝銏ｆ硾椤戝棗鈻嶅畝鍕拻濞达絼璀﹂悞楣冩煛閸偄澧撮柟顔惧厴閺佸啴宕掑鍫熷濞达綀鍊介悢鐑樺仒闁斥晛鍟弶鎼佹⒒娴ｈ櫣甯涢柨姘舵煟韫囨柨鍝虹�殿喗濞婇崺锟犲川椤旀儳骞堥梺璇插嚱缂嶅棝宕戦崱妞曟椽寮堕幋鏃�鏂�闂佺偨鍎遍崯鍧椼�傚畷鍥╃＜妞ゆ梻鏅幊鍐煃鐠囨煡鍙勭�规洘绮忛ˇ鎻掆攽椤旇姤銇濋柡宀嬬秮閹垽宕妷褏鍘戦梻浣规偠閸斿苯顭囬敓鐘靛祦闁告劦鐓堝銊╂煥閻斿墎鐭欑�殿噮鍋婇獮妯肩磼濡粯顏熼梻浣芥硶閸ｏ箓骞忛敓锟�?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ゆい顓犲厴瀵鏁愭径濠勭杸濡炪倖甯婄拋鏌ュ几濞嗘挻鈷戠紓浣姑粭鈺佲攽椤斿搫锟芥骞戦姀鐘闁靛繒濮撮懓鍨攽閳藉棗鐏ｇ紒顕呭灦瀹曟洘鎯旈妸锔规嫼闁哄鍋炴竟鍡浰囬敃鍌涘�垫慨姗嗗亜瀹撳棛锟芥鍠涢褔鍩ユ径鎰潊闁绘﹢娼ф慨鍫曟⒒娴ｅ憡鍟為柛鏃撻檮缁傚秴鈹戠�ｎ亪妫峰銈嗘穿閹烽攱鎱ㄦ繝鍌涙儓閻撱倝鎮归崶銊ョ祷缂佺姵妞藉娲捶椤撶喎娈屽┑鐐叉▕閸樺ジ顢氶敐鍡欑瘈婵﹩鍘藉▍婊勭節閵忥絾纭鹃柨鏇畵椤㈡ê煤椤忓應鎷洪梺鍦焾濞撮绮婚幘缈犵箚妞ゆ劦鍋勯獮鏍懚閻愮儤鐓曢柡鍥ュ妼楠炴鐥幑鎰棄闂囧鏌ㄥ┑鍡樺櫤闁诡垰鐗撳浠嬫晸閻樺磭鍘介梺闈涚箚閺呮盯鎮橀懠顒傜＜缂備焦顭囩粻鎾淬亜閺囶亞绋荤紒缁樼箓椤繈顢橀悢鍝ュ礁婵犵數濮伴崹鐓庘枖濞戞粎妾堕梻渚�娼ц墝闁哄懏绮撻幃陇绠涢幙鍐數闂佽偐顭堢欢閬嶎敂閸曘劍鐎哄┑鐐叉閹稿鎮″▎蹇ｆ富閻庯綆浜妤呮煕濡粯灏﹂柡灞稿墲閹峰懐鎲撮崟顐わ紦闂備浇妗ㄩ悞锕傚箲閸ヮ剙鏋侀柟鍓х帛閺呮悂鏌ㄩ悤鍌涘" + role.getName() + "\t" + role.getTeamIndex());
			return false;
		}
		
		if (!role.canMove())
		{
			role.confirmCurPosition();
			return false;
		}
		
		if(role.isJumping())
		{
			//role.getJumpRole().confirmPositionToStart();
			return false;
		}
		
		int z = role.getPos().getZ();
		final Position destPos = new Position(curpos.x, curpos.y, z);
		final java.util.List<Position> positions = new java.util.ArrayList<Position>();
		positions.add(role.getPos());// 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊炲銈嗗笒椤︿即寮查鍫熷仭婵犲﹤鍟扮粻缁橆殽閻愭潙鐏村┑顕嗘嫹闂侀潧鐗嗛幊鎰版偪閿熻姤淇婇悙顏勶拷鏍涙担鑲濇盯宕熼浣稿妳婵犵數濮村ú锕傚煕閹寸姵鍠愰柣妤�鐗嗙粭鎺懨瑰锟介崡鎶藉蓟濞戞瑦鍎熼柕濠忛檮闁款參姊虹�圭姵顥夋い锔诲灥閻忔帡姊绘担鍝ヤ虎妞ゆ垵娲弫鎾绘寠婢舵鍚嬪┑鈽嗗亜閹虫﹢銆侀弴銏狀潊闁炽儱鍟挎禍鍫曟⒒娴ｄ警鐒鹃悗娑掓櫊楠炴劙骞庨挊澶嬬�梺鐟板⒔缁垳锟界數濮撮…璺ㄦ崉娓氼垰鍓版繛瀵稿У閹稿啿顫忓ú顏勪紶闁告洦鍓氶幏閬嶆⒑閻戔晜娅撻柛銊ㄩ哺缁岃鲸绻濋崶銊ワ拷鑽ょ磼濞戞﹩鍎愰柡鍛櫊濮婅櫣绱掑Ο璇茬闁诲骸鐏氱敮鎺椻�﹂崶顒佸殥闁靛牆娲ㄩ敍婵嬫⒑缁嬫寧婀伴柣鐔濆懐椹抽煫鍥ㄧ♁閻撴瑧锟界懓瀚妯何ｇ紒妯镐簻妞ゆ挾鍋為崑銉╂煙閾忣偆鐭掓俊顐㈠暙閳藉顫滈崱妯肩Ь闂傚倸鍊烽懗鍓佸垝椤栫偛绠伴柟闂寸閻ゎ噣鏌熺紒銏犳灈闁藉啰鍠栭弻锟犲炊閳轰焦鐎荤紓浣稿閸嬨倝寮诲☉銏╂晝闁挎繂娲ㄩ悾闈涱渻閵堝骸澧い锕傛涧椤繘鎼归崷顓狅紲濠碘槅鍨甸崑鎰邦敇閸忚偐绠鹃悗娑欘焽閻倕霉濠婂簼绨绘い鏇稻缁绘繂顫濋鐔哥彸闂備礁鎲℃笟妤佺濠靛妫橀柨鐔剁矙濮婄粯鎷呴崨濠傛殘濠电偠顕滅粻鎾崇暦閹达箑绠婚悹鍥皺椤斿棝姊虹紒妯虹伇婵☆偄瀚板畷锟犲箮閼恒儳鍘棅顐㈡处濞叉牕鏆╅梻浣告啞閻熼亶骞忛柨瀣瘈闁汇垽娼цⅷ闂佹悶鍔岄妶绋跨暦濞差亜鍐�妞ゆ挾鍋熼ˇ顕�姊洪崫鍕窛濠殿噣鏀辩粙澶婎吋婢跺鍘炬繝娈垮枟閸旀洟鏁撻懞銉畼濠㈣娲熷畷妤呮嚃閳哄喚鍟庨梻浣烘嚀椤曨參宕戦悢绗猴拷鍌炲蓟閵夛妇鍘遍梺闈涚墕缁绘垹锟芥俺顫夌换婵嬫偨闂堟刀锝嗐亜閺冿拷閻楃姴鐣烽弶璇炬棃宕橀鍡欏幆闂備胶顢婇幓顏嗙不閹达附鍋傛慨妤嬫嫹闁哄瞼鍠愬蹇斻偅閸愨晩锟藉秹姊虹粙鍖″姛闁稿繑锕㈠濠氬Χ閸パ勭�抽梺鍛婎殘閸嬫盯锝為埡渚囨富闁靛牆鍟敓绐栧洤绠柣鎴ｅГ閳锋帡鏌涚仦鍓ф噮闁告柨绉归弻鐔碱敊閼测晛鐓熼悗瑙勬礃缁诲倿鎮惧┑瀣妞ゆ劕鐟崶銊у幈濠电偞鍨堕敃顐㈩潖濡ゅ啰纾奸悹鍥у级椤ャ垽鏌″畝瀣М濠殿噯鎷烽梺闈涚箚閺呮繈宕濋崫銉х＝濞达絽鎼牎闂佺儵鏅╅崹璺侯嚕婵犳艾鐒洪柛鎰╁妿缁愮偤鏌熼崗鑲╂殬闁搞劌顭锋俊瀛樼節閸屻倖瀵岄梺闈涚墕濡瑩鍩涢幇鐗堝仺妞ゆ牗顨愰幏鐑藉箛娴ｅ湱绋佹繝鐢靛仜濡﹥绂嶅鍐惧晠婵犻潧妫岄弨浠嬫煟濡绲婚柨鐔诲Г閹倿鏁愰悙鍏告勃閻熸瑱绲鹃弬锟介梻浣哥枃濡嫬螞濡ゅ懏鍊堕柣妯肩帛閻撱儵鏌￠崶銉ュ缂併劎绮妵鍕即椤忓棛袦濡ょ姷鍋為悧妤呭箯閸涱垱鍠嗛柛鏇ㄥ墻娴犙勭節閻㈤潧浠滄い鏇ㄥ幗閹便劑骞橀鍛櫈闂佺硶鍓濈粙鎴︽偂閺囥垺鐓欓柣鎴灻▓顔炬喐閻楀牆绗氶柡鍛絻椤潡鎳滈惉顏呭灴钘熼柡宥冨妿缁犻箖鏌熺�电浠﹂悘蹇庡嵆閺岋綁骞欓崟顓犵槇閻庢鍠栭…鐑藉箖閵忋倖鍋傞幖杈剧秵濡查亶姊绘笟锟藉褔鎮ч崱妞㈡稑螖閸滀焦鏅滈梺璺ㄥ櫐閹凤拷? 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣洴钘濋柣銏㈩焾閸ㄥ倸螖閿濆懎鏆欑紒鐘崇☉闇夐柨婵嗘噺鐠愶紕绱掔�ｂ晞鍏岀紒杈ㄦ崌瀹曟帒顫濋濠冨闁绘垼濮ら崐鍧楁煥閺囨氨鍔嶉柟鍐茬焸濮婄粯鎷呴崨濠傛殘闂佽崵鍠嗛崕鎶藉箲閵忕媭娼ㄩ柨鐔绘椤曪絾绻濆顓炰簻闂佹儳绻愬﹢閬嶆晬濠婂牊鈷戦梻鍫熺〒缁犲啿鈹戦鐐毈闁诡喗锕㈠畷濂稿Ψ閿旇瀚兼繝鐢靛仩鐏忣亪顢氳閻涱喖螖娴ｅ吀绨婚梺闈涱焾閸庡鐓鍌︽嫹濞堝灝鏋︽い鏇嗗洤鐓″鑸靛姇椤懘鏌ｅ锟藉褎鎱ㄩ崼鏇熲拻濞达絽鎲￠崯鐐烘煕閺冩捇妾紒鍌氱Ч瀵粙鈥栭濠勭М鐎规洖銈告慨锟介柕蹇ｆ緛缁卞啿鈹戦悙瀛樺鞍闁煎綊绠栭弫鍐Ψ瑜濋幏宄邦潩椤掑倻楔濠殿喖锕ㄥ▍锝夊礌閺嶎厼鍗抽柣鎰ゴ閹枫倖淇婇悙顏勶拷褏绮婚幘鍓佺＝婵娉涙闂佸湱澧楀妯肩不閹惰姤鐓欓柟顖嗗啫绗紓浣靛妿閺佽顫忓ú顏呭仭闁哄瀵ч崐顖炴⒑鐠団�崇仩闁活厼鍊搁悾閿嬪閺夋垵鍞ㄩ悷婊冾樀瀵悂寮崼鐔哄幈濡炪倖鍔х徊鍓х矆閸愵喗鐓曞┑鐘插閺嗩剟鏌熼鐓庢Щ闁宠姘︾粻娑㈠箼閸愌呮／缂傚倸鍊风粈渚�鎯屾担绯曟灃闁哄洨濮甸～鏇㈡煙閻愵剙澧柛姘儔閺屾盯寮撮妸銉ョ闂佺粯绋忛崹纭呯亙闂佺粯锕㈠褎绂掑鍫熺厱闁绘梻顭堥埢鏇炩攽閿涘嫭鏆鐐叉喘瀵墎鎹勯…鎴濇暯闂傚倷鑳堕幊鎾活敋椤撶喐鍙忛柟缁㈠枟閺呮悂鏌ｉ敐鍛板濞寸姾椴搁幈銊︾節閸愨斂浠㈠Δ鐘靛仦閸旀牠骞嗛弮鍫濐潊妞ゎ偒鍠氶獮銏㈢磽閸屾艾锟介娆㈤妶澶婄鐎瑰嫯鍩囬敓鑺ュ笒椤繈鎮欓锟介鍫曟煟鎼淬値娼愭繛鎻掔箻瀹曡绂掔�ｎ亝鐎梺鐟板⒔缁垶宕戦幇鐗堢厸闁稿本锚閸旀粓鎮楀鍐蹭汗缂佽鲸鎹囧畷鎺戔枎閹搭厽袦婵＄偑鍊栭崹闈浳涘┑瀣拷渚�寮借閺嬪酣鏌熼幆褏锛嶉柨娑氬枎閳规垿鎮╃拠褍浼愰梺纭呮珪閸旀绔熼弴銏″仼鐎癸拷鐎ｎ偄顏跺Δ鐘靛仜閻忔繈宕濆鑸靛�垫慨妯煎帶濞呭秹鎸婂┑瀣叆闁哄洨鍋涢敓钘夌秺閹繝鎮㈤崗鑲╁弳濠电娀娼уΛ娆撳闯鐟欏嫪绻嗛柤纰卞墰鐢盯鏌曢崶褍顏い銏℃礋閺佹劙宕堕埡鍐╂緰濠碉紕鍋戦崐鎴﹀垂濞差亗锟藉啴宕卞Δ濠傛闂佸憡娲﹂崣蹇涘箯閻戣姤鏅查幖瀛樼箘閺佹牕鈹戦檱椤曟粎绱炴担鍓叉綎濠电姵鑹剧壕鍏肩箾閸℃ê绗掗柛妯凤拷鎰佹富闁靛牆鍟悘鈺呮煥閺囥劋閭柡浣瑰姍閹瑩寮堕幋鐘电嵁闂備礁缍婇崑濠囧礈濞戔懞鍥敋閿熻棄顫忓ú顏勪紶闁告洦鍓欓崑宥夋⒑閹肩偛濮�妞ゆ泦鍥ㄥ仼闁割煈鍋嗛悷褰掓煥閻斿墎鐭欑�殿喖顭锋俊鎼佸煛閸屾矮绨介梻浣侯焾閺堫剛绮欓幋锔绘晜闁跨噦鎷�
		for(final Pos p : poslist)
			positions.add(new Position(p.x, p.y, z));
		
		final int length = destPos.getDistance(role.getPos());
		if(role.isJumping())
		{
			//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄婵犲灚鍔栫紞妤呮⒑鐠恒劌鏋欐俊顐㈠瀹曟劙宕烽鐘电効闂佸湱鍎ゅΛ鎴﹀箯閻戣姤鏅查幖绮癸拷鑼嚬婵犵數鍋涢幊宀勫垂閽樺娼栨繛宸簼閸ゅ秹鏌曟径濠傛灓濞存粠浜ｅΛ鐔奉渻閵堝棛澧遍柛瀣☉鏁堥柡灞诲劜閳锋垶銇勯幒鐐村缂備礁顦遍弫濠氬箖閿熺姴唯闁冲搫鍊婚崢浠嬫⒑閸濆嫬鏆欓柛濠呭吹閺侇喖鈽夊▎宥勭盎闂侀潧顦崕鍝勎ｉ搹鍦＜閺夊牄鍔嶇亸顓熴亜閹剧偨鍋㈢�规洦浜畷姗�顢橀悙鏉戝壍婵犲痉鏉匡拷妤佹叏閻戣棄纾绘繛鎴欏灩閻ゎ喗銇勯幇鈺佸姢濞存粈绮欏娲嚒閵堝憛銏＄箾濞村娅囧ù婊咁焾閳诲酣骞嬮悩闈涚闂備胶绮崝鏇㈩敋椤撶姴濮柨鐔剁矙濮婂搫效閸パ呬紙濠电偘鍖犻崘顏呮噧闂傚倷娴囬褏锟芥稈鏅濈划娆撳醇閵夈儳鏌у┑鐐村灍閸嬫捇鏁撻挊澶嬪櫤缂佽櫣鏅划娆戞嫚闁款垱娅婇柡灞界Ч瀹曨偊宕熼顒佸闁汇垻顭堢粻顖涚箾瀹割喕绨奸柍閿嬪灴閺屾盯鏁傜拠鎻掑闂佺粯甯為崑鎾舵崲濞戙垹绠绘い鏇炴噺椤ユ牜绱撴笟鍥ф灈妞ゎ厾鍏橀悰顔嘉熼懖鈺冿紲濠碘槅鍨抽崢褔鐛澶嬧拻濞达絽鎲￠崯鐐烘煕閺冿拷椤洦绂嶇粙搴撴瀻闁瑰濮崇粭澶嬬節閻㈤潧校缁炬澘绉归幃锟犳偄閸忚偐鍘甸梺鍓茬厛閸犳牠寮冲▎蹇ｇ唵鐟滃秹鎮洪妸鈺佄﹂柛鏇ㄥ灠椤懘鏌嶉挊澶嬵棡闁汇倓绶氶幃妤冩喆閸曨剛顦梺鍝ュУ閻楃娀濡存担鑲濇棃宕ㄩ鑺ヮ仧闂備礁鍚嬫禍浠嬪磿閹跺锟藉懘鏌ㄧ�ｃ劋绨婚梺鍝勭▉閸嬪嫭绂掗敃鍌涚厓闂佸灝顑呴悘鎾煛鐏炲墽鈽夐柍钘夘槸椤粓宕煎┑鍡╂浆缂傚倸鍊烽懗鑸垫叏閻㈢绠查柛銉墮缁犳牗淇婇妶蹇斿濡炪値鍋呯换鍫ュ箖閳╁啯鍎熼柕蹇嬪灩缂嶅棝姊虹拠鎻掝劉妞ゆ梹鐗犲畷鏉课旈崨顓犵暫闂佺鏈銊╁汲閿旇姤鍙忔俊銈咁儐鐎氱懓顪冮妶鍐ㄧ仾婵☆偄鍟悾鐑藉础閻愨晜鐎诲┑鐐叉閸ㄧ數鑺遍妷鈺傗拻濞达絿鐡旈崵娆愮箾閺夋垵妲婚柍璇茬Ч婵拷闁靛牆鎳愰鍡涙⒑缂佹ê鐏卞┑顔哄�濆畷鎰版偨閸涘﹦鍙嗗┑鐘绘涧濡繈顢撳Δ锟介湁婵犲﹤瀚惌瀣煏閸パ冾伂缂佺姵鐩俊鐑芥晝閿熶粙顢旈敓锟�
			if(!role.getJumpRole().checkValidJump(positions, destPos))
			{
				role.getJumpRole().confirmPositionToStart();
				return false;
			}
		}
		else
		{
			// 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閻樻爠鍥ㄧ厱闁靛鍨哄▍鍥煕濡厧鈻堟慨濠勭帛閹峰懘鎼归悷鎵偧闂備焦鎮堕崝宀勬偉閻撳寒鍤曢柟闂寸劍閸ゆ帡鏌曢崼婵囧窛妞わ富鍨跺娲传閸曨喚妾ㄩ悗鐧告嫹闁跨喍绮欏畷顒勬偨閸涘﹦鍘介梺缁橆焽閸庛倝顢旈悩缁樺�堕煫鍥ь儏婵倻锟借娲樼换鍫ュ箖閵忋倕绀傞柤娴嬫櫅楠炴劙姊绘担铏广�婇柛鎾寸箞瀹曟繈寮撮姀鈩冩闂佸吋浜介崕鑼矆鐎ｎ偆绡�闁跨喕濮ょ粭鐔兼晸閽樺娼栨繛宸簻缁犱即骞栨潏鍓ф偧闁伙綁娼ч埞鎴︽倷閼碱剚鍕鹃梺绋匡攻缁诲倿鎮惧畡鎵虫斀闁割偒鍓氱�氬綊鏌ㄥ┑鍡涱�楀褔绠栭弻鐔兼倻缁涘顥栭梺鐟板级閹稿啿鐣烽悢纰辨晢闁稿被鍊栬ⅲ婵犵绱曢崑鎴﹀磹瑜忕槐鎾愁潩鐠鸿櫣顢呴梺鎯ф禋閸嬪倻鎹㈤崱娑欑厽闁靛繈鍩勯悞鍓х磼閿熺晫锟斤綆鍋佹禍婊堟煛瀹ュ啫濮�濠㈣锕㈤弻娑㈡倷椤忓嫬顫囧┑顔硷攻濡炶棄螞閸愵煁褰掑Χ閸℃瑦鍒涢悗瑙勬磸閸旀垿銆佸☉姗嗘僵妞ゆ帒鍊婚幉鎸庣節閻㈤潧啸闁轰礁鎲￠幈銊╂倻閽樺鐎梺褰掓？缁�浣哄缂佹绠鹃柟瀛樼懃閻忣亪鏌涚�ｎ亶鍎旈柣鎿冨亰瀹曞爼濡搁敂瑙勫缂傚倷鑳舵繛锟界紒鐘崇墵瀵濡搁埡鍌氫簻闁荤姴娲﹂悾顐﹀箻缂佹鍘垫繛鎾磋壘閻忔繃淇婇悾宀�纾肩紓浣诡焽缁犵偟锟借娲樼敮鈩冧繆閸洖鐐婄憸搴ㄥ磹椤栫偞鈷掗柛灞剧懄缁佺増淇婂鐓庡闁诡喚鍋ら弫鍐磼濮橀硸鍞堕梻浣哄帶椤洟宕愬Δ鍛剹濠㈣埖鍔栭悡娆撴煟閹寸倖鎴λ夐弽顓熺厵濡炲楠搁崢鎾煛娴ｇ懓濮堥柟顖涙煥閳规垿宕奸姀鈩冩珤闂傚倸鍊峰ù鍥敋瑜忛敓钘夌仛鐢�崇暦閵忥紕闄勭紒顖涙穿閹风兘寮崼婵堫槰濡炪倖鏌ㄥΣ鍫ｎ樄闁哄本鐩崺鍕礂閿旇棄鍝烘鐐茬箲缁绘繂顫濋娑欏闂備礁鎲￠崝鏍亹閸愩剮锝嗙節濮橆厾鍘藉┑掳鍊撻悞锔句焊椤撱垺鐓熼柨婵嗘搐閸樺瓨銇勯姀鈽嗘疁闁轰焦鎹囬幃鍓т沪閽樺鏌ф繝纰夌磿閸嬫垿宕愰弴鐘冲床闁圭増婢樼粻鐘绘煙閻楀牊绶查柛灞诲姂閺屾稑鈽夊鍫濆缂備讲妲勯幏鐑芥⒒娓氾拷濞佳勵殽韫囨洖绶ら柛鎾楀嫬鍘归梺缁樺姦閸忔稓鎹㈤崱妯镐簻闁规澘澧庨幃濂告煙閸愭彃鏆ｉ柡灞界Ф閹风娀鎳犻顐庡拑鎷风憴鍕鐎规洦鍓熼崺銏℃償閵娿儳顓洪梺缁樼懃閹虫劖鎯旀繝鍥ㄢ拻濞达絿鐡旈崵娆撴煕閹寸姵娅曠紒杈╁仱瀹曞崬鈽夊Ο纭风幢闂備胶纭堕崜婵婃懌濠电偛鎳愭繛锟介柡宀嬬秮婵拷闁绘ê鍟块弳鍫ユ⒑缂佹ɑ灏紒缁橈耿瀵鈽夐姀鐘靛姶闂佸憡鍔忛弲婵嬎囬鐘电＝濞达絿鎳撴慨鍫熸叏婵犲倻绉洪柕鍡楀暣婵＄兘鍩￠崒姘炬嫹妞嬪函鎷烽悷鏉款棌闁哥姵鐗犲畷婊堝醇閺囩啿鎷洪柡澶屽仦婢瑰棝藝閿曞倹鐓曞┑鐘插�归崑銉︻殽閻愭彃鏆ｇ�规洘绮忛ˇ杈ㄧ箾瀹�濠侀偗闁哄矉绠戣灒闁绘艾顕粈濠囨⒑闂堟侗妲撮柡鍛矒閸╂盯骞掑Δ浣哄幈闁诲繒鍋涙晶浠嬪箠閸℃稒鐓曢煫鍥ㄦ尵閻忚京绱掓潏銊ユ诞妞ゃ垺宀稿畷銊╊敇閻樿鲸顢橀梺璇插椤旀牠宕伴弽顓涳拷锕傛煥鐎ｂ晝绠氶梺褰掓？缁�渚�鎮″☉妯忓綊鏁愰崨顔藉枑闂佸憡绻傞柊锝咁潖缂佹ɑ濯撮柛娑橈攻閸庢捇鏌ｉ悙鏉戝毈闁稿锕ら悾鐑藉即閻忕粯妞介、鏃堝礋椤掑偊鎷烽浣虹瘈闁汇垽娼у瓭闂佺锕﹂弫璇差嚕閵婏妇顩烽悗锝庡亞閸樿棄鈹戦埥鍡楃仩闁圭⒈鍋嗛惀顏囶槻妞ゎ叀娉曢幑鍕传閸曞吀绱旈梻浣告惈閻绱炴笟锟介悰顔嘉熺涵閿嬪婵炴垶鐟悞鑺ャ亜閿斿灝宓嗘慨濠冩そ瀹曨偊宕熼鐘辩礃闂備礁鎽滄慨鐢告偋閺囥垺鍋╅柣鎴犵摂閺佸啴鏌ㄩ弴顏呭缂備緤鎷烽悗锝庡枟閳锋帡鏌涢銈呮灁闁宠棄顦…鍧楁偡閹殿喖鈪靛┑顔硷功缁垶骞忛崨瀛樺殟闁靛／渚婃嫹婵犲洦鈷戦柛婵勫劚鏍″┑鐐插级閿曘垽鐛崼銉ノ╅柍杞扮导瑜嶉…璺ㄦ崉娓氼垰鍓版繛瀛樼矒娴滆泛顫忛搹鍦＜婵☆垰娴氭禍婊嗙亽婵犵數濮村ú銈夊触瑜版帗鐓涢柛銉㈡櫅娴滃綊鏌￠敓鑺ョ鐎ｎ偆鍘藉┑鈽嗗灥濞咃綁鏁嶅鍡愪簻闁挎繂妫涢崣锟介梺鍝勭焿缁绘繂鐣烽妸鈺婃晩闁芥ê顧�閹风兘骞囬悧鍫㈠幐闁诲繒鍋犻褎鎱ㄩ崒鐐寸厵妞ゆ柨鎼敓鑺ョ箓閻ｇ兘骞掗幋鏃�顫嶅┑顔筋殔濡梻妲愰敓锟�
			int cruiseid = role.getCruiseid();
			if(! role.checkValidMove(cruiseid, positions, destPos, curTick, length))
			{
				role.confirmCurPosition();
				return false;
			}
		}
		role.move(destPos);
		if(!role.isJumping())
			SceneBattle.process(role, length, curTick);
		return true;
	}
	

	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 790435;

	public int getType() {
		return 790435;
	}

	public fire.pb.move.Pos curpos; // 人物当前点
	public java.util.LinkedList<fire.pb.move.Pos> poslist; // 路径上的关键点
	public long sceneid; // 场景id

	public CCheckMove() {
		curpos = new fire.pb.move.Pos();
		poslist = new java.util.LinkedList<fire.pb.move.Pos>();
	}

	public CCheckMove(fire.pb.move.Pos _curpos_, java.util.LinkedList<fire.pb.move.Pos> _poslist_, long _sceneid_) {
		this.curpos = _curpos_;
		this.poslist = _poslist_;
		this.sceneid = _sceneid_;
	}

	public final boolean _validator_() {
		if (!curpos._validator_()) return false;
		for (fire.pb.move.Pos _v_ : poslist)
			if (!_v_._validator_()) return false;
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		_os_.marshal(curpos);
		_os_.compact_uint32(poslist.size());
		for (fire.pb.move.Pos _v_ : poslist) {
			_os_.marshal(_v_);
		}
		_os_.marshal(sceneid);
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		curpos.unmarshal(_os_);
		for (int _size_ = _os_.uncompact_uint32(); _size_ > 0; --_size_) {
			fire.pb.move.Pos _v_ = new fire.pb.move.Pos();
			_v_.unmarshal(_os_);
			poslist.add(_v_);
		}
		sceneid = _os_.unmarshal_long();
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CCheckMove) {
			CCheckMove _o_ = (CCheckMove)_o1_;
			if (!curpos.equals(_o_.curpos)) return false;
			if (!poslist.equals(_o_.poslist)) return false;
			if (sceneid != _o_.sceneid) return false;
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		_h_ += curpos.hashCode();
		_h_ += poslist.hashCode();
		_h_ += (int)sceneid;
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append(curpos).append(",");
		_sb_.append(poslist).append(",");
		_sb_.append(sceneid).append(",");
		_sb_.append(")");
		return _sb_.toString();
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

