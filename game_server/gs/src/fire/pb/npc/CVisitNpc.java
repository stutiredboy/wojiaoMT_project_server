
package fire.pb.npc;

import java.util.Collections;

import fire.pb.PropRole;
import fire.pb.main.ConfigManager;
import fire.pb.map.Npc;
import fire.pb.map.Role;
import fire.pb.map.RoleManager;
import fire.pb.map.SceneNpcManager;


// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CVisitNpc__ extends mkio.Protocol { }

/** 客户端请求访问 NPC
*/
// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

public class CVisitNpc extends __CVisitNpc__ {
	private boolean checkGatherTask( long roleid, final SGatherConfig conf ) {
		if ( conf.tasks == null || conf.tasks.isEmpty() ) {
			Module.logger.error("闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚敐澶婄闁挎繂鎲涢幘缁樼厱濠电姴鍊归崑銉╂煛鐏炶濮傜�殿喗娼欓～婵嬫嚋濞堝尅鎷烽弽銊х閻庢稒顭囬惌濠勭磽瀹ュ拑韬�殿喛顕ч埥澶愬閻樼數鏉搁梻浣圭湽閸ㄨ棄顭囪閺侇噣骞掗幋鏃�鏂�闂佺粯鍔曞鍫曞煝閺囩伝鐟邦煥閸愵亜鐓熼悗娈垮櫘閸嬪﹤鐣烽崼鏇ㄦ晢濞达絽鎼獮妤呮⒒娴ｄ警鏀伴柛鈺佹喘瀹曟繂顓奸崨顏呯�洪梺绯曞墲缁嬫帡鎮￠悢鑲╁彄闁搞儯鍔嶇亸顓㈡煛閸☆厾绋婚柟渚垮妽缁绘繈宕橀埞澶歌檸婵°倗濮烽崑鐐哄礉閺嶎厼绠氶柡鍐ㄧ墕椤懘鏌曡箛濠冩珕鐞氾綁姊婚崒姘拷鐑芥嚄閸洍锟斤箓宕奸妷锔芥珖闂侀潧鐗嗗ú銊х矆婵犲倵鏀介柣妯诲絻閿熻棄顭峰鎶芥晝閸屾稓鍘甸柣搴ｆ暩椤牓顢撻幘缁樼厵濡炲楠搁崢鎾煛娴ｇ懓濮堥柟顖涙閸╁嫰宕橀鍐╁枤闂傚倸鍊烽懗鍓佸垝椤栫偛绠伴柟闂寸閻ゎ噣鏌熺紒銏犳灈闁藉啰鍠愮换娑㈠箣閻愬啯宀稿銊︾鐎ｎ偆鍘遍梺鏂ユ櫅閸犳艾鈻撻姀鐘嗗綊鎮╃仦鍌氫划濠殿喖锕ュ钘夌暦椤愶箑绀嬫い鎺戭槹閿熴儵姊绘担渚劸妞ゆ垵鍟村畷鎰攽閸♀晛娈ㄦ繝鐢靛У绾板秹寮查幓鎺濈唵閻犺桨璀﹂崕鎰箾閸涱喚鐭掓慨濠冩そ楠炴牠鎮欓幓鎺戭潙闂備礁鎲￠弻銊╂煀閿濆锟戒礁鈻庨幘鍐茬彉缂備礁宕崺宄撮梻鍌氬�搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊炲銈嗗笒椤︿即寮查鍫熷仭婵犲﹤鍟扮粻濠氭煛娴ｈ宕岄柟宕囧仱婵＄柉顦柡瀣濮婃椽宕崟顒�娅ょ紓浣筋嚙鐎氭澘鐣峰璺虹闁瑰瓨姊归悗濠氭⒑鐟欏嫬鍔ょ痪缁㈠弮椤㈡瑦绻濋崒妤佹杸闂佹寧绋戠�氼剚绂掕閺屾洟宕卞Δ濠傚壎濡ょ姷鍋涚换姗�骞冨鍫熷癄濠㈣泛鐭堝Σ鐗堜繆閻愵亜锟芥牕顫忔繝姘偍鐟滄棃骞婇幘璇插瀭妞ゆ棁顫夐弬锟介梻浣虹帛閸旀牕顭囧▎鎾村�堕柛妤冨剱濞撳鎮楀☉娅虫垿宕愰幇顕嗘嫹濞堝灝鏋熼柣鎿勭節瀹曟椽鏁撻悩鎻掔獩濡炪倖姊归崕鎶界嵁濡ゅ懏鈷掑┑鐘查娴滄粍绻涚拠褏鐣遍悡銈夋煛瀹ュ啫濡挎い鈺呮敱缁绘繃绻濋崒姘亾闂佺粯鏌ㄥΛ娑㈠箟缁嬭法鏆嗛柨鐔剁矙瀹曟岸骞掗幋鏃�鐎婚梺瑙勫礃濞呮洖危椤掑嫭鈷戦梻鍫熺〒缁犵偤鏌涙繝鍐╃闁绘碍鍎抽鍏煎緞鐎ｎ剙骞堟俊鐐�栭崝鎴﹀磹閺囥垹鍑犻柡鍐ㄧ墛閻撴洘绻涢崱妤冪妞ゅ浚鍘芥穱濠囶敃閵忊�虫畻濡炪們鍨哄ú鐔告叏閿熶粙鏌嶉妷锕�澧俊鏌ヤ憾濮婄粯鎷呴崨濠呯濡炪値鍘奸悧鎾荤嵁濡わ拷椤劑宕煎┑鍥╋拷顒�顪冮妶鍡樼┛闁瑰嘲鍢查埞鎴﹀焺閸愨晛锟芥劙鏌涢埡瀣瘈鐎规洘甯掗…銊╁礃閵娧屽敹婵犵數濮烽弫鎼佸磻閻愬搫绠板┑鐘崇閸ゅ苯螖閿濆懎鏆為柡鍛箞閺屾洘绔熼姘毙ｉ悗姘愁潐閹便劌螣閻撳簼澹曢柣搴㈢啲閹凤拷");
			return true;
		}
		if ( fire.pb.mission.Module.getInstance().checkGather(roleid, conf) ) {
			return true;
		}
		return false;
	}
	private void gatherProcess( long roleid, int gatherid ) {
		// 
		SGatherConfig conf = ConfigManager.getInstance().getConf(fire.pb.npc.SGatherConfig.class).get(gatherid );
		if ( conf == null ) {
			Module.logger.error( "濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閹冣挃缂侇噮鍨抽幑銏犫槈閵忕姷顓洪梺缁樺姇閻忔岸宕宠缁辨挻鎷呯粙娆炬殺闂佺顑冮崐婵嗩嚕鐠囨祴妲堥柕蹇曞閵婏负浜滈柡鍐ㄥ�哥敮鑸点亜椤愮喐娅囩紒杈ㄦ尰缁楃喐绻濋崘顭戜紦闂傚倷绀佹竟濠囧磻閸℃稑绐楅柟鎹愭硾婵剟鏌ㄩ悢鍓佺煓婵﹤顭峰畷鎺戭潩閸楃儐鏉哥紓鍌欑椤戝棛鏁敓鐘叉瀬鐎广儱顦猾宥夋煕椤愩倕鏋旈柛姗�绠栧娲传閸曞灚歇濠电偛顦板ú妯肩矉閹烘顫呴柕鍫濇－濮婃寧绻濋姀锝呯厫闁告梹鐗犻幃锟犲Ψ閿斿墽鐦堥梻鍌氱墛缁嬫帡藟閻愮儤鐓欓柛蹇曞帶婵秹鏌＄仦鍓ф创鐎殿噮鍓欓埢搴ㄥ箚瑜嶆竟搴ㄦ⒒娴ｇ瓔鍤冮柛鐘愁殜閵嗗啴宕ㄦ潏鍓х◤濠电娀娼ч鎰板极閸ヮ剚鐓熼柟閭﹀墮缁狙囨煙閾忣偆鎳囨慨濠勭帛閹峰懘宕ㄦ繝鍐ㄥ壍闂備礁鎼悧婊堝礈濞嗘垵寮叉繝纰樻閸垳鎷冮敃鍌氬惞婵°倕鎳忛悡鏇㈡煛閸ャ儱濡奸柣蹇曞У椤ㄣ儵鎮欓鍕痪婵烇絽娲ら敃顏堛�佸☉妯锋斀闁糕剝顨嗛崕顏堟煟閻斿摜鐭嬫繝銏★耿楠炲﹨绠涢弴鐔峰簥濠电娀娼ч鍡涘磻閵娾晜鈷掗柛顐ゅ枔閳笺儳绱掗鑲╁煟婵﹥妞介幃鐑藉级閹稿孩鐦ｇ紓鍌欒兌缁垶宕濆▎鎾崇畺闁诡垎锟介弨浠嬫煕椤愮姴鐏柣鎾存尭閳规垿鎮欓崣澶樻￥闂佺顑嗛幐鍓ф閻愬瓨鍎熼柕蹇嬪灮閻﹀牓姊哄Ч鍥х伈婵炰匠鍕ⅰ闂傚倷鑳堕崢褏绱炴繝鍕笉闁哄稁鍘介崑妯汇亜閺囶亝瀚规繝娈垮櫙閹风兘姊洪悙钘夊姤閻忓繑鐟х划璇差潩閼哥鎷洪梻鍌氱墛缁嬫挻鏅堕弴銏″�垫慨妯煎帶閺嬨倝鏌熷畡鎵Ш闁诡啫鍥ч唶婵犲﹤鎳愰悾鐐繆閻愵亜锟芥牠宕濆Δ浣瑰弿闁圭虎鍠楅弲鎼佹煠閹帒鍔ゅ褔浜堕弻鐔肩嵁閸喚浠奸梺瀹狀潐閸ㄥ綊鏁撻弬銈囩У濞存粎鍋ゅ畷銏ゆ焼瀹ュ棌鎷洪柣鐘充航閸斿矂寮稿鍥╃＜妞ゆ梻鏅幊鍐煟閿濆懎妲绘い顐ｇ矒閺佹挻绂掔�ｎ亝妲梺鏂ユ櫅閸燁垱鍒婇幘顔解拺闁割煈鍣崕鎰版煃缂佹ɑ绀嬫慨濠傤煼瀹曟帒顫濋濠冨鐎瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟⒑閸濆嫮鈻夐柛妯恒偢瀹曞綊宕掑В顓炵秺瀹曟宕楅懖鈺冣枏闂備焦鐪归崐銈夊闯閿濆钃熼柍鈺佸暙缁剁偤鎮楅敐搴濈敖濞寸姴銈稿娲传閸曨剨绱ㄧ紓浣哄У閹瑰洤顕ｆ繝姘櫜濠㈣泛锕﹂惈鍕⒑缁嬫寧婀版い銊ユ閿熻姤纰嶉惄顖氼潖閻戞ɑ濮滈柟娈垮櫘濡差喚绱撴担鍓叉Ш闁轰礁顭烽悰顕�宕奸妷銉庘晠鏌曟径妯烘灍鐎点倖妞藉铏瑰寲閺囩偛鈷夊銈冨妼閹虫﹢宕哄☉娆忕窞鐎癸拷閿熺晫澹曢挊澹濆綊鏁愭径妯活棖濡炪倧璁ｉ梽鍕Φ閸曨垰鍗抽柕濞垮劚缁犺鈹戦垾鍐茬骇闁告梹鐟╅悰顔嘉熼崗鐓庣彴闂佽偐鈷堥崜銊ф閸欏绡�婵炲牆鐏濋弸鐔兼煥閺囨娅婄�规洘顨呴埥澶愬閻樼數宕跺┑鐘垫暩婵潙煤閿曞倸鐓曢柟杈鹃檮閻撶喖鏌ｉ弬鎸庡暈缂佽泛寮剁换娑㈠醇濮橆厽鐝氶梺鍝勭灱閸犳牕鐣峰▎鎾澄ч柛鈩冾殢娴硷拷?" + gatherid );
			return;
		}

		if ( !checkGatherTask( roleid, conf ) )
			return;

		fire.msp.npc.GCheckGathering send = new fire.msp.npc.GCheckGathering();
		send.gatherkey = npckey;
		send.roleid = roleid;
		fire.pb.GsClient.sendToScene( send );
	}
	
	public static void getScenarioQuests( 
			final long roleid,
			final int npcid, 
			SVisitNpc svisitNpc ) {
		try {
			svisitNpc.scenarioquests.clear();
			svisitNpc.scenarioquests = new fire.pb.mission.MissionColumn(roleid, true).getMissionsByNpcid(npcid, svisitNpc);
			Collections.sort(svisitNpc.scenarioquests);

		} catch ( Exception e ) {
			e.printStackTrace();
		}
	}
	
	private void onVisitNpc( final long roleid, final SNpcShare share ) {
		//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄婵犲灚鍔栫紞妤呮⒑鐠恒劌鏋欐俊顐㈠瀹曟劙宕烽鐘电効闂佸湱鍎ゅΛ鎴﹀箯閻戣姤鏅查幖绮癸拷鑼嚬婵犵數鍋涢幊宀勫垂閽樺娼栨繛宸簼閸ゅ秹鏌曟径濠傛灓濞存粠浜ｅΛ鐔奉渻閵堝棛澧遍柛瀣☉鏁堥柡灞诲劜閳锋垶銇勯幒鐐村缂備礁顦遍弫濠氬箖閿熺姴唯闁冲搫鍊婚崢浠嬫⒑閸濆嫬鏆欓柛濠呭吹閺侇喖鈽夊▎宥勭盎闂侀潧顦崕鍝勎ｉ搹鍦＜閺夊牄鍔嶇亸顓熴亜閹剧偨鍋㈢�规洦浜畷姗�顢橀悙鏉戝壍婵犲痉鏉匡拷妤佹叏閻戣棄纾绘繛鎴欏灩閻ゎ喗銇勯幇鈺佸姢濞存粈绮欏娲嚒閵堝憛銏＄箾濞村娅囧ù婊咁焾閳诲酣骞嬮悩闈涚闂備胶绮崝妤呭磿閵堝鐓曢柟瀵稿У閸犳劙鏌ｅΔ锟介悧鍡欑箔閹烘嚚鐟邦煥閿熶粙宕￠幎钘夎摕婵炴垯鍨圭粻濠氭倵闂堟稒鍟為柛锛卞喚娓婚柕鍫濇缁岃法绱掗煫顓犵煓闁诡噣绠栭弫鎾绘偐瀹曞洤濮洪梻浣瑰濡礁螞閸曨垱鍎婃繝濠傜墛閳锋帒銆掑鐐濠电偘鍖犻崶銊ヤ罕闂佺硶鍓濋妵鍌氣槈濡攱顫嶅┑鐐叉閸旀牠鎮靛畡閭︽富闁靛牆妫楃粭鎺楁倵濮樼厧寮柟顕嗙節閹晠宕归銏＄�鹃梻浣虹帛椤ㄥ懘鎮ч崱娆戠當鐟滄棃寮婚敐澶嬫櫜闁糕剝菧娴犮垽姊洪崷顓х劸闁挎洦浜獮鍐閵堝棗浠忛柣搴㈢♁閿氭い蹇撶埣濮婅櫣鎷惔鈥虫殲闁哥喓鍋ら幃妤�顫濋鍌溞ㄥ┑顔硷攻濡炶棄鐣烽妸锔剧瘈闁告劦鐓堝Σ閬嶆⒒娴ｅ憡鍟為柟绋款煼閹嫰顢涘杈ㄦ闂侀潧绻堥崐鏇犵不閻熸噴褰掓晲閸涱厼杈呴梺褰掓敱濡炶棄顫忓ú顏勫窛濠电姴鍟棄宥夋偡濠婂嫭绶查柛鐕佸灣缁顓奸崱娆樻祫闁诲函缍嗛崑鍡涘储闁秵鐓熼幖鎼灣缁夐潧霉濠婂嫮鐭掓い銏℃椤㈡棃宕奸悢鍝勫箰闂備礁鎲＄粙鎺戭熆濮楋拷閹繝骞囬悧鍫濓拷闈浢归敐鍛殭濞存粌缍婇弻銊╂偄鐠囨畫鎾剁磼鐎ｎ偄娴柡浣割儐缁绘稓锟界數顭堝瓭闂佸湱鈷堥崑濠囧灳閺冨牆绀冩い鏂挎瑜旈弻娑㈠焺閸愵亝鍣у銈庡�ら崨顖滐紲闂佺粯鍔﹂崜姘辨閼碱剛纾煎璺猴功缁夋椽鏌ｅ☉鍗炴珝鐎规洖宕埥澶婎潨閿熶粙宕崼鏇熲拺闂傚牊渚楀褍鈹戦垾铏枠鐎规洏鍨介獮姗�宕滄担鐚寸闯闂備胶顭堥張顒勬偡瑜斿畷婵嗩吋婢跺鐝旈柡澶婄墑閸斿﹥绂嶅鍫熺厪濠㈣泛鐗嗛崝銈咁熆瑜嬮崹浠嬪蓟閵娾晜鍋勯悹鍥ㄧ暙閹炬番浜滈柡鍐挎嫹闁绘濮撮悾鐑藉级鐠囩偓妫冨畷銊╊敇閻欙拷閸炲爼姊绘担绛嬫綈闁稿海鍘ц灋闁告洦鍘炬稉宥夋煛瀹ュ啫濡跨紒鐘荤畺閺屾盯鍩勯崗鈺傚灩娴滄悂顢橀姀锛勫幗濡炪倖鎸鹃崳銉モ枔閺冿拷閵囧嫰顢橀埄鍐�婇梺鍦嚀鐎氼厾绮悢纰辨晬婵﹩鍓欓ˉ搴♀攽閿涘嫬浜奸柛濠冪墪椤繘鎮烽幏鏃�鐩畷姗�鈥﹂幋鐐电▉濠电姷鏁告慨鐢告嚌閸撗冾棜闁稿繗鍋愮粻楣冩煕閳╁厾顏堟倶閵夈儮鏀介柍銉ㄥ皺閻瑦鎱ㄦ繝鍌涙儓閻撱倝鎮规担鍝ワ紞闁烩晛娴风槐鎾诲磼濮樻瘷銏ゆ煥閺囨ê锟芥繈骞冮幆褏鏆嬮柟浣冩珪閺傦拷闂備胶纭堕崜婵嬫偡閿曪拷閳绘捇寮撮姀鈾�鎷洪梺鍛婄☉閿曘儲寰勯崟顖涚厱閻庯綆浜濋崳褰掑础鏉堛劊浜滈柟鐑樺灥椤忣亪鏌嶉柨瀣伌闁哄本绋戦埞鎴﹀幢濡ゅ﹣绱濇繝纰樺墲瑜板啰绱炴繝鍥ц摕闁挎繂鎳夊Σ鍫熺箾閸℃绠冲ù鐓庤嫰閳规垿顢欑涵宄颁紣濡炪値鍘奸崲鏌ユ偩閻戣棄绠抽柟瀛樻⒐閻庡姊洪悷鎵憼缂佽鍊块垾鏍ㄥ緞閹邦厸鎷洪柣鐘叉搐瀵爼骞戦敐澶嬬厽闁绘梻顭堥埢鏇狅拷瑙勬磸閸旀垿銆佸☉姗嗙叆闁告侗鍘肩粻姘舵⒒閸屾艾锟界兘鎳楅崼鏇橈拷浣圭節閸パ咁唽濡炪倕绻愬Λ娑欑▔瀹ュ鐓欓悗鐢殿焾椤庢捇鏌熷畡鏉挎Щ妞ゎ偅绻堥、妤佸緞鐎ｆ挆鍥ㄢ拺闂傚牊绋掗幖鎰版倵濮橆偄宓嗛柣娑卞櫍楠炴帒螖閿熺晫绮婚敐鍡欑瘈闁割煈鍋勬慨鍐煙椤曞棛绉慨濠勭帛閹峰懘宕ㄦ繝鍐ㄥ壍闂佽瀛╅崫搴ㄥ礉閹存繄鏆﹂柡鍥ュ灪閸嬨劎绱掔�ｎ厼鍔甸柟鑺ユ礀閳规垿鎮欓弶鎴犱桓闁艰￥鍊栨穱濠囧箵閹烘柨鈪甸梺鍝勬湰缁嬫垼鐏冮梺鍛婂姂閸斿骞嬮柨瀣閻庣數顭堥宀勬煕濞嗗繐鏆ｇ�殿喖顭烽弫鎰板醇閵忋垺婢戦梻浣筋潐瀹曟ê鐣烽棃娑氭殾妞ゅ繐鐗婇埛鎴︽煟閻斿憡绶叉繛鍫氭櫊閺岀喖宕欓妶鍡楊伓?
		if (share.npctype == 16) {
			fire.pb.instancezone.Module.visitNpc(roleid, npckey, share);
			return;
		}
		//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閳╁啯鐝栭梻浣芥硶閸犲秶鍒掑▎鎾崇畺闁秆勵殢閺佸鏌ㄩ悢鍓佺煓鐎殿喖顭峰鎾偄閾忚鍟庨梻浣虹帛閸旓箓宕滃鑸靛仧闁哄啫鍊荤壕濂告煟閹伴潧澧柛鏂诲�栫换娑氫焊閺嶅灚瀚归柟棰佺劍缂嶅骸鈹戦悙鍙夆枙濞存粌鐖煎顐﹀幢濞戞瑧鍙嗛梺缁樻⒒閸庛倕鈻嶉弴鐘电＜妞ゆ棁濮らˉ鍫ユ煙椤旂偓娅曠紒顔界懅閹瑰嫰鈥﹂幒鏂胯�垮┑鐘垫暩婵即宕规總绋挎槬闁哄稁鍘肩粈澶愭煛瀹ュ骸骞楅柛瀣�块弻锟犲炊閳轰焦鐎繛瀛樼矋缁捇寮婚悢鐓庣骇闁割煈鍣弳銏㈢磽娴ｅ壊鍎撶�规洜鏁稿Σ鎰板箳濡や焦娅㈡繛瀵稿Т椤戝棝寮查幖浣圭厽闁挎繂鎳愰悘杈╃棯閹规劖顥夐柕鍡樺笒椤繈顢楁繝鍐╂毎闂佽瀛╅懝鍓х礊婵犲偆娼栨繛宸簻缁�鍫ユ煙缂佹ê绗傜紒銊ょ矙濮婃椽宕妷銉愩垺淇婇锝囨噮缂侇喖顑呴濂稿椽娴ｅ搫寮抽梻浣稿閸嬪棝宕伴幘璇插偍闁归棿鐒﹂崐鍨殽閻愯尙浠㈤柛鏃�宀搁弻娑㈡偆娴ｉ晲绨兼繛锝呮搐閿曨亜鐣风粙璇炬梹鎷呴崫鍕瑲闂傚倷绀侀幉锟犳偡閿濆纾跨�规洖娲ㄩ悳濠氭煛閸愩劎澧涢柣鎾寸〒閿熺晫娅㈤幏鐑芥煥閻斿墎鐭欑�规洑鍗冲浠嬵敇閻愮數鏆繝鐢靛Т閿曘倝鎮ч崱娆戜笉闁挎繂顦伴悡娆撴煟閹寸倖鎴犱焊椤撱垺鐓涢悗锝冨妼閿熻姤绻傞～蹇曠磼濡顎撻梺鍛婄☉閿曘儵宕曢幘缁樷拺婵炶尪顕ч獮鏍ㄣ亜閿曪拷瀹曨剟顢氶妷锔剧瘈闁告劦浜跺ù鍕煟鎼搭垳绉靛ù婊呭仱瀹曘垽骞橀瑙ｆ嫼闂佸憡绋戦敃銈嗘叏閿曞倹鐓曢柣妯诲墯濞堟粎锟借娲橀崝娆撳蓟閵娧嶆嫹閿濆啫濡虹紒銊ヮ煼濮婃椽鎮烽悧鍫熷創缂備礁顦遍崗妯虹暦濡わ拷閻ｆ繈鏁撴禒瀣疅闁归棿绀佺痪褔鏌熺粙鍨槰婵☆偁鍊楃槐鎾存媴娴犲鎽甸梺鍦焾椤兘鐛箛娑樺窛妞ゆ柨鎼禍浼存⒑閸︻収鐒鹃悗鍨浮閺佹捇鎳為妷顔界杹濠殿喖锕ュ钘夌暦閵婏妇绠鹃柟鐑樼箑闁垰鈹戦垾宕囧煟妤犵偞鐗楅幏鍛村传閵壯勬瘒闂傚倷绶氬褔藝椤愶箑鐤炬繝濠傜墕绾惧鏌涘畝锟介崑娑氱不瑜版帒绾ч柛顐ｇ箓閳锋梻绱掔�ｎ剛甯涚紒缁樼洴瀹曞ジ鎮㈠畡鏉啃戦梻浣哥枃椤宕归崸妞硷拷浣糕枎閹寸娀鈹忛柣搴秵閸嬫帡宕ラ崨瀛樷拻濞达絽鎲＄拹锟犳煕韫囨棑鑰块挊鐔兼煙閸撗呭笡闁哄懏鎮傞弻娑欑節閸曨偅鐝″┑鐐插悑閸旀牜鎹㈠☉銏犵闁圭儤姊婚鎺楁倵鐟欏嫭绀冪紒璇茬墦閻涱喚锟斤綆鍠楅弲婊堟煟濮橆剛鎽犻悗姘辨嚀闇夐柨婵嗘川閵嗗﹥淇婇幓鎺斿濞ｅ洤锕、娑㈡倷鐎涙ɑ娈告俊鐐�ら崑鍕矓閹绢喖鐓橀柟杈惧瘜閺佸﹪鏌￠崒妯猴拷鎾舵閻㈠憡鈷戦柛娑樷檨閼测晛鍨濇繛鍡樻尪閿熸垝绀侀埢搴ょ疀閿濆懏顓垮┑鐘绘涧椤﹂亶鎮甸敓锟�
		if (share.npctype == 17) {
			fire.pb.mission.instance.InstanceManager.visitNpc(roleid, npckey, share);
			return;
		}
		//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闂囧鏌ㄥ┑鍡╂Ч濞存嚎鍊濋弻銈夊级閹稿骸浠村┑顔硷攻濡炰粙銆佸Δ鍛櫢闁伙絽鐬奸惌鎾绘倵闂堟稒鎲稿☉鎾崇Ч閺岋絽螣閼测晛绗￠梺缁樻尰閻熲晠寮婚悢纰辨晬闁糕剝顨呴弳鐐淬亜閺冿拷閸ㄥ灝顫忓ú顏勭闁绘劖褰冩慨鍫曟⒑閸涘﹥灏扮�癸拷缁嬭法鏆﹂柟杈剧畱鎯熼梺鍐叉惈閸婂宕㈤柆宥嗏拺閻熸瑥瀚崝銈夋煕閻旂粯纭堕柣銉海椤﹀綊鏌″畝瀣瘈鐎规洏鍔戦、娑橆潩椤愩倖宕熼梻鍌欑閻ゅ洭锝炴径鎰瀭闁割偅娲滃畵浣糕攽閻樺弶澶勯柣鎾存礀閳规垿鎮╅幓鎺撴閻庤娲栭惌鍌炲蓟閻斿吋鎯炴い鎰靛亝閻や線鎮楃憴鍕闁靛牏顭堥锝夊级閹搭厽寤洪梺鍓插亞閸犲酣顢旈崼鏇熲拺闁告稑锕﹂埥澶愭煟鎺抽崝鎴濈暦閹邦厾绡�婵﹩鍘鹃崢楣冩⒑鐠団�冲箺閻㈩垱甯″畷婵嗩潩椤戠偛缍婇幃顏堟晸娴犲鍨傞悹杞拌濞兼牗绻涘顔荤盎缂佺姴缍婇弻锝夊箛椤撶偟绁锋繝娈垮枛閻倸顫忓ú顏勫窛濠电姴鍟伴崣鍡涙⒑濞茶澧伴柛妯犲浂鏁嬮柕澶涘缁★拷闂佸憡娲﹂崢楣冩晬濠婂啠鏀介柍钘夋閻忥箓鏌￠崨鏉跨毢闁奸缚浜幏鐘差啅椤旇棄鐦滈梻渚�娼ч悧鍡椢涘Δ浣瑰弿濠㈣泛艌閺�鑺ャ亜閺冨洤袚閻忓骏绠撻弻鈩冩媴鐟欏嫬纾抽梺鐟扮－閸嬨倖淇婇悿顖ｆЬ闂佹眹鍊曠�氫即骞冨Δ锟介埢鎾诲垂椤旂晫浜俊鐐�ら崢楣冨礂濡警鍤曟い鎰剁畱缁犳盯鏌℃径濠勪虎缂佹劖绋戦—鍐Χ閸涱垳顔囬梺鐟板暱缁绘ê顕ｉ搹顐ょ瘈闁搞儯鍔夐幏缁樼箾鏉堝墽绉繛鍜冪悼閺侇喖鈽夐姀锛勫幈闂佸搫鍟幐楣冩偩閻㈢鎷风憴鍕缂侇喖鐭傞敐鐐测攽鐎ｎ偄娈濋梻鍌氱墛缁嬫劙骞嬮悜鑺モ拻濞达絽鎲￠幆鍫熺箾鐏炲倸濡介柟渚垮妽椤︾増鎯旈埥鍡橆棥闂備礁鍚嬬粊鎾疾濠靛牆顥氶柦妯侯棦瑜版帗鏅插璺侯儐闁款參姊虹拠鑼畾闁哄懏绮撻妴鍐Ψ閳哄倸锟界兘鎮楅悽娈跨劸闁冲嘲鐭傚娲传閸曨厾鍔圭紓鍌氱С缁�渚�顢氶敐鍡欘浄閻庯絽鐏氶弲婵嬫⒑闂堟稓绠冲┑顔肩－閸掓帡顢涢悙绮规嫽婵炶揪缍侀ˉ鎾寸▔閼碱剛纾奸棅顐幘閻瑧锟借娲橀悡鈥愁嚕婵犳艾唯妞ゆ牗绮庨埣銈嗙節閻㈤潧孝闁挎洏鍊濋幃褎绻濋崶褏鏌ч梺褰掓？閻掞箓鎮￠姀鈥茬箚妞ゆ牗鐟ㄩ鐔镐繆閸欏銇濋柡宀嬬節瀹曢亶顢橀悩鍨闂備礁鎼張顒�煤濡吋宕叉繛鎴欏灪閸婇攱銇勯幒宥堝厡鐟滄壆鍠栧缁樻媴閼恒儯锟藉啰绱掗敓鑺ユ媴閾忓湱鐓嬮梺姹囧灩閻忔艾鐣烽崣澶岀闁瑰瓨鐟ラ悘鈺冪磼閻欏懐绉柡宀嬬秮楠炲洭顢樿閺呴亶姊洪崫鍕棏闁跨喕濮ら弸濂稿绩娴犲鐓熼柟閭﹀灠閻ㄥ搫顭胯閸ㄤ粙寮婚敐鍛斀闁割偆鍠撻濉�
		if (share.npctype == 28) {
			if (mkdb.Transaction.current() != null) {
				new fire.pb.circletask.catchit.PSendCatchItNpcService(share.getId(), npckey, roleid).call();
			}
			else {
				new fire.pb.circletask.catchit.PSendCatchItNpcService(share.getId(), npckey, roleid).submit();
			}
			return;
		}
		
		//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鐐劤椤兘寮婚敐澶婄疀妞ゆ帊鐒﹂崕鎾绘⒑閸濆嫬顏ラ柛搴ㄤ憾閸╃偤骞嬮敂钘変汗闂佸憡鐟ラˇ浼村箖濞嗘垹纾藉ù锝呮惈椤庡矂鏌涢妸銉у煟鐎殿喖顭锋俊鎼佸煛閸屾矮绨介梻浣侯焾閺堫剛绮欓幋锔绘晜闁跨噦鎷�?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊箣閿濆棭妫勯梺鍝勵儎缁舵岸寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閹冣挃缂侇噮鍨抽幑銏犫槈閵忕姷顓洪梺缁樺灥濡盯宕濋姘ｆ斀闁绘劖娼欓悘锔姐亜椤撶偞鍠樼�殿喗濞婂畷鍗炩槈濞嗘垵骞堥梻浣告惈濞层垽宕濈仦鍓ь洸闁绘劖鐣禍婊堟煥閺冨浂鍤欑�殿噮鍠楅幈銊︾節閸涱噮浠╅梺鍦嚀鐎氱増淇婇幖浣肝ㄩ柨鏃�鍎崇紞鎺楁⒒閸屾瑨鍏岄柟铏崌瀹曠敻寮介鐐殿唵闂佽法鍣﹂幏锟�?闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊瑜忛弳锕傛煟閵忋埄鐒剧紒鎰殜閺岀喖鏌囬敃锟介弸娑㈡煕閵婏妇绠橀柨鐔烘櫕濞呫垽骞忛悜鑺ョ叆闁绘梻鍎ゅ▍鏇㈡煕閹烘挸娴�殿噮鍣ｅ畷濂告偄閾氬倻绱﹂梻鍌欑劍閻綊宕归挊澶樼劷鐟滃秹鎮鹃悜钘壩ㄩ柍鍝勫�甸幏铏圭磽閸屾瑧鍔嶉拑閬嶆煃闁垮娴柡灞剧☉铻ｉ柣妯哄级婢跺嫰鏌涙繝鍌氭Щ闁宠鍨块幃鈺呭箵閹烘挻顓惧┑鐐茬摠缁秶鍒掗幘璇茶摕闁绘柨鍚嬮幆鐐烘煟閻旂⒈鏆掓繛宀婁邯閺岋絾鎯旈姀锝咁棟缂傚倸绉撮敃顏勵嚕婵犳碍鏅查柛鈩兠崝鍛存⒑闂堟盯鐛滅紒韫矙钘熸繝闈涙－濞撳鏌曢崼婵堢缂佸彉鍗抽弻娑樜旈崟顒傚涧婵烇絽娲ら敃顏堝箖閻ｅ瞼鐭欓悹渚厛濡茶淇婇悙顏勶拷鏍偋濡わ拷椤繈濡搁埡濠冩櫓婵犵數濮村ú锕傚煕閹达附鐓熼柣鏃傤焾椤ュ鏌熼悾灞叫ョ紒杈ㄥ笧缁辨帒螣閸濆嫷娼氭俊銈囧Х閸嬫稓鎹㈠锟介獮鍐煥閸喎鐧勬繝銏ｆ硾椤﹂亶鎮欐繝鍥ㄢ拻濞撴熬鎷锋繛浣冲毝銊╂晸閻ｅ瞼纾奸柣妯哄暱閻忓瓨銇勯姀鈩冾棃妤犵偞鐗楅幏鍛村礂婢跺顏圭紓鍌氬�搁崐鐑芥倿閿曚焦鎳岄梻浣虹帛閹稿爼宕曢悽绋胯摕闁绘柨鍚嬮崵宥夋煏婢诡垰鎳愰崢鎺旂磽閸屾瑧璐伴柛鐘崇墵閳ワ箓鎮滈悾灞界ウ闂佺硶鍓濋崙鐟邦瀶閵娾晜鈷戠紓浣股戦悡銉︿繆椤愶絿绠炴鐐插暟閹叉挳宕熼锟介～锟犳⒑閻熸澘妲婚柣顓炵墦瀹曟繈宕ㄧ�涙ǚ鎷虹紓浣割儏閻忔繈顢楅姀銈嗙厱闁哄喛鎷锋い銊ョ墕鍗遍柟鐗堟緲缁犺櫕淇婇妶鍕妽婵炲懌鍨虹换娑氾拷鐢殿焾瀛濆銈嗗灥濡繂顕ｉ懠顒傜煓婵☆偊娼х紞濠囧箖閳轰緡鍟呮い鏃傚帶婢瑰姊绘担鐟扳枙闁猴拷闁秴鍨傞柛褎顨呴拑鐔哥箾閹寸們姘跺绩娴犲鐓曢柡鍥ュ妼娴滄粌鈹戦鐓庮劉缂佺粯绋撻敓鐣屾暩椤牓顢撻幘鍓佺＜闁绘娅曞畷宀�锟芥鍠栭…鐑藉箖閵忋倖鍋傞幖杈剧磿閻涒晛鈹戦悩鍨毄濠殿喗鎸冲畷鎰版偨缁嬪灝鍤戝┑鐐叉缁箖寮崼鐔蜂汗闂傚倸鐗婄粙鎰垝鐠鸿　鏀介柍钘夋娴滄繄绱掔拠鎻掞拷鍧楀箖閹呮殝闂侇叏闄勫娲⒑鐠恒劌鏋嶇紒顔界懇婵″瓨鎷呯化鏇熺�婚梺鍦亾濞兼瑥鈻撻幇鐗堚拺闁告劕寮堕幆鍫ユ煥閺囨ê鍔氶柣鈽嗗幘缁辨捇宕掑顒婃嫹閹间礁纾归柟闂寸绾惧湱锟界懓瀚伴崑濠傘�掓繝姘厵闁绘垶蓱閳锋帡鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚泛鈹戦悩娈挎毌闁跨喕妫勭壕顓㈠春閿濆鐓涘ù锝堫潐瀹曞矂鏌℃担瑙勫磳闁轰焦鎹囬弫鎾绘晸閿燂拷
		if (fire.pb.mission.instance.line.LineInstManager.getInstance().checkLineNpc(share.getId())) {
			fire.pb.mission.instance.line.LineInstManager.visitNpc(roleid, npckey, share);
			return;
		}
		// added by cn
		// 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閳╁啯鐝曢梻浣藉Г閿氭い锔诲枤缁辨棃寮撮姀鈾�鎷绘繛杈剧秬濞咃綁濡存繝鍥ㄧ厱闁规儳顕粻鐐烘煙閽樺锟藉鏁撻弬銈囩У闁哥姵鐗犻幃娆愮節閸愶缚绨婚梺纭呮閸嬬偟锟芥艾婀辩槐鎺旂磼閵忕姴浼庨梺褰掝棑閸忔ê顫忕紒妯诲闁惧繒鎳撶粭锟犳⒑閸涘﹥鐓ョ紒缁樏锝夊箵閹烘繄鍙嗛梺鍓插亞閸犲酣鏁撻崐鐔哥【闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖绻濆▓鍨灈闁挎洏鍎遍—鍐╃鐎ｎ亞鐣洪梺缁樺灱婵倝鎮炴禒瀣叆闁哄浂浜濈�氱懓鈹戦悙鑼闁绘牜鍘ч～蹇涙惞閸︻厾鐓撳┑鐐叉閸庢娊宕滈幎鑺モ拺闁告縿鍎辨牎闂佺粯顨堟慨鍨┍婵犲洤绠绘い鏃傚帶缁愭盯鏌ｆ惔銏⑩檨闁挎岸鏌ㄩ悢缁橆棄妞ゎ厾鍏樺濠氬Χ婢跺﹦鐣抽梺鍦劋閸ㄥ灚鎱ㄦ惔銏㈢閻庣數顭堥宀勬煕閵娿劍纭炬い顐㈢箰鐓ゆい蹇撳椤旀劙姊虹紒妯哄鐟滄澘鍟幈銊ョ暆閸曨兘鎷洪梺鍛婄☉閿曘儵鎮￠妷鈺傜厽妞ゆ帒鍊哥敮鑸点亜閺囨ê鍔滅紒缁樼箞瀹曠喖顢橀悪鍛簥濠电姷顣藉Σ鍛村垂閸洖鐤鹃柤纰卞墲婵娊鎮归崶褎鈻曟繛鎾愁煼閺屾洟宕煎┑鍥舵婵犳鍠栭ˇ顖炲煘閹达富鏁婇柤鎭掑劚閸炲姊烘潪鎵妽闁圭懓娲獮濠囨倷閸濆嫀銊╂煥閺冨倽妾告俊鎻掔秺濮婄粯鎷呴搹骞匡拷濠囨煛閸屾艾锟藉灝鐣烽弴銏犵闁圭儤绻傚▓顐︽⒑閸涘﹥澶勯柛銊﹀缁鈽夊▎宥勭盎闂佽宕樺▔娑㈠几閹寸偑浜滈煫鍥ㄦ礀閺嬫稒鎱ㄦ繝鍕笡闁瑰嘲鎳橀幊鐐哄Ψ瑜嬮敓钘夛躬濮婃椽妫冮埡鍐ょ紓浣哄У閹瑰洭鎮伴璺ㄧ杸婵炴垶鐟﹀▍銏ゆ⒑鐠恒劌娅愰柟鍑ゆ嫹?,闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴楠炴﹢鎳犻澶嬓滈梻浣规偠閸斿秶鎹㈤崘顔嘉﹂柛鏇ㄥ灠閸愶拷闂侀潧臎娓氬﹥瀚归柟鐑橆殕閻撶喐绻濋棃娑欘棤闁糕晪缍侀弻鈥崇暆鐎ｎ剛鐦堥悗瑙勬礀閻栧吋淇婇悜钘壩ㄧ憸宀勫箖閿濆鈷掑ù锝呮贡濠�浠嬫煕婵犲喚娈滅�规洘鍨块獮姗�鎳滈棃娑樼哎婵犵數鍋為崹顖炲垂閸︻厾涓嶉柨婵嗘缁犻箖鏌涢埄鍐炬畼缂佺姵濞婇弻娑㈠籍閿熶粙骞愰崘宸綎闁绘垶蓱婵粓鏌熷▓鍨珮婵″樊鍣ｅ娲箰鎼淬垻鈹涚紓浣哄У閹瑰洤顕ｉ锕�绠荤紓浣姑惂鍕節閵忥絾纭鹃柣顒�銈稿鍐测槈閵忊檧鎷虹紓浣割儏濞硷繝宕ｉ崟顐�鐟邦煥閸曨偄濮稿┑鈽嗗亞閸犲酣鈥旈崘顔嘉ч柛鈩冪懃閳峰牓姊虹粙娆惧剳闁稿鍊曢悾鐑藉即閻愬秵姊归幏鍛槹鎼达絿鏆伴梻鍌欑窔濞佳囨偋閸℃瑱鎷峰顓熺凡妞ゎ剙锕ら悾锟犲箠婵犲嫭鍤�妞ゎ厹鍔戝畷鐔碱敇閻橀潧甯ㄩ梻鍌欑閹碱偅寰勯崶顒佹櫢闁兼亽鍎辨晶顖炴煕濮橆剦鍎旈柡灞剧洴楠炲洭鍩℃担鍓茬�虫俊鐐�ら崜娆擃敄閸モ晜顫曢柟鎯х摠婵挳鏌涘┑鍡楃彅闁挎繂顦伴悡娆撴煟閻斿搫顣奸柛鐘愁焽閿熻姤顔栭崰娑㈩敋瑜旈崺銉﹀緞婵炪垻鍠庨…銊╁川椤撶喓浜栫紓鍌欐祰妞村摜鏁幒鏇犱航闂備礁鎲＄换鍌滐拷姘煎弮瀵偊顢旈崼鐔叉嫽闂佺鏈悷褔藝閿曞倹鐓欑痪鏉垮船娴滄繄锟藉灚婢樼�氭澘鐣烽崼鏇ㄦ晢濞达綀顫夐鐔兼⒒娴ｇ鎮戝ù婊�绮欏畷鏇熸綇閵婏附鐝峰銈嗙墱閸嬬偤鎮￠弴鐔稿弿婵妫楁晶濠氭煕鎼淬垺顥堥柡宀嬬磿娴狅箓宕滆閸掓稑顪冮妶鍐ㄧ仾婵炶尙鍠栭妴渚�寮撮～顔剧◤濡炪倖鎸炬慨鎾吹椤掑倻纾介柛灞捐壘閿熻姤鎮傚畷鎰板传閵壯呯厠闂佸湱铏庨崰妤呭磻鐎ｎ喗鐓曢柍鈺佸暟閳藉鏌ｉ幘杈捐�块柡宀�鍠愬蹇斻偅閸愨晩锟藉秹姊虹粙娆惧剱闁搞劌娼″璇测槈濡攱顫嶉梺鍛婎殘閸嬬偤鎮橀崼婵愭富闁靛牆鎳愮粻浼存煟閺嶎偄甯舵い顐㈢箳缁辨帒螣鐠囧樊锟芥捇姊洪崨濠勨槈闁挎洏鍎靛畷鏇㈠箻閹颁焦瀵岄梺闈涚墕缁绘劙鎯佸鍫熺厱闁靛绠戦埢鏇㈡煙瀹曞洤浠遍柡灞芥椤撳ジ宕卞▎蹇撔﹂梺璇查缁犲秹宕曢柆宥呯疇闁规崘顕х粻娲煛閸ャ儱鐏柍閿嬪灴閺岀喓绮欓崹顕呭妷缂備緤鎷烽柨鐔剁矙濮婅櫣绮欓崠鈥充紣缂傚倸绉撮敃顏堢嵁閸愵喗鏅搁柣妯垮皺椤︺劌顪冮妶鍡樷拻闁哄拋鍋婂畷銏ゅ箻缂佹鍘告繝銏ｆ硾閼活垱绂掗敃锟介…鍧楁偡閻楀牜妫﹂柦妯荤箞閺屻劑寮撮悙璇ф嫹瑜版帗鍋傛繛鎴欏灪閻撴洟鏌嶉埡浣告殶闁瑰啿鍟湁闁绘ɑ鐟ラ幊鎰婵傜绾ч柛顐ｇ☉婵″吋绻涢幖顓炴珝闁哄瞼鍠栭、娆戞喆閸曨剛褰嬮柣搴ゎ潐濞叉﹢鏁冮姀鐘垫殾闁挎繂妫楃欢鐐哄箹鏉堝墽绋绘い搴℃喘濮婂宕掑顒婃嫹瀹勬噴褰掑炊椤掑鏅梺鍝勭▉閸樿偐绮ｅΔ浣虹闁规惌鍘界欢娑氱磽瀹ュ棛澧い顓炴健閹虫粓妫冨☉姗嗘綋缂傚倷鑳舵刊顓㈠垂閸洖钃熸繛鎴炃氬Σ鍫熺箾閸℃ê濮夌紒瀣喘閹鎮烽悧鍫濇殘缂備浇顕ч崐鍧楀春閻愬搫绠ｉ柨鏃囨娴滃綊姊洪崷顓犲笡閻㈩垼浜獮蹇撶暋閹殿喗娈濋梺鐟扮仛鐢帡鏌婇敐澶堬拷浣糕枎閹炬潙浠奸悗鐧告嫹闁跨喍绮欓幆渚�宕奸姀銏紲闂佸憡鎸嗛崘鐐瘔闂佽棄鍟虫ご鎼佸Φ閸曨垼鏁冩い顐枦閸氼偊姊洪崫鍕拱缂佸鎹囬弫鎾诲棘閵堝洨校婵炲瓨绮嶇换鍫ｆ＂闂侀潧绻堥崐鏍偂閵夛妇绡�闂傚牊绋撴晶鏇灻归悩杞板惈闁跨喕濮ら鏍窗濡や胶鐝堕柛鈩冪懅绾句粙鏌熼崜褏甯涢柛濠勫厴閺岋綁骞嬮悙鍐╁哺楠炲繑绻濆顓涙嫼缂備礁顑嗙�笛冿耿娴煎瓨鐓熼柣鏃�绻傚ú銈囩矆婢跺矉鎷烽獮鍨姎妞わ缚鍗抽幃锟犳偄閹肩偘绨婚棅顐㈡处閹告悂顢旈銈囩＜濠㈣泛瀛╅鐘绘煥閻斿嚖鎷烽悤浣圭秷濠电偛寮堕…鍥箲閵忋倕纾奸柣鎰綑娴犵厧鈹戦悩缁樻锭妞ゆ垵妫濆鑼矙濡潧缍婇幃鈺侇啅椤旂厧澹夐梻浣告惈閹冲繘骞冮崒鐐茶摕闁靛牆顦粻鎺楁煙閻戞ê鐏ュ┑顔奸叄濮婃椽骞栭悙璇ф嫹閵堝绀堥柣鏃傚帶閽冪喐绻涢幋娆忕仼閹喖姊洪棃娑崇础鐎广儱娲ㄩˇ顖炴⒒閸屾瑧顦﹂柟璇х磿閺侇喖螖閸愨晜娈板┑掳鍊曢崯顖氱暦閸欏绡�闂傚牊渚楅崕蹇涙煟閹邦剨韬柡灞诲�楃划娆戞崉閵娿倗椹虫繝鐢靛仜閹冲骸煤椤撶儐娼栫紓浣股戞刊鎾煟閻旂厧浜伴柛銈咁儏閳规垿鎮欑�垫悶鍋為梺鍝勬噽婵烇拷闁绘侗鍠涚粻娑樷槈濞嗗骏鎷锋繝姘厾闁诡厽甯掗崝銈夋煕濮楋拷娴滆泛顫忛搹瑙勫枂闁告洦鍋掗敓鑺ョ矒閺屾盯鍩￠崒婊冣拡闂佽法鍠曟慨銈夋偄椤掑嫬绠柨鐕傛嫹?,闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴椤㈡洟鏁愰崱娆樻К缂備胶鍋撻崕鍐差焽閿熺姴钃熼柨婵嗩槸椤懘鏌曡箛濠冩珖闁告梹鎮傚鍝勑ч崶褝鎷峰Δ鍛；闁规崘鍩栧畷鍙夌箾閹存瑥鐏╃紒鐙呯稻缁绘盯宕卞Δ鍐唺婵炲濞�缁犳牕顫忛搹鍦煓婵炲棙鍎抽崜顓㈡⒑缁嬪尅鏀荤紒璇茬墕椤曪絾绻濆顒�宓嗛梺缁樻濞咃綁顢欓弴銏″仭婵犲﹤鍟拌倴闂佽法鍠曟慨銈夊礄瑜版帒鍌ㄥ┑鍌滎焾閻撴繈鏌熼悙顒佺稇妞ゆ洟浜堕幃妤�鈽夊▎妯煎姺闂佸憡眉缁瑩寮婚悢鐓庣闁兼祴鏅滃▓顒勬⒑閹肩偛濡兼い顓犲厴瀹曟椽鏁傞悾宀�鎳濋梺璺ㄥ枍缁瑩鐛箛娑樼闁挎洩鎷风痪顓ㄦ嫹闂備浇顕х换妤�鐣烽悽绋跨疇闁规崘顕ч悡姗�鏌涢幇闈涙灈闁搞劌鍊归妵鍕即閻愭惌妫￠柣搴亢椤鎹㈠┑瀣棃婵炴垵宕崜浼存⒑閽樺鏆熼柛鐘崇墵瀵濡搁埡鍌氫簻闂佸憡绻傜�氬懘濮�閵忋垺锛忛梺璇″瀻閸愨晛锟筋垳绱撴担铏瑰笡闁烩晩鍨堕悰顔撅拷锝庡枟閸婂鏌涢妷顖氼洭閺夆晜妫冨缁樻媴鐟欏嫬浠╅梺绋匡攻濞茬喖銆侀弽顓炵倞闁冲搫鍋嗗鐔兼⒑鐟欏嫬鍔ゆい鏇ㄥ弮閹兘鎮烽幍铏杸闂佺粯蓱瑜板啴寮冲▎鎰╀簻闊洦鎸鹃崺锝嗘叏婵犲嫮甯涢柟宄版嚇閹崇偤濡疯閿熻棄锕娲传閵夈儛銏㈢磼婢跺﹦鍩ｇ�规洘宀搁獮鎺楀箣閺冿拷閻庡妫呴銏＄カ缂佹彃澧界槐鐐存償閳撅拷閺�浠嬫煟閹邦剙绾ч柍缁樻礀闇夋繝濠傚閻帗顨ラ悙鏉戠伌闁硅櫕绮撻幃娆撴焻濞戞氨娉块梻鍌欐祰椤鐣峰Ο琛℃灃婵炴垶顭囬幗銉х磽閸屾艾锟界兘鎮為敃鍌橈拷鍐箛椤旇棄搴婂┑鐘绘涧濡厼顭囬弽銊х鐎瑰壊鍠曠花鑽わ拷鐟版啞缁诲倿鍩為幋锔藉亹闁圭粯甯楀▓婊堟⒑瑜版帩妫戦柟铏崌閳ユ棃宕橀鍢壯囨煕閹扳晛濡兼い顒�鐗撳娲箰鎼淬垻锛橀梺绋挎唉鐏忔瑧鍒掑顓熺秶闁靛ě鍛闂備焦鎮堕崕娲偂閸惊娑㈠礃閵娿垺鏂�闂佺粯鍔栧娆撴倶閸楃儐娓婚悗娑櫳戦崐鎰拷瑙勬礃閹瑰洤螞閸愩劉妲堥弶鍫涘妼閻︽粓姊绘笟锟藉褔鎮ч崱妞㈡稑鈻庨幋婊呭墾闂傚倸鐗婄粙鍫ュ绩閼恒儯浜滈柡鍥╁仦閸ｅ湱锟芥鍣崰姘舵晸閼恒儺鍟忛柛鐘虫崌瀹曟繈骞嬮敂鎯хウ闁瑰吋鐣崝宥夊吹瀹ュ鐓忓璺虹墕閻忣亪鎮楀顑惧仮婵﹦绮幏鍛村川婵犲啫鍓甸梻浣侯焾閿曘倝鎮ラ悡搴ｆ殾闁哄洢鍨圭粻鐢告煙閸濆嫭顥為柣搴㈡そ濮婃椽宕ㄦ繝鍕ㄦ闂佸鏉垮闁诡噯绻濆鎾閿涘嫬骞楅梻浣告惈閸婃悂鎮樺┑鍫㈡／鐟滃海鎹㈠☉銏犲窛妞ゆ挾鍠庨ˇ鈺傜箾閿濆懏鎼愰柨鏇ㄤ簻閻ｇ兘鏁愰崱妤冪獮婵犵數濮撮崑鍡楊焽濮樿埖鈷掑ù锝堝Г閵嗗啴鏌ｉ幒鐐电暤妤犵偞鍨垮畷鍫曨敆閿熶粙寮告笟锟介弻鐔煎礈瑜忕敮娑㈡煛閸涱喗鍊愰柡灞诲姂閹倝宕掑☉姗嗕紦,婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鐐劤椤兘寮婚敐澶婄疀妞ゆ帊鐒﹂崕鎾绘⒑閹肩偛濡奸柛濠傛健瀵鈽夐姀鈺傛櫇闂佹寧绻傚Λ娑⑺囬妷褏纾藉ù锝呮惈灏忛梺鍛婎殕婵炲﹤顕ｇ拠娴嬫婵☆垶鏀遍弬锟介梻浣告啞濞诧箓宕戦崟顒佸弿闁靛繈鍊栭埛鎴炵箾閼奸鍤欐鐐搭殜閺岀喖鎮烽悧鍫濇灎閻庢鍠栭…鐑藉极閹邦厼绶為悗锝庝簷缁ㄥ姊洪懡銈呅㈡繛娴嬫櫇娴滅鈻庨幘宕囶槷闂佺粯鍨兼慨銈夊煕閹达附鍋ｉ柟顓熷笒婵″ジ鏌＄�ｎ偆鎳冮柍瑙勫灴椤㈡瑩宕崟鑸靛婵°倕鎳庨弸浣广亜閺囶亝瀚归梺鎼炲妽閸庢娊鎮鹃悜钘夌倞闁靛瀵岄崯搴♀攽閻樺灚鏆╁┑顔芥尦閺佸啴濡堕崶閿嬪婵鍘ч獮妤呮煕閹烘埊韬鐐达耿椤㈡瑩鎮剧仦钘夌闂傚倷鑳剁划顖炲蓟閵娾晛绠规い鎰惰礋閿熻棄鍊垮畷妤呭礂閻撳骸浼庨梻浣瑰缁诲倿骞婅箛娑樼闁规壆澧楅悡鍐偡濞嗗繐顏╅柣蹇旀尦閺岀喖顢欓悾灞惧櫚闂佺娅曠划鎾澄涢崘銊㈡婵炲棙鎸婚弳妯肩磽閸屾艾锟芥悂宕愰悜鑺ュ�块柨鏇炲�归崑鍌炴煥濞戞ê顏☉鎾崇Ч閺屸�愁吋鎼粹�崇缂備胶濮甸悧妤冩崲濞戞﹩鍟呮い鏃囧吹閻╁酣姊洪崨濠庢畷濠电偛锕濠氬即閿涘嫮鏉搁梺鍝勬川閸婎偊濡烽敂杞扮盎闂佹寧妫侀褍顕ｉ鑺ュ弿濠电姴鍟妵婵囦繆椤愩垹鏆欓棁澶愭煏婢跺牆鍔ゅ褝濡囬敓鑺ヮ問閸犳銇愰崘顔癸拷锕傚Ω閳轰線鍞堕梺缁樻濞撳湱鑺遍悽鍛娾拻濞达絽鎲￠幆鍫熺箾鐏炲倸鐏茬�规洜鎳撶叅妞ゅ繐鎳庢禍妤�鈹戦悙鍙夘棡闁圭顭峰畷鎰版偨閸涘﹦鍘介梺闈涚箚濡插懘宕箛娑欑厽闁圭儤鍨甸埛鏃堟煥閻旇袚缂佸甯為幑銏ゅ醇濠垫劖缍庡┑鐐叉▕娴滄粌顔忓┑鍡忔斀闁绘ɑ褰冮弳鐔兼煕濞嗗繑顥滄い顏勫暣婵″爼宕卞Δ鍐ф樊婵犵妲呴崑鍛存儎椤栫偟宓侀柟杈剧畱椤懘鏌ｅ鍡椾簼闁哄偊鎷烽梻浣筋嚙閸戠晫绱為崱娑樼；闁告侗鍘搁弸宥夋煏韫囥儳纾跨紒鐘荤畺閹鎮藉▓璺ㄥ姼閻庢稒绻傞—鍐Χ閸℃浠撮梺纭呮珪閿曘垽鐛崘銊㈡瀻闁归偊鍠氶惁鍫ユ⒑閸涘﹤濮х紓鍌涙皑閼鸿鲸绻濆顓涙嫼缂佺虎鍘奸幊蹇涱敂閻樼粯鐓曢悗锝庡墮娴犙囨煥閻旇袚闁艰鍎抽敃銏℃綇閳哄偆娼熼梺瑙勫劤椤曨參鎮烽悷鎵虫斀闁绘ɑ褰冮弳娆愩亜韫囨碍纭鹃柍瑙勫灴閹晠顢欓懖鈺�绱橀梻浣虹《閺呮粓鎮ч悩鑼殾婵犻潧顑呴崘锟藉銈嗘尵閸犲孩绂嶅Δ鍛拺闁告稑锕ゆ慨锕傛煕閻樻剚娈滈柟顔欍倗鐤�闁瑰灝鍟伴崬鐢告煟閻樿崵绱版繛鍜冪稻閺呭爼寮撮姀锛勫幈闂佸搫鍠涢幏椋庯拷鐧告嫹闁归棿绀侀拑鐔兼煥閻斿搫孝妤犵偑鍨虹换娑㈠箣閻戝棙鐣烽梺鍝ュУ瀹�绋款潖濞差亜浼犻柛鏇ㄥ幘閸斿湱绱撻崒姘扁枌闁圭兘顥撶槐鎾存媴閸濆嫅锝夋煟閳哄﹤鐏犳い鏇秮椤㈡岸鏁撻挊澶屾殾闁圭儤鍨熷Σ鍫熶繆椤栨繂鍚圭憸鐗堟尦濮婂宕掑顒婃嫹瀹勬噴褰掑炊椤掑鏅梺鍝勭▉閸樿偐绮ｅΔ鍛厸鐎广儱楠搁獮妤呮煕鐎ｎ亶妲搁柍瑙勫灴瀹曟帒顭ㄦ惔锝呭Ъ闂備礁鎼鍕濮樿泛钃熼柣鏃傚帶缁�鍫㈡喐韫囨洘鏆滄繛鎴欏灪閻撴盯鏌涘☉鍗炴灍闁稿﹥鍔欓弻锛勪沪鐠囨彃顫囬梺璇″枔閸婃繂鐣烽幒鎴旀婵妫旂槐锟�?,婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄婵犲灚鍔栫紞妤呮⒑鐠恒劌鏋欐俊顐㈠瀹曟劙宕烽鐘电効闂佸湱鍎ゅΛ鎴﹀箯閻戣姤鏅查幖绮癸拷鑼嚬婵犵數鍋涢幊宀勫垂閽樺娼栨繛宸簼閸ゅ秹鏌曟径濠傛灓濞存粠浜ｅΛ鐔奉渻閵堝棛澧遍柛瀣☉鏁堥柡灞诲劜閳锋垶銇勯幒鐐村缂備礁顦遍弫濠氬箖閿熺姴唯闁冲搫鍊婚崢浠嬫⒑閸濆嫬鏆欓柛濠呭吹閺侇喖鈽夊▎宥勭盎闂侀潧顦崕鍝勎ｉ搹鍦＜閺夊牄鍔嶇亸顓熴亜閹剧偨鍋㈢�规洦浜畷姗�顢橀悙鏉戝壍婵犲痉鏉匡拷妤佹叏閻戣棄纾绘繛鎴欏灩閻ゎ喗銇勯幇鈺佸姢濞存粈绮欏娲嚒閵堝憛銏＄箾濞村娅囧ù婊咁焾閳诲酣骞嬮悩闈涚闂備胶绮崝妤呭磿閵堝鐓曢柟瀵稿У閸犳劙鏌ｅΔ锟介悧鍡欑箔閹烘嚚鐟邦煥閿熶粙宕￠幎钘夎摕婵炴垯鍨圭粻濠氭倵闂堟稒鍟為柛锝勫嵆濮婅櫣鎷犻垾铏彎濠电偘鍖犻崱娆庤埅闂傚倷鑳堕崢褔锝為弴銏犵９婵°倕鎳忛崕濠囨煕椤愮姴鍔滈柍閿嬪灴濮婂宕奸悢鐑樺垱闂佺粯绋掔划搴ｆ閹烘绠甸柟鐑樺灍閹稿啫鈹戦悙鏉戠仼闁轰礁顭烽獮鍐ㄢ枎閹垮啯鏅㈤梺绋挎湰缁娀宕惔銊︹拻濞达絽鎲＄拹锟犳煣韫囨捇鍙勭�规洘濞婇、娆撳床婢跺娲存鐐差儔閹晠鎮界喊澶屽簥濠碉紕鍋戦崐鏍ь潖婵犳艾鐓曢柛顐犲劜閸嬪倿鏌ゅù瀣珨闁圭兘顥撻幉鎾礋椤掑偆妲堕梻浣侯焾缁绘垿鏁冮姀銈呂ュù锝呭濞笺劑鏌ㄩ悢鍓佺煓妤犵偛鍟撮崺锟犲礃閵婏妇锟借櫕绻濋姀锝嗙【闁兼椿鍨抽懞閬嶅Ψ閵夈垺鏂�闂佺粯锚閻忔岸寮抽埡浣叉斀妞ゆ棁顕у畵鍡欙拷瑙勬礀缂嶅﹪骞冮埄鍐╁劅婵☆垵宕垫禍娆愮節閻㈤潧浠﹂柛顭戝灦瀹曠懓煤椤忓嫮鏌у┑鐘绘涧椤戝棝鎮￠妷鈺傜厸闁告劑鍔岄敓鐣屾嚀閳诲秹寮撮悜鍡欏數閻熸粍绻勯幑銏犫攽閸♀晜缍庢繝鐢靛У閼瑰墽澹曢崗鑲╃闁糕剝锚缁楁帡鏌涘Ο鍑ゆ嫹閹颁焦瀵岄梺闈涚墕妤犳悂鐛弽顓熺厽婵°倧鎷烽柨鏇ㄤ邯婵℃挳宕橀鍢夈劑鏌嶆潪鐗堫樂缂佸崬鐖煎娲濞戣鲸顎嗙紓浣哄У閸ㄥ爼骞嗛弮锟界换婵嬪磼濡や焦鏉搁梻浣哥枃濡嫬螞濡ゅ懏鍊堕柕澶涘缁犻箖鏌涘鍐ㄦ殶缂佸鍠氶敓鑺ヮ問閸犳绻涙繝鍥ф瀬闁告劦鍠栫壕鍏肩箾閹寸偠澹樼�殿喗濞婂缁樻媴閾忕懓绗″┑鐐插级閻楃姴鐣烽幇鏉挎嵍妞ゆ挶鍔嶇�氳鎱ㄥΟ鐓庝壕閻庢熬鎷�?,缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閻愵剙鍔ょ紓宥咃躬瀵鏁愭径濠勵吅闂佹寧绻傞幉娑㈠箻缂佹鍘遍梺闈涚墕閹冲酣顢旈銏＄厸閻忕偛澧藉ú瀛樸亜閵忊剝绀嬮柡浣瑰姍瀹曞崬鈻庡Ο鎭嶆氨绱撻崒姘拷鐑芥倿閿曞倸绀夐柡宥庡幑閿熻棄鍟村畷濂稿Ψ閿旇姤顏熼梻浣藉Г閿氭い锕備憾閹箖顢橀姀锛勫幈闁硅偐琛ラ敓钘夌枃閸╃偤鏌ｉ幘鍗烇拷婵嬪蓟閺囩喓绠鹃柣鎰靛墯閻濇梻绱掔紒銏犲伎闁圭兘鏀辩换婵嗏枔閸喗鐏嶅銈庡幖閻楁挸鐣峰ú顏勫唨妞ゆ挾鍠庢禍妤�鈹戦悙鍙夘棡闁搞劌婀辨竟鏇㈡寠婢规繂缍婇弫鎰緞鐎ｎ偊鏁梻浣筋嚙缁诲棝寮查悩璇茶摕闁挎稑瀚搁幏鐑芥晲鎼粹�茬敖闂侀潧妫欑敮鐐垫閹烘挻缍囬柕濞垮劜鐠囩偤姊烘潪鎵妽闁规瓕宕电划瀣箳閺冩挻瀚归柨婵嗙凹缁ㄨ姤銇勯敂鍝勫婵﹥妞藉畷姗�宕ｆ径瀣壍闂備礁鎽滈崰宥夊础閹跺锟戒礁鈻庨幘鍐插祮闂侀潧绻嗗褔骞忛搹鍦＝濞撴艾娲ら悘鈩冪箾閸欏澧柡鍛埣瀹曪絾寰勯崼婊呯泿闂備線娼ч…鍫ュ磿閾忣偅娅犻柕蹇嬪灮绾惧吋銇勯弮鍌楁嫛闁绘捁鍋愰敓鑺ヮ問閸犳牠鈥﹂柨瀣╃箚闁绘垼濮ら弲婊呯磽娴ｇ櫢渚涙俊顐㈡噹閳规垿鏁嶉崟顐℃澀闂佺锕ラ悧婊堝极椤曪拷楠炴帒顪冨┑鍡樺枠妞ゃ垺绋戦埥澶娾枎閹邦喖濞囬梻浣筋嚙濞寸兘寮拠宸劷濠电姵鑹剧粻顖滐拷鐟板婢瑰寮搁弮鍫熺厱妞ゎ厽鍨甸弸鐔兼煟韫囨挾澧︽慨濠呮缁辨帒螣閻撳簶鍚傞梻渚�娼ч悧蹇涒�﹂崼銉﹀仼鐎瑰嫭鍣村ú顏嶆晜闁告侗鍠楅鐔兼⒒娴ｈ櫣甯涙い顓炵墢娴滅鈻庨幘瀛樻珫濠电姴锕ら崯鐘诲绩娴犲鐓熸俊顖涱儥閸ゅ锟借鎮堕崕鐢稿箖濡わ拷椤繈鎮℃惔鈽嗘交闂備礁鐤囬褏绮旀搴ｄ笉婵炴垶菤濡插牊绻涢崱妤佹拱閻庢矮绮欏缁樻媴娓氼垳鍔搁梺鍝勭墱閸撶喖骞冮悜鑺ユ櫆闁告挆鍛姼闂備胶绮〃鍛存偋閸曨剛顩叉繝濠傜墛閻撴盯鏌涢妷銏℃珔闁哄妫冮弻锝夘敇閻旈鐟插銈冨妸閸庣敻骞冨▎鎾村殤妞ゆ帒鍋嗛崯瀣⒒娴ｈ姤銆冮柣鎺炵畵楠炴垿宕堕锟介弸渚�鏌熼崜褏甯涢柡鍛倐閺屻劑鎮ら崒娑橆伓
		// 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閳╁啯鐝栭梻浣芥硶閸犳捇寮查锝囩彾闁哄洢鍨洪崑锟犳煙閸愯宸ョ紓宥咃躬楠炲啴鍩℃笟鍥ф櫊濡炪倖姊婚崢褎淇婅缁辨捇宕掑顒婃嫹閸濄儳鐭撻柣銏犳啞閸嬪鏌￠崶锝嗗櫚闁跨喐鏋绘俊鍥箲閸曨垰惟闁挎洩鎷风痪缁㈠灦濮婅櫣绱掑Ο铏逛桓闁藉啴浜堕弻鐔兼倻閹存帗鍠氬┑顔硷龚濞咃絿鍒掑▎鎴炲磯闁靛ě灞芥暭缂傚倸鍊风欢锟犲窗濡ゅ懎绠查柛銉戝苯娈ㄩ柣鐘叉处缁佹潙危閸儲鐓忛煫鍥э攻濞呭棝鏌￠崨顔剧疄婵﹥妞介獮鎰償閿濆洨鏆ゆ繝纰樻閸嬪懘鎯勯婵囶棨闂備線娼ц墝闁哄懏绮撻崺娑㈠箣閻樼數锛濇繛杈剧秬閸嬪倿骞嬮敃锟界粻姘舵煕椤愮姴鍔滈柣鎾寸懇閺屾盯骞嬪▎蹇ユ嫹閺嶎偓鎷峰鐐?
		if (!checkNpcVisitable(roleid)){
			Module.logger.info("npc is unvisitable");
			return;
		}
		
		//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄婵犲灚鍔栫紞妤呮⒑鐠恒劌鏋欐俊顐㈠瀹曟劙宕烽鐘电効闂佸湱鍎ゅΛ鎴﹀箯閻戣姤鏅查幖绮癸拷鑼嚬婵犵數鍋涢幊宀勫垂閽樺娼栨繛宸簼閸ゅ秹鏌曟径濠傛灓濞存粠浜ｅΛ鐔奉渻閵堝棛澧遍柛瀣☉鏁堥柡灞诲劜閳锋垶銇勯幒鐐村缂備礁顦遍弫濠氬箖閿熺姴唯闁冲搫鍊婚崢浠嬫⒑閸濆嫬鏆欓柛濠呭吹閺侇喖鈽夊▎宥勭盎闂侀潧顦崕鍝勎ｉ搹鍦＜閺夊牄鍔嶇亸顓熴亜閹剧偨鍋㈢�规洦浜畷姗�顢橀悙鏉戝壍婵犲痉鏉匡拷妤佹叏閻戣棄纾绘繛鎴欏灩閻ゎ喗銇勯幇鈺佸姢濞存粈绮欏娲嚒閵堝憛銏＄箾濞村娅囧ù婊咁焾閳诲酣骞嬮悩闈涚闂備胶绮崝妤呭磿閵堝鐓曢柟瀵稿У閸犳劙鏌ｅΔ锟介悧鍡欑箔閹烘嚚鐟邦煥閿熶粙宕￠幎钘夎摕婵炴垯鍨圭粻濠氭倵闂堟稒鍟為柛锛卞喚娓婚柕鍫濇缁岃法绱掗煫顓犵煓闁诡噣绠栭弫鎾绘偐瀹曞洤濮洪梻浣瑰濡礁螞閸曨垱鍎婃繝濠傜墛閳锋帒銆掑鐐濠电偘鍖犻崶銊ヤ罕闂佺硶鍓濋妵鍌氣槈濡攱顫嶅┑鐐叉閸旀牠鎮靛畡閭︽富闁靛牆妫楃粭鎺楁煕婵犲懎鍚瑰瑙勬礋瀹曟绮潪鎵泿闂備礁鎼崯顐⒚洪妶鍡欘洸鐟滅増甯楅悡鐔兼煙閻戞ɑ灏伴柛濠冨姍閺岀喓绮欓崠陇鍚梺璇″枔閸ㄨ棄顫忚ぐ鎺戠疀妞ゆ柨澧介弳浼存⒒閸屾瑧绐旀繛浣冲洦鍋嬮柛鈩冪懕閹峰嘲顫濋悡搴ｄ桓閻庤娲橀〃鍛存偩濠靛鏅搁柣锝呮湰椤洟鏌熼悜姗嗘畷闁稿鍔欓弻銈嗘叏閹邦剨鎷峰Δ鍛辈妞ゆ劧闄勯埛鎴︽煕濠靛棗顏繝锟芥导瀛樼厽闁冲搫锕ら悘锕傛煏閸℃洜绐旂�殿喗鎸虫慨锟介柍鈺佸暞閻濇娊姊绘担瑙勫仩闁稿寒鍣ｅ鏌ュ煛閸涱叀鍩為梺鍓插亝濞叉﹢鍩涢幒鎳ㄥ綊鏁愰崨顔兼殘闂佸摜鍠撻崑鐐哄箞閵婏妇绡�闁稿被鍊楅崥瀣倵鐟欏嫭纾婚柛妤佸▕閻涱噣宕堕澶嬫櫓闂佽姤锚椤︻垳鑺遍妷锔剧瘈闁汇垽娼ф禒锕傛煕椤垵鐏︾�规洜顢婇妵鎰板箳閹捐泛甯掗梻浣规偠閸庢椽宕滃鑸靛亗闁绘柨鍚嬮悡娑㈡煕閹扳晛濡垮褎鐩弻鈩冪瑹閿熻姤绂嶉崼鏇炶摕闁跨喓濮撮獮銏′繆椤栨粎甯涢柡澶岀彑闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊為悷婊冪箻瀵娊鏁冮崒娑氬幈濡炪値鍘介崹鍨濠靛鐓曟繛鍡楃箳缁犳娊鏌ㄩ悢鍑ゆ嫹閻曚焦缍堝┑鐐插级閻楁洜鍙呴梺闈浥堥弲婊堝磿濡ゅ懏鐓曢柍鈺佸枤濡懐鎲搁悧鍫濈瑲闁哄懏鐓￠弻娑樷槈閸楃偛瀛ｅ┑鈽嗗亜閻倸顫忛搹鍦＜婵☆垵娅ｉ悷鎰磽娓氬洤鏋熼柣鐔叉櫅椤曪絿鎷犲顔兼倯婵犮垼娉涜癌闁靛ň鏅滈悡銉╂煛閸屾氨浠㈤柍閿嬫閺岋絽鈽夐崡鐐寸亪闂佸疇顫夐崹鍧楀箖濞嗘挸绾ч柟瀵稿С閹寸兘姊绘担瑙勫仩闁告柨绉撮—鍐寠婢跺本娈鹃梺姹囧灮椤ｎ噣骞忛悜鑺ユ櫜閹肩补鍓濋悘宥夋⒑閹惰姤鏁遍悽顖ょ節瀵鈽夐姀鈺傛櫇闂侀潧鐗嗛幊蹇涙倶娓氾拷濮婃椽妫冨☉娆樻！闁汇埄鍨抽崑鐔肺ｉ幇鏉跨婵°倧鎷风紒鐘崇♁閵囧嫰寮崼鐕傜吹濠碘�冲级閸旀洟鍩為幋锔绘晩缁绢參鏀遍弫鎯р攽閿涘嫬浠╂俊顐㈠閹箖鎮滈挊澹┾晠鏌ㄩ弬鍨挃闁伙箑鐗撳娲川婵犲倸袝闂佺粯鎸搁悧鍡楀祫闂備緡鍓欑粔鐢稿煕閹烘嚚褰掓晲閸涱喖鏆堥梺鍝ュ枔閸嬨倝骞嗛崶銊ョ窞鐎癸拷閿熺晫澹曢崗绗轰簻闁哄啫鍊瑰▍鏇㈡煙閸愭彃鏆ｉ柡宀嬬秮閺佹劙宕惰楠炲螖閻橀潧浠滄繛宸弮楠炲啳顦圭�规洜鍘ч埞鎴﹀箻閺夋埈浼撳┑锛勫仜椤戝懎霉妞嬪骸顥氬ù鐘差儐閻撴洘銇勯幇顔夹㈤柣蹇婃櫊瀹曨垶宕妷褏锛濇繛杈剧到閹碱偅鐗庨柣搴ｆ閹烽绱掔�ｎ偒鍎ユ繛鍏肩墵閺屟嗙疀濮樺吋缍堥悗瑙勬礀椤︾敻寮婚弴鐔虹闁割煈鍠栨慨鏇㈡⒑缂佹缂氶柛銊ㄦ椤繐煤椤忓懎浠梺鍝勵槹鐎笛囶敊閿熶粙姊绘担鐑樺殌闁搞倖鐗犻獮蹇涙晸閿燂拷?
		SpecialNpcDialogProcessor processor = SpecialVisitProcessCreator.getInstance().createNpcDialogProcessor(roleid, npckey);
		if(null != processor){
			Module.logger.info("specialNpcDialog. npcid:"+share.id);
			processor.onVisitNpc();
			return;
		}
		
		final SVisitNpc svisitNpc = new SVisitNpc();
		svisitNpc.npckey = npckey;
		final java.util.List<Integer> services = NpcServiceManager.getInstance().getShowServicesIDSByNpcKey(roleid, npckey);
		if (null != services) {
			svisitNpc.services.addAll(services);
		}
		getScenarioQuests(roleid, share.id, svisitNpc);
		
		gnet.link.Onlines.getInstance().send(roleid, svisitNpc);
		Module.logger.info("SVisitNpc闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣洴钘濋柣銏㈩焾閺嬩線鏌熼崜褏甯涢柛瀣姈閵囧嫰寮撮悙鎼！闁诲孩鑹剧紞濠囧蓟濞戙垹绠涢梻鍫熺♁閻忓牓鎮楅悷鐗堝暈缂佽鍟存俊鐢稿礋椤栨艾鍞ㄩ梺闈浤涢敓钘壩ｉ崼銉︾厵闁稿繐鍚嬬紞鎴︽煥閺囨ê锟芥繈宕洪悙鍝勭闁绘劘灏欓悿鍥⒒娴ｄ警鐒鹃柨鏇樺劚鐓ら柣鏃囧亹瀹撲線鐓崶銊︾┛闁归鍏橀弫鎰償閳╁啰浜梻浣告惈椤戝嫮绮堟笟锟介崺鐐哄箣閿旇棄浜归梺鍛婄懃椤︻垶藝閳哄懏鈷戠紓浣股戠亸鐗堢箾閸欏鐒介柟骞垮灩閳藉濮�閻樻鍚呴梻浣虹帛閸旀洟鎮樺璺洪棷妞ゆ挾濮风壕浠嬫煕鐏炵偓鐨戦弽锟犳⒑閹肩偛濡兼繝锟介崡鐐嶏綁骞囬弶璺唺濠德板�撻悞锕�鈻嶉姀锛勭閻庣數顭堝瓭濡炪倖鍨甸幊鎰垝閸儱绀冮柍鐟般仒缁ㄥ姊洪崫鍕殭闁稿﹦鎳撻埢宥夊即閵忥紕鍘卞┑鈽嗗灠閹碱偊鎳滆ぐ鎺撶厓閻熸瑥瀚悘鎾煙椤旂晫鎳囩�殿喖鐖奸獮瀣偐鏉堛劍鈻曢梻浣筋嚙濮橈箓锝炴径濞掓椽鏁冮崒姘鳖槶濠电偛妫欓幖鈺呭极鐎ｎ喗鐓ユ繝闈涙椤ユ捇鏌涚�ｎ亝鍤囬柡灞剧洴楠炲洭濡搁敂鐣屽絿闂備礁鎲￠敃銏＄鐠轰警娼栭柧蹇撴贡绾惧吋淇婇婵嗗惞妞わ负鍎靛铏圭矙閸栤�充紣濠电媴鎷烽梺顒�绉甸弲鎼佹煠閹帒鍔ら柛鐔哥叀閺岀喖宕欓妶鍡楊伓-" + getString(svisitNpc,share.id));
	}
	

	private String getString(SVisitNpc svisitNpc,int npcid) {
		StringBuffer sb = new StringBuffer();
		sb.append("NPC:[" + npcid + "],");
		sb.append("Services:[");
		for(Integer serviceid : svisitNpc.services){
			sb.append(serviceid +";");
		}
		sb.append("],");
		sb.append("ScenarioQuests:[");
		for(Integer serviceid : svisitNpc.scenarioquests){
			sb.append(serviceid +";");
		}
		sb.append("].");
		return sb.toString();
	}
	@Override
	protected void process() {

		//Module.logger.info("闂傚倸鍊搁崐鎼佸磹閹间礁纾圭�瑰嫭鍣磋ぐ鎺戠倞鐟滃繘寮抽敃鍌涚厽闁靛繈鍩勯悞鍓х磼閹邦収娈滈柡宀�鍠栭弻鍥晝閿熶粙寮稿☉銏＄厱闁靛濡囩粻鐐搭殽閻愬澧懣鎰亜閹虹偞瀚归梺璇叉禋娴滄繄鎹㈠☉銏犲窛妞ゆ牗顕撮敐鍚冲酣宕惰闊剙鈹戦垾宕囧煟鐎规洏鍔戦、娆撳礂绾板彉鍝楃紓鍌氬�搁崐鐑芥嚄閼稿灚鍙忛柟鎯版绾拷闂佽鍎煎Λ鍕嫅閻斿摜绠鹃柟瀵稿�戝顑╋綁宕奸悢绋垮伎濠德板�ч幏鐑芥煟濡わ拷閿曨亜顕ｉ锕�绠氱憸澶愬绩娴犲鐓熼柟閭﹀墮缁狙囨煕閿濆牊顥夐柍瑙勫灴閹粓宕堕妸銉紦闂傚倸鍊风粈渚�骞栭锔藉剹濠㈣泛鑻欢銈夋煕婵犲嫬鏋斿ù婊�绮欏缁樻媴閻熸澘濮㈢紓浣虹帛閿曘垽寮幘缁樺殟闁靛／渚婃嫹閹烘埈娓婚柣鐔告緲閺嗛亶鏌嶇憴鍕伌闁诡喒鏅犻獮鍥ㄦ媴閸涘﹥鐝遍梻鍌欑劍閹爼宕濈�ｎ喖纭�闁惧浚鍋傜换鍡涙煕椤愶絾绀�缂佺姷鎳撻湁闁挎繂妫涢幗鍐煙閼恒儲绀�闁宠鍨块幃娆撳级閹寸姳妗撶紓鍌欑贰閸犳碍鎱ㄩ弶鎴濈カ闂備胶绮幐鍝ワ拷鍨笒閵嗘帗绻濆顓犲帾闂佸壊鍋呯换鍌炲汲濞嗗繆鏀介柍銉ュ暱閹垵菐閸パ嶈含妞ゃ垺娲熼弫鎰板炊閳哄啯婢栭梺璇插椤旀牠宕抽锟藉畷鎴﹀礋椤栵絾鏅ｉ梺绋跨箳閸樠呮閻愭祴鏀介柣妯诲絻椤忣參鏌ｅ☉娆愬鞍缂佺粯绻傞埢鎾诲垂椤旂晫浜俊鐐�ら崣搴ㄥ礈閻旇偐宓佹俊銈呮噺閺呮悂鏌ㄩ悤鍌涘 id + " + NpcServiceManager.getNpcIDByKey(npckey));
		
		// protocol handle
		// TODO:婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鎯у⒔缁垳鎹㈠☉銏犵婵炲棗绻掓禒楣冩⒑缁嬫鍎嶉柛濠冪箞瀵寮撮悢铏诡啎閻熸粌绉瑰畷顖烆敃閿旇棄锟借泛鈹戦悩鍙夊闁抽攱鍨块幃宄扳枎韫囨搩浠奸梺鍛婃煟閸婃洟鈥﹂懗顖ｆЩ濠电偞鎸抽弨杈╃博閻旂厧鍗抽柕蹇婏拷铏枀闂備線娼ч¨锟界紒鐘冲灥椤曪綁宕归瑙勬杸闂佸疇妫勫Λ妤呮倶閿熺姵鍊电紒妤佺☉閹冲繘宕楀鍫熺厱闁圭偓顨呴幊鎰版晬濠婂牊鈷戦悹鎭掑妼閺嬪秶绱掗鐣屾噧闁伙絿鍏橀獮鎺楀箣閺冿拷椤秴鈹戦悙鍙夘棞缂佺粯鍔栫�靛吋鎯旈姀銏㈢槇閻庡吀鍗抽弨鍗烆熆濮楋拷閺佹捇鎳為妷锔绢槹濡炪們鍨洪悧鐘茬暦閸楃偐鏋庢繛鍡樺姇椤忚泛鈹戦鏂や緵闁告挻绋撶划鏂棵洪鍛幍濡炪倖姊婚悺鏂库枔濮楋拷閺岀喖宕ｆ径瀣攭閻庤娲滈崰鏍�佸Δ鍛＜闁挎梹鍎抽弸鐘绘⒒閸屾艾锟界兘鎳楅崼鏇楋拷锕傚醇濠㈡繂缍婇幃婊堟寠婢跺锟筋剟鏌ｉ悩鍙夋悙婵☆垰锕畷鐢稿即閻旂繝绨婚梺瑙勬緲婢у酣鎮炬潏鈺冪＜闁跨喍绮欏畷姗�顢欓悾灞藉笚闂備礁鎲＄换鍌滐拷姘煎墴瀵娊鎮㈤崗鑲╁幍闂佹儳娴氶崑鍡欑不閻愬瓨鍙忓┑鐘插暞閵囨繃顨ラ悙瀵稿⒌闁诡喗鐟╅獮鎾诲箳閹宠櫕顨婂缁樻媴閸涘﹤鏆堝┑鐐额嚋缁犳挸鐣峰鍐ｆ婵犙冦仒濮规姊哄Ч鍥х仼闁硅绻濋崺娑㈠箳濡や胶鍘遍柣蹇曞仦瀹曟ɑ绔熷锟介弻銊╂偄鐠囨畫鎾绘煙椤旂厧锟芥悂鎮鹃悜钘夌疀闁哄娉曢鎰箾鏉堝墽鍒伴柟鑺ョ矒閺佸秴鈻庨幘绮规嫼閻熸粎澧楃敮妤呮晬閻旇櫣纾奸柨鐔诲Г閹峰懘宕崟鍨棥闂備浇宕甸崰鎰珶鐎ｎ喖缁╁ù鐘差儐閻撶喐淇婇婵囶仩闁哄鍟…璺ㄦ喆閸曠數鍔风紓浣介哺閹稿骞忛崨鏉戠煑濠㈣泛顑囪ぐ瀣⒒娴ｅ憡鎯堥柡鍫墮鐓ら柣鏂款殠閸ゆ洟鏌涙繝鍕珡婵¤尪顕ч埞鎴︽倷閼碱剙鈷婇梺鐟板殩閹凤拷,婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鎯у⒔缁垳鎹㈠☉銏犵婵炲棗绻掓禒楣冩⒑缁嬫鍎嶉柛濠冪箞瀵寮撮悢铏诡啎閻熸粌绉瑰畷顖烆敃閿旇棄锟借泛鈹戦悩鍙夊妞ゃ儱锕ラ妵鍕箛閳轰胶浠炬繝銏ｆ硾鐎氫即寮婚悢鐓庡窛濠电姴鍟崬澶愭倵濞堝灝鏋ゆい顓炵墦椤㈡﹢宕楅悡搴ｇ獮闁诲函缍嗛崜娆忣嚕閾忣偆绡�闁汇垽娼ч埢鍫熺箾娴ｅ啿鍚樺☉妯锋瀻闁规儳绉撮ˇ鐢稿箖濞嗘埊鎷烽棃娑欐喐妞ゆ梹娲熷娲川婵犱胶绻侀梺鎼炲妺閸楁娊宕洪姀銈呴唶闁靛濡囬崢鎼佹煟韫囨洖浠滃褌绮欓垾鏍礂缁楄桨绨婚梺鎸庢磻閻掞箓鎮甸鍫熺厪闁搞儜鍐句純婵犵鍓濋幃鍌涗繆閻戣姤鏅滅紓浣癸公缁辨姊虹拠鍙夊攭妞ゎ偄顦叅婵鎷风�规洖缍婂畷绋课旈崘銊с偊闂備焦鎮堕崕娲礈濮樿泛纾婚悗锝庡枟閻撴洘銇勯幇顔夹㈤柣蹇婃櫆椤ㄣ儵鎮欐潏鎹愶拷鎸庢叏婵犲偆鐓肩�规洘甯掗～婵嬵敆婵犲啫顏堕梺褰掓？閻掞箓宕戠�ｎ喗鐓曢柟浼存涧閺嬫盯鏌ｉ妶鍥т壕缂佺粯绻冪换婵嬪磼濞戞褰呴梻浣烘嚀閸㈡煡宕查弻銉稏婵犻潧顑嗛崐閿嬨亜閹虹偞瀚瑰銈呴獜閹凤拷?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝呂熷▎鎯ф缂備胶濮撮悘姘跺Φ閸曨喚鐤�闁圭偓鎯屽Λ鐐电磽娴ｇ晫鍫柛濠冪箞瀵鈽夊搴⑿俊鐐�戦崝宀勫箠閹邦厾鐝堕柡鍥ュ灩闁裤倖淇婇妶鍕厡闁告﹩浜娲礈閹绘帊绨肩紓浣筋嚙缁夋潙宓勯悷婊呭鐢鎮￠弴銏″�甸柨娑樺船鐎氼參鎮靛顑芥斀妞ゆ梻銆嬮弨缁樹繆閻愭壆鐭欓柕鍡曠铻栭柛娑卞枟濞呫垽姊烘导娆戝埌闁活剙銈搁幆宀勫箻缂佹鍘介梺闈涚箳婵敻宕悙鐑樼厱閻庯綆浜滈敓钘夋健瀵鏁撻悩鑼�為梺闈涱槶閸庤櫕绂掓ィ鍐┾拺缂備焦蓱鐏忎即鏌ｉ悢鍙夋珚鐎殿喛顕ч埥澶娢熼柨瀣澑闂備胶纭堕崜婵嬨�冭箛鏂款嚤鐎癸拷閸曨兘鎷虹紓浣割儏濞硷繝顢撳Δ鍐＜缂備焦锕懓璺拷娈垮枛椤攱淇婇幖浣哥厸闁稿本鐭花濠氭⒑閼姐倕孝婵炶绠撻幃楣冾敃閿曪拷缁犺崵绱撴担璇＄劷闁告妫勯埞鎴炲箠闁稿﹥娲熷畷顖烆敃閵忋垺鎳冩繝纰夌磿閸嬫垿宕愰弽顬℃椽鍩￠崘銊х瓘闂佸憡鎸嗛崟顐㈢哎婵犵數濞�濞佳兾涢鐑嗙劷闁冲搫鍊舵禍婊堟煙閻戞ê鐏ラ柨鐔诲Г閹倿寮幘缁樺仼閻忕偞鍨濈划璺侯渻閵堝簼绨婚柛鐔风摠娣囧﹪宕奸弴鐐茶�垮┑掳鍊曢崯浼村箟椤忓牊鈷掑ù锝堟鐢盯鎮介锝勭敖缂侇喖顭烽獮瀣晝閿熶粙鎮″┑鍫嫹楠炲灝鍔氭い锔诲灦瀹曟﹢鏁撻挊澶樻富闁靛牆妫欑亸鐢告煕閻樿櫕宕岀�规洏鍨虹粋鎺旓拷锝庡亽濡懎顪冮妶鍡楀闁搞劎鍎ゅ鍕礋椤掑倻顔曢梺鍛婄懃椤﹁鲸鏅堕鍌滅＜闁稿本绋戝ù顕�鏌涢埡瀣瘈鐎规洏鍔戦、娆撳箚瑜嶇粻鐐烘⒒娴ｇ瓔鍤欓柛鎴犳櫕缁辩偤宕卞☉妯硷紱闂佸憡娲﹂崜姘跺矗韫囨稒鐓曟い鎰Т閸旀粓鏌涙繝鍕毈婵﹤顭峰畷濂告偄鐞涒剝锛堥梻浣侯焾椤戝啴宕瑰ú顏傦拷鍐Ψ閳哄倸锟界兘鏌涘▎蹇ｆЦ闁哄濮撮—鍐Χ閸愩劎浠鹃梺缁橆殘婵烇拷妤犵偛锕幃娆撳传閸曞簺鍔戦弻銊╁籍閸ヮ灝鎾剁磼妫版繂浜版慨濠傤煼瀹曟帒顫濋濠冨闁绘垼濮ら崵鍕煕椤愶絾绀�缁炬儳顭烽弻鏇熺箾閻愵剚鐝旂紒鐐劤濞尖�愁潖濞差亶鏁嗛柨鐔烘櫕缁棃骞橀钘変痪濡炪倖娲╅幏鐑芥煛鐏炲墽顬兼い锕佹珪閵囧嫰濡搁妷锔绘＆閻庢鍠楅悡锟犵嵁閺嶃劍濯撮柛锔诲幖瀵喗绻濈喊妯活潑闁割煈鍨抽幏鍐晝閿熻棄宓勯梺鍛婄☉閿曪絿鎹㈤崱娑欑厾缁炬澘宕晶浼存偨椤栨稓娲撮柡灞炬礋瀹曟儼顦叉い蹇ｅ幗閵囧嫰濮�閳╁啰顦伴梺杞扮劍閸旀瑥鐣烽崼鏇炵厸闁告劏鏅滅欢浼存⒒閸屾艾锟藉嘲霉閸パ屾禆闁靛ě鍛劶婵炴挻鐔幏椋庯拷瑙勬处閸ㄨ泛顕ｉ崼鏇炵闁绘娅曢鏇㈡⒒娴ｅ憡璐￠柛搴涘�濆畷娲醇濠垫劗鍔烽梺鍐叉惈閸婅埖绂嶅鍫熺厵闁惧繒鎳撴禒锕傛倵濮橆剛绉烘慨濠呮閹叉挳宕熼锟芥禒鈺呮⒑缁嬪尅鏀荤紒璇插�块敐鐐剁疀閺囩姷锛滃┑鈽嗗灥椤曆囶敁閹剧粯鈷戠紓浣姑悘锕傛煥濮橆厾绠鹃柛顐ｇ箘閻掑憡鎱ㄦ繝鍛仩闁归濞�閹崇娀顢楅崒銈呮暭缂傚倸鍊峰ù鍥敋瑜忛敓鑺ョ煯閸楀啿顕ｉ锕�绠荤紓浣姑▓鐔兼⒑闂堟侗妲堕柛搴″船琚欓柛顐犲劜閳锋垿鏌涘┑鍕姎閺嶁�斥攽椤旇婊堝礉閹存繄鏆︽慨妯挎硾缁犺櫕淇婇妶蹇斿闂備礁宕ú顓㈠蓟閿濆绫嶉柛顐亝椤ユ牜绱撴担鐟板闁稿鍊曢～蹇斻偊鐟併倓姹楅梺鍦劋閸ㄦ娊宕版繝鍥ㄢ拺闁告稑顭懓璺ㄧ磼閻樺磭澧柣锝囧厴婵拷闁靛牆妫楁禒娲⒑閸涘﹦鈽夐柨鏇畵瀹曘垺绂掔�ｎ偆鍘甸梺绋跨箺閸嬫劙寮冲锟介弻娑㈠Ω閵夘喚鍚嬮梺绯曟櫔闂勫嫮绮悢鍏兼櫢濞寸姴顑呴拑鐔兼煛閸ャ儱鐏╂鐐灪缁绘盯宕卞Δ鍐吅濠碘�冲级閸旀洝鐏冮梺缁橈耿濞佳勭濠婂嫨浜滈柟瀛樼箥濡拷閻庢鍣崑濠傜暦濮楋拷椤㈡瑩鎳為妷锔讳户婵犵數鍋涢顓熸叏閹绢噮鏁勯柛娑卞灣閻棝鏌涢弴銊ョ仭闁绘挾鍠愭穱濠囶敍濠靛棔姹楅柣銏╁灡閻╊垶寮婚敐澶婄閻犺櫣鍎ら悘鍫ユ⒑閸濆嫮鐒跨紒缁樼箓閻ｇ兘骞掗幋鏃�顫嶅┑顔筋殔濡鈻撳┑瀣拻濞达絿鍎ら崵锟介悗娈垮枛閻栧ジ鐛崘顔肩＜闁绘劘灏幗鏇㈡倵楠炲灝鍔氭俊顐ｎ殜椤㈡碍娼忛妸褏顔曢梺绯曞墲閿氬┑顔兼处閵囧嫯绠涢妷锕�顏�?...
		final long roleid = gnet.link.Onlines.getInstance().findRoleid(this);
		if (roleid < 0){
			Module.logger.error("闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊為悷婊冪箻瀵娊鏁冮崒娑氬幈濡炪値鍘介崹鍨濠靛鐓曟繛鍡楃箳缁犳娊鏌ㄩ悢鍑ゆ嫹閻曚焦缍堝┑鐐插级閻楁洜鍙呴梺闈浥堥弲婊堝磿濡ゅ懏鐓曢柍鈺佸枤濡懐鎲搁悧鍫濈瑲闁哄懏鐓￠弻娑樷槈閸楃偛瀛ｅ┑鈽嗗亜閻倸顫忛搹鍦＜婵☆垵娅ｉ悷鎰磽娓氬洤鏋熼柣鐔叉櫅椤曪絿鎷犲顔兼倯婵犮垼娉涜癌闁靛ň鏅滈悡銉╂煛閸屾氨浠㈤柍閿嬫閺岋絽鈽夐崡鐐寸亪闂佸疇顫夐崹鍧楀箖濞嗘挸绾ч柟瀵稿С濡楁挻绻濆▓鍨灍閼垦囨煕閺冿拷閸ㄥ潡鐛崱妤冩殕闁告洦鍋嗛鎺旂磽閸屾瑧鍔嶆い顓炴喘瀹曘垽妫冨☉杈ㄥ瘜闂侀潧鐗嗗Λ娆戜焊閻㈠憡鐓曢柣妯挎珪瀹曞本銇勯姀鈩冾棃妤犵偞锕㈤、娆戞喆閿濆棗顏洪梻鍌欒兌椤牓寮甸鍕殞濡わ絽鍟弲鎼佹煟閿濆懓瀚伴柛妯绘尦閺岀喖顢欓幆褌妲愰梺杞扮閸熸潙鐣烽幒鎴旀婵☆垰鎼ˉ鎰版⒑閼姐倕鏋戠紒顔煎閺呰泛螖閸愨晜娈伴梺鍦劋濮婂鎯岄崱妤婄唵閻犻缚娅ｉ悞鍧楁煙妞嬪骸鍘撮柟顖氬�垮畷銊︾節閸屻倓绱﹂梻鍌氬�峰ù鍥р枖閺囥垹绐楃�广儱娲ら崹婵囩箾閸℃ɑ灏柡瀣╃窔閺岀喖宕滆鐢盯鏌涢妶鍛ч柡灞炬礃瀵板嫰宕煎┑鍡楊潛婵犳鍣徊浠嬫偋閹炬剚娼栨繛宸簻缁犲綊鏌ｉ幇顓炵祷妞ゎ剙鐗撳铏圭磼濡厧鈪归梺闈涚墢椤牓顢氶敐澶樻晝闁挎洩鎷风紒鐘崇洴閺岋絽螖閿熶粙鎮ч崱娑欐櫢闁伙絽鑻崢鎾煛鐏炲墽鈽夐柍璇叉唉缁犳盯骞欓崟顒�顏堕梺鑽ゅ枑鐎氬牆鈽夐姀鐘殿槰闂侀潧臎閸曨剦鍟庨梻鍌欑窔濞佳嗗闂佸搫鎳夐弲鐘差嚕椤愶絿绡�闁搞儯鍔庨崢閬嶆椤愩垺澶勯柤鍦亾缁傚秷銇愰幒鎾跺幐婵犮垼鍩栫粙鎺旓拷姘炬嫹? 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闂囧鏌ㄥ┑鍡欏闁靛棗鍟撮弻锝夊箳閹搭垵鍚梺鍝勬湰缁嬫垿鍩ユ径濞炬瀻闁归偊鍠氶埢蹇曠磽閸屾瑨鍏屽┑顖ｅ弮瀹曞綊宕奸弴鐐舵憰闂侀潧艌閺呮粓宕戦崱娑欑厱閻忕偛澧介埥澶嬨亜韫囥儲瀚�? " + roleid + "闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閳╁啯鐝曢梻浣藉Г閿氭い锔诲枤缁辨棃寮撮姀鈾�鎷绘繛杈剧秬濞咃綁濡存繝鍥ㄧ厱闁规儳顕粻鐐烘煙閽樺锟藉鏁撻弬銈囩У闁哥姵鐗犻幃娆愮節閸愶缚绨婚梺鐟版惈缁夊爼藝閿曪拷闇夐柣妯煎劋椤忕姷绱掓潏銊﹀鞍闁瑰嘲鎳樺畷婊堝箵閹烘垵顥庨梻浣筋嚙濞寸兘鎮烽幎钘夌倞闁靛鍎婚幏鐑藉垂椤愮姳绨婚梺鍦劋閸ㄧ敻顢旈鍫熺厓闂佸灝顑呴悘鎾煙椤旇偐绉烘鐐扮窔楠炴帡骞嬪┑鎰拷铏節閻㈤潧浠滈柟鍐茬箻瀹曟繂鈻庨幘瀹犳憰闂佺粯姊婚崢褏绮堥崟顖涚厪闁割偅绻冮ˉ婊勩亜韫囥儲瀚�");
			return;
		}
		
		PropRole prole = new PropRole(roleid, true);	
		if(prole.getProperties().getCruise() > 0) {
			Module.logger.error("闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊為悷婊冪箻瀵娊鏁冮崒娑氬幈濡炪値鍘介崹鍨濠靛鐓曟繛鍡楃箳缁犳娊鏌ㄩ悢鍑ゆ嫹閻曚焦缍堝┑鐐插级閻楁洜鍙呴梺闈浥堥弲婊堝磿濡ゅ懏鐓曢柍鈺佸枤濡懐鎲搁悧鍫濈瑲闁哄懏鐓￠弻娑樷槈閸楃偛瀛ｅ┑鈽嗗亜閻倸顫忛搹鍦＜婵☆垵娅ｉ悷鎰磽娓氬洤鏋熼柣鐔叉櫅椤曪絿鎷犲顔兼倯婵犮垼娉涜癌闁靛ň鏅滈悡銉╂煛閸屾氨浠㈤柍閿嬫閺岋絽鈽夐崡鐐寸亪闂佸疇顫夐崹鍧楀箖濞嗘挸绾ч柟瀵稿С濡楁挻绻濆▓鍨灍閼垦囨煕閺冿拷閸ㄥ潡鐛崱妤冩殕闁告洦鍋嗛鎺旂磽閸屾瑧鍔嶆い顓炴喘瀹曘垽妫冨☉杈ㄥ瘜闂侀潧鐗嗗Λ娆戜焊閻㈠憡鐓曢柣妯挎珪瀹曞本銇勯姀鈩冾棃妤犵偞锕㈤、娆戞喆閿濆棗顏洪梻鍌欒兌椤牓寮甸鍕殞濡わ絽鍟弲鎼佹煟閿濆懓瀚伴柛妯绘尦閺岀喖顢欓幆褌妲愰梺杞扮閸熸潙鐣烽幒鎴旀婵☆垰鎼ˉ鎰版⒑閼姐倕鏋戠紒顔煎閺呰泛螖閸愨晜娈伴梺鍦劋濮婂鎯岄崱妤婄唵閻犻缚娅ｉ悞鍧楁煙妞嬪骸鍘撮柟顖氬�垮畷銊︾節閸屻倓绱﹂梻鍌氬�峰ù鍥р枖閺囥垹绐楃�广儱娲ら崹婵囩箾閸℃ɑ灏柡瀣╃窔閺岀喖宕滆鐢盯鏌涢妶鍛ч柡灞炬礃瀵板嫰宕煎┑鍡楊潛婵犳鍣徊浠嬫偋閹炬剚娼栨繛宸簻缁犲綊鏌ｉ幇顓炵祷妞ゎ剙鐗撳铏圭磼濡厧鈪归梺闈涚墢椤牓顢氶敐澶樻晝闁挎洩鎷风紒鐘崇洴閺岋絽螖閿熶粙鎮ч崱娑欐櫢闁伙絽鑻崢鎾煛鐏炲墽鈽夐柍璇叉唉缁犳盯骞欓崟顒�顏堕梺鑽ゅ枑鐎氬牆鈽夐姀鐘殿槰闂侀潧臎閸曨剦鍟庨梻鍌欑窔濞佳嗗闂佸搫鎳夐弲鐘差嚕椤愶絿绡�闁搞儯鍔庨崢閬嶆椤愩垺澶勯柤鍦亾缁傚秷銇愰幒鎾跺幐婵犮垼鍩栫粙鎺旓拷姘炬嫹? 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闂囧鏌ㄥ┑鍡欏闁靛棗鍟撮弻锝夊箳閹搭垵鍚梺鍝勬湰缁嬫垿鍩ユ径濞炬瀻闁归偊鍠氶埢蹇曠磽閸屾瑨鍏屽┑顖ｅ弮瀹曞綊宕奸弴鐐舵憰闂侀潧艌閺呮粓宕戦崱娑欑厱閻忕偛澧介埥澶嬨亜韫囥儲瀚�? " + roleid + "闂傚倸鍊搁崐鎼佸磹閹间礁纾圭�瑰嫭鍣磋ぐ鎺戠倞妞ゆ帒顦伴弲顏堟偡濠婂啴鍙勯柕鍡楀暣婵＄柉顦撮柣顓熺懇閺屾盯寮婚婊冿拷褔骞忛悜钘夐敜婵°倧鎷风紒鐙欏洦鐓曟い鎰剁悼椤ｅ弶绻涢崨顓燁棦闁哄本绋栫粻娑㈠籍閸屾粎鍘滈梻浣告惈閺堫剟鎯勯鐐拷渚�寮撮姀鈩冩珳闂佺硶鍓濋悷顖毼ｉ鍌滅＝闁稿本鐟х粵蹇涙煙妞嬪骸鍘撮柡灞剧洴椤㈡洟濡堕崨顔句簴缂傚倷璁插Σ鍕箯閻戣姤鈷掗柛灞捐壘閿熻姤鎮傞幃褎绻濋崘顏嗘嚌濠德板�曢幊搴ｅ閸ф鐓欓柟娈垮枛椤ｅジ鏌ｉ幘瀛樼闁诡喗顨婇弫鎰償濠靛洤鏋ゆ繝纰樻閸ㄤ粙骞忛悜鑺モ拻濞达絽鎲￠幆鍫ユ煛閸偄澧撮柟顖氬椤㈡盯鎮欓搴㈠濞撴熬鎷风�殿喗鎸虫慨锟介柍鈺佸暞閻濇娊姊绘担铏广�婇柛鎾寸箞閹兘顢涘В纭风稻鐎佃偐锟芥稒菤閹风粯绻涙潏鍓у閻狅拷閿曞倹鍊块柣鎰靛厵娴滄粓鏌熺�涙绠栨い銉ｅ灮閿熷�燁潐濞叉鎹㈤崒鐐茬厺閹兼番鍔岀粻濠氭倵閸︻厼校闁硅弓鍗冲缁樼瑹閿熻棄顭囪閹囧幢濞存澘娲︾�电厧顫㈤妶鍜佹█鐎规洖銈告俊鐑芥晜閹冪瑲闂傚倷绀侀幉锛勬崲閸屾粣鎷峰鐓庡⒋闁轰焦鎹囬幊鐐哄Ψ閿曪拷閿熻姤鍔栭妵鍕閳╁喚妫冮梺杞扮劍閹瑰洭寮幘缁樻櫢闁跨噦鎷�?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁炬儳顭烽弻锝夊箛椤掍焦鍎撶紓浣哄У濠㈡﹢鍩為幋锔藉亹鐎规洖娴傞弳锟犳⒑閹肩偛锟芥洟鎳熼婵堜簷闂備焦瀵х换鍌炲箠鎼淬劌姹查柣鎰劋閻撴盯鏌涘☉鍗炴灓缂佺姷鍋ら弻锛勪沪鐠囨彃顫囬悗娈垮櫘閸撶喎鐣疯ぐ鎺濇晩閻熸瑥瀚惁閬嶆⒒閸屾瑧鍔嶆俊鐐叉健瀹曘垽鎮￠獮顒佺☉铻栭柛娑变悍閹风兘鏁傞悙顒�纾梺闈涱煭缁犳垹澹曢鐐粹拺闁诡垎鍛唶濠电媴鎷烽弶鍫涘妼椤曢亶鏌涢妷銏℃珖缁炬儳銈搁弻锝夊箛闂堟稑顫╅梺鍛婃煟閸婃繈寮婚弴銏犻唶闁绘梻顭堥敓鑺ュ姉閿熻姤顔栭崰娑㈩敋瑜旈崺銉﹀緞婵犲孩鍍靛銈嗗姧缁茶姤鍒婃导瀛樷拻濞达絽鎲￠崯鐐烘煙缁嬫寧顥㈢�规洜鍠栭、鏇㈡晲閸パ嗘嫬闂傚倸鍊搁崐鎼佸磹妞嬪海鐭嗗〒姘炬嫹妤犵偛顦甸弫鎾绘偐閼艰埖鎲伴梻渚�娼ц噹闁告侗鍨抽崢鐘绘⒒娴ｅ湱婀介柛銊ヮ煼閳ワ箓宕奸悤浣规暞闂傚倸鍊风粈渚�骞夐垾瓒佹椽鏁冮崒姘�梺瑙勵問閸犳碍绋夊澶嬬厵闁诡垱婢樿闂佺粯鎸婚悷鈺呭蓟閻旂儤鍠嗛柛鏇ㄥ亜椤酣姊洪崜鎻掍航濞存粠浜濠氬Ω閳哄倸浜滈柣鐘叉处閻ｎ偊骞樼紒妯轰缓濡炪倖鐗撻崐妤冨姬閿熶粙鎮楀▓鍨灈妞ゎ厾鍏橀獮鍐閳藉棙效闁瑰吋鐣崹娲偪閸岀偞鈷掗柛灞剧懅鐠愪即鏌涘▎蹇曠缂侇喖顭烽獮瀣晝閿熺晫绮堥崼銉︾厱妞ゆ劧绲剧粈鍐煕婵犲嫭鏆柟顔煎槻閳诲氦绠涢幙鍐х棯缂傚倷绶ら幏鐑芥煕椤愩倕鏋傚ù婊勭矋閵囧嫰骞樼捄杞版埛婵犫拃宥囩М闁哄矉缍�缁犳盯骞橀搹顐ｎ唹缂傚倷鑳剁划顖炴儎椤栫偟宓佹俊顖滃帶椤ユ岸鎮楅敐搴濇喚婵☆偆鍠栧缁樻媴閻熼偊鍤嬪┑鐐寸ゴ閺呮繄鍒掓繝姘闁挎梻娅㈤幏鐑藉籍閸繄顦ㄥ銈嗘婵倕鈻嶉姀銈嗏拺閻犳亽鍔屽▍鎰版煙閸戙倖瀚�.");
			return;
		}

		// 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣洴钘濋柣銏㈩焾閺嬩線鏌熼崜褏甯涢柛瀣姍閺屾盯骞囬姘卞闂佹眹鍨荤划顖涚┍婵犲洦鍊锋い蹇撳閹风兘寮介鐔蜂罕濠电姴锕ら悧鍡欏缂佹绠鹃柟瀛樼懃閻忊晠鏌涢妸銉ワ拷鍧楀蓟濞戞矮娌紓浣靛灩濞堁囨偡濠婂懎顣奸悽顖涘笧缁牓宕掗悙瀵稿幈闂婎偄娲﹂懝鐐閸︻厾纾奸悗锝庝簼閸犳ɑ鎱ㄦ繝鍐┿仢妤犵偞鐗犻幃娆撳箵閹烘繄锟芥娊姊绘担渚劸闁挎洏鍊曢…鍥晸閻樺啿浠掑銈嗘穿閹烽锟芥鍠曠划娆撳灳閺嶎厼唯闁靛鏅涘鏉款渻閵堝啫鐏い銊ワ躬瀵偊骞樼�靛壊娴勯柣搴秵閸嬪嫰鏁撻崐鐔风厫闁靛洤瀚板顒�鈻庨悙顒傜◥濠电偛鐡ㄧ划宥囧垝閹捐钃熺�广儱妫欐慨婊堟煙濞堝灝娅樻俊宸枤缁辨挻鎷呴崫鍕綑闂佹悶鍎崝搴ㄥ储椤忓牊鈷戦柟鑲╁仜閸旓拷闂佸憡鍔曡ぐ鐐垫閺冿拷娣囧﹪濡堕崶顬儵鏌涚�ｎ偆鈽夐悡銈嗐亜閹惧崬鐏╅柡鍕╁劦閺屽秹鍩℃担鍛婃闂佽崵鍠撻幊鎾诲煘閹达附鍋愰柟缁樺笚濞堫厼顪冮妶鍛闁绘牜鍘ч～蹇撁洪鍕炊闂佸憡娲﹂崢鎼佸几閸℃稒鈷戦柛娑樷檨閼测晛鍨濇繛鍡楃箳閺嗭箓鏌熸潏鍓х暠闁绘挻鐩弻娑樷槈閸楃偞鐏撻梺鍛婎焾濡嫰鈥旈崘顔嘉ч柛娑卞灣椤斿洭姊洪悷鏉挎毐缂佺粯锚閻ｇ兘骞囬悧鍫濆壓濡炪倕绻愰悧濠囧煕閹烘鐓曢悘鐐村礃婢规﹢鏌ㄩ悢璇残撻柟顔煎�搁悾鐑藉箛椤撗勑ч柟鑹版彧缁插潡鎮為崗鑲╃閺夊牆澧界粔顒佷繆濡炵厧濮傞柟顔惧仦缁绘繈宕堕妸褍骞堟繝鐢靛仦閸ㄥ爼鎮烽敂鍓х闁瑰濮风壕濂告煟濞嗘瑦瀚归梺鎼炲妼閻栫厧顕ｆ繝姘╅柍鍝勫�告禍鐐烘⒑缁嬫寧婀扮紒瀣灴椤㈡棃鏁撻敓锟�?
		Npc npc = SceneNpcManager.selectNpcByKey(npckey);
		if (npc == null){
			Module.logger.error("闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊為悷婊冪箻瀵娊鏁冮崒娑氬幈濡炪値鍘介崹鍨濠靛鐓曟繛鍡楃箳缁犳娊鏌ㄩ悢鍑ゆ嫹閻曚焦缍堝┑鐐插级閻楁洜鍙呴梺闈浥堥弲婊堝磿濡ゅ懏鐓曢柍鈺佸枤濡懐鎲搁悧鍫濈瑲闁哄懏鐓￠弻娑樷槈閸楃偛瀛ｅ┑鈽嗗亜閻倸顫忛搹鍦＜婵☆垵娅ｉ悷鎰磽娓氬洤鏋熼柣鐔叉櫅椤曪絿鎷犲顔兼倯婵犮垼娉涜癌闁靛ň鏅滈悡銉╂煛閸屾氨浠㈤柍閿嬫閺岋絽鈽夐崡鐐寸亪闂佸疇顫夐崹鍧楀箖濞嗘挸绾ч柟瀵稿С濡楁挻绻濆▓鍨灍閼垦囨煕閺冿拷閸ㄥ潡鐛崱妤冩殕闁告洦鍋嗛鎺旂磽閸屾瑧鍔嶆い顓炴喘瀹曘垽妫冨☉杈ㄥ瘜闂侀潧鐗嗗Λ娆戜焊閻㈠憡鐓曢柣妯挎珪瀹曞本銇勯姀鈩冾棃鐎殿喖鐖奸獮瀣籍閿熶粙寮敓浠嬫⒒娴ｈ櫣甯涢柨姘舵煟韫囨柨鍝虹�殿喗濞婇崺锟犲川椤旀儳骞堥梺璇插嚱缂嶅棝宕滃▎鎰浄閺夊牃鏅幏椋庢喆閸曨剛顦ョ紓鍌氱Т閿曘倝鎮鹃柨瀣檮缂佸鐏濆畵鍡涙⒑缂佹ê濮堟い鏃�鐗犲畷顒勫醇閺囩啿鎷绘繛杈剧到閹诧繝宕悙鐢电＜闁告繂瀚崑銉э拷瑙勬礃濞茬喖鐛惔銊﹀殟闁靛鍎辨竟鎺楁⒒娴ｇ儤鍤�濠⒀呮櫕閸掓帡顢涢悙鏉戜簵濠电偛妫欓崹鍦閽樺褰掓晲婢跺閿梺璇茬箚閺呯娀寮婚敍鍕舵嫹閿濆骸澧柡瀣洴閺岋紕浠﹂崜褋锟芥帡鏌ㄩ悢鍛婄伄缂佹彃顭峰畷婵嗙暆閸曨剚娅㈤梺鍏间航閸庡磭绮婚悙纰夋嫹濞堝灝鏋涙い顓炲槻椤曪綁骞橀钘変簻闂佹儳绻楅鏍疮鎼淬劍鈷掑ù锝堟鐢盯鏌涢弮鎾剁暤鐎规洘绮岄～婵嬫嚋闂堟稐鎴烽梻浣告惈閸燁偊鎮ф繝鍥х厱闁硅揪闄勯悡鏇㈡煥閺冨浂鍤欐鐐搭殕閵囧嫯绠涢弴鐐寸亪闂佸搫鐬奸崰鏍х暦濞嗘挸围闁糕剝顨忔导锟�? 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闂囧鏌ㄥ┑鍡欏闁靛棗鍟撮弻锝夊箳閹搭垵鍚梺鍝勬湰缁嬫垿鍩ユ径濞炬瀻闁归偊鍠氶埢蹇曠磽閸屾瑨鍏屽┑顖ｅ弮瀹曞綊宕奸弴鐐舵憰闂侀潧艌閺呮粓宕戦崱娑欑厱閻忕偛澧介埥澶嬨亜韫囥儲瀚�? " + npckey);
			return;
		}
		final SNpcShare share = NpcManager.getInstance().getNpcShareByID( npc.getNpcID() );
		if ( share == null ){
			Module.logger.error("闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊為悷婊冪箻瀵娊鏁冮崒娑氬幈濡炪値鍘介崹鍨濠靛鐓曟繛鍡楃箳缁犳娊鏌ㄩ悢鍑ゆ嫹閻曚焦缍堝┑鐐插级閻楁洜鍙呴梺闈浥堥弲婊堝磿濡ゅ懏鐓曢柍鈺佸枤濡懐鎲搁悧鍫濈瑲闁哄懏鐓￠弻娑樷槈閸楃偛瀛ｅ┑鈽嗗亜閻倸顫忛搹鍦＜婵☆垵娅ｉ悷鎰磽娓氬洤鏋熼柣鐔叉櫅椤曪絿鎷犲顔兼倯婵犮垼娉涜癌闁靛ň鏅滈悡銉╂煛閸屾氨浠㈤柍閿嬫閺岋絽鈽夐崡鐐寸亪闂佸疇顫夐崹鍧楀箖濞嗘挸绾ч柟瀵稿С濡楁挻绻濆▓鍨灍閼垦囨煕閺冿拷閸ㄥ潡鐛崱妤冩殕闁告洦鍋嗛鎺旂磽閸屾瑧鍔嶆い顓炴喘瀹曘垽妫冨☉杈ㄥ瘜闂侀潧鐗嗗Λ娆戜焊閻㈠憡鐓曢柣妯挎珪瀹曞本銇勯姀鈩冾棃妤犵偞锕㈤、娆戞喆閿濆棗顏洪梻鍌欒兌椤牓寮甸鍕殞濡わ絽鍟弲鎼佹煟閿濆懓瀚伴柛妯绘尦閺岀喖顢欓幆褌妲愰梺杞扮閸熸潙鐣烽幒鎴旀婵☆垰鎼ˉ鎰版⒑閼姐倕鏋戠紒顔煎閺呰泛螖閸愨晜娈伴梺鍦劋濮婂鎯岄崱妤婄唵閻犻缚娅ｉ悞鍧楁煙妞嬪骸鍘撮柟顖氬�垮畷銊︾節閸屻倓绱﹂梻鍌氬�风粈渚�骞夐垾瓒佹椽鏁冮崒姘憋紱闂佸憡渚楅崢娆撴晲婢舵ɑ鏅㈤梺鍛婃处閸忔﹢骞忓ú顏呪拺闁告稑锕ョ亸顓狅拷娈垮枛婢у骸鈻庨姀鐘闁靛骏绱曢崢鐢告⒑閸涘﹤鐏熼柛濠冪墱閿熻姤鐔幏锟� 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闂囧鏌ㄥ┑鍡欏闁靛棗鍟撮弻锝夊箳閹搭垵鍚梺鍝勬湰缁嬫垿鍩ユ径濞炬瀻闁归偊鍠氶埢蹇曠磽閸屾瑨鍏屽┑顖ｅ弮瀹曞綊宕奸弴鐐舵憰闂侀潧艌閺呮粓宕戦崱娑欑厱閻忕偛澧介埥澶嬨亜韫囥儲瀚�? " + npc.getNpcID() + "闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閳╁啯鐝曢梻浣藉Г閿氭い锔诲枤缁辨棃寮撮姀鈾�鎷绘繛杈剧秬濞咃綁濡存繝鍥ㄧ厱闁规儳顕粻鐐烘煙閽樺锟藉鏁撻弬銈囩У闁哥姵鐗犻幃娆愮節閸愶缚绨婚梺鐟版惈缁夊爼藝閿曪拷闇夐柣妯煎劋椤忕姷绱掓潏銊﹀鞍闁瑰嘲鎳樺畷婊堝箵閹烘垵顥庨梻浣筋嚙濞寸兘鎮烽幎钘夌倞闁靛鍎婚幏鐑藉垂椤愮姳绨婚梺鍦劋閸ㄧ敻顢旈鍫熺厓闂佸灝顑呴悘鎾煙椤旇偐绉烘鐐扮窔楠炴帡骞嬪┑鎰拷铏節閻㈤潧浠滈柟鍐茬箻瀹曟繂鈻庨幘瀹犳憰闂佺粯姊婚崢褏绮堥崟顖涚厪闁割偅绻冮ˉ婊勩亜韫囥儲瀚� share婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鐐劤椤兘寮婚敐澶婄疀妞ゆ帊鐒﹂崕鎾绘⒑閹肩偛濡奸柛濠傛健瀵鈽夐姀鈺傛櫇闂佹寧绻傚Λ娑⑺囬妷褏纾藉ù锝呮惈鏍″┑鐘灪椤牓鎮橀崘顔解拺闁圭娴风粻鎾绘煙閸愭煡鍙勭�殿喗濞婇幃娆撴倻濡厧骞堥梺纭呭閹活亞妲愰弴鐔告珡闂傚倷绀侀幖顐︽儗婢跺瞼绀婂ù锝呭閸ゆ洖霉閻樺樊鍎忛幆鐔兼⒑闂堟侗妾ч梻鍕閳绘捇銆傞敓锟�");
			return;
		}
		if ( share.npctype == 5 ) {
			Role role = RoleManager.getInstance().getRoleByID(roleid);
			if(!role.checkDistance(npc,400)){
				Module.logger.error("闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊為悷婊冪箻瀵娊鏁冮崒娑氬幈濡炪値鍘介崹鍨濠靛鐓曟繛鍡楃箳缁犳娊鏌ㄩ悢鍑ゆ嫹閻曚焦缍堝┑鐐插级閻楁洜鍙呴梺闈浥堥弲婊堝磿濡ゅ懏鐓曢柍鈺佸枤濡懐鎲搁悧鍫濈瑲闁哄懏鐓￠弻娑樷槈閸楃偛瀛ｅ┑鈽嗗亜閻倸顫忛搹鍦＜婵☆垵娅ｉ悷鎰磽娓氬洤鏋熼柣鐔叉櫅椤曪絿鎷犲顔兼倯婵犮垼娉涜癌闁靛ň鏅滈悡銉╂煛閸屾氨浠㈤柍閿嬫閺岋絽鈽夐崡鐐寸亪闂佸疇顫夐崹鍧楀箖濞嗘挸绾ч柟瀵稿С濡楁挻绻濆▓鍨灍閼垦囨煕閺冿拷閸ㄥ潡鐛崱妤冩殕闁告洦鍋嗛鎺旂磽閸屾瑧鍔嶆い顓炴喘瀹曘垽妫冨☉杈ㄥ瘜闂侀潧鐗嗗Λ娆戜焊閻㈠憡鐓曢柣妯挎珪瀹曞本銇勯姀鈩冾棃妤犵偞锕㈤、娆戞喆閿濆棗顏洪梻鍌欒兌椤牓寮甸鍕殞濡わ絽鍟弲鎼佹煟閿濆懓瀚伴柛妯绘尦閺岀喖顢欓幆褌妲愰梺杞扮閸熸潙鐣烽幒鎴旀婵☆垰鎼ˉ鎰版⒑閼姐倕鏋戠紒顔煎閺呰泛螖閸愨晜娈伴梺鍦劋濮婂鎯岄崱妤婄唵閻犻缚娅ｉ悞鍧楁煙妞嬪骸鍘撮柟顖氬�垮畷銊︾節閸屻倓绱﹂梻鍌氬�峰ù鍥р枖閺囥垹绐楃�广儱娲ら崹婵囩箾閸℃ɑ灏柡瀣╃窔閺岀喖宕滆鐢盯鏌涢妶鍛ч柡灞炬礃瀵板嫰宕煎┑鍡楊潛婵犳鍣徊浠嬫偋閹炬剚娼栨繛宸簻缁犲綊鏌ｉ幇顓炵祷妞ゎ剙鐗忕槐鎺楀礈瑜戝鎼佹煕濞嗗繐鏆欓柣锝呭槻椤繄鎹勯搹璇″敽婵犲痉鏉匡拷鎾绘倿閿曪拷閳诲秴顭ㄩ崼鐔叉嫼闂佸憡绋戦敃锝囨閸楃伝鐟邦煥閸曨厾鐤勯梺鎸庣箘閸嬫盯顢樻總绋垮窛妞ゅ繐鎳忛弶鍛婁繆閻愵亜锟芥牕顫忔繝姘仱闁哄啫鐗婇崐鍧楁煙椤栵絿浜归柣鐔煎亰閻撱儵骞栫划鐧告嫹閺傘儲瀚梻鍌欐祰椤曟牠宕板璺虹；闁靛牆鎳愰弳锔剧磼鐎ｎ収鍤﹂柡鍐挎嫹闁瑰嘲鎳樺畷锝嗗緞婵犲簼绱梻鍌氬�搁崐椋庣矆娓氾拷楠炲鏁嶉崟顒�搴婇梺绋挎湰缁綁骞忓畡閭︽僵闁绘挸楠搁埛瀣渻閵堝啫鐏俊顐㈠暣瀹曟椽鏁撻悩鑼槰濡炪倕绻愬Λ瀵告閼碱剛纾介柛灞捐壘閿熺晫鍏橀幃鐐烘晝閸屾稒娅旂紓鍌氬�烽悞锕傚Φ閸℃稑宸濇い鏍ㄧ玻缁卞弶淇婇悙顏勶拷鏍ь潖婵犳艾鐓曢柛顐犲劜閸嬪倿鏌ゅù瀣珨闁瑰嘲鍢查埢鎾诲垂椤旂晫浜炵紓鍌欑贰閸犳鎮烽埡鍛ュù锝呭濞笺劑鏌ㄩ悢鍓佺煓妤犵偛鍟埢搴ㄥ箻閺夋垳缂撻梻浣告啞缁哄潡宕曟潏鈺冪焼闁割偁鍎查埛鎺楁煕鐏炴崘澹橀柨鐔绘閸㈡煡婀侀梺鎼炲劀閿熶粙寮搁弽顓熺厸闁搞儯鍎遍悘鈺呮⒒閸屻倕鐏﹂柡灞诲姂瀵挳鎮欑拠褎瀚归柛婵勫劤娑撳秵銇勯弽顐沪闁绘挶鍎甸弻锝夊即閻愯鎷烽崷顓ㄦ嫹濮樼偓瀚�? 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闂囧鏌ㄥ┑鍡欏闁靛棗鍟撮弻锝夊箳閹搭垵鍚梺鍝勬湰缁嬫垿鍩ユ径濞炬瀻闁归偊鍠氶埢蹇曠磽閸屾瑨鍏屽┑顖ｅ弮瀹曞綊宕奸弴鐐舵憰闂侀潧艌閺呮粓宕戦崱娑欑厱閻忕偛澧介埥澶嬨亜韫囥儲瀚�? " + npc.getNpcID());
				return;
			}
			gatherProcess( roleid, share.id );
			return;
		}
		if (!fire.pb.map.SceneNpcManager.checkDistance(npckey, roleid)){
			Module.logger.error("npc闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕婵犲倹鍋ラ柡灞诲姂瀵挳鎮欑拠褎瀚圭憸鐗堝笒绾惧潡鏌熺�电校闁哥姵鍔欓弻锝呂旈敓浠嬫偋閸℃瑧绠旈柟鐑樻⒒绾惧ジ鏌ㄩ悢璇残撶�垫澘瀚悾婵堬拷锝庡亜椤忓爼姊虹拫搴″暞閸熺偤鎮楀顒傜Ш婵﹨娅ｉ幑鍕Ω閵夛妇锟借櫣绱撴笟鍥ф灍闁荤啿鏅涢锝夘敃閿曪拷缁犺崵绱撴担濮戭亜鈻撻悢鍏尖拺闂傚牊渚楀Σ鍫曟煕鎼粹�宠埞鐞氭瑩鏌涢鐘插姕闁抽攱鍨块弻鐔兼嚃閳轰椒绮舵繝寰枫倕浜归柣銉簽缁辨帡濮�閻樿尙鐫勯柣搴ゎ潐濞叉ê鐣濋幖浣哄祦闁圭儤鍤﹂弮锟介幏鍛喆閸曨厼绀侀梻鍌氬�风粈渚�骞夐埄鍐懝婵°倓鑳堕々鍙夌節闂堟侗鍎滅紓宥嗙墱閿熻棄绠嶉崕閬嶅箠婢舵劕缁╅柤鎭掑劘娴滄粓鏌￠崘銊ワ拷濠氬箺閸岀偞鐓熼柟鐑樻尭閸斻倝妫佹径瀣瘈濠电姴鍊块妤�顭胯閹告娊寮婚悢纰辨晩闁诡垎鍌涱潟闁诲氦顫夊ú婊堚�﹂崼锝囦簷濠电偠鎻徊钘夘嚕閸撲緤鎷峰顑惧仮婵﹦绮幏鍛村川婵犲倹娈樼紓鍌欐祰椤曆囧磹婵犳碍鏅搁柤鎭掑劚閸ゎ剟鏌涢幘璺烘灈闁靛棔绶氬顕�宕煎┑鍫濆箰闂備礁鎲￠崝锔界閻愮儤鏅繝濠傛噽绾句粙鏌涚仦鍓ф噮闁告柨绉归弻銊ヮ潩鏉堚晝锛滃┑锛勫剳缁犳垿骞婇幇顔碱棜闁稿繒顑曟禍婊堟煛閸愩劌锟界敻骞忛敓鐘崇厽闁瑰墽鎳撴禍褰掓煥閻旇袚妞ゆ梹鐗犲畷浼村即閻樻彃鐏婂┑鐐叉閹稿爼鏁撻幋鎺旑槮妞ゎ偅绮撻弫鎾寸鐎ｎ亞鐣哄┑鐐叉閹稿宕戦妸鈺傜厱婵犻潧瀚崝姘辩磼閿熶粙宕奸妷锔规嫽闂佺鏈懝楣冩晸閽樺妲婚棁澶愭煕閵夋埊鎷烽柡瀣墵閺岋繝宕堕妷銉т患闂傚倸鍋嗛崹鍫曞蓟閵娾晛鍗抽柣鎰嚋閹风兘宕妷褌绗夊銈嗙墱閸嬬偤鎮￠妷鈺傜厽闁哄洨鍋涢敓钘夋贡閿熻姤鐔幏锟�? 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闂囧鏌ㄥ┑鍡欏闁靛棗鍟撮弻锝夊箳閹搭垵鍚梺鍝勬湰缁嬫垿鍩ユ径濞炬瀻闁归偊鍠氶埢蹇曠磽閸屾瑨鍏屽┑顖ｅ弮瀹曞綊宕奸弴鐐舵憰闂侀潧艌閺呮粓宕戦崱娑欑厱閻忕偛澧介埥澶嬨亜韫囥儲瀚�? " + npc.getNpcID());
			return;
		}
		fire.pb.team.Team team = fire.pb.team.TeamManager.selectTeamByRoleId(roleid);
		if (team != null) {
			if (team.isTeamLeader(roleid)) {
				if (share.share==1) {
					for (Long member : team.getNormalMemberIds()) {
						onVisitNpc( member, share );
					}
				} else {
					onVisitNpc( roleid, share );
				}
			} else {
				if ( team.isAbsentMember( roleid ) ) {
					onVisitNpc( roleid, share );
				}
			}
		} else {
			onVisitNpc( roleid, share );
		}
	}

	

	private boolean checkNpcVisitable(long roleid) {

		// 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閳╁啯鐝栭梻浣芥硶閸犳捇寮查銈呭灊濠电姵纰嶉崑鎰版偣閸ヮ亜鐨烘い鏃�鍔曢埞鎴︽倻閸モ晝校闂佸憡鎸婚悷锔界┍婵犲洦鍤冮柍鍝勫暟閿涙粓姊虹紒妯忚偐鎷冮敃锟介…鍥箛閻楀牏鍘梺鎼炲劀閸愬彞绱旀俊銈囧Х閸嬫稑煤椤撶偟鏆︽繝濠傚婵挳鏌ゆ禒瀣暠闁搞劌鐏濋～蹇撁洪鍕獩婵犵數濮寸�氼參宕宠缁辨挻鎷呴搹鐟扮闂佹寧娲忛崹浠嬬嵁閸愵喗鏅搁柣娆欐嫹闁轰礁鍟撮弻銊╁即椤忓懎顏堕梻浣虹帛閸旀洟鏁冮鍫濊摕闁哄洨鍠撶弧锟介棅顐㈡处閹尖晛煤椤撶儐娓婚柕鍫濈箺缁�瀣煕閺冿拷閸ㄥ灝顕ｆ繝姘櫜闁糕剝锚閸斿懘姊洪棃娑氱疄闁糕晛瀚板鎶芥晸閻樺啿锟界敻鏌ｈ閹诧紕锟芥艾缍婂楦裤亹閹烘搫绱电紓渚婃嫹濞撴熬鎷烽柟閿嬪灴閹垽宕楅懖鈺佸汲闂備胶绮弻銊╁箹椤愩垻鎽ラ梻鍌欒兌缁垶宕濋弴銏℃櫇妞ゅ繐鐗嗛拑鐔猴拷骞垮劚濡瑦鎱ㄥ鍫熺厵婵炲牆鐏濋弸鐔兼煕鐎ｆ柨娲﹂埛鎴︽⒒閸喍绶辨俊鍙夋尦閺岋繝宕ㄩ鍓х厜闂佽鍣换婵嬪箖閵忋倕绠归柣鎰閻╁酣姊绘担绛嬫綈鐎规洘锚閳绘柨鈽夐姀鐘殿槶闂佽鍎兼慨銈壦夋繝鍐︿簻闁圭儤鍩堝Σ绋款熆瑜庨幐鎶藉蓟閿涘嫪娌梻鍫氭櫆鐎氬湱锟借娲栧ú锕�鈻撻弴銏＄厽閹兼惌鍨崇粔鐢告煕閹惧顬奸柍顏勭仛缁绘繈鎮介棃娴躲儲銇勯敐鍕煓鐎规洘绮岄埞鎴狅拷锝庝簽閻ｆ椽姊虹粙鎸庢拱缂佸鍔楅幑銏ゅ幢濞戞瑧鍘介梺纭呮彧缁查箖藟婢舵劕鑸规い鏍ㄥ嚬濞撳鏌曢崼婵囶棡妞ゃ儱妫涢敓鍊燁潐濞叉粓寮崨濠勭彾闁哄洨濮风壕鍏间繆椤栨繂浜归柣锕�鐗撳鍝勑ч崶褏浼堝┑鐐板尃閸″繐寰旈梻鍌氬�烽悞锕傚箖閸洖绀夌�癸拷閸曨倠褔鏌熼梻瀵稿妽闁哄懏鐓￠弻锝夊箛椤撶喓绋囩紓浣稿閸嬨倝骞冨锟介幃娆撴濞戞顥氭繝鐢靛仜閻楀懘宕￠崘宸綎婵炲樊浜滈幑鑸点亜閹捐泛浠滃┑鈥虫惈椤啴濡堕崘銊ヮ瀳闂佺娅曢敃銏ょ嵁閸愵喖鐏抽柡鍌樺劜閺傦拷闂佽鍑界紞鍡涘磻閸℃稑鍌ㄩ柣銏犳啞閳锋垿鎮归崶锝忔嫹瀹曞浄鎷锋繝姘�堕柣鎰硾琚氬銈嗘煥缁夊墎妲愰幘璇茬＜婵炲棙甯╅崬鐟扳攽閳╁啫绲婚悗姘嵆閻涱喛绠涘☉娆忥拷濠氭煠閹帒鍔楅柟椋庣帛缁绘稒娼忛崜褍顕遍柣鐙呮嫹闁挎洖鍊归崐鍨旈敐鍛殲闁稿濮甸幈銊ノ熼悡搴′粯婵炲瓨绮嶆竟鍡涙晸閸婄噥娼愭繛鍙夛耿瀹曟繂鈻庤箛锝呮婵炲濮撮鎰板极閸曨垱鐓㈡俊顖欒濡插綊鏌涙繝鍌炲弰婵﹤顭峰畷鎺戭潩椤掑﹥瀚归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氫即宕戞繝鍌橈拷鎺撶節濮橆厾鍘甸梺缁樺灦钃遍柍閿嬪姈閵囧嫰顢曢敐鍡欘槰闂侀潧娲ょ�氭澘顕ｉ幘顕呮晜闁告侗鍙庢导鎾斥攽鎺抽崐妤佹叏閻戣棄纾绘繛鎴炵瀹曞弶鎱ㄥΔ瀣閻庢鍣崑濠囩嵁濡偐纾兼俊顖滅帛椤忕喖姊绘担鑺ョ《闁革綇绠撻獮蹇涙晸閿燂拷?
//		if(!fire.pb.activity.keju.KejuManager.getInstance().checkNpcVisitable(roleid,npckey)){
//			Module.logger.info("闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閳╁啯鐝栭梻浣芥硶閸犳捇寮查銈呭灊濠电姵纰嶉崑鎰版偣閸ヮ亜鐨烘い鏃�鍔曢埞鎴︽倻閸モ晝校闂佸憡鎸婚悷锔界┍婵犲洦鍤冮柍鍝勫暟閿涙粓姊虹紒妯忚偐鎷冮敃锟介…鍥箛閻楀牏鍘梺鎼炲劀閸愬彞绱旀俊銈囧Х閸嬫稑煤椤撶偟鏆︽繝濠傚婵挳鏌ゆ禒瀣暠闁搞劌鐏濋～蹇撁洪鍕獩婵犵數濮寸�氼參宕宠缁辨挻鎷呴搹鐟扮闂佹寧娲忛崹浠嬬嵁閸愵喗鏅搁柣娆欐嫹闁轰礁鍟撮弻銊╁即椤忓懎顏堕梻浣虹帛閸旀洟鏁冮鍫濊摕闁哄洨鍠撶弧锟介棅顐㈡处閹尖晛煤椤撶儐娓婚柕鍫濈箺缁�瀣煕閺冿拷閸ㄥ灝顕ｆ繝姘櫜闁糕剝锚閸斿懘姊洪棃娑氱疄闁糕晛瀚板鎶芥晸閻樺啿锟界敻鏌ｈ閹诧紕锟芥艾缍婂楦裤亹閹烘搫绱电紓渚婃嫹濞撴熬鎷烽柟閿嬪灴閹垽宕楅懖鈺佸汲闂備胶绮弻銊╁箹椤愩垻鎽ラ梻鍌欒兌缁垶宕濋弴銏℃櫇妞ゅ繐鐗嗛拑鐔猴拷骞垮劚濡瑦鎱ㄥ鍫熺厵婵炲牆鐏濋弸鐔兼煕鐎ｆ柨娲﹂埛鎴︽⒒閸喍绶辨俊鍙夋尦閺岋繝宕ㄩ鍓х厜闂佽鍣换婵嬪箖閵忋倕绠归柣鎰閻╁酣姊绘担绛嬫綈鐎规洘锚閳绘柨鈽夐姀鐘殿槶闁哄鐗勯崝搴ｇ不妤ｅ啯鐓犵痪鏉垮船婢у鏌ｉ幘璺哄彂,闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻锝夊箣閿濆憛鎾绘煕閵堝懎顏柡灞剧洴楠炴﹢鎳犻澶嬓滈梻浣规偠閸斿秶鎹㈤崘顔嘉﹂柛鏇ㄥ灠閸愶拷闂侀潧臎娓氬﹥瀚归柟鐑橆殕閻撶喐绻濋棃娑欘棤闁糕晪缍侀弻鈥崇暆鐎ｎ剛鐦堥悗瑙勬礀閻栧吋淇婇悜钘壩ㄧ憸宀勫箖閿濆鈷掑ù锝呮贡濠�浠嬫煕婵犲喚娈滅�规洘鍨块獮姗�鎳滈棃娑樼哎婵犵數鍋為崹顖炲垂閸︻厾涓嶉柨婵嗘缁犻箖鏌涢埄鍐炬畼缂佺姵濞婇弻娑㈠籍閿熶粙骞愰崘宸綎闁绘垶蓱婵粓鏌熷▓鍨珮婵″樊鍣ｅ娲箰鎼淬垻鈹涚紓浣哄У閹瑰洤顕ｉ锕�绠荤紓浣姑惂鍕節閵忥絾纭鹃柣顒�銈稿鍐测槈閵忊檧鎷虹紓浣割儏濞硷繝顢撳Δ鍐挎嫹鐟欏嫭澶勯柛鎾寸箞閹锟斤綆浜栭弨浠嬫煟閹邦厽缍戦柣蹇曞枛閺屾盯濡搁妷褏楔闂佽鍠掗敓鑺ユ灱閺�浠嬫倵閿濆骸浜為柛妯绘倐濮婃椽宕ㄦ繝鍌氼潎闂佸憡鏌ㄩ張顒傜矉瀹ュ棗顕遍悗娑欘焽閸樺灚淇婇悙宸剰濡ょ姵鎮傚畷銏ゅ箻椤旂晫鍘藉┑鐐村灥瀹曨剙鈻嶅鍥锋嫹鐟欏嫭绀�缂傚秴锕妴浣糕枎閹炬潙浜楅柟鍏兼儗閸犳绱為幘缁樷拻闁稿本鑹鹃敓鐣屽厴閹虫宕滄担绋跨亰濡炪倖鐗滈崑鎴︽晸閽樺鏆ｇ�规洏鍔戦、姗�宕堕妸褉妲堥梺瀹狀潐閸ㄥ灝鐣烽崡鐐╂瀻闁归偊鍙庨崯搴ㄦ⒒閸屾瑧绐旀繛浣冲懏宕查柛顐犲劚绾惧綊鏌￠崶鈺佇ュ☉鎾崇Ф缁辨挻鎷呮銊︾矋缁傚秴顭ㄩ崼鐔哄幐闂佸憡鍔戦崝宥嗗緞閸曨兙浜滈柕澶堝労濡叉悂妫佹径鎰厽婵炲棙鐟︾�氬綊姊洪幖鐐插濞存粠鍓熼獮鎴﹀閻橆偅顫嶅┑鐐叉閸旀绮旈崼鏇熲拺闁告稑锕ョ�垫瑩鏌涢幇鈺佸闁告ɑ甯″濠氬磼濞嗘帒鍘″銈冨灩閿曨亪銆佸顒夌叆闁告侗鍠栨惔濠傗攽閻樼粯娑ф俊顐ｇ洴瀵娊鏁冮崒娑氬幍闁哄鐗嗘晶浠嬫偩闁秴鑸规い鏍仦閳锋垿鏌熺粙鍨劉妞ゃ儱妫欑换娑欏緞鐎ｎ偆顦紓渚囧枦椤曆囷綖濠靛鏁嗗璺侯儏閻︽粓姊绘笟锟藉褔鎮ч崱妞㈡稑螖娴ｇ懓寮块梺鎸庢礀閸婂綊鎮￠弴銏＄厵闁诡垎鍛喖闂佹眹鍔嶉崹鍧楀蓟閵娾晜鍋勯悹鍥ㄧ暙閹剧粯鐓熼柡鍐╁灥婢у瓨顨ラ悙鑼闁轰焦鎹囬弫鎾绘晸閿燂拷:"+roleid);
//			return false;
//		}
		// 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忚埖淇婇妶鍥ラ柛瀣仱閹囨偐濮瑰浄鎷锋笟锟藉鎾閳╁啯鐝栭梻浣芥硶閸犳捇寮查銈呭灊濠电姵纰嶉崑鎰版偣閸ヮ亜鐨烘い鏃�鍔曢埞鎴︽倻閸モ晝校闂佸憡鎸婚悷锔界┍婵犲洦鍤冮柍鍝勫暟閿涙粓姊虹紒妯忚偐鎷冮敃锟介…鍥箛閻楀牏鍘梺鎼炲劀閸愬彞绱旀俊銈囧Х閸嬫稑煤椤撶偟鏆︽繝濠傚婵挳鏌ゆ禒瀣暠闁搞劌鐏濋～蹇撁洪鍕獩婵犵數濮寸�氼參宕宠缁辨挻鎷呴搹鐟扮闂佹寧娲忛崹浠嬬嵁閸愵喗鏅搁柣娆欐嫹闁轰礁鍟撮弻銊╁即椤忓懎顏堕梻浣虹帛閸旀洟鏁冮鍫濊摕闁哄洨鍠撶弧锟介棅顐㈡处閹尖晛煤椤撶儐娓婚柕鍫濈箺缁�瀣煕閺冿拷閸ㄥ灝顕ｆ繝姘櫜闁糕剝锚閸斿懘姊洪棃娑氱疄闁糕晛瀚板鎶芥晸閻樺啿锟界敻鏌ｈ閹诧紕锟芥艾缍婂楦裤亹閹烘搫绱电紓渚婃嫹濞撴熬鎷烽柟閿嬪灴閹垽宕楅懖鈺佸汲闂備胶绮弻銊╁箹椤愩垻鎽ラ梻鍌欒兌缁垶宕濋弴銏℃櫇妞ゅ繐鐗嗛拑鐔猴拷骞垮劚濡瑦鎱ㄥ鍫熺厵婵炲牆鐏濋弸鐔兼煕鐎ｆ柨娲﹂埛鎴︽⒒閸喍绶辨俊鍙夋尦閺岋繝宕ㄩ鍓х厜闂佽鍣换婵嬪箖閵忋倕绠归柣鎰閻╁酣姊绘担绛嬫綈鐎规洘锚閳绘柨鈽夐姀鐘殿槶闂佽鍎兼慨銈壦夋繝鍐︿簻闁圭儤鍩堝Σ绋款熆瑜庨幐鎶藉蓟閿涘嫪娌梻鍫氭櫆鐎氬湱锟借娲栧ú锕�鈻撻弴銏＄厽閹兼惌鍨崇粔鐢告煕閹惧顬奸柍顏勭仛缁绘繈鎮介棃娴躲儲銇勯敐鍕煓鐎规洘绮岄埞鎴狅拷锝庝簽閻ｆ椽姊虹粙鎸庢拱缂佸鍔楅幑銏ゅ幢濞戞瑧鍘介梺纭呮彧缁查箖藟婢舵劕鑸规い鏍ㄥ嚬濞撳鏌曢崼婵囶棡妞ゃ儱妫涢敓鍊燁潐濞叉粓寮崨濠勭彾闁哄洨濮风壕鍏间繆椤栨繂浜归柣锕�鐗撳鍝勑ч崶褏浼堝┑鐐板尃閸″繐寰旈梻鍌氬�烽悞锕傚箖閸洖绀夌�癸拷閸曨倠褔鏌熼梻瀵稿妽闁哄懏鐓￠弻锝夊箛椤撶喓绋囩紓浣稿閸嬨倝骞冨锟介幃娆撴濞戞顥氭繝鐢靛仜閻楀懘宕￠崘宸綎婵炲樊浜滈幑鑸点亜閹捐泛浠滃┑鈥虫惈椤啴濡堕崘銊ヮ瀳闂佺娅曢敃銏ょ嵁閸愵喖鐏抽柡鍌樺劜閺傦拷闂佽鍑界紞鍡涘磻閸℃稑鍌ㄩ柣銏犳啞閳锋垿鎮归崶锝忔嫹瀹曞浄鎷锋繝姘�堕柣鎰硾琚氬銈嗘煥缁夊墎妲愰幘璇茬＜婵炲棙甯╅崬鐟扳攽閳╁啫绲婚悗姘嵆閻涱喛绠涘☉娆忥拷濠氭煠閹帒鍔楅柟椋庣帛缁绘稒娼忛崜褍顕遍柣鐙呮嫹闁挎洖鍊归崐鍨旈敐鍛殲闁稿濮甸幈銊ノ熼悡搴′粯婵炲瓨绮嶆竟鍡涙晸閸婄噥娼愭繛鍙夛耿瀹曟繂鈻庤箛锝呮婵炲濮撮鎰板极閸曨垱鐓㈡俊顖欒濡插綊鏌涙繝鍌炲弰婵﹤顭峰畷鎺戭潩椤掑﹥瀚归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氫即宕戞繝鍌橈拷鎺撶節濮橆厾鍘甸梺缁樺灦钃遍柍閿嬪姈閵囧嫰顢曢敐鍡欘槰闂侀潧娲ょ�氭澘顕ｉ幘顕呮晜闁告侗鍙庢导鎾斥攽鎺抽崐妤佹叏閻戣棄纾绘繛鎴炵瀹曞弶鎱ㄥΔ瀣閻庢鍣崑濠囩嵁濡偐纾兼俊顖滅帛椤忕喖姊绘担鑺ョ《闁革綇绠撻獮蹇涙晸閿燂拷? end
		return true;
	}

	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 795433;

	public int getType() {
		return 795433;
	}

	public long npckey; // npckey为npc的唯一ID

	public CVisitNpc() {
	}

	public CVisitNpc(long _npckey_) {
		this.npckey = _npckey_;
	}

	public final boolean _validator_() {
		if (npckey < 0) return false;
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		_os_.marshal(npckey);
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		npckey = _os_.unmarshal_long();
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CVisitNpc) {
			CVisitNpc _o_ = (CVisitNpc)_o1_;
			if (npckey != _o_.npckey) return false;
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		_h_ += (int)npckey;
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append(npckey).append(",");
		_sb_.append(")");
		return _sb_.toString();
	}

	public int compareTo(CVisitNpc _o_) {
		if (_o_ == this) return 0;
		int _c_ = 0;
		_c_ = Long.signum(npckey - _o_.npckey);
		if (0 != _c_) return _c_;
		return _c_;
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}
