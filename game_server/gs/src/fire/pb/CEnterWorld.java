
package fire.pb;

import fire.pb.state.DRoleOnlineFail;
import fire.pb.state.PRoleOnline;
import fire.pb.state.StateManager;

// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __CEnterWorld__ extends mkio.Protocol { }

// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

public class CEnterWorld extends __CEnterWorld__ {
	@Override
	protected void process() {
		//XXX:濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌熼梻瀵割槮缁惧墽绮换娑㈠箣濞嗗繒鍔撮梺杞扮椤戝棝濡甸崟顖氱閻犺櫣鍎ら悗楣冩⒑閸涘﹦鎳冪紒缁樏～蹇旂節濮橆剟鍞堕梺缁樻煥婢у海鎹㈡担绯曟斀闁绘劖褰冮幃鎴︽煟濡ゅ啫鈻堢�殿喖顭锋俊鍫曞幢濡搫浼庨梻浣哥秺閸嬪﹪宕滈妸鈺佺闁绘垼妫勯崡鎶芥煏韫囨洖孝闁诲寒鍘奸埞鎴︽偐缂佹ɑ閿銈嗗灥濞差厼鐣烽敐澶婄缂備焦顭囬崢閬嶆⒑闂堟侗妾х紒鑼跺Г娣囧﹪宕稿Δ浣哄帗闂佸憡鐟ｉ崕宕囩玻閺冨牊鐓涢悘鐐插⒔濞叉潙鈹戦埄鍐ㄥ姸缂佺姵鐩顒�鈻庨崣銉у闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑鐐濡ょ姷鍋涢ˇ鐢稿极閹剧粯鍋愰柤纰卞墻濡茬兘姊绘担鐟邦嚋婵炲弶鐗犲畷鎰板箹娴ｅ摜锛滈梺闈涱焾閸庡秷銇愰幒鎾充汗閻庣懓澹婇崰鏍礈妤ｅ啯鈷戦弶鐐靛椤︾兘鏌ｉ幒鐐电暤妤犵偛鐗撴俊鎼佸Ψ椤旇棄缂撻梻浣虹《閸撴繈銆冮崨瀵稿祦閻庯綆浜栭弨浠嬫煃閳轰礁鏆欑紒鎻掝煼閺岋絽螖娴ｇ懓纾抽悗娈垮枛椤兘骞冮姀銈呯闁绘挸鍑介幏鐑芥煥鐎ｃ劋绨婚梺纭呮閸嬬偟锟芥俺顫夌换婵嬪煕閿熺晫浠﹂悾灞兼闂備礁鎼張顒傜矙閹烘绠氶柡鍐ㄧ墕椤懘鏌曡箛瀣伄闁告ɑ甯炵槐鎾诲磼濞嗘劗銈版俊鐐存綑閹芥粓寮鍢夋棃鏁撴禒瀣э拷锕傚炊椤忓棛鏉稿┑鐐村灦椤倿鍩￠崘鈺佹瀾闂婎偄娲︾粙鎺楀磻閳哄懏鐓熼柟瀵稿剱閻掔晫绱掗悩鑽ょ暫闁哄被鍔岄埞鎴﹀幢濡儤顏￠梻浣烘嚀閸氬宕濆▎鎾宠摕闁靛ň鏅涢崡鎶芥煏婵炲灝锟芥鎯勬惔銊︹拺濞村吋鐟ч幃濂告煕韫囨棑鑰块柣娑卞櫍楠炴帒螖閿熺晫绮婚敐澶嬬厸闁告劖瀵х�氱懓顪冮妶搴′簻缂佸鎸抽崺鐐哄箣閿旂粯鏅╅梺鍝勫�堕崐鎾舵閻㈠憡鈷戠紒瀣儥閸庡繘鎮楀顓熺凡闁伙絿鍏橀幃浠嬪川婵犲嫬濮搁柣搴＄畭閸庡崬螞瀹�鍕婵炲樊浜濋埛鎴︽煕濞戞﹫鍔熺紒鐘虫崌閹顫濋锟藉Σ濠氬础闁秵鐓欑紓浣靛灩閺嬬喖鏌ｉ幘瀵告创闁哄本绋戦埥澶愬础閻愬浜鹃梻浣规た閸樼晫鏁敓鐘茶摕闁绘梻鈷堥弫濠囨煙椤栧棗鍟粻锝呪攽閻樿尙妫勯柕鍫濇噽閸橆偊鎮楅崹顐ｇ凡閻庢凹鍣ｉ弫鎾诲棘閵堝洨校婵炲瓨绮嶇换鍫ュ箖閻愵剛闄勯柛娑樑堥幏缁樼箾鏉堝墽瀵奸悹锟介敃鍌氱哗濞寸厧鐡ㄩ悡娆愮箾閼奸鍞洪梺顓у灡閹便劍绻濇担铏圭厯閻庤娲滈崰鏍�佸☉姗嗘僵闁告鍋涚粻鐐烘⒒閸屾瑧顦︽繝锟介柆宥呯？闁靛牆顦敓钘夊暣瀹曞崬鈽夊Ο纭风串闂備礁澹婇悡鍫ュ磻閸℃瑧涓嶅Δ锝呭暞閻撴瑩鎮楅悽娈跨劸闁告挸宕湁闁绘挸瀛╅ˉ銏ゆ煛瀹�锟介崰鎾绘晸閻ｅ本鏆╂い顓炵墕閺嗏晛鈹戦悙鏉戠仸闁圭鎽滅划鏃囥亹閹烘垼鎽曢梺缁樻煥閸氬宕愮紒妯诲弿婵°倧鎷锋俊顐ｇ懇閹箖鎮滈懞銉㈡嫼缂傚倷鐒﹁摫閻忓繋鍗抽弻锝夊煛婵犲倻浠搁悗娈垮枦椤曆囧煡婢舵劕顫呴柣妯兼暩閺夋悂姊婚崒姘拷鎼佹偋婵犲嫮鐭欓柟瀵稿Х娑撳秹鏌ц箛鎾磋础缁炬崘鍋愮槐鎾存媴闂堟稓浠煎Δ鐘靛仦閿曘垽寮诲☉姘炬嫹閿濆骸浜濋悘蹇斿缁辨帒鐣濋崘顔兼懙缂備胶绮换鍫濈暦閸洘鍤嬮柛顭戝亝閻濐偄鈹戦悩鎰佸晱闁哥姵顨夐幗顐︽倵鐟欏嫭绀冮柨鏇樺灩閻ｇ兘濡烽埡濠冩櫇闂佽櫕鍎兼慨銈呂涢崘顔肩畺闁冲搫鎳忛ˉ鍫熺箾閹寸伝顏埶夐幇鐗堚拻濞达絽鎽滅粔鐑樸亜閵夛附宕岀�规洘顨呴～婊堟晸閽樺鍤曞┑鐘崇閸嬪嫰鏌涜箛鏇炲付濞存粍顨婇弻鐔兼嚌閻楀牆娑х紓浣圭叀缁犳牠鐛径鎰殐闁冲搫鍟伴敍婵囩箾鏉堝墽鎮奸柣鈩冩瀹曢潧鈻庨幘鏉戯拷鍨叏濮楀棗浜滅�规挸妫欓〃銉╂倷閹绘帗娈婚悗瑙勬礈椤牐鐏冮梺璺ㄥ枔閺咁偆鍒掗崼顫嫹閿濆骸浜栧ù婊勭矒閺屸�愁吋閸愩劌顬嬮梺闈涙鐢繝寮诲☉姗嗘建闁跨喕濮ょ粋宥囨崉娓氼垱缍庨梺鎯х箺椤鐣锋径鎰厪濠电偛鐏濋崝婊堟煟濠靛嫬鐏叉慨濠冩そ閹兘寮堕幐搴敤闂備胶鎳撻崵鏍箯閿燂拷?
		//TODO:10缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁惧墽鎳撻—鍐拷锝庝簼閹癸綁鏌ｉ鐐搭棞闁靛棙甯掗～婵嬫倷椤掞拷椤忓爼姊洪懞銉夋垹鎹㈤崼銉ヨ摕闁绘柨鐨濋弸鏃堟煕椤垵鏋熼柣蹇撶Ч濮婃椽宕崟顒夋！缂備緡鍠楅幑鍥ь嚕婵犳碍鍋勯柛蹇曞帶閿熺晫绮幈銊ノ旈敓钘壩涘▎鎾村仼闁割偅娲橀埛鎴︽煠濞村娅撻柣鎺戝⒔缁辨挸顓奸崪鍐惈閻庢鍠栭…鐑藉箖閵忋倖鎯為柛锔诲弿缁辨煡姊绘笟锟藉褏鎹㈤幒鎾村弿闁汇垹鎲￠崐鍫曟煕椤愮姴鍔滈柍閿嬪灦缁绘盯鎳犳０婵嗘濡ょ姷鍋為〃鍡涘Φ閸曨垰惟闁靛瀵屽Λ锔界節绾板纾块柡浣筋嚙閻ｇ兘鎮㈢喊杈ㄦ櫓闂佸憡鎸嗛崟顒傚竼闂傚倸鍊峰ù鍥綖婢舵劕纾块柟鍓佺摂閺佸銇勯幘鍗炵仼閸ユ挳姊洪崘鍙夋儓闁瑰啿绻橀崺娑㈠箣閿旂晫鍘卞┑鐘绘涧鐎氼剟宕濆顑炵懓顭ㄩ崘锕�浠梺鍝勬湰閻╊垰顕ｉ锟介弫鎾寸鐎ｎ亜鐎梺鍓茬厛閸ｎ噣宕甸弴鐐╂斀闁绘ê纾。鏌ユ煛閸涱喚鍙�闁哄本鐩、鏇㈩敃椤厾鍑归梻浣哥枃椤曆囁囬悧鍫⑩攳濠电姴娲﹂崐閿嬨亜韫囨挸顏甸柟椋庡厴瀵�燁槷闁哄鐗犻弻銊╁即閻愯鎷风粙娆惧晠婵犻潧娲㈡禍婊堟煛瀹ュ啫濡块柣顓滃�栨穱濠囧矗婢跺锟芥劙鏌″畝瀣ɑ闁诡垱妫冮弫宥夊礋椤撶喐顔嗛梻鍌欒兌椤牊顨ョ粙璺ㄦ殾妞ゆ帒鍟版禍杈ㄧ節閻㈤潧浠﹂柛顭戝灦瀹曠銇愰幒鎾充簵濠电娀娼ч鍡涙偂閵夆晜鐓熼柡鍥╁仜閿熻棄婀遍敓鑺ョ啲閹凤拷?婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鎯у⒔缁垳鎹㈠☉銏犵婵炲棗绻掓禒濂告⒑閸涘﹤鐏╁┑鐑囨嫹闂佸搫鐬奸崰鎾舵閹烘顫呴柣妯虹－娴滃爼姊绘担鍛婃儓闁瑰啿绻橀獮鍐磼閻愯尪鎽曢梺闈浥堥弲婊堝磻閸℃稒鐓曢悘鐐插⒔閳藉銇勮箛銉﹀?闂傚倸鍊搁崐鎼佸磹閹间礁纾归柣鎴ｅГ閸ゅ嫰鏌涢锝嗙５闁跨喐鏋荤粻鎾崇暦婵傜唯闁挎洩鎷烽柛鎾瑰煐缁绘繈妫冨☉姗堟嫹婵犳埃锟斤箓宕奸姀鐙�妫滄繝鐢靛У绾板秹鎮￠悢鍏肩厵闂侇叏绠戦獮鏍ㄣ亜閵夈儺鍎旈柡宀嬬節瀹曠喖顢曢～顔藉闁割煈鍣鏍р攽閻樺疇澹樼痪鎯у悑缁绘盯宕卞Ο铏圭懆闂佸憡锕换婵嬪蓟閿濆牏鐤�闁规儳澧庨悿鍕⒑閸涘﹥鈷愰柛銊ユ健閹即顢欑捄銊ф澑濠电偞鍨堕悷銉╂晸閽樺鐓奸柡灞诲�濋獮渚�骞掗幋婵嗩潛濠电偛顕刊顓㈠垂鐠轰警娼栨繛宸簻缁犲綊鏌ｉ幇顓炵祷濠殿喖鐭傚娲川婵犲啰鍙嗛梺娲诲墰閸樠囶敋閵夛妇绡�闁告洦鍘鹃敍婊冣攽閳藉棗鐏ユい鏇嗗喚鍤曢柛褎顨嗛埛鎴︽煙缁嬫寧鎹ｇ紒鐘虫崌閺岀喖鏌ㄧ�ｎ亞浼岄梺缁樻惄閸撶喖銆佸Δ鍛妞ゆ帒鍊搁獮鎰版⒑鐠囪尙绠抽柛瀣枛瀹曟垿骞橀崜浣虹劶闁诲函缍嗛崰妤呮偂濞戞◤褰掓晲閸偅缍堥悗瑙勬礀閻倿寮婚埄鍐╁閻熸瑥瀚壕鎶芥⒑鏉炴壆鍔嶉柟鐟版喘瀵偊骞樼紒妯绘闂佽法鍣﹂幏锟�?
		final int userId=((gnet.link.Dispatch)this.getContext()).userid;
		final xbean.User usr = xtable.User.select(userId);
		if(null == usr || !usr.getIdlist().contains(roleid))
		{
			StateManager.logger.error(new StringBuilder("CEnterWorld: 闂傚倸鍊搁崐鎼佸磹閹间礁纾圭�瑰嫭鍣磋ぐ鎺戠倞鐟滃繘寮抽敃鍌涚厱妞ゎ厽鍨垫禍婵嬫煕濞嗗繒绠婚柡宀嬬秮婵拷闁靛繆鏅濋崝鍝ョ磽娓氬﹥瀚规繝銏ｆ硾閺堫剟宕伴幇鎵彄闁搞儯鍔嶇粈锟介梺鎼炲妽缁诲倿鍩為幋锔藉亹閻庡湱濮撮ˉ婵堢磽娴ｅ搫顎撶紓宥勭窔瀵濡搁妷銏℃杸闂佺硶鍓濋〃鍡椻枔閵娿儮鏀芥い鏃�顑欏鎰亜閵娿儳澧㈡俊鍙夊姍楠炴锟芥稒锚椤庢捇姊洪崨濠勨槈闁挎洏鍎靛畷鏇㈠箻缂佹ǚ鎷洪梺鍛婃崄鐏忔瑩宕㈠鍫熺厵闁告垯鍊栫�氾拷 = ").append(userId).append("婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻鐔兼⒒鐎靛壊妲紒鎯у⒔缁垳鎹㈠☉銏犵闁绘劕鐏氶崳褏绱撴担绋款暢闁稿鍊濆璇测槈閵忕姈銊︺亜閺冨倸甯舵い顐熸櫇缁辨挻绗熸繝鍐伓闂備礁澹婇崑鍡涘窗閹捐泛濮柨鐔剁矙濮婂宕掑鍗烆杸缂備礁顑嗙敮锟犲极瀹ュ绫嶉柛顐ゅ枔閸橀箖姊洪崫鍕垫Ъ婵炲娲樼粋鎺楀閵堝棭姊挎繝銏ｅ煐閸旀牠鎮￠妷锔剧瘈闂傚牊绋掗ˉ鐘差熆瑜戞ご鍝ユ崲濞戙垹绀傞柣鎾抽椤矂姊婚崶褜妲圭紒缁樼箚椤︽煡鏌ｈ箛鏃傜疄闁轰焦鎹囬幊鐐哄Ψ瑜嶉埛鍫ユ⒑閻熸壆鐣柛銊ョ秺閸┿儲寰勯幇顒夋綂闂佺粯顭堢亸顏堟晸閽樺浠㈤柍瑙勫灦楠炲﹪鏌涙繝鍐╃妤犵偛锕ラ幆鏃堝煡閸℃顓垮┑鐐差嚟閸樠囨偤閵娾晛鐓曢柟杈鹃檮閻撴瑩鏌ゅù瀣珔濞寸姵绮撻弻銊╂偄鐠囨畫鎾寸箾閼碱剙鏋涢柕鍡曠窔瀵粙濡搁妷褏鐛梻浣哥秺閸嬪﹪宕滃☉銏″仼婵炲樊浜濋崐鐢告煟閻斿憡绶叉い蹇ｄ簻椤潡鎮烽柇锕�鍓堕悗娈垮枛閹诧繝骞嗛弮鍫澪╅柨鏃�鍎抽獮宥夋⒒閸屾瑧璐伴柛娆忕箳缁骞嬮悙瀛樼彿闂佺粯顨呴悧鍕濠婂牊鐓欓悗娑欘焽缁犳挻銇勮箛锝勭敖缂佽鲸甯炵槐鎺懳熼懖鈺冩澖濠电姵顔栭崳顖炲箯閻戣姤鈷戦梻鍫熺〒缁犳岸鏌ㄩ悢鍑ゆ嫹閻斿摜褰ч梺浼欑秵閸撶喎顫忕紒妯诲闁荤喖鍋婇崵瀣攽閻愰鍤嬮梻鍕缁顓兼径妯绘櫆闂佸憡娲熷褍鈻撻妸銉富闁靛牆妫楁慨褔姊婚崟顐㈩伃鐎殿喗鐓￠獮鏍ㄦ媴閸︻厼寮抽梻浣虹帛濞叉牠宕愰崷顓ㄦ嫹濮樼偓瀚�?").append(roleid).append(", 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊炲銈嗗笂缁�渚�宕滈鐑嗘富闁靛牆妫楁慨褏绱掗悩鍐茬伌闁绘侗鍣ｆ慨锟介柕鍫濇閸樻捇鏌℃径灞戒沪濠㈢懓妫濆畷婵嗩吋閸℃劒绨婚梺鍝勫�搁悘婵嬵敂椤愩倗纾奸弶鍫涘妽瀹曞瞼锟借娲樼敮鎺楋綖濠靛鏁嗗┑鐘插暙椤忓爼姊洪崨濠勭細闁稿孩濞婇幆宀勫箻缂佹ê锟界敻姊婚崼鐔衡檨闁瑰弶鎮傞弻锝夘敇閻旂纾冲┑顔硷工椤嘲鐣锋總鍛婂亜闁告挷鑳剁粻鎺楁⒒娴ｈ鍋犻柛濠冪墵閵嗗啯绻濋崶褑鎽曞┑鐐村灟閸ㄥ綊宕￠幎鑺ョ厪濠电偛鐏濋崝姘亜椤愵偂绨界紒杈ㄦ崌瀹曟帒顫濆В娆嶅灪缁绘稓鎷犺閻ｉ潧鈹戦敍鍕毈鐎规洜鍠栭、娑橆潩鏉堚晜婢戦梻鍌欑閻ゅ洤顩奸妸褏鐭嗗ù锝呮贡閻濊埖鎱ㄥΔ瀣濠殿喖锕ュ钘夌暦椤愶箑绀嬫い鎺炴嫹闁稿绉瑰娲箹閻愭彃顬夊┑锛勫仒缁瑩鐛崘顔筋�愮紓浣哄У缁嬫垿鍩ユ径濞炬瀻闁瑰瓨绻傚Ч鏌ユ⒒閸屾瑨鍏岀紒顕呭灠鐓ら柡宥庡幖绾惧綊鏌涢敂璇插伎闁瑰嘲鍢查～婵嬫倷椤掞拷椤忥拷?"));
			return;
		}
		StateManager.logger.info(new StringBuilder("roleid=").append(roleid).append(" 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪Ч濠�渚�姊虹紒妯虹仴妞ゎ偅娲熼弫鎾绘寠婢跺鎷烽崸妞硷拷浣割潩閼稿灚娅㈡繛瀵稿Т椤戝洤鐣垫笟锟介悡顐﹀炊閵娧�妾ㄩ梺鍝勬噺閹倿寮婚妸鈺傚亞闁稿本绋戦锟�?濠电姷鏁告慨鐑藉极閸涘﹥鍙忛柣鎴ｆ閺嬩線鏌涘☉姗堟敾闁告瑥绻橀弻锝夊閻樺樊妫岄梺杞扮閿曨亪寮婚垾鎰佸悑閹肩补锟藉磭顔愮紓鍌欑劍閸旀牠銆冩繝鍥ц摕闁炽儲鍓氶崥瀣箹缁櫢鎷烽崘宸妧闂傚倷娴囧銊х矆娴ｇ尨鎷峰顐㈠祮鐎殿喛顕ч埥澶愬閳哄倹娅囬梻浣虹帛椤牏浜稿▎鎰浄濡わ絽鍟崐鐢告偡濞嗗繐顏紒锟介敓浠嬫倵濞堝灝鏋涢柣鏍с偢閻涱噣宕奸妷銉庘晠鏌曟径濠傤劉婵﹤顭烽弫鎾诲棘閵堝洨校闂佺顑呯�氫即銆侀弮鍫濋唶闁哄洨鍠撻崢浠嬫煙閸忚偐鏆橀柛濞垮�曢…鍥箛椤撶姷顔曢梺鍛婄懃椤э拷闁兼澘娼￠弻鏇㈠幢濡わ拷閺嗙偟绱掔紒妯肩疄鐎规洘顭堥ˇ瀵哥磼閻樺啿鍝烘慨濠呮缁辨帒螣閾忛�涚礃婵犵妲呴崑鍕拷姘煎墮鐓ら柛褎顨嗛埛鎺懨归敐鍫綈闁稿濞�閺屾稒鎯旈鍏肩彎閻庢鍠楄ぐ鍐�﹂妸鈺侀唶婵犻潧顑嗛敍妤�鈹戦悙宸殶濠殿喗鎸抽、鏍幢濞戞鍘遍梺鍦劋閸ゆ俺銇愰幒鎾存珳婵犮垼鍩栬摫妞ゃ儲鐗楃换娑㈠箣閻愭潙闉嶉梺缁樻惈缁绘繂顕ｆ繝姘亜闁绘挸娴烽ˇ鈺呮⒑闂堟稓澧曟俊顐ｎ殜椤㈡棃鏁撻敓锟�?"));
		//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾剧懓顪冪�ｎ亝鎹ｉ柣顓炴閵嗘帒顫濋悙顒�顏舵俊銈囧Х閸嬫盯藝閻㈢鍨傚Δ锝呭暙缁犳稑霉閿濆懏璐＄紒瀣╄兌缁辨捇宕掑顒婃嫹閻戣姤鍊块柨鏇氱劍閹冲矂姊绘担鍛婂暈闁荤喆鍎抽幑銏狀潨閿熻棄顕ｆ繝姘亜闁惧繐婀遍敍婊堟⒑闂堟稓绠冲┑顔炬暬閹﹢宕奸妷锔规嫼濠电偠灏褔鐛Δ浣典簻闁靛鍎婚煬顒傦拷娈垮枦椤曆囧煡婢舵劕顫呴柣姗�娼ф慨鍫曟⒒娴ｅ憡鍟為柛鏃撻檮缁傚秹寮介‖顒婄秮瀹曠厧鈹戦崘鈺傛澑闂備礁鐤囧Λ鍕涘Δ浣侯洸婵犻潧顑嗛悡銉╂煛閸ヮ煁顏堟倶閼碱剨鎷峰▓鍨灈妞ゎ厾鍏橀獮鍐椤厾鍓ㄦ繛杈剧到濠�杈ㄧ閺嶎厽鈷掑ù锝囶焾椤ュ繘鏌ｉ幘宕囧ⅵ鐎规洘婢樿灃闁告侗鍠栭敓钘夊閿熻棄绠嶉崕閬嵥囨导鏉戠厱闁瑰瓨绶疯ぐ鎺戠闁兼祴鏅滈崳顔剧磽娴ｅ壊妯堥柛鐘崇墵濠�浣糕攽閻樿宸ラ柛鐔跺嵆瀹曟椽鏁愰崱鈺傤啍闂佺粯鍔栬ぐ鍐汲濞嗘挻鐓熼柨婵嗙箳缁★拷濡ょ姷鍋涚粔褰掑箹瑜版帩鏁冮柕鍫濈箲鐎氱懓鈹戦悩宕囶暡闁抽攱鍨归幉鎼佹偋閸繄鐟ㄦ繛瀛樼矆閸楁娊寮诲☉銏犵閻庨潧鎲￠崚娑橆渻閵堝啫鐏柣妤冨Т閻ｇ兘鎮㈢喊杈ㄦ櫌闂佺鏈划搴∥ｉ崶顒佲拻濞撴熬鎷锋繛浣冲懏宕查柛顐犲劚閸ㄥ倹绻涘顔绘喚闁轰礁鍊块弻锝夊棘閸喗鍊梺缁樻尰閻熲晠寮诲☉銏犵婵炲棗楠忛幏鐑藉冀椤愵剚瀚规慨妯煎亾鐎氾拷,闂傚倸鍊搁崐鎼佸磹閹间礁纾瑰瀣捣閻棗銆掑鐐濡ょ姷鍋為悧鐘汇�侀弴姘辩Т闂佹悶鍎洪崜锕傚极閸愵喗鐓ラ柡鍥朵簼鐎氬綊姊哄Ч鍥э拷妤呭磻閹捐埖宕叉繝闈涙川缁★拷闂佺鏈划宀劼烽敓浠嬫⒒娴ｄ警鐒炬い鎴炲灩閹广垹鈹戠�ｎ亣鎽曢梺鍝勬储閸ㄥ綊鏌嬮崶銊х瘈闂傚牊绋掗幖鎰磼閹邦厾娲存慨濠冩そ瀹曘劍绻濇惔銏㈡殾闁诲海娅㈤幏鐑芥煙闂傚顦﹂柦鍐枛閺岋綁寮崶顭戜哗缂佺偓鍎抽妶鎼佸蓟閺囷紕鐤�闁哄洨鍊敐澶嬬厽闊洦鎸炬晶锔芥叏婵犲倹鎯堥悡銈夋偣閸ャ劌绲荤紒鐘叉惈椤啴濡堕崘銊ヮ瀳闂佹寧娲︽禍婊堫敋閿濆棛绡�婵﹩鍓欏畵鍡涙⒑缂佹ɑ顥堟い銉︽尵缁綁鎮欓悜妯锋嫼闂佸憡鎸昏ぐ鍐╃濠靛牏纾奸悹鍥ㄥ絻閿熻棄缍婇獮鍫ュΩ閳轰緡娼婇梺闈涚箞閸ㄥ鏁嶅┑鍥╃閺夊牆澧介崚浼存煙绾板崬浜濋柣妤�閰ｅ缁樻媴鐟欏嫬浠╅梺鍛婃煥闁帮絽顕ｉ锝囩瘈婵﹩鍓涙导瀣⒑閸濆嫬鏆欓柣妤�妫涚划鍫ュ礃閳瑰じ绨婚梺鍝勫�圭�笛囷綖瀹ュ洦鍠愰柡鍐ㄧ墕閽冪喐绻涢幋娆忕仼閸烆垶姊洪棃娑氱畾闁告挻绻堥幃鐢稿籍閸屾粎锛濇繛杈剧秬椤曟牕鈻撻敐鍥╃＜缂備焦顭囩粻鎾淬亜椤愩垻绠伴悡銈嗐亜韫囨挸顏х紒鍗炵埣濮婃椽宕ㄦ繝鍐槱闂佺顑嗛幑鍥嵁韫囨稒鐓ラ悗锝呯仛鏁堥梺鐟板悑閻ｎ亪宕洪崟顖氱；闁靛鍎弨鑺ャ亜閺冿拷閺嬬粯绗熷☉銏＄厱闁规儳顕ú瀵革拷娈垮枟婵炲﹪寮崘顔肩＜婵炴垶鑹鹃獮妤呮⒒娴ｄ警鏀伴柟娲讳簽瀵板﹥銈ｉ崗顖氼槹瀵板嫰骞囬鍌滄毎闂備胶绮弻銊┿�冩惔掳锟芥帗绻濆顓犲帾闂佸壊鍋呯换鍫ヮ敁濡や緡娈介柣鎰儗濞堟粓鏌＄仦鍓ф创濠碘剝鎮傛俊鐤槻闁绘挾鍠栭幃妤冩喆閸曨剛顦ㄩ梺鎼炲妽鐎笛勭┍婵犲洦鍊婚柦妯侯槺閸樻悂姊虹粙鎸庢拱妞ゃ劌妫涢敓鑺ヨ壘閵堢顫忕紒妯诲缂佸瀵ч崐顖滅磽娴ｉ鍔嶉柟绋垮暱椤曪綁寮婚妷銉у幐闂佸憡渚楅崢楣冨传濡や胶绠鹃悗鐢殿焾鐢爼鏌ｆ幊閸旀垵鐣烽幇鏉块唶闁哄洨濮磋ぐ鍕⒑閹肩偛鍔︽い銉︽尵閿熸垝绲婚崑鎰閹烘惟闁靛牆娲ㄩ悡鎾绘⒑閸濆嫮鐏遍柛鐘崇墵閹即顢氶敓钘夌暦瑜版帩鏁婇柛娆嶅劜閸嬪懎鈹戦敍鍕杭闁稿鍊濆畷鎴﹀川椤栨艾鐏婇梺瑙勫礃椤曆囧几娓氾拷閺岀喖宕滆鐢盯鎮楅悽闈浶㈡い顓℃硶閹瑰嫰鎮滃Ο缁樺婵犵數鍋涢悧濠囧磿閹惰棄鐓橀柟瀵稿仜缁犵娀姊虹粙鍖℃敾婵炶尙鍠栭悰顔界節閸愨晛鍔呴梺鏂ユ櫅閸燁垰鈻撴导瀛樷拻闁稿本鑹鹃敓浠嬵棑濞嗐垹顫濋澶屽姺閻熸粍姊婚惁顒勬⒑鐠恒劌鏋欐俊顐㈠閸╃偤骞嬮敃锟介悘鎶芥煣韫囷絽浜滈柡瀣█濮婅櫣鎷犻垾宕囦哗闂佸摜鍣ラ崹鎶藉箲閵忕姭鏀介柛鈾�鏅滈崓闈涱渻閵堝棙灏扮紒瀣笧閿熻姤鑹鹃妶绋款潖缂佹ɑ濯撮柛娑橈工閺嗗牏绱撴担绛嬪殭闁稿﹤顭烽弫鎾绘嚍閵夈儱姣堥梺鍛娒肩划娆忕暦濮橆厾绡�闁告劦浜顕�姊洪崨濠勨槈闁挎洩绠撳畷銏ゆ焼瀹ュ棌鎷洪梻鍌氱墛娑撶懓鈽夐姀鐘殿槰闂佺粯鍔﹂崜姘舵儊閺冨牊鈷掗柛灞剧懅椤︼箓鏌熺喊鍗炰喊妤犵偛锕ラ幆鏃堝Ω閿曪拷娴滎垱绻濋棃娑橈拷濠氣�﹂崼銉ュ嚑濞撴熬鎷烽柡宀�鍠栧畷婊嗩槾閻㈩垱鐩弻锟犲川椤旇棄锟芥劙鏌＄仦璇插闁诡喓鍊濆畷鎺戔槈濮楀棔绱�
		gnet.link.Onlines.getInstance().insert(this, roleid);
		StateManager.logger.error(new StringBuilder("roleid=").append(roleid).append(" CEnterWorld: 闂傚倸鍊搁崐鎼佸磹瀹勬噴褰掑炊椤掑鏅悷婊冪Ч閿濈偛鈹戠�ｎ偅娅囬梺绋跨焿婵″洨绮欒箛鏃傜瘈闁靛骏绲介悡鎰版煕閺冿拷閻楃姴鐣烽幋锕�围濠㈣泛顑囬崢鎼佹⒑閹肩偛鍔楅柡鍛☉閻剟姊绘担铏瑰笡閻㈩垱甯￠弫鍐Ψ瑜庡畷鍙夌箾閹存瑥鐏╂鐐灪娣囧﹪顢涘┑鍥朵哗婵炲濮甸幐鍐差潖濞差亜绠归柣鎰絻椤绱撴担绛嬪殭闁绘鎸搁锝嗙節濮橆儵鈺呮煃閸濆嫬锟藉憡绂嶅鍫熲拺闁告稑锕︾粻鎾绘倵濮橆剚鍤囧┑顕嗘嫹闂侀潧绻堥崹濠氭晬濠婂牊鈷戦悹鎭掑妼閺嬫瑥鈹戦鍝勶拷鏇㈩敋閵夆晛绀嬫い鏍ㄦ皑閻わ拷婵＄偑鍊栭幐鐐叏閹绢喚宓佹俊銈勮兌缁★拷缂佸墽澧楄摫妞ゎ偄锕弻娑㈠Ω瑜庨弳顒併亜閵忊�蹭孩妞わ箑顕敓钘夌仛濠㈡﹢鏁冮鍫濈疇闁跨喓濮村洿闂婎偄娲﹂弻銊╊敂鐠鸿　鏀介柣鎰皺婢ф洟鏌ｈ箛鏃傜疄鐎殿喗鎮傞幃銏焊娴ｈ鏉搁梻浣虹帛閸旀﹢顢氬鍫㈠彆妞ゆ帒鍋婇幏宄扳枔閸喗鐏堝銈庡幖閸㈡煡顢氶敐澶婄妞ゆ梻鈷堝濠囨⒑閺傘儲娅呴柛鐕佸灦椤㈡棃鎮㈤崗灏栨嫽婵炶揪缍�婵倗娑甸崼鏇熺厱闁挎繂绻掗悾鍨殽閻愯尙绠婚柡浣规崌閺佹捇鏁撻敓锟�?"));
		
		PRoleOnline pRoleOnline = new PRoleOnline(userId,roleid);
		try
		{
			if (rolesnum > 0) 
				new mkdb.Procedure()
				{
					protected boolean process() throws Exception {
						final xbean.Properties roleProp = xtable.Properties.get(roleid);
						if (null == roleProp)
							return false;
						if(roleProp.getSysconfigmap().size() == 0){
							GameSystemConfig.resetSysConfig(roleProp);
						}
						
						Integer oldMaxScreenShowNum = roleProp.getSysconfigmap().get(SysConfigType.MaxScreenShowNum);
						if(oldMaxScreenShowNum == null)
							oldMaxScreenShowNum = 0;
						if(rolesnum == oldMaxScreenShowNum)
							return true;
						roleProp.getSysconfigmap().put(SysConfigType.MaxScreenShowNum, rolesnum);
						return true;
					};
				}.submit().get();
			pRoleOnline.submit().get();
		} catch (Exception e)
		{
			StateManager.logger.error(new StringBuilder("roleid=").append(roleid).append(" 闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊炲銈嗗笂缁�渚�宕滈鐑嗘富闁靛牆妫楁慨褏绱掗悩鍐茬伌闁绘侗鍣ｆ慨锟介柕鍫濇閸樻捇鏌℃径灞戒沪濠㈢懓妫濆畷婵嗩吋閸℃劒绨婚梺鍝勫�搁悘婵嬵敂椤撶喐鍙忓┑鐘插鐢盯鏌熷畡鐗堝殗鐎规洏鍔嶇换婵嬪磼濞戞瑧鏆梻鍌氬�峰ù鍥х暦閻㈢绐楅柛鈩冪☉绾惧潡寮堕崼顐簽濞存粏椴哥换婵嬫偨闂堟稈鏋呭┑鐐板尃閸忕偓绋戦埥澶愬閻樺疇绶㈤梻浣瑰濮婂寮查銈囦笉濡わ絽鍟悡鏇㈡煃閳轰礁鏋ゆ繛鍫燂耿閹綊骞囬妸锔界彆缂備胶绮粙鎴︻敊韫囨侗鏁婄紓浣姑弸銈夋⒒娴ｈ姤銆冪紒锟芥笟锟藉畷鎰板锤濡わ拷閽冪喐绻涢幋鐐冩艾危閸儲鐓曟俊銈呭暙娴狅箓鏌ｈ箛鎾缎ф慨濠呮缁辨帒螣閼测晩鍞剁紓鍌欒兌婵敻骞愰幖渚婄稏闊洦娲滅壕鍏间繆椤栨繍鍤欐い搴㈡尰缁绘盯骞橀弶鎴濇瘓闂佹悶鍔屽畷顒勫煝閹炬潙顕遍悗娑櫱氶幏娲⒑閼姐倕鏋戞繝銏∶埢鎾诲煛閸涱喚鍘甸梺鍛婂灟閸婃牜锟芥熬鎷�?").append(e));
		}
		new DRoleOnlineFail().doDone(pRoleOnline);
	}
	

	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 786437;

	public int getType() {
		return 786437;
	}

	public long roleid;
	public int rolesnum; // 同屏能看见的人数

	public CEnterWorld() {
	}

	public CEnterWorld(long _roleid_, int _rolesnum_) {
		this.roleid = _roleid_;
		this.rolesnum = _rolesnum_;
	}

	public final boolean _validator_() {
		if (roleid < 1) return false;
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		_os_.marshal(roleid);
		_os_.marshal(rolesnum);
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		roleid = _os_.unmarshal_long();
		rolesnum = _os_.unmarshal_int();
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof CEnterWorld) {
			CEnterWorld _o_ = (CEnterWorld)_o1_;
			if (roleid != _o_.roleid) return false;
			if (rolesnum != _o_.rolesnum) return false;
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		_h_ += (int)roleid;
		_h_ += rolesnum;
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append(roleid).append(",");
		_sb_.append(rolesnum).append(",");
		_sb_.append(")");
		return _sb_.toString();
	}

	public int compareTo(CEnterWorld _o_) {
		if (_o_ == this) return 0;
		int _c_ = 0;
		_c_ = Long.signum(roleid - _o_.roleid);
		if (0 != _c_) return _c_;
		_c_ = rolesnum - _o_.rolesnum;
		if (0 != _c_) return _c_;
		return _c_;
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

