
package fire.msp.npc;

import java.util.ArrayList;
import java.util.List;
import java.util.Map;
import fire.pb.activity.timernpc.TimerNpcService;
import fire.pb.game.SUseXueYueKey;
import fire.pb.map.Npc;
import fire.pb.map.Role;
import fire.pb.map.RoleManager;
import fire.pb.map.SceneNpcManager;
import fire.pb.scene.movable.NPC;
import fire.pb.talk.MessageMgr;
import fire.pb.util.Misc;

// {{{ RPCGEN_IMPORT_BEGIN
// {{{ DO NOT EDIT THIS
import com.locojoy.base.Marshal.OctetsStream;
import com.locojoy.base.Marshal.MarshalException;

abstract class __GFindNpcWithNpcId__ extends mkio.Protocol { }

// DO NOT EDIT THIS }}}
// RPCGEN_IMPORT_END }}}

public class GFindNpcWithNpcId extends __GFindNpcWithNpcId__ {
	@Override
	protected void process() {
		// protocol handle
		int actId = TimerNpcService.getInstance().getActId(npcid);
		//婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄闁挎繂妫Λ鍕⒑閸濆嫷鍎庣紒鑸靛哺瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁绘劦鍓欓崝銈嗐亜椤撶姴鍘寸�殿喖顭烽弫鎰板川閸屾粌鏋涚�规洦鍋婂畷鐔碱敆閿熶粙鏁撻挊澶愬弰婵﹨娅ｇ槐鎺懳熼搹鍦噯闂備焦瀵уú蹇涘磿閸偂绻嗛柣銏㈩焾缁�瀣亜閺傚灝鈷旈柡澶嬫倐濮婅櫣鎲撮崟顐ゎ槰濠电偛顦伴惄顖炲春濞戙垹閱囬柕澶涜吂閹锋椽鏌℃径灞戒沪濠㈢懓妫濊棟闁挎柨顫曟禍婊堟煙鐎涙绠栭柛鐘成戦〃銉╂倷瀹割喗鈻堥悗瑙勬磸閸斿秶鎹㈠┑瀣闁靛鍎遍煢闂傚倸鍊风欢姘焽瑜旈垾锕傚醇閵夈儳锛熼梺瑙勫劶婵倝宕戦鍫熺厱闁哄洢鍔岄悘锟犳煃闁垮鐏存慨濠傤煼瀹曞ジ鎮㈠畡鎵槹闂備礁澹婇崑渚�宕曢柆宥嗗仾闁绘劦鍓涚粻楣冩煙鐎涙鎳冮柣蹇ｄ邯閺屾稓锟斤綆浜滈敓钘夋贡閹广垹鈽夐姀鐘殿吅濠电偛妫楃换鎺撶妤ｅ啯鈷戠紓浣股戠亸鐗堢箾閸欏鐒介柟骞垮灩閳藉濮�閻樻鍚呮繝鐢靛█濞佳兾涘鍫濇槬闁绘劗鍎ら埛鎴︽煕濠靛棗顏撮柛搴＄Ч閺屾稒绻濋崘顏嗙杽閻庢鍠涢褔鍩ユ径濞㈢喖鏌ㄧ�ｎ剨鎷锋繝姘棅妞ゆ劑鍨烘径鍕繆椤愩垻绠伴摶鐐烘煟閹邦喖鍔嬮柍閿嬪灴閹宕烽鐑嗭拷灞剧箾閸忕厧濮嶉柡灞剧洴婵℃悂濡烽敃锟芥禒鏉懳旈悩闈涗粶闁哥噥鍋婇崺銏℃償閵娿儳顔掗悗瑙勬礀濞层劑宕㈤锟介埞鎴︽偐椤旇偐浼囬梺绯曟櫆閻楃偤骞楅锔解拺闁圭娴烽埣銉х磼閼镐絻澹樻い顐㈢箻瀹曨偊宕熼幊宄版搐閻愬﹦鎲歌箛娑樼闁圭虎鍠楅埛鎴︽煕閹剧懓鐨洪柛妯荤☉闇夋繝濠傜凹缁ㄧ粯銇勯弴顏嗙М鐎殿喖顭锋俊鐑芥晝閿熻姤绂嶈ぐ鎺撯拺闁兼祴鏂侀幏锟犳煕閹剧澹橀柍缁樻尰閵堬綁宕橀埞鐐婵犳鍠氶幊鎾趁洪妶澶嬪�堕柍鍝勬噺閻撴瑩鎮归崶鍥ф噽閻﹀牓鎮楀▓鍨灍闁绘搫绻濋悰顕�寮介妸锕�顎撻梺闈╁瘜閸樼厧顕ｉ幎鑺モ拻濞达綀娅ｇ敮娑欑箾閸欏澧电�规洘鍔欏畷鐑筋敇閵婏箑顏跺┑顔筋焽閸嬫挾锟芥熬鎷�
		if (actId == -1) {
			return;
		}
		
		boolean findit = false;
		int findmapid = 0;
		int findposx = 0;
		int findposy = 0;
		long npckey = 0;
		
		Role sceneRole = RoleManager.getInstance().getRoleByID(roleid);
		int roleMapid = sceneRole.getMapId();
		
		//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚敐澶婄闁挎繂鎲涢幘缁樼厱闁靛牆鎳庨顓㈡煛鐏炲墽娲存い銏℃礋閺佹劙宕卞▎娆戠┛闂傚倷娴囧▔鏇㈠窗閹版澘鍑犻柤濮愬�楁稉宥夋煙閹咃紞闁哄棴绠戦埞鎴﹀磼濠婂海鍔稿銈庡亜閹虫﹢寮诲澶娢ㄩ柕澶堝劜濮ｆ劗绱撴担闈涘Ω闁稿酣娼ч～蹇曠磼濡顎撶紓浣圭☉椤戝棛绱為崼鐔虹瘈闁靛繈鍨洪崵锟藉┑鈽嗗亝閻熲晛顕ｉ懠顒佸磯濞达絾娲樺Λ鍐ㄧ暦閵娾晩鏁囬柣娆忔噽楠炪垽姊绘担绛嬪殭闁告垹鏅槐鐐哄幢濞戞鐛ュ┑掳鍊曢幊蹇涘磻閸岀偞鐓涢柛銉ｅ劚閻忣亪鏌ｉ幘鍐叉殻闁哄苯绉靛顏堝箥椤曞懏袦闂備礁鎼鍐磹閺嶎偅宕叉繛鎴欏灩闁卞洦銇勯幒鎴濓拷鏄忊叺闂傚倷绀侀幖顐ゆ偖椤愶箑纾规繝闈涱儏缁犳牜鎲搁弬璺ㄦ殾闁绘挸绨堕弨浠嬫煙闁箑澧柣銈呭�垮濠氬磼濞嗘垹鐛㈠┑鐐板尃閸忕姵妞芥俊鍫曞炊闁垮顏跺┑顔筋焽閸樠囨倶閿濆洨纾兼い鏃�顑欓崵娆撴煃閽樺妯�濠殿噯鎷烽梺缁樕戦鏍疮鐎ｎ喗鈷掑ù锝呮啞閹牊銇勯敂鍨祮鐎规洖缍婂畷褰掝敃閵堝孩閿ら梺鑽ゅ█缂傛岸濡撮敓浠嬫煛閿熻姤绂掔�ｎ偆鍘介梺褰掑亰閸ㄤ即鎯冨ú顏呯厵闁伙絽鑻暩缂備浇椴哥敮锟犮�佸▎鎾村殐闁冲搫鍟╃槐妯肩磽閸屾瑦绁板ù婊庡墴瀹曟垿鎮欓崹顐㈠簥濠电娀娼ч鍛存倷婵犲嫭鍠愰柟杈剧畱缁犳椽鏌￠崶銉ョ仾闁抽攱鍨圭槐鎾存媴閼测剝鍨块崺娑㈠箳濡や胶鍘卞┑鈽嗗灣婵挳骞婇幇顓犫枖鐎广儱妫欓崣蹇斾繆椤栨碍鍋ラ柛婵囨そ閺屾盯鎮╅崘鎻掝潕闂佽法鍠曞Λ鍕不瀹ュ纾块梺顒�鍗曢崶顒夋晬婵絽鐏曢崶褑鎽曢梺闈涱槶閸庤櫕顨ラ崶顒佲拺闁告挻褰冩禍婵堢磼鐎ｎ偄鐏﹀ǎ鍥э功缁瑥螞閻㈠灚鍤�妞ゎ厹鍔戝畷鐔碱敇閻橀潧甯ㄩ梻鍌欑閹碱偊寮甸锟界叅闁绘棃顥撻弳锕傛煟閹惧磭宀搁柡锟芥禒瀣厱闁靛鍨电�氶攱绂掗銏♀拻闁稿本鐟ч崝宥夋煙椤旇偐鍩ｇ�规洘鍔欏鎾倶缂佹ɑ銇濇い銏★耿婵拷闁绘鍎ら幉浼存⒒娴ｈ櫣甯涙慨濠傤煼閸╂盯宕奸妷銉︾�繝鐢靛Т濞诧箓鎮￠悢鍏肩厵闁诡垎鍐╂瘣濡炪倖甯囬崹铏圭矉瀹ュ應妲堥柕蹇婃閹风粯绻涙潏鍓у埌闁硅姤绮撳鎼佸礃閳瑰じ绨婚梺鍝勬搐濡宕板顒夌劷闁冲搫鎳忛悡銉╂煛閸屾氨浠㈤柍閿嬫煥閳藉骞樺畷鍥嗭絿绱掔紒妯兼创妤犵偛顑呴埢搴ょ疀閺囨碍鍋呯紓鍌氬�风欢锟犲磻閸曨厾鐭撶憸鐗堝笒閽冪喖鏌ｉ弮鍌氱殤闁归鍏橀幃钘夆枔鐠恒劌濮奸梻浣告啞閹稿摜澹曢鐘愁潟闁圭儤鎸荤紞鍥ㄣ亜椤撶喎鐏﹂柣銈勭閳规垿顢欑涵宄颁紣濡炪値鍘奸崲鏌ユ偩閻戣棄绠抽柟瀛樻⒐閻庡姊洪悷閭﹀殶濠殿喖鍢查悾鐑藉矗婢跺瞼鐦堥梺姹囧灲濞佳勭閳轰緡鐔嗛柣鐔稿婢ф洟鏌ｉ敐鍥у幋婵☆偄鍟埥澶愬础閻愭惌鍞繝鐢靛Х閺佸憡鎱ㄩ弶鎳ㄦ椽鏁冮崒姘憋紱闂佸啿鎼崰娑㈠箯閻戣姤鍎岄柛娑橈工椤忓爼姊绘担鑺ョ《闁哥姵鎹囧鏌ヮ敃閵堝懎鐏婇梺鍓插亞閸犳挾寮ч敓浠嬫⒑缁嬫寧婀版い銊ユ瀵剟鏁撴禒瀣拻濞达綀娅ｇ敮娑㈡煥濮樻唻鎷峰▓鍨灈闁绘牕銈搁悰顕�寮介鐐电杸闂佺粯顨呴悧蹇涘矗閸愵喗鈷戦柛娑橈工婵箑霉濠婂嫮鐭掔�殿喗鎮傚顕�宕奸悢鍝勫汲闂備胶绮濠氬磿閵堝應鏋嶉柡鍥╁枔缁犻箖鏌涘☉鍗炰簻闁诲繐寮堕〃銉╂倷閼碱剛顔掗梺璇″枟缁捇骞婇悙鍝勎ㄧ憸宥咁嚕閹惰姤鈷掑ù锝堟鐢稒淇婇锛勭獢妞ゃ垺淇洪ˇ鑸点亜閿濆牊纭剁紒杈ㄦ崌瀹曟帒鈻庨幋顓熜滈梻浣侯焾閿曘倕锕㈤柆宥呮瀬妞ゆ洩鎷烽柡浣规崌閹晠宕ｆ径宀嬫嫹椤掑嫭鈷戦柛娑橈工婵箓鏌涢悩宕囧⒈濠㈣娲熷畷妤呭礂閻撳骸浼庢繝纰樻閸ㄤ即濡靛锟藉畷銉╊敃閿旂晫鍘搁梺绯曞墲濞叉牕鐣甸崱娑欑厸鐎癸拷鐎ｎ剛袦闂佽鍠撻崹钘夌暦椤愶箑唯鐟滃繘宕㈤幋鐘电＝闁稿本鐟х拹浼存煕閻樺磭澧甸柟顖氭湰缁楃喖鏁撴禒瀣畺婵☆垳銆嬮幏鐑芥晲鎼粹剝鐏嶉梺鎶芥敱閸ㄥ湱妲愰幘瀛樺闁兼祴鍓濋崹鑳＂闂佺硶鍓濋…鍥╃不妤ｅ啯鐓曟繝濠傚暙閺嗙喖鏌熼鎯у付妞ゎ叀娉曢幉鎾礋椤掑偆妲归梻浣告贡椤牓鏁冮妷褏鍗氶柣鏂跨殱閺�浠嬫煕閳╁啰鎳呭Δ鏃堟⒒娴ｈ姤銆冮柣鎺炵畵瀹曟繂鈻庤箛鏇熸闂侀潧艌閺呪晠寮繝鍥ㄧ參婵☆垯璀﹀Σ绋款熆閻熸壆效婵﹨娅ｉ幏鐘诲箵閹烘繂濡风紓鍌欑椤戝棛鏁悙鍝勭闁靛繈鍊曢柋鍥煏婢跺牆鍔ら柣锝呮惈閳规垶骞婇柛濠冩礋瀹曨垶顢涢悙鑼崶闂佺硶鍓濈粙鎺楁偂閺囥垺鐓涢柛銉ｅ劚婵＄厧顭胯閸犳濡甸崟顖涙櫆閻熸瑥瀚悵姘攽椤旂》鏀绘俊鐐舵閻ｇ兘濡搁敂鍓х槇闂佸憡鍔戦崝宥呪枔椤愶附鈷掑ù锝呮啞閹茬鈹戦鐐毈闁诡啫鍥ㄥ亹缂備焦锚娴犳帒顪冮妶鍡樼┛闁圭兘顥撻敓鍊燁潐濞叉﹢鏁冮姀銈呯伋闁挎梹鎷濋幏鐑芥晲鎼粹�茬凹闂侀潧娲︾换鍐Φ閸曨垰顫呴柍鈺佸枤濡啴鎮楃憴鍕８闁告梹鍨块妴浣糕枎閹寸娀鈹忛柣搴岛閺呮粓宕哄☉銏♀拻闁稿本鑹鹃敓鑺ユ倐瀹曟劕鐣￠幊濠傜秺瀹曟儼顦柡瀣墵閺岋繝宕堕妷銉т患闂傚倸鍋嗛崹鍫曞蓟閵娾晛鍗抽柣鎰嚋閹风兘宕妷褌绗夊銈嗙墱閸嬬偤鎮￠妷鈺傜厽闁哄洨鍋涢敓钘夋贡閿熻姤鐔幏锟�
		fire.pb.scene.movable.Role role = fire.pb.scene.manager.RoleManager.getInstance().getRoleByID(roleid);
		Map<Long, NPC> allNpcInScreens = role.getAllNpcsInScreens();
		for (NPC npc : allNpcInScreens.values()) {
			if (npc.getNpcID() == npcid) {
				findit = true;
				findmapid = npc.getScene().getMapID();
				findposx = npc.getPos().toGridPos().getX();
				findposy = npc.getPos().toGridPos().getY();
				npckey = npc.getNpcKey();
				break;
			}
		}
		
		//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊為悷婊冪箻瀵娊鏁冮崒娑氬幗闂侀潧绻堥崺鍕倿閸撗呯＜闁归偊鍙庡▓婊堟煛瀹�锟介崰鏍蓟閸ヮ剚鏅濋柨鐔剁矙瀵鈽夐姀锛勫幈闂侀潧顭俊鍥╃不閻愭惌娈介柣鎰嚟婢ь亪鎳ｉ幇顓滀簻闁硅櫣鍋炵�氬綊姊虹拠鍙夌濞存粍绻勯幑銏犫槈閵忕姴绐涘銈嗙墬椤曟挳鏁愰崥鍐查叄瀹曟儼顧傞棅顒夊墮閳规垿鍨惧畷鍥х厽閻庤娲忛崝鎴︺�佸▎鎾崇缁炬澘褰夐崫妤冪磽閸屾艾锟芥悂宕愰悜鑺ュ殑闁肩鐏氶崣蹇涙煙閹増顥夌痪顓ㄦ嫹闂備浇顫夐崕鐓幬涢崟顖涘珔闁绘柨鎽滅粻楣冩煙鐎电锟芥垵顫濋鈺嬬秮瀹曞ジ鎮㈢粙鍨紟婵犲痉鏉匡拷褔骞忛悜鑺ョ厽婵°倧鎷烽柨鏇ㄤ簻椤曪綁顢曢敃锟界粻姘辨喐婢舵劕缁╁ù鐘差儐閻撶喖鏌熼柇锕�澧紒鐙欏洦鐓曢柨婵嗙墛椤ュ鏌嶇憴鍕伌闁诡喗绮撳畷鍫曞Ω閵夘喕绱﹂梻鍌氬�搁崐椋庣矆娓氾拷楠炴牠顢曢敂钘夊壒婵犮垼娉涢懟顖滄閵堝鐓曞┑鐘插閺嬫柨霉濠婏拷缁瑥顫忕紒妯诲闁荤喐婢樻慨銏㈢磽娴ｈ櫣甯涢柨鏇樺灲瀵偊骞樼紒妯烘疅闂侀潧锛忔笟濠冨闁圭儤鍩堝〒濠氭偡濞嗗繐顏╅柍缁樻礃閹便劍绻濋崟顓炵闂佺懓鍢查幊妯虹暦閵婏妇绡�闁告劑鍔嶉悗鐐節閻㈤潧校妞ゆ梹鐗犲畷鏉课旈敓浠嬧�﹂崶褉鏋庨柟鐑樻煣缂冩洖鈹戦悩鍨毄濠电儑鎷峰┑鐐板尃閸ヨ埖鏅為梺鍛婄☉閻°劎锟芥艾鎳橀弻锝夊棘閹稿孩鍠愮紓浣哄█缁犳牠寮婚悢鐚存嫹濞戞瑯鐒介柟鍐插暣閺岋綀绠涙繝鍐╃彋闂佸搫鐭夌紞渚�鐛幒妤�绠绘繛锝庡厸閾忓酣姊绘担鍛婃儓闁哄牜鍓熼幆鍕敍閻愰潧绁﹂梺鎼炲労閸撴瑧绮堥崒鐐寸厱婵犻潧瀚崝婊堟倵閸偆鐭嬬紒缁樼箘閸犲﹤螣閸濆嫧鎷ら柣鐔哥矋濠㈡﹢宕幘顔肩畺鐟滄柨鐣烽崡鐐╂婵☆垳鍘ч獮瀣⒒娴ｄ警鏀伴柟娲讳邯濮婁粙宕熼姘憋紮闂佺粯鍨兼慨銈夋偂閺囩喓绠鹃柛鈩冾殕缁傚淇婇崣澶嬪�愰柡宀嬬到閳规垿宕堕妸銏″缂傚倷娴囨ご鎼佸箲閸パ呮殾闁圭儤鍩堝鈺傛叏閿濆棛鎳曠紒杈ㄦ礈濡叉劙骞掑Δ浣规闂佸吋浜介崕鎶芥偡瑜版帗鐓ラ柣鏂垮閻瑩鏌℃担鐟板闁诡喗鐟╁畷婊勬媴閻戞ɑ绶梻鍌欒兌閹虫捁銇愰悙鐑樺�块柨鏇嫹妞ゎ亜鍟粋鎺旓拷锝庣厜閹烽攱绗熼敓钘夘嚕椤曪拷瀹曠厧鈹戦崼顐Ｐу┑锛勫亼閸婃牠骞愰崱娑樼闁冲搫鍊圭欢顐︽⒒閸屾艾锟芥悂宕愰幖浣哥９濡炲娴烽惌鍡椕归敐澶嬩氦闁兼澘娼″娲敆閿熺晫绮旂�电顥氶柛褎顨嗛悡蹇涙煕椤愶絿绠ユ俊鎻掓憸缁辨帡鎮╅搹顐ゅ嚒闂佸疇顫夐崹鍧楀箖閳哄喛鎷烽崷顓炐㈡い銉︾箘缁辨挻鎷呴崫鍕碉拷宀勬煕閵娿劍纭炬い顐㈢箰鐓ゆい蹇撶У閺呫垽姊虹捄銊ユ灁闁哄拋鍋嗛崚鎺楀籍閸喎浠虹紓浣割儓濞夋洟宕㈤柆宥嗏拺闁荤喖鍋婇崵鐔兼煕鐎ｎ剙浠辩�规洩缍�缁犳稑鈽夊▎鎴濆箺闂備胶绮弻銊╁箹椤愶负锟藉倹绺介崨濠勫幍闂佺绻掗崢褎鎱ㄥ澶嬬厸閻忕偛澧藉ú瀵革拷娈垮櫘閸ｏ綁寮幘缁樺癄濠㈣泛鏈▓鏇㈡⒑瑜版帗锛熺紒锟芥笟锟介幏鎴︽偄閸忚偐鍘介梺鍝勫�搁悘婵嬪箖閹达附鐓欐い鏍ㄧ矊娴狅箓鏌曢崶褍顏鐐叉喘閹虫粓妫冨☉鍙樼处婵犵绱曢崑鎴﹀磹閺囩姵宕查柟鎵閸嬪绻濇繝鍌滃闁哄绶氶幃妤呮晲鎼粹剝鐏嶉梺缁樻尪閸庤尙鎹㈠┑瀣棃婵炴垶鐟辩槐鐐测攽閳ュ啿绾ч柟顔煎�垮璇测槈閵忕姈鈺呮煏婢跺牆鍔甸柟椋庢焿閵囨劙骞掗幊绛圭畵閺屾盯寮撮妸銉т哗缂備胶濮甸惄顖炲蓟瀹ュ棙濮滈柟宄拌嫰閸樷剝绻涚�电甯堕悗姘煎枤濡叉劙骞樼�涙ê顎撻梺鑽ゅ枑濠㈡﹢锝炴惔銊︹拺缂佸顑欓崕宥夋煕婵犲啰绠撴い鏇稻缁绘繂顫濋鐔哥彸闂備胶纭堕崜婵嬫晪闂佸憡鏌ㄩ幊搴ㄢ�旈崘顔嘉ч柛鈩冪懃椤呯磽娓氬洤鏋涢悗娑掓櫊閹勬償閵忋垻鐦堥梺姹囧灲濞佳勭濠婂牊鐓熼幒鎶藉礉鎼淬劌绀嗛柟鐑樻礈閻わ拷闂佸湱铏庨崹閬嶆倶閸愩劉鏀介柣鎰綑閻忥妇绱掗鐓庮劉缂佸倸绉归弻鍡楊吋閸″繑瀚藉┑鐐舵彧缂嶏拷婵炲拑绲块弫顔尖槈閵忥紕鍘搁柣蹇曞仩椤曆勬叏閸屾粣鎷风憴鍕８闁稿孩濞婇弫鎾诲棘閵堝洨校闂佸摜濮甸悧鐘诲箖閿熺姴鍗抽柕蹇ョ磿閸樼敻鏌℃径濠勫ⅵ缂佺姵鐗曢‖濠囶敋閿熶粙寮诲澶嬬叆閻庯綆浜濈拠鐐烘⒑閸濆嫭婀伴柣鈺婂灦閵嗕線寮撮姀鈩冩珳闂佹悶鍎撮崺鏍р枔鐟欏嫮绡�闁汇垽娼ф禒婊堟煙閸愭煡顎楅摶鐐寸節闂堟侗鍎忕紒鐘崇墬娣囧﹪濡惰箛鏂款伓婵＄偑鍊ら崑鍛崲閸儱绠栨繛鍡樻惄閺佸棝鏌ㄩ悢鍓佺煓妞ゃ垺妫冮弫鎾绘晸閿燂拷?,闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鎯у⒔閹虫捇鈥旈崘顏庢嫹閿濆簼绨奸柟鐧哥秮閺岋綁顢橀悙鎼闂侀潧妫欑敮鎺楋綖濠靛鍊锋い鎺炴嫹妞ゅ繗鍩栨穱濠囧Χ閸ヮ灝銉╂煕鐎ｎ偆娲撮挊婵嬫煟閵忋埄鐒鹃柡瀣╄兌閿熻棄绠嶉崕閬嵥囬婊呯焼閻庯綆鍋佹禍婊堟煙閸濆嫮肖闁告柨绉甸妵鍕棘閹稿骸顦╃紓浣虹帛缁诲倿顢氶妷鈺傜叆閻庯綆鍋嗛崙锟犳⒑鐠恒劌鏋欏┑顔哄�曠叅闁绘棁鍋愬畵浣糕攽閻樺弶鍣介柣銈忔嫹婵犵數鍋為崹鍫曗�﹂崶顒佹櫖婵炴垯鍨洪埛鎴︽偣閹帒濡奸柡瀣煥閳规垿顢欓悙顒佹瘓闂佽鍟撻妶鍥╂澑闂佺懓鐏濋崯浼村船閻㈠憡鐓熼柣妯垮吹缁辩増绻涢崪鍐ɑ闁哄懎鐖煎鎾閿涘嫬骞堥梻浣告惈閸燁偊宕愯ぐ鎺戞辈妞ゆ帒瀚悡娑㈡倶閻愰鍤欓柨鐔诲Г缁诲牓鐛崘顓ф▌閻庤娲滈崢褔鍩為幋锕�绠涙い鎺嶈兌閺夋椽姊婚崒姘拷椋庢濮橆剦鐒界憸宥囧弲闂侀潧鐗嗗ù鍕箯瀹勯偊娼╅柣鎾虫捣娴狀垳绱撴笟鍥ф灕妞ゆ泦鍥х叀濠㈣埖鍔曢～鍛存煟濡椿鍟忛柛鐔奉儔濮婄粯鎷呴崨濠冨創濡炪倧缂氶崡鍐茬暦瑜版帒鍨傛い鎰╁�ゅú鎼佹煟閻樿崵绱伴柕鍡嫹闂佺尨鎷峰ù鐘差儐閻撶喖鏌熼柇锕�鐏犻柣銊︽そ閺岀喖鎮剧仦鍙儳绱掓潏銊ユ诞妞ゃ垺鐟╅幊鏍煛閸愌呯缂傚倸鍊峰ù鍥ㄧ椤掑嫬纾婚柣鎰仛瀹曞弶绻濋棃娑卞剰闁绘劕锕﹂幉鎼佸箣閿曪拷缁犳椽鏌￠崶銉ョ仾闁抽攱鍨圭槐鎾存媴閼测剝鍨块崺娑㈠箳濡や胶鍘卞┑鈽嗗灣婵挳骞婇幇顓犫枖鐎广儱妫欓崣蹇斾繆椤栨碍鍋ラ柛婵囨そ閺屾盯鎮╅崘鎻掝潕闂佽法鍠曞Λ鍕不瀹ュ纾块梺顒�鍗曢崶顒夋晬婵絽鐏曢崶褑鎽曢梺闈涱槶閸庤櫕顨ラ崶顒佲拺闁告挻褰冩禍婵堢磼鐎ｎ偄鐏﹀ǎ鍥э功缁瑥螞閻㈠灚鍤�妞ゎ厹鍔戝畷鐔碱敇閻橀潧甯ㄩ梻鍌欑閹碱偊寮甸锟界叅闁绘棃顥撻弳锕傛煟閹惧磭宀搁柡锟芥禒瀣厱闁靛鍨电�氶攱绂掗銏♀拻闁稿本鐟ч崝宥夋煙椤旇偐鍩ｇ�规洘鍔欏鎾倶缂佹ɑ銇濇い銏★耿婵拷闁绘鍎ら幉浼存⒒娴ｇ懓顕滅紒瀣灩閿熻姤鍑规禍婊堝煝娴犲鏁傞柛顐ゅ枔閸橀亶姊洪崷顓炰壕妞ゃ劌鎳愰敓鑺ュ嚬閸撶喎鐣疯ぐ鎺撶劶鐎广儱妫岄幏缁樼箾鏉堝墽绉┑顔哄�濇俊鎾礃椤忓棛锛滈梺璺ㄥ枙婵倗绮悢鍏兼櫢闁芥ê顦遍弳锕傛煙閻楀牊绶查梺瑁ゅ�栨穱濠囧Χ韫囨柨顏剁紓鍌欒兌婵攱绻涢敓浠嬫煛瀹�瀣М妤犵偛娲、妤佹媴閻熸澘澹嶉梻浣告憸閸庢劙宕归崼鏇炵畺鐎瑰嫰鍋婇悡銉╂煕閹扮鎷烽鍡楁嫅閹烽鎲撮崟顒傤槶闂佽桨绀侀…鐑芥偘椤曪拷楠炴帒螖閿熺晫绮绘繝姘厱闁规崘灏崗灞句繆閹绘帗鍠樻慨濠勭帛閹峰懘宕烽鐔诲即闂備焦鎮堕崝蹇撐涢崟顖楋拷锕傚炊椤忓秵歇缂傚倷绀侀崐鍦暜閹烘せ锟斤箓濡搁埡渚�鍞堕梺缁樻煥閹碱偊鐛Δ鍛拺闁革富鍘奸崝瀣攽閻愯宸ラ柣锝呭槻閳规垹锟斤綆浜為娲⒑閹稿孩绌块柟椋庡厴閺岋紕锟斤絺鏅濈粣鏃堟煛鐏炲墽娲存鐐叉喘濡啫鈽夊▎鎴滈偗濠碉紕鍋戦崐銈夊磻閸曨垰绠犳慨妤嬫嫹鐎殿喖顭峰鎾閻樿鏁规繝鐢靛█濞佳兠洪敃鍌氱畺婵炲棙鍨圭壕钘壝归敐澶樻缂佹稑绻掔槐鎺楁偐閾忣偄纰嶅銈庡亜缁绘﹢骞栭崷顓熷枂闁告洦鍋嗛敍蹇涙⒒娓氾拷濞佳団�﹂崼銉ョ？闁哄被鍎查崑鐔兼煏韫囧锟芥牠鍩涢幋锔界厽闁绘柨鎲＄欢鍙夌箾閸碍娅婇柡宀�鍠栧畷娆撳Χ閸℃浼�?
		if (!findit) {
			xbean.timerNpcInfoCol npcInfo = xtable.Timernpcinfotable.select(actId);
			if (npcInfo == null) {
				return;
			}
			
			List<Long> npcList = new ArrayList<Long>();
			for (Map.Entry<Long, xbean.timerNpcInfo> npcinfos : npcInfo.getNpcinfo().entrySet()) {
				//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氼參宕崇壕瀣ㄤ汗闁圭儤鍨归崐鐐差渻閵堝棗绗掓い锔垮嵆瀵煡顢旈崼鐔蜂画濠电姴锕ら崯鐗堟櫏婵犵數濯撮幏宄般�掑鐐濠殿喖锕ㄥ▍锝囨閹烘嚦鐔兼惞闁稓绀冨┑鐘殿暯濡插懘宕戦崟顓ㄦ嫹濮橆厽绶叉い鏇秮瀹曘劍绻濋崟顓熷殞闂備浇娉曢崰宥囧垝濞嗗浚鍤曞┑鐘崇閸嬪嫰鏌涜箛鎾舵癁闁瑰嘲顭烽弻锝嗘償閵婏附閿繝銏㈡嚀閿曘倕宓勫銈嗘煥婢х晫澹曢挊澹濆綊鏁愰崨顔藉創闁哥喎鎲＄换婵嬫偨闂堟稑澹嬮梺褰掝棑閸忔ê顫忓ú顏勪紶闁告洦鍘炬导鍥⒑閸濄儱校闁绘濞�閻涱噣宕橀妸銏＄�婚梺鐟扮仢閸燁垶寮查姀銈嗏拺閻犳亽鍔岄弸宥囩磼椤旂晫鎳冮柣锝呭槻閳规垿宕奸悢椋庯紡闂佽崵鍋炵粙鍫ュ礈濠靛妫橀柨鐔诲Г娣囧﹪鎮欓鍕舵嫹閺嶎灛娑欐媴閼叉繃鐩畷鐔碱敍濮樺崬骞掗梻浣告惈濞层垽宕瑰ú顏呭亗婵炴垶鐔幏鐑芥儌閸涘﹤顏堕梺璇插嚱缂嶅棝宕滃☉婧惧徍婵犵绱曢崑鎴﹀磹閹达箑鍨傛繛宸簵閿熻棄鍟村畷鍗炍旀繝鍌涱唫闂備礁鎲″ú锕傚矗韫囨稑绠柣鎴ｅГ閺呮煡骞栫划鐧告嫹閼碱剛娉垮┑鐘垫暩閸嬫盯鎮ч崱妤婂殫濠电姴娲﹂埛鎺楁煕鐏炴崘澹橀柨鐔诲Г閹倸鐣烽幇鏉跨濞达絽鎽滈敍娆撴⒑瑜版帗锛熺紒锟芥担鍝勵棜鐟滅増甯楅悡鐔兼煙鏉堝墽鍒扮悮姘舵⒑缁嬪尅宸ユ繛纭风節瀵濡搁埡浣稿祮闂佺粯鍔橀婊堝箯閻ゎ垬浜归柟鐑樺灩閿涚喖姊洪悷閭﹀殶濠殿喚鏁诲畷浼村箛閻楀牏鍘藉┑掳鍊ч幏鐑芥煟濡わ拷濡稓鍒掗銏犵闁哄啫鍊婚敍婊堟⒑鐠恒劌鏋欏┑顔哄�曢銉╁礋椤愩倖娈曢柣搴秵閸嬪嫰顢旈崼鏇熲拺閻犲楠搁崯顖炲疮閻愮儤鍊垫慨姗嗗墰缁夌儤鎱ㄦ繝鍛仩闁圭懓瀚版俊鎼佸Ψ閿旀拝鎷烽搹鍦＝濞撴艾娲ら弸鐔兼煟閻斿弶娅呮い鏇秮椤㈡洟鏁冮敓鐣岀不閼姐倗纾藉ù锝咁潠椤忓嫧鏋旈柣鏂垮悑閳锋垿姊婚崼鐔剁繁婵℃彃鐖奸弻娑欐償閳ュ疇鍩為悶姘懇閺屾盯顢曢悩鎻掑闂佹娊鏀遍崹鍧楀蓟濞戞ǚ鏀介柛鏇ㄥ亜婵酣鏌″渚婃嫹閹颁焦瀵岄梺闈涚墕閸燁偅淇婃總鍛婄叆闁哄洢鍔嬮柇顖炴煙椤旇宓嗘い銏″哺閺佹捇鎸婃径灞炬婵犻潧鍊婚…鍫濇暜闂備線娼чˇ顖滆姳閸洖鐤鹃柣妯款嚙閽冪喓锟藉箍鍎卞Λ娆愭叏濠婂牊鐓欑�瑰嫭濯界�氫即鏌涘Ο鍑ゆ嫹閹颁焦瀵岄梺闈涚墕濡瑩鍩涢幇鐗堢厱闁哄喛鎷烽柣妤佺矒楠炴垿濮�閻橆偅顫嶅┑鐐叉閸旀绮旈崼鏇熲拺闁告稑锕ョ�垫瑩鏌涢幇鈺佸闁告ɑ甯″濠氬磼濞嗘帒鍘″銈冨灩閿曘儵骞堥妸鈺佄ч柛銉戝啰浜伴梻浣筋潐瀹曟﹢顢氳缁寮介‖顒佹閺佹劙宕ㄩ鐔割唹闂備礁鎼幊蹇涘箖閸岀偛钃熼柕濞炬櫆閸嬪棝鏌涚仦鍓р槈妞ゅ骏鎷�? 0=缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閹冣挃闁硅櫕鎹囬垾鏃堝礃椤忓孩瀚归柨婵嗙凹缁ㄥジ鏌熼惂鍝ョМ闁哄矉缍侀、姗�鎮欓幖顓燁棧闂備線娼уΛ娆戞暜閹烘缍栨繝闈涱儐閸婇攱銇勯幒鐐村濡炪倕绻愰悥濂稿蓟閿濆棙鍎熼柕蹇婃櫅閺呴亶姊洪崫銉バｇ�癸拷缁嬫鍤曟い鎰剁悼缁★拷濠殿喗菧閸庡骞忛柨瀣闁煎弶绻冨Λ鍐ㄧ暦閵娾晩鏁婇柤鎭掑労娴犙勭節閻㈤潧浠滄い鏇ㄥ幗閹便劑骞橀鍛櫈闂佺鐬奸崑鐐哄疾閹间焦鐓犻柟顓熷笒閸旀粍銇勯妷銉уⅱ闁跨喎锟界噥娼愭繛鍙夛耿閺佸啴濮�閵堝喛鎷锋担绯曟瀻闁圭偓娼欓惂鍕節閵忥絾纭鹃柡鍫墴椤㈡挸顓奸崱娆戠槇闂佹眹鍨藉褑鈪烽梻浣规偠閸斿瞼绱炴繝鍌滄殾闁靛繒濯悡銉╂煕椤愶絿绠橀柡灞熷啠鏀介柣妯款嚋瀹搞儵鏌ｅΔ锟介敃顏勭暦閺囩喐鍎熼柍褜鍏涚花濠氭⒑閸濆嫮鈻夐柛瀣缁傛帒顭ㄩ崼鐔哄幐闁诲函绲洪弲婵堢玻閺冨牊鐓涚�癸拷閿熶粙宕伴弽褏鏆︽繝濠傛－濡查箖鏌ｉ姀鈺佺仭闁烩晩鍨跺濠氭晸閻樻彃绐涘銈嗘濡嫰鏁撻懞銉ュ闁哄矉绱曟禒锔炬嫚閹绘帩娼庨梻浣筋嚃閸犳捇宕愬┑鍡欐殾闁圭儤鍨熷Σ鍫熸叏濡わ拷濡梻妲愰敓锟� 1=闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚敐澶婄闁挎繂鎲涢幘缁樼厱闁靛牆鎳庨顓㈡煛鐏炲墽娲存い銏℃礋閺佹劙宕卞▎妯恍氱紓鍌氬�烽懗鑸垫叏闁垮绠鹃柨鐔剁矙閺屸�崇暆閿熶粙宕伴弽褏鏆︽繝濠傛－濡查箖鏌ｉ姀鈺佺仭闁烩晩鍨跺璇测槈濮樼偓瀚归柨婵嗗暙婵″ジ鏌ㄩ悢璇残撶紒璇茬墕椤曪絾绻濆顒�宓嗛梺缁樻濞咃綁顢欓弴銏♀拺闁告捁灏欓崢娑㈡煕閻樺磭澧甸柍銉︾墬瀵板嫰骞囬娑欏闂備浇宕甸崰鎰熆濮楋拷瀵娊鏌嗗鍡欏幗濡炪倖鎸鹃崑娑㈡晸閼恒儲鍊愰柨婵堝仩缁犳盯寮撮悩纰夌床婵犵妲呴崹鐢割敋瑜旈、鎾诲箻缂佹ǚ鎷洪梺鍛婄☉閿曪箓鍩ユ径鎰叆闁哄洦锚閸旓妇锟借娲樺ú鐔肩嵁濮楋拷楠炲洦鎷呴悷鎵В闂傚倷绶氬褔鎮ч崱妞㈡稑螖閸涱喖锟藉爼鏌曟径娑橆洭缂佺姴澧介敓鐣屾嚀婢瑰﹪宕伴弽顓犲祦闁哄稁鍘介悡鐔兼煥濠靛棭妲归柡渚�浜堕幃妤呮濞戞牕浠悗娈垮枛閻栧ジ鐛�ｎ喗鍋愰柛顭戝亝缁额偅绻濈喊澶岀？闁稿鍨垮畷鎰板冀椤撶偠鎽曢梺闈涱煭闂勫嫬鈻嶉悩瑁佸綊鎮╁顔煎壉闂佺顑呴崐鍧楀蓟閻旂厧绀堢憸蹇曟暜濞戙垺鐓冮梺鍨儏閻忔挳鏌熼鑲╃Ш妤犵偘绶氶獮鎺楀箣濠垫劗锟借櫕绻濋悽闈涗粶闁瑰啿绻樺畷婵嗏枎閹惧疇鎽曢梺缁樻⒒閸樠呯矆閸曨垱鐓忛柛顐ｇ箖椤ユ粍銇勮箛銉﹀? 2=闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊炲銈嗗笒椤︿即寮查鍫熷仭婵犲﹤鍟版晥闂佹寧绻勯崑娑㈠煘閹寸媴鎷烽敐搴′簼婵炲懎娲铏圭矙鐠恒劎鍔规繝纰橈拷铏窛缂侇喗鐟ㄧ粻娑㈠籍閸屾粎妲囬梻渚�娼ф蹇曞緤娴犲鍋傞柟鎵閻撴洟鏌￠崘鎸庡闂佺粯顨堟慨鎾偩閻戣棄绠ｉ柨鏇嫹閸ュ瓨绻濋姀锝嗙【妞ゆ垵娲畷銏ゅ箹娴ｅ厜鎷洪梺纭呭亹閸嬫盯宕濆Δ鍛厸闁告侗鍠氶埥澶愭煟椤垵澧存慨濠勭帛閹峰懘鎼归悷鎵偧闂佹眹鍩勯崹杈╂暜閿熺姴鏋侀柛鎰靛枛鍞悷婊冮閻ｇ兘宕ｆ径宀�顔曢梺鐟扮摠閻熴儵鎮橀埡鍌ゆ闁绘劦浜滈悘顏勄庨崶褝韬い銏＄☉閳规垿宕堕張闈涙憢婵犵數鍋涢顓熸叏閻㈢绠伴柛鎰▕濞兼牗绻涘顔荤盎缂佺姴缍婇弻锝夊箛椤撶偟绁峰銈庡墮椤﹁京妲愰幘瀛樺缂佹稑顑呭▓顓㈡⒑缂佹﹩娈曢柟鍛婃倐椤㈡岸鏁愰崶銊ョ彴閻庣懓澹婇崰鏍箖閹寸偟绡�闁靛骏绲剧涵鍓ф嫬閳哄懏鐓忓┑鐐靛亾濞呭棝鏌ｉ幘鍗炲姦闁哄矉绻濆畷姗�濡搁妷顖涘闁荤喐澹嬮弸宥夋煛閸モ晙绱崇憸鐗堝笚閸嬪倿骞栧ǎ顒�鐏柟顔界懇濮婅櫣锟藉湱濯鎰版煕閵娿儲鍋ョ�规洘妞藉畷鐔碱敍濮橀硸妲伴梻渚�娼ц噹闁告侗鍋勬禒顓㈡⒒閸屾艾锟界兘鎳楅崜浣稿灊妞ゆ牜鍋戦敓钘夊暣瀹曞崬鈽夊Ο纰卞敼闂備焦鎮堕崕婊呬沪閼恒儺鍚欓梻浣藉吹婵潙煤閿斿墽鐭堥柡澶嬪殾閿濆閱囬柕澶涘閸橆亪妫呴銏℃悙闁挎洏鍎遍埢宥夊幢濞戞瑧鍘搁梺鍛婁緱閸犳氨绮婚悙瀛樺弿濠电姴鍟妵婵囶殽閻愭潙濮堥柟顖涙閺佹劙宕堕埡鍌涱啌婵犵數濮烽弫鎼佸磻濞戙垺鍎戝ù鍏兼綑缁�澶愬箹缁懓鐏抽柨婵嗩槸缁犳盯鏌ｅΔ锟介悧鍡樼闁秵鈷戦柛鎾村絻娴滄牠鏌涢妸銉吋妞ゃ垺鐟╁鎾閿涘嫬骞楅梺鐟板悑閻ｎ亪宕规繝姘參濞达絽绠嶆禍婊勩亜閹捐泛浠﹂柛鐘筹耿閺岀喖顢欓幐搴ｅ涧缂備胶绮换鍌烇綖濠靛鏁囬柣妯诲絻缁犮儵姊婚崒娆戭槮闁硅绻濆畷褰掝敍閻愯尙锛欓梺鍝勭▉閸嬫捇骞忓畡閭︽僵闁绘劦鍓欓锟�
				if (npcinfos.getValue().getNpcstatus() == 0) { //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄闁挎繂妫Λ鍕⒑閸濆嫷鍎庣紒鑸靛哺瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁诡垎鍐ｆ寖缂備緡鍣崹鎶藉箲閵忕姭妲堥柕蹇曞Х椤撴椽姊虹紒妯哄闁诲繑宀稿畷瀹狀槾缂佽鲸鎸婚幏鍛矙濞嗙偓娈洪梻浣侯焾椤戝啴宕愬┑鍡╁殨閻犲洦绁村Σ鍫ユ煏韫囨洖顫嶉柕濠忚礋娴滄粓鏌￠崘銊ワ拷鍝ユ暜閼哥偣浜滄い鎰枑濞呭洨绱掓潏銊﹀鞍缂佹鍠愮换婵嬪礃椤垳绱﹂梻鍌氬�风粈浣圭珶婵犲洤纾婚柛鈩冪☉缁愭鏌熼幑鎰【濠殿噮鍓熼弻銊╂偄閸撲胶鐓撳┑顔硷工椤嘲鐣烽幒鎴僵闁告鍎愰弶鍝ョ磽閸屾瑧顦︽い鎴濇閺侇噣鏁撻悩鍙夌�悗骞垮劚椤︻垳鐚惧澶嬬厱妞ゆ劑鍊曢弸鏃堟煕濮楋拷缁犳牕顫忓ú顏勪紶闁告洖鐏氭瓏婵犵數鍋涢ˇ鏉棵哄Ο鑲╃焿闁圭儤顨呴～鍛存煏閸繃锛嶆慨濠冨缁绘繈濮�閿濆懐鍘梺鍛婃⒐閻楃娀骞冮敓鐘参ㄩ柨鏂垮⒔閻﹀牓姊婚崒姘卞缂佸甯¤棢闁绘劗顣幏鐑芥偡閻楀牆鏆堢紓浣筋嚙閻楁挸顕ｆ繝姘嵆闁靛繒濮撮懓鍨攽鎺抽崐鏇㈩敄閸℃稑鏋侀柣鎰靛墰缁犻箖鏌ㄥ┑鍡樺櫤闁瑰吋鍔欓弻銊╁即閵娿倝鍋楅梺缁樹緱閸ｏ綁鐛Ο鍏煎珰闁肩⒈鍓﹂崬娲⒒娴ｅ憡鎯堥柛濠傛憸閼洪亶鏌嗗鍛厬濠电偛妯婃禍婵嬪煕閹烘嚚褰掓晲閸涱喖鏆堥梺璇″灠閻楁捇寮婚敓鐘查唶妞ゆ劑鍨归埛瀣⒑鐠団�崇仩閻庢矮鍗抽妴浣糕槈閵忊�筹拷閿嬨亜韫囨挸顒㈤悗姘辨嚀閵嗘帒顫濋悙顒�顏堕柣搴㈩問閸犳骞愰搹顐ｅ弿闁跨喍绮欓弻宥夊煛娴ｅ憡娈查梺缁樼箖婵炲﹤顫忕紒妯诲閻熸瑥瀚禒鈺呮⒑缁嬪灝鐦ㄩ柛锝忕到椤曪綁骞撻幒鍡樻杸闂佸壊鍋侀崹濠氱嵁閹炬枼鏀介幒鎶藉磹瑜旈獮蹇涙倻閼恒儳鍘撻柣鐔哥懃鐎氼剟鎮橀幘顔界厵妞ゆ梻鏅幊鍥煙瀹曞洤鈻堟い銏☆殕閹峰懘鎮烽悧鍫邯缂傚倸鍊搁崐鎼佸磹妞嬪孩顐介柨鐔哄Т闂傤垱銇勯弽銊х煂缂侊拷婵犲倶锟芥帒顫濋悙顒�顏堕梻浣虹帛娓氭宕板☉姘变笉婵炴垶菤濡插牊绻涢崱妯哄妞ゅ繒鍠栧缁樻媴閼恒儳銆婇梺闈╃秶缁犳捇鐛箛娑欐櫢闁跨噦鎷�
					npcList.add(npcinfos.getKey());
				}
			}
			
			for (Long npckeyy : npcList) {
				Npc npc = SceneNpcManager.selectNpcByKey(npckeyy);
				if (npc == null)
					continue;
				
				if (roleMapid == npc.getMapId()) {
					findit = true;
					findmapid = roleMapid;
					findposx = npc.getPos().toGridPos().getX();
					findposy = npc.getPos().toGridPos().getY();
					npckey = npckeyy;
					break;
				}
			}
		}
		
		if (!findit) {
			xbean.timerNpcInfoCol npcInfo = xtable.Timernpcinfotable.select(actId);
			if (npcInfo == null) {
				return;
			}
			
			List<Long> npcList = new ArrayList<Long>();
			for (Map.Entry<Long, xbean.timerNpcInfo> npcinfos : npcInfo.getNpcinfo().entrySet()) {
				//闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳婀遍敓鐣屾嚀鐎氼參宕崇壕瀣ㄤ汗闁圭儤鍨归崐鐐差渻閵堝棗绗掓い锔垮嵆瀵煡顢旈崼鐔蜂画濠电姴锕ら崯鐗堟櫏婵犵數濯撮幏宄般�掑鐐濠殿喖锕ㄥ▍锝囨閹烘嚦鐔兼惞闁稓绀冨┑鐘殿暯濡插懘宕戦崟顓ㄦ嫹濮橆厽绶叉い鏇秮瀹曘劍绻濋崟顓熷殞闂備浇娉曢崰宥囧垝濞嗗浚鍤曞┑鐘崇閸嬪嫰鏌涜箛鎾舵癁闁瑰嘲顭烽弻锝嗘償閵婏附閿繝銏㈡嚀閿曘倕宓勫銈嗘煥婢х晫澹曢挊澹濆綊鏁愰崨顔藉創闁哥喎鎲＄换婵嬫偨闂堟稑澹嬮梺褰掝棑閸忔ê顫忓ú顏勪紶闁告洦鍘炬导鍥⒑閸濄儱校闁绘濞�閻涱噣宕橀妸銏＄�婚梺鐟扮仢閸燁垶寮查姀銈嗏拺閻犳亽鍔岄弸宥囩磼椤旂晫鎳冮柣锝呭槻閳规垿宕奸悢椋庯紡闂佽崵鍋炵粙鍫ュ礈濠靛妫橀柨鐔诲Г娣囧﹪鎮欓鍕舵嫹閺嶎灛娑欐媴閼叉繃鐩畷鐔碱敍濮樺崬骞掗梻浣告惈濞层垽宕瑰ú顏呭亗婵炴垶鐔幏鐑芥儌閸涘﹤顏堕梺璇插嚱缂嶅棝宕滃☉婧惧徍婵犵绱曢崑鎴﹀磹閹达箑鍨傛繛宸簵閿熻棄鍟村畷鍗炍旀繝鍌涱唫闂備礁鎲″ú锕傚矗韫囨稑绠柣鎴ｅГ閺呮煡骞栫划鐧告嫹閼碱剛娉垮┑鐘垫暩閸嬫盯鎮ч崱妤婂殫濠电姴娲﹂埛鎺楁煕鐏炴崘澹橀柨鐔诲Г閹倸鐣烽幇鏉跨濞达絽鎽滈敍娆撴⒑瑜版帗锛熺紒锟芥担鍝勵棜鐟滅増甯楅悡鐔兼煙鏉堝墽鍒扮悮姘舵⒑缁嬪尅宸ユ繛纭风節瀵濡搁埡浣稿祮闂佺粯鍔橀婊堝箯閻ゎ垬浜归柟鐑樺灩閿涚喖姊洪悷閭﹀殶濠殿喚鏁诲畷浼村箛閻楀牏鍘藉┑掳鍊ч幏鐑芥煟濡わ拷濡稓鍒掗銏犵闁哄啫鍊婚敍婊堟⒑鐠恒劌鏋欏┑顔哄�曢銉╁礋椤愩倖娈曢柣搴秵閸嬪嫰顢旈崼鏇熲拺閻犲楠搁崯顖炲疮閻愮儤鍊垫慨姗嗗墰缁夌儤鎱ㄦ繝鍛仩闁圭懓瀚版俊鎼佸Ψ閿旀拝鎷烽搹鍦＝濞撴艾娲ら弸鐔兼煟閻斿弶娅呮い鏇秮椤㈡洟鏁冮敓鐣岀不閼姐倗纾藉ù锝咁潠椤忓嫧鏋旈柣鏂垮悑閳锋垿姊婚崼鐔剁繁婵℃彃鐖奸弻娑欐償閳ュ疇鍩為悶姘懇閺屾盯顢曢悩鎻掑闂佹娊鏀遍崹鍧楀蓟濞戞ǚ鏀介柛鏇ㄥ亜婵酣鏌″渚婃嫹閹颁焦瀵岄梺闈涚墕閸燁偅淇婃總鍛婄叆闁哄洢鍔嬮柇顖炴煙椤旇宓嗘い銏″哺閺佹捇鎸婃径灞炬婵犻潧鍊婚…鍫濇暜闂備線娼чˇ顖滆姳閸洖鐤鹃柣妯款嚙閽冪喓锟藉箍鍎卞Λ娆愭叏濠婂牊鐓欑�瑰嫭濯界�氫即鏌涘Ο鍑ゆ嫹閹颁焦瀵岄梺闈涚墕濡瑩鍩涢幇鐗堢厱闁哄喛鎷烽柣妤佺矒楠炴垿濮�閻橆偅顫嶅┑鐐叉閸旀绮旈崼鏇熲拺闁告稑锕ョ�垫瑩鏌涢幇鈺佸闁告ɑ甯″濠氬磼濞嗘帒鍘″銈冨灩閿曘儵骞堥妸鈺佄ч柛銉戝啰浜伴梻浣筋潐瀹曟﹢顢氳缁寮介‖顒佹閺佹劙宕ㄩ鐔割唹闂備礁鎼幊蹇涘箖閸岀偛钃熼柕濞炬櫆閸嬪棝鏌涚仦鍓р槈妞ゅ骏鎷�? 0=缂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚悢鍏尖拻閻庨潧澹婂Σ顔剧磼閹冣挃闁硅櫕鎹囬垾鏃堝礃椤忓孩瀚归柨婵嗙凹缁ㄥジ鏌熼惂鍝ョМ闁哄矉缍侀、姗�鎮欓幖顓燁棧闂備線娼уΛ娆戞暜閹烘缍栨繝闈涱儐閸婇攱銇勯幒鐐村濡炪倕绻愰悥濂稿蓟閿濆棙鍎熼柕蹇婃櫅閺呴亶姊洪崫銉バｇ�癸拷缁嬫鍤曟い鎰剁悼缁★拷濠殿喗菧閸庡骞忛柨瀣闁煎弶绻冨Λ鍐ㄧ暦閵娾晩鏁婇柤鎭掑労娴犙勭節閻㈤潧浠滄い鏇ㄥ幗閹便劑骞橀鍛櫈闂佺鐬奸崑鐐哄疾閹间焦鐓犻柟顓熷笒閸旀粍銇勯妷銉уⅱ闁跨喎锟界噥娼愭繛鍙夛耿閺佸啴濮�閵堝喛鎷锋担绯曟瀻闁圭偓娼欓惂鍕節閵忥絾纭鹃柡鍫墴椤㈡挸顓奸崱娆戠槇闂佹眹鍨藉褑鈪烽梻浣规偠閸斿瞼绱炴繝鍌滄殾闁靛繒濯悡銉╂煕椤愶絿绠橀柡灞熷啠鏀介柣妯款嚋瀹搞儵鏌ｅΔ锟介敃顏勭暦閺囩喐鍎熼柍褜鍏涚花濠氭⒑閸濆嫮鈻夐柛瀣缁傛帒顭ㄩ崼鐔哄幐闁诲函绲洪弲婵堢玻閺冨牊鐓涚�癸拷閿熶粙宕伴弽褏鏆︽繝濠傛－濡查箖鏌ｉ姀鈺佺仭闁烩晩鍨跺濠氭晸閻樻彃绐涘銈嗘濡嫰鏁撻懞銉ュ闁哄矉绱曟禒锔炬嫚閹绘帩娼庨梻浣筋嚃閸犳捇宕愬┑鍡欐殾闁圭儤鍨熷Σ鍫熸叏濡わ拷濡梻妲愰敓锟� 1=闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧綊鏌熼梻瀵割槮缁炬儳缍婇弻鐔兼⒒鐎靛壊妲紒鐐劤缂嶅﹪寮婚敐澶婄闁挎繂鎲涢幘缁樼厱闁靛牆鎳庨顓㈡煛鐏炲墽娲存い銏℃礋閺佹劙宕卞▎妯恍氱紓鍌氬�烽懗鑸垫叏闁垮绠鹃柨鐔剁矙閺屸�崇暆閿熶粙宕伴弽褏鏆︽繝濠傛－濡查箖鏌ｉ姀鈺佺仭闁烩晩鍨跺璇测槈濮樼偓瀚归柨婵嗗暙婵″ジ鏌ㄩ悢璇残撶紒璇茬墕椤曪絾绻濆顒�宓嗛梺缁樻濞咃綁顢欓弴銏♀拺闁告捁灏欓崢娑㈡煕閻樺磭澧甸柍銉︾墬瀵板嫰骞囬娑欏闂備浇宕甸崰鎰熆濮楋拷瀵娊鏌嗗鍡欏幗濡炪倖鎸鹃崑娑㈡晸閼恒儲鍊愰柨婵堝仩缁犳盯寮撮悩纰夌床婵犵妲呴崹鐢割敋瑜旈、鎾诲箻缂佹ǚ鎷洪梺鍛婄☉閿曪箓鍩ユ径鎰叆闁哄洦锚閸旓妇锟借娲樺ú鐔肩嵁濮楋拷楠炲洦鎷呴悷鎵В闂傚倷绶氬褔鎮ч崱妞㈡稑螖閸涱喖锟藉爼鏌曟径娑橆洭缂佺姴澧介敓鐣屾嚀婢瑰﹪宕伴弽顓犲祦闁哄稁鍘介悡鐔兼煥濠靛棭妲归柡渚�浜堕幃妤呮濞戞牕浠悗娈垮枛閻栧ジ鐛�ｎ喗鍋愰柛顭戝亝缁额偅绻濈喊澶岀？闁稿鍨垮畷鎰板冀椤撶偠鎽曢梺闈涱煭闂勫嫬鈻嶉悩瑁佸綊鎮╁顔煎壉闂佺顑呴崐鍧楀蓟閻旂厧绀堢憸蹇曟暜濞戙垺鐓冮梺鍨儏閻忔挳鏌熼鑲╃Ш妤犵偘绶氶獮鎺楀箣濠垫劗锟借櫕绻濋悽闈涗粶闁瑰啿绻樺畷婵嗏枎閹惧疇鎽曢梺缁樻⒒閸樠呯矆閸曨垱鐓忛柛顐ｇ箖椤ユ粍銇勮箛銉﹀? 2=闂傚倸鍊搁崐鎼佸磹閹间礁纾归柟闂寸绾惧湱锟界懓瀚崳纾嬨亹閹烘垹鍊炲銈嗗笒椤︿即寮查鍫熷仭婵犲﹤鍟版晥闂佹寧绻勯崑娑㈠煘閹寸媴鎷烽敐搴′簼婵炲懎娲铏圭矙鐠恒劎鍔规繝纰橈拷铏窛缂侇喗鐟ㄧ粻娑㈠籍閸屾粎妲囬梻渚�娼ф蹇曞緤娴犲鍋傞柟鎵閻撴洟鏌￠崘鎸庡闂佺粯顨堟慨鎾偩閻戣棄绠ｉ柨鏇嫹閸ュ瓨绻濋姀锝嗙【妞ゆ垵娲畷銏ゅ箹娴ｅ厜鎷洪梺纭呭亹閸嬫盯宕濆Δ鍛厸闁告侗鍠氶埥澶愭煟椤垵澧存慨濠勭帛閹峰懘鎼归悷鎵偧闂佹眹鍩勯崹杈╂暜閿熺姴鏋侀柛鎰靛枛鍞悷婊冮閻ｇ兘宕ｆ径宀�顔曢梺鐟扮摠閻熴儵鎮橀埡鍌ゆ闁绘劦浜滈悘顏勄庨崶褝韬い銏＄☉閳规垿宕堕張闈涙憢婵犵數鍋涢顓熸叏閻㈢绠伴柛鎰▕濞兼牗绻涘顔荤盎缂佺姴缍婇弻锝夊箛椤撶偟绁峰銈庡墮椤﹁京妲愰幘瀛樺缂佹稑顑呭▓顓㈡⒑缂佹﹩娈曢柟鍛婃倐椤㈡岸鏁愰崶銊ョ彴閻庣懓澹婇崰鏍箖閹寸偟绡�闁靛骏绲剧涵鍓ф嫬閳哄懏鐓忓┑鐐靛亾濞呭棝鏌ｉ幘鍗炲姦闁哄矉绻濆畷姗�濡搁妷顖涘闁荤喐澹嬮弸宥夋煛閸モ晙绱崇憸鐗堝笚閸嬪倿骞栧ǎ顒�鐏柟顔界懇濮婅櫣锟藉湱濯鎰版煕閵娿儲鍋ョ�规洘妞藉畷鐔碱敍濮橀硸妲伴梻渚�娼ц噹闁告侗鍋勬禒顓㈡⒒閸屾艾锟界兘鎳楅崜浣稿灊妞ゆ牜鍋戦敓钘夊暣瀹曞崬鈽夊Ο纰卞敼闂備焦鎮堕崕婊呬沪閼恒儺鍚欓梻浣藉吹婵潙煤閿斿墽鐭堥柡澶嬪殾閿濆閱囬柕澶涘閸橆亪妫呴銏℃悙闁挎洏鍎遍埢宥夊幢濞戞瑧鍘搁梺鍛婁緱閸犳氨绮婚悙瀛樺弿濠电姴鍟妵婵囶殽閻愭潙濮堥柟顖涙閺佹劙宕堕埡鍌涱啌婵犵數濮烽弫鎼佸磻濞戙垺鍎戝ù鍏兼綑缁�澶愬箹缁懓鐏抽柨婵嗩槸缁犳盯鏌ｅΔ锟介悧鍡樼闁秵鈷戦柛鎾村絻娴滄牠鏌涢妸銉吋妞ゃ垺鐟╁鎾閿涘嫬骞楅梺鐟板悑閻ｎ亪宕规繝姘參濞达絽绠嶆禍婊勩亜閹捐泛浠﹂柛鐘筹耿閺岀喖顢欓幐搴ｅ涧缂備胶绮换鍌烇綖濠靛鏁囬柣妯诲絻缁犮儵姊婚崒娆戭槮闁硅绻濆畷褰掝敍閻愯尙锛欓梺鍝勭▉閸嬫捇骞忓畡閭︽僵闁绘劦鍓欓锟�
				if (npcinfos.getValue().getNpcstatus() == 0) { //婵犵數濮烽弫鍛婃叏閻戣棄鏋侀柛娑橈攻閸欏繘鏌ｉ幋锝嗩棄闁哄绶氶弻娑樷槈濮楀牊鏁鹃梺鍛婄懃缁绘﹢寮婚敐澶婄闁挎繂妫Λ鍕⒑閸濆嫷鍎庣紒鑸靛哺瀵鎮㈤崗灏栨嫽闁诲酣娼ф竟濠偽ｉ鍓х＜闁诡垎鍐ｆ寖缂備緡鍣崹鎶藉箲閵忕姭妲堥柕蹇曞Х椤撴椽姊虹紒妯哄闁诲繑宀稿畷瀹狀槾缂佽鲸鎸婚幏鍛矙濞嗙偓娈洪梻浣侯焾椤戝啴宕愬┑鍡╁殨閻犲洦绁村Σ鍫ユ煏韫囨洖顫嶉柕濠忚礋娴滄粓鏌￠崘銊ワ拷鍝ユ暜閼哥偣浜滄い鎰枑濞呭洨绱掓潏銊﹀鞍缂佹鍠愮换婵嬪礃椤垳绱﹂梻鍌氬�风粈浣圭珶婵犲洤纾婚柛鈩冪☉缁愭鏌熼幑鎰【濠殿噮鍓熼弻銊╂偄閸撲胶鐓撳┑顔硷工椤嘲鐣烽幒鎴僵闁告鍎愰弶鍝ョ磽閸屾瑧顦︽い鎴濇閺侇噣鏁撻悩鍙夌�悗骞垮劚椤︻垳鐚惧澶嬬厱妞ゆ劑鍊曢弸鏃堟煕濮楋拷缁犳牕顫忓ú顏勪紶闁告洖鐏氭瓏婵犵數鍋涢ˇ鏉棵哄Ο鑲╃焿闁圭儤顨呴～鍛存煏閸繃锛嶆慨濠冨缁绘繈濮�閿濆懐鍘梺鍛婃⒐閻楃娀骞冮敓鐘参ㄩ柨鏂垮⒔閻﹀牓姊婚崒姘卞缂佸甯¤棢闁绘劗顣幏鐑芥偡閻楀牆鏆堢紓浣筋嚙閻楁挸顕ｆ繝姘嵆闁靛繒濮撮懓鍨攽鎺抽崐鏇㈩敄閸℃稑鏋侀柣鎰靛墰缁犻箖鏌ㄥ┑鍡樺櫤闁瑰吋鍔欓弻銊╁即閵娿倝鍋楅梺缁樹緱閸ｏ綁鐛Ο鍏煎珰闁肩⒈鍓﹂崬娲⒒娴ｅ憡鎯堥柛濠傛憸閼洪亶鏌嗗鍛厬濠电偛妯婃禍婵嬪煕閹烘嚚褰掓晲閸涱喖鏆堥梺璇″灠閻楁捇寮婚敓鐘查唶妞ゆ劑鍨归埛瀣⒑鐠団�崇仩閻庢矮鍗抽妴浣糕槈閵忊�筹拷閿嬨亜韫囨挸顒㈤悗姘辨嚀閵嗘帒顫濋悙顒�顏堕柣搴㈩問閸犳骞愰搹顐ｅ弿闁跨喍绮欓弻宥夊煛娴ｅ憡娈查梺缁樼箖婵炲﹤顫忕紒妯诲閻熸瑥瀚禒鈺呮⒑缁嬪灝鐦ㄩ柛锝忕到椤曪綁骞撻幒鍡樻杸闂佸壊鍋侀崹濠氱嵁閹炬枼鏀介幒鎶藉磹瑜旈獮蹇涙倻閼恒儳鍘撻柣鐔哥懃鐎氼剟鎮橀幘顔界厵妞ゆ梻鏅幊鍥煙瀹曞洤鈻堟い銏☆殕閹峰懘鎮烽悧鍫邯缂傚倸鍊搁崐鎼佸磹妞嬪孩顐介柨鐔哄Т闂傤垱銇勯弽銊х煂缂侊拷婵犲倶锟芥帒顫濋悙顒�顏堕梻浣虹帛娓氭宕板☉姘变笉婵炴垶菤濡插牊绻涢崱妯哄妞ゅ繒鍠栧缁樻媴閼恒儳銆婇梺闈╃秶缁犳捇鐛箛娑欐櫢闁跨噦鎷�
					npcList.add(npcinfos.getKey());
				}
			}
			
			int index = Misc.getRandomBetween(0, npcList.size() - 1);
			npckey = npcList.get(index);
			
			Npc npc = SceneNpcManager.selectNpcByKey(npckey);
			if (npc == null) {
				MessageMgr.psendMsgNotify(roleid, 170021, null);
				return;
			}
			findit = true;
			findmapid = npc.getMapId();
			findposx = npc.getPos().toGridPos().getX();
			findposy = npc.getPos().toGridPos().getY();
		}
		
		if (!findit)
			return;
		
		SUseXueYueKey useKey = new SUseXueYueKey(npcid, npckey, findmapid, findposx, findposy);
		gnet.link.Onlines.getInstance().send(roleid, useKey);
	}

	// {{{ RPCGEN_DEFINE_BEGIN
	// {{{ DO NOT EDIT THIS
	public static final int PROTOCOL_TYPE = 730436;

	public int getType() {
		return 730436;
	}

	public long roleid;
	public int npcid;

	public GFindNpcWithNpcId() {
	}

	public GFindNpcWithNpcId(long _roleid_, int _npcid_) {
		this.roleid = _roleid_;
		this.npcid = _npcid_;
	}

	public final boolean _validator_() {
		return true;
	}

	public OctetsStream marshal(OctetsStream _os_) {
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		_os_.marshal(roleid);
		_os_.marshal(npcid);
		return _os_;
	}

	public OctetsStream unmarshal(OctetsStream _os_) throws MarshalException {
		roleid = _os_.unmarshal_long();
		npcid = _os_.unmarshal_int();
		if (!_validator_()) {
			throw new VerifyError("validator failed");
		}
		return _os_;
	}

	public boolean equals(Object _o1_) {
		if (_o1_ == this) return true;
		if (_o1_ instanceof GFindNpcWithNpcId) {
			GFindNpcWithNpcId _o_ = (GFindNpcWithNpcId)_o1_;
			if (roleid != _o_.roleid) return false;
			if (npcid != _o_.npcid) return false;
			return true;
		}
		return false;
	}

	public int hashCode() {
		int _h_ = 0;
		_h_ += (int)roleid;
		_h_ += npcid;
		return _h_;
	}

	public String toString() {
		StringBuilder _sb_ = new StringBuilder();
		_sb_.append("(");
		_sb_.append(roleid).append(",");
		_sb_.append(npcid).append(",");
		_sb_.append(")");
		return _sb_.toString();
	}

	public int compareTo(GFindNpcWithNpcId _o_) {
		if (_o_ == this) return 0;
		int _c_ = 0;
		_c_ = Long.signum(roleid - _o_.roleid);
		if (0 != _c_) return _c_;
		_c_ = npcid - _o_.npcid;
		if (0 != _c_) return _c_;
		return _c_;
	}

	// DO NOT EDIT THIS }}}
	// RPCGEN_DEFINE_END }}}

}

